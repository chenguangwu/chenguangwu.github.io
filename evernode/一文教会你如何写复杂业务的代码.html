<html>
<head>
  <title>一文教会你如何写复杂业务的代码</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="13110"/>
<h1>一文教会你如何写复杂业务的代码</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2019/11/7 10:36</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://www.jianshu.com/p/0b1e5602fc53?utm_campaign=hugo&utm_medium=reader_share&utm_content=note&utm_source=weixin-timeline&from=timeline"><i>https://www.jianshu.com/p/0b1e5602fc53?utm_campaign=hugo&amp;utm_medium=reader_share&amp;utm_content=note&amp;utm_source=weixin-timeline&amp;from=timeline</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="box-sizing:border-box;font-family:sans-serif;line-height:1.15;text-size-adjust:100%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);"><div style="box-sizing:border-box;color:rgb(64, 64, 64);font-size:14px;font-family:-apple-system, BlinkMacSystemFont, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;line-height:1.42857;font-feature-settings:&quot;tnum&quot;;background-color:rgb(255, 255, 255);font-variant:tabular-nums;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;background-color:rgb(249, 249, 249);"><div style="box-sizing:content-box;-webkit-box-pack:center;justify-content:center;-webkit-box-align:start;align-items:flex-start;font-size:16px;"><div style="box-sizing:border-box;flex-shrink:0;"><div style="box-sizing:border-box;background-color:rgb(255, 255, 255);border-radius:4px;"><h1 style="box-sizing:border-box;margin-top:0px;margin-bottom:0.5em;color:rgb(64, 64, 64);font-weight:700;text-rendering:optimizelegibility;font-size:30px;word-break:break-word;">一文教会你如何写复杂业务的代码</h1><div style="box-sizing:border-box;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center;margin-bottom:32px;font-size:13px;display:flex;"><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;"><a href="https://www.jianshu.com/u/949a388d9e5d" rel="noopener noreferrer" style="box-sizing:border-box;color:inherit;text-decoration:none;background-color:rgba(0, 0, 0, 0);outline:none;cursor:pointer;transition:color 0.3s ease 0s;touch-action:manipulation;" target="_blank"><img src="一文教会你如何写复杂业务的代码_files/webp.webp" type="image/webp" data-filename="webp.webp" alt="" height="46" style="box-sizing:border-box;vertical-align:middle;display:block;border-radius:50%;border:1px solid rgb(238, 238, 238);min-width:48px;min-height:48px;width:48px;height:48px;border-style:none;" width="46"/></a><div style="box-sizing:border-box;margin-left:8px;"><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;margin-bottom:6px;"><span style="box-sizing:border-box;font-size:16px;font-weight:500;margin-right:8px;"><a href="https://www.jianshu.com/u/949a388d9e5d" rel="noopener noreferrer" style="box-sizing:border-box;color:inherit;text-decoration:none;background-color:rgba(0, 0, 0, 0);outline:none;cursor:pointer;transition:color 0.3s ease 0s;touch-action:manipulation;" target="_blank">搬砖的码哥</a></span><a href="https://www.jianshu.com/p/3bc50b869c89" rel="noopener noreferrer" style="box-sizing:border-box;color:inherit;text-decoration:none;background-color:rgba(0, 0, 0, 0);outline:none;cursor:pointer;transition:color 0.3s ease 0s;touch-action:manipulation;flex-shrink:0;margin-right:8px;" target="_blank"><img src="一文教会你如何写复杂业务的代码_files/99870935-12e7-4765-9285-d5a53768e614.png" type="image/png" data-filename="99870935-12e7-4765-9285-d5a53768e614.png" alt="" height="16" style="box-sizing:border-box;vertical-align:middle;border-style:none;display:block;width:16px;height:16px;min-width:16px;min-height:16px;" width="16"/></a></div><div style="box-sizing:border-box;display:flex;color:rgb(150, 150, 150);"><span style="box-sizing:border-box;margin-right:10px;display:inline-flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;color:rgb(236, 114, 89);"><i style="box-sizing:border-box;display:inline-block;color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-0.125em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased;margin-right:0.5em;"><span style="color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;display:none;"></span><span style="box-sizing:border-box;overflow:hidden;line-height:1;display:inline-block;"><span style="box-sizing:border-box;"></span></span></i><span style="box-sizing:border-box;">7</span></span><span style="box-sizing:border-box;margin-right:10px;">2019.09.15 22:54:12</span><span style="box-sizing:border-box;margin-right:10px;">字数 3,991</span><span style="box-sizing:border-box;">阅读 976</span></div></div></div></div><div style="box-sizing:border-box;display:block;font-weight:400;line-height:1.8;margin-bottom:20px;"><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">这两天在看零售通商品域的代码。面对零售通如此复杂的业务场景，如何在架构和代码层面进行应对，是一个新课题。针对该命题，我进行了比较细致的思考和研究。结合实际的业务场景，我沉淀了一套“如何写复杂业务代码”的方法论，在此分享给大家。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">我相信，同样的方法论可以复制到大部分复杂业务场景。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">一个复杂业务的处理过程</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">业务背景</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">简单的介绍下业务背景，零售通是给线下小店供货的B2B模式，我们希望通过数字化重构传统供应链渠道，提升供应链效率，为新零售助力。阿里在中间是一个平台角色，提供的是Bsbc中的service的功能。</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:549px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:50.83%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [1].webp" type="image/webp" data-filename="webp.webp" height="347" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">在商品域，运营会操作一个“上架”动作，上架之后，商品就能在零售通上面对小店进行销售了。<b style="box-sizing:border-box;font-weight:bolder;">是零售通业务非常关键的业务操作之一，因此涉及很多的数据校验和关联操作</b>。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">针对上架，一个简化的业务流程如下所示：</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:574px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:53.15%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [2].webp" type="image/webp" data-filename="webp.webp" height="362" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">过程分解</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">像这么复杂的业务，我想应该没有人会写在一个service方法中吧。一个类解决不了，那就分治吧。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">说实话，能想到分而治之的工程师，已经做的不错了，至少比没有分治思维要好很多。我也见过复杂程度相当的业务，连分解都没有，就是一堆方法和类的堆砌。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">不过，这里存在一个问题：即很多同学过度的依赖工具或是辅助手段来实现分解。比如在我们的商品域中，类似的分解手段至少有3套以上，有自制的流程引擎，有依赖于数据库配置的流程处理：</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:521px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:48.24%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [3].webp" type="image/webp" data-filename="webp.webp" height="329" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">本质上来讲，这些辅助手段做的都是一个pipeline的处理流程，没有其它。因此，我建议此处最好保持KISS（Keep It Simple and Stupid），即<b style="box-sizing:border-box;font-weight:bolder;">最好是什么工具都不要用，次之是用一个极简的Pipeline模式，最差是使用像流程引擎这样的重方法</b>。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">除非你的应用有极强的流程可视化和编排的诉求，否则我非常不推荐使用流程引擎等工具。第一，它会引入额外的复杂度，特别是那些需要持久化状态的流程引擎；第二，它会割裂代码，导致阅读代码的不顺畅。<b style="box-sizing:border-box;font-weight:bolder;">大胆断言一下，全天下估计80%对流程引擎的使用都是得不偿失的</b>。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">回到商品上架的问题，这里问题核心是工具吗？是设计模式带来的代码灵活性吗？显然不是，<b style="box-sizing:border-box;font-weight:bolder;">问题的核心应该是如何分解问题和抽象问题</b>，知道金字塔原理的应该知道，此处，我们可以使用结构化分解将问题解构成一个有层级的金字塔结构：</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:470px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:47.86%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [4].webp" type="image/webp" data-filename="webp.webp" height="326" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">按照这种分解写的代码，就像一本书，目录和内容清晰明了。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">以商品上架为例，程序的入口是一个上架命令（OnSaleCommand）, 它由三个阶段（Phase）组成。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">@Command</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">public class OnSaleNormalItemCmdExe {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    @Resource</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private OnSaleContextInitPhase onSaleContextInitPhase;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    @Resource</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private OnSaleDataCheckPhase onSaleDataCheckPhase;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    @Resource</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private OnSaleProcessPhase onSaleProcessPhase;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    @Override</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    public Response execute(OnSaleNormalItemCmd cmd) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        OnSaleContext onSaleContext = init(cmd);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        checkData(onSaleContext);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        process(onSaleContext);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        return Response.buildSuccess();</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    }</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private OnSaleContext init(OnSaleNormalItemCmd cmd) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        return onSaleContextInitPhase.init(cmd);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    }</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private void checkData(OnSaleContext onSaleContext) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        onSaleDataCheckPhase.check(onSaleContext);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    }</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private void process(OnSaleContext onSaleContext) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        onSaleProcessPhase.process(onSaleContext);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    }</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">每个Phase又可以拆解成多个步骤（Step），以 OnSaleProcessPhase为例，它是由一系列Step组成的：</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">@Phase</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">public class OnSaleProcessPhase {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    @Resource</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private PublishOfferStep publishOfferStep;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    @Resource</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private BackOfferBindStep backOfferBindStep;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    //省略其它step</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    public void process(OnSaleContext onSaleContext){</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        SupplierItem supplierItem = onSaleContext.getSupplierItem();</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 生成OfferGroupNo</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        generateOfferGroupNo(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">       // 发布商品</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        publishOffer(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 前后端库存绑定 backoffer域</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        bindBackOfferStock(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 同步库存路由 backoffer域</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        syncStockRoute(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 设置虚拟商品拓展字段</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        setVirtualProductExtension(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 发货保障打标 offer域</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        markSendProtection(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 记录变更内容ChangeDetail</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        recordChangeDetail(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 同步供货价到BackOffer</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        syncSupplyPriceToBackOffer(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 如果是组合商品打标，写扩展信息</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        setCombineProductExtension(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 去售罄标</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        removeSellOutTag(offerId);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 发送领域事件</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        fireDomainEvent(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        // 关闭关联的待办事项</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        closeIssues(supplierItem);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    }</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">看到了吗，这就是商品上架这个复杂业务的业务流程。需要流程引擎吗？不需要，需要设计模式支撑吗？也不需要。对于这种业务流程的表达，简单朴素的组合方法模式（Composed Method）是再合适不过的了。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">因此，在做过程分解的时候，我建议工程师不要把太多精力放在工具上，放在设计模式带来的灵活性上。而是应该多花时间在对问题分析，结构化分解，最后通过合理的抽象，形成合适的阶段（Phase）和步骤（Step）上。z</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:113px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:16.14%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [5].webp" type="image/webp" data-filename="webp.webp" height="110" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">过程分解后的两个问题</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">的确，使用过程分解之后的代码，已经比以前的代码更清晰、更容易维护了。不过，还有两个问题值得我们去关注一下：</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">1、领域知识被割裂肢解</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">什么叫被肢解？因为我们到目前为止做的都是过程化拆解，导致没有一个聚合领域知识的地方。每个Use Case的代码只关心自己的处理流程，知识没有沉淀。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">相同的业务逻辑会在多个Use Case中被重复实现，导致代码重复度高，即使有复用，最多也就是抽取一个util，代码对业务语义的表达能力很弱，从而影响代码的可读性和可理解性。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">2、代码的业务表达能力缺失</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">试想下，在过程式的代码中，所做的事情无外乎就是取数据--做计算--存数据，在这种情况下，要如何通过代码显性化的表达我们的业务呢？说实话，很难做到，因为我们缺失了模型，以及模型之间的关系。脱离模型的业务表达，是缺少韵律和灵魂的。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">举个例子，在上架过程中，有一个校验是检查库存的，其中对于组合品（CombineBackOffer）其库存的处理会和普通品不一样。原来的代码是这么写的：</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">boolean isCombineProduct = supplierItem.getSign().isCombProductQuote();</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">// supplier.usc warehouse needn't check</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">if (WarehouseTypeEnum.isAliWarehouse(supplierItem.getWarehouseType())) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">// quote warehosue check</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">if (CollectionUtil.isEmpty(supplierItem.getWarehouseIdList()) &amp;&amp; !isCombineProduct) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    throw ExceptionFactory.makeFault(ServiceExceptionCode.SYSTEM_ERROR, &quot;亲，不能发布Offer，请联系仓配运营人员，建立品仓关系！&quot;);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">// inventory amount check</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">Long sellableAmount = 0L;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">if (!isCombineProduct) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    sellableAmount = normalBiz.acquireSellableAmount(supplierItem.getBackOfferId(), supplierItem.getWarehouseIdList());</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">} else {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    //组套商品</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    OfferModel backOffer = backOfferQueryService.getBackOffer(supplierItem.getBackOfferId());</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    if (backOffer != null) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        sellableAmount = backOffer.getOffer().getTradeModel().getTradeCondition().getAmountOnSale();</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    }</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">if (sellableAmount &lt; 1) {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    throw ExceptionFactory.makeFault(ServiceExceptionCode.SYSTEM_ERROR, &quot;亲，实仓库存必须大于0才能发布，请确认已补货.\r[id:&quot; + supplierItem.getId() + &quot;]&quot;);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">然而，如果我们在系统中引入领域模型之后，其代码会简化为如下：</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">if(backOffer.isCloudWarehouse()){</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    return;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">if (backOffer.isNonInWarehouse()){</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    throw new BizException(&quot;亲，不能发布Offer，请联系仓配运营人员，建立品仓关系！&quot;);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">if (backOffer.getStockAmount() &lt; 1){</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    throw new BizException(&quot;亲，实仓库存必须大于0才能发布，请确认已补货.\r[id:&quot; + backOffer.getSupplierItem().getCspuCode() + &quot;]&quot;);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">} </p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">有没有发现，使用模型的表达要清晰易懂很多，而且也不需要做关于组合品的判断了，因为我们在系统中引入了更加贴近现实的对象模型（CombineBackOffer继承BackOffer），通过对象的多态可以消除我们代码中的大部分的if-else。</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:295px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:27.310000000000002%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [6].webp" type="image/webp" data-filename="webp.webp" height="186" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">过程分解+对象模型</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">通过上面的案例，我们可以看到<b style="box-sizing:border-box;font-weight:bolder;">有过程分解要好于没有分解</b>，<b style="box-sizing:border-box;font-weight:bolder;">过程分解+对象模型要好于仅仅是过程分解</b>。对于商品上架这个case，如果采用过程分解+对象模型的方式，最终我们会得到一个如下的系统结构：</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:515px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:47.69%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [7].webp" type="image/webp" data-filename="webp.webp" height="325" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">写复杂业务的方法论</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">通过上面案例的讲解，我想说，我已经交代了复杂业务代码要怎么写：<b style="box-sizing:border-box;font-weight:bolder;">即自上而下的结构化分解+自下而上的面向对象分析</b>。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">接下来，让我们把上面的案例进行进一步的提炼，形成一个可落地的方法论，从而可以泛化到更多的复杂业务场景。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">上下结合</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">所谓上下结合，是指我们要<b style="box-sizing:border-box;font-weight:bolder;">结合自上而下的过程分解和自下而上的对象建模</b>，螺旋式的构建我们的应用系统。这是一个动态的过程，两个步骤可以交替进行、也可以同时进行。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">这两个步骤是相辅相成的，<b style="box-sizing:border-box;font-weight:bolder;">上面的分析可以帮助我们更好的理清模型之间的关系，而下面的模型表达可以提升我们代码的复用度和业务语义表达能力</b>。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">其过程如下图所示：</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:540px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:50.0%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [8].webp" type="image/webp" data-filename="webp.webp" height="341" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">使用这种上下结合的方式，我们就有可能在面对任何复杂的业务场景，都能写出干净整洁、易维护的代码。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">能力下沉</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">一般来说实践DDD有两个过程：</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">1. 套概念阶段</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">了解了一些DDD的概念，然后在代码中“使用”Aggregation Root，Bonded Context，Repository等等这些概念。跟进一步，也会使用一定的分层策略。然而这种做法一般对复杂度的治理并没有多大作用。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">2. 融会贯通阶段</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">术语已经不再重要，理解DDD的本质是统一语言、边界划分和面向对象分析的方法。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">大体上而言，我大概是在1.7的阶段，因为有一个问题一直在困扰我，就是哪些能力应该放在Domain层，是不是按照传统的做法，将所有的业务都收拢到Domain上，这样做合理吗？说实话，这个问题我一直没有想清楚。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">因为在现实业务中，很多的功能都是用例特有的（Use case specific）的，如果“盲目”的使用Domain收拢业务并不见得能带来多大的益处。相反，这种收拢会导致Domain层的膨胀过厚，不够纯粹，反而会影响复用性和表达能力。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">鉴于此，我最近的思考是我们应该采用<b style="box-sizing:border-box;font-weight:bolder;">能力下沉</b>的策略。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">所谓的能力下沉，是指我们不强求一次就能设计出Domain的能力，也不需要强制让把所有的业务功能都放到Domain层，而是采用实用主义的态度，即只对那些需要在多个场景中需要被复用的能力进行抽象下沉，而不需要复用的，就暂时放在App层的Use Case里就好了。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">注：Use Case是《架构整洁之道》里面的术语，简单理解就是响应一个Request的处理过程</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">通过实践，<b style="box-sizing:border-box;font-weight:bolder;">我发现这种循序渐进的能力下沉策略，应该是一种更符合实际、更敏捷的方法。因为我们承认模型不是一次性设计出来的，而是迭代演化出来的。</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">下沉的过程如下图所示，假设两个use case中，我们发现uc1的step3和uc2的step1有类似的功能，我们就可以考虑让其下沉到Domain层，从而增加代码的复用性。</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:547px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:50.64999999999999%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [9].webp" type="image/webp" data-filename="webp.webp" height="345" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">指导下沉有两个关键指标：代码的复用性和内聚性</b>。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">复用性是告诉我们When（什么时候该下沉了），即有重复代码的时候。内聚性是告诉我们How（要下沉到哪里），功能有没有内聚到恰当的实体上，有没有放到合适的层次上（因为Domain层的能力也是有两个层次的，一个是Domain Service这是相对比较粗的粒度，另一个是Domain的Model这个是最细粒度的复用）。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">比如，在我们的商品域，经常需要判断一个商品是不是最小单位，是不是中包商品。像这种能力就非常有必要直接挂载在Model上。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">public class CSPU {</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private String code;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    private String baseCode;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    //省略其它属性</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    /**</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">     * 单品是否为最小单位。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">     *</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">     */</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    public boolean isMinimumUnit(){</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        return StringUtils.equals(code, baseCode);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    }</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    /**</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">     * 针对中包的特殊处理</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">     *</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">     */</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    public boolean isMidPackage(){</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">        return StringUtils.equals(code, midPackageCode);</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">    }</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">}</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">之前，因为老系统中没有领域模型，没有CSPU这个实体。你会发现像判断单品是否为最小单位的逻辑是以 StringUtils.equals(code,baseCode)的形式散落在代码的各个角落。这种代码的可理解性是可想而知的，至少在第一眼看到的时候，是完全不知道什么意思。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;">业务技术要怎么做</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">写到这里，我想顺便回答一下很多业务技术同学的困惑，也是我之前的困惑：<b style="box-sizing:border-box;font-weight:bolder;">即业务技术到底是在做业务，还是做技术？业务技术的技术性体现在哪里？</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">通过上面的案例，我们可以看到业务所面临的复杂性并不亚于底层技术，要想写好业务代码也不是一件容易的事情。业务技术和底层技术人员唯一的区别是他们所面临的问题域不一样。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">业务技术面对的问题域变化更多、面对的人更加庞杂。而底层技术面对的问题域更加稳定、但对技术的要求更加深。比如，如果你需要去开发Pandora，你就要对Classloader有更加深入的了解才行。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">但是，不管是业务技术还是底层技术人员，有一些思维和能力都是共通的。比如，<b style="box-sizing:border-box;font-weight:bolder;">分解问题的能力，抽象思维，结构化思维</b>等等。</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:700px;max-height:489px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:45.28%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [10].webp" type="image/webp" data-filename="webp.webp" height="309" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="682"/></div>
</div>

</div><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">用我的话说就是：<b style="box-sizing:border-box;font-weight:bolder;">“做不好业务开发的，也做不好技术底层开发，反之亦然。业务开发一点都不简单，只是我们很多人把它做“简单”了</b></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">因此，如果从变化的角度来看，业务技术的难度一点不逊色于底层技术，其面临的挑战甚至更大。因此，我想对广大的从事业务技术开发说：<b style="box-sizing:border-box;font-weight:bolder;">沉下心来，夯实自己的基础技术能力、OO能力、建模能力... 不断提升抽象思维、结构化思维、思辨思维... 持续学习精进，写好代码。我们可以在业务技术岗做的很”技术“！</b>。</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">本文来自公众号“从码农到工匠”（craftsman_frank）</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><br style="box-sizing:border-box;"/></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;"><b style="box-sizing:border-box;font-weight:bolder;"><i style="box-sizing:border-box;">源网络，版权归原创者所有。如有侵权烦请告知，我们会立即删除并表示歉意。</i></b></p><hr style="box-sizing:content-box;height:0px;overflow:visible;margin:0px 0px 20px;border-right:0px;border-bottom:0px;border-left:0px;border-image:initial;border-top:1px solid rgb(238, 238, 238);"/><p style="box-sizing:border-box;margin-top:0px;margin-bottom:20px;word-break:break-word;">更多技术，欢迎关注下方公众号</p><div style="box-sizing:border-box;width:100%;margin:0px;padding-bottom:25px;text-align:center;font-size:0px;">
<div style="box-sizing:border-box;position:relative;z-index:95;background-color:transparent;transition:background-color 0.1s linear 0s;margin:0px auto;max-width:242px;max-height:239px;">
<div style="box-sizing:border-box;z-index:90;padding-bottom:98.76%;"></div>
<div style="box-sizing:border-box;position:absolute;top:0px;left:0px;width:100%;height:100%;overflow:hidden;"><img src="一文教会你如何写复杂业务的代码_files/webp [11].webp" type="image/webp" data-filename="webp.webp" height="239" style="box-sizing:border-box;vertical-align:middle;max-width:100%;width:auto;height:auto;border:0px;transition:all 0.15s linear 0s;z-index:95;opacity:1;border-style:none;cursor:zoom-in;" width="242"/></div>
</div>

</div></div><div style="box-sizing:border-box;"></div><div style="box-sizing:border-box;-webkit-box-pack:justify;justify-content:space-between;font-size:14px;color:rgb(150, 150, 150);user-select:none;display:flex;-webkit-box-align:center;align-items:center;"><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;"><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;margin-right:12px;"><div style="box-sizing:border-box;touch-action:manipulation;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;width:40px;height:40px;color:rgb(150, 150, 150);border:1px solid rgb(238, 238, 238);border-radius:50%;font-size:18px;cursor:pointer;"><i style="box-sizing:border-box;display:inline-block;color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-0.125em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased;"><span style="color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;display:none;"></span><span style="box-sizing:border-box;overflow:hidden;line-height:1;display:inline-block;"><span style="box-sizing:border-box;"></span></span></i></div><span style="box-sizing:border-box;touch-action:manipulation;margin-left:8px;cursor:pointer;">29人点赞<i style="box-sizing:border-box;display:inline-block;color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-0.125em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased;font-size:12px;"><span style="color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;font-size:12px;display:none;"></span><span style="box-sizing:border-box;overflow:hidden;line-height:1;display:inline-block;"><span style="box-sizing:border-box;"></span></span></i></span></div><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;"><div style="box-sizing:border-box;touch-action:manipulation;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;width:40px;height:40px;color:rgb(150, 150, 150);border:1px solid rgb(238, 238, 238);border-radius:50%;font-size:18px;cursor:pointer;"><i style="box-sizing:border-box;display:inline-block;color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-0.125em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased;"><span style="color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;display:none;"></span><span style="box-sizing:border-box;overflow:hidden;line-height:1;display:inline-block;"><span style="box-sizing:border-box;"></span></span></i></div></div></div><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;"><a href="https://www.jianshu.com/nb/27934080" rel="noopener noreferrer" style="box-sizing:border-box;color:inherit;text-decoration:none;background-color:rgba(0, 0, 0, 0);outline:none;cursor:pointer;transition:color 0.3s ease 0s;touch-action:manipulation;display:flex;-webkit-box-align:center;align-items:center;margin-right:12px;" target="_blank"><i style="box-sizing:border-box;display:inline-block;color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-0.125em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased;font-size:16px;"><span style="color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;font-size:16px;display:none;"></span><span style="box-sizing:border-box;overflow:hidden;line-height:1;display:inline-block;"><span style="box-sizing:border-box;"></span></span></i><span style="box-sizing:border-box;margin-left:8px;">日记本</span></a><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;"><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;width:40px;height:40px;color:rgb(150, 150, 150);border:1px solid rgb(238, 238, 238);border-radius:50%;font-size:18px;cursor:pointer;"><i style="box-sizing:border-box;display:inline-block;color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-0.125em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased;"><span style="color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;display:none;"></span><span style="box-sizing:border-box;overflow:hidden;line-height:1;display:inline-block;"><span style="box-sizing:border-box;"></span></span></i></div></div></div></div><div style="box-sizing:border-box;width:100%;height:1px;margin:16px 0px;background-color:rgb(238, 238, 238);margin-top:24px;margin-bottom:24px;"></div><div style="box-sizing:border-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:center;align-items:center;margin:40px 0px 32px;"><div style="box-sizing:border-box;font-size:16px;font-weight:500;margin-bottom:16px;">&quot;小礼物走一走，来简书关注我&quot;</div><span style="box-sizing:border-box;color:rgb(102, 102, 102);margin-top:24px;">还没有人赞赏，支持一下</span></div><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;background-color:rgb(250, 250, 250);border-radius:4px;padding:12px 16px;"><a href="https://www.jianshu.com/u/949a388d9e5d" rel="noopener noreferrer" style="box-sizing:border-box;color:inherit;text-decoration:none;background-color:rgba(0, 0, 0, 0);outline:none;cursor:pointer;transition:color 0.3s ease 0s;touch-action:manipulation;" target="_blank"><img src="一文教会你如何写复杂业务的代码_files/webp [12].webp" type="image/webp" data-filename="webp.webp" alt="" height="48" style="box-sizing:border-box;vertical-align:middle;border-radius:50%;border:1px solid rgb(238, 238, 238);min-width:50px;min-height:50px;width:50px;height:50px;border-style:none;" width="48"/></a><div style="box-sizing:border-box;-webkit-box-flex:1;flex-grow:1;margin:0px 12px;overflow:hidden;"><div style="box-sizing:border-box;display:flex;-webkit-box-align:center;align-items:center;margin-bottom:2px;"><a href="https://www.jianshu.com/u/949a388d9e5d" rel="noopener noreferrer" style="box-sizing:border-box;color:inherit;text-decoration:none;background-color:rgba(0, 0, 0, 0);outline:none;cursor:pointer;transition:color 0.3s ease 0s;touch-action:manipulation;flex-shrink:0;font-size:16px;font-weight:500;margin-right:6px;" target="_blank" title="搬砖的码哥">搬砖的码哥</a><a href="https://www.jianshu.com/p/3bc50b869c89" rel="noopener noreferrer" style="box-sizing:border-box;color:inherit;text-decoration:none;background-color:rgba(0, 0, 0, 0);outline:none;cursor:pointer;transition:color 0.3s ease 0s;touch-action:manipulation;flex-shrink:0;margin-right:6px;" target="_blank"><img src="一文教会你如何写复杂业务的代码_files/99870935-12e7-4765-9285-d5a53768e614 [1].png" type="image/png" data-filename="99870935-12e7-4765-9285-d5a53768e614.png" alt="" height="16" style="box-sizing:border-box;vertical-align:middle;border-style:none;display:block;width:16px;height:16px;min-width:16px;min-height:16px;" width="16"/></a><span style="box-sizing:border-box;font-size:14px;color:rgb(102, 102, 102);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;" title=""></span></div><div style="box-sizing:border-box;font-size:14px;color:rgb(150, 150, 150);"><span style="box-sizing:border-box;margin-right:12px;">总资产1,081 (约108.65元)</span><span style="box-sizing:border-box;margin-right:12px;">共写了70.6W字</span><span style="box-sizing:border-box;margin-right:12px;">获得1,994个赞</span><span style="box-sizing:border-box;margin-right:0px;">共662个粉丝</span></div></div></div></div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 