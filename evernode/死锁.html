<html>
<head>
  <title>死锁</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="8070"/>
<h1>死锁</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2015/8/23 16:19</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2015/8/23 16:19</i></td></tr>
</table>
</div>
<br/>

<div>
<span style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>package</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">com.text.thread1;</span></font></div><div align="left"><font color="#010101" face="Consolas" size="2"><span style="font-size:10pt"><br/></span></font></div><div align="left"><font color="#010101" face="Consolas" size="2"><span style="font-size:10pt"><br/></span></font></div><div align="left"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Resource{</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       String</span></font> <font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">name</span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       Resource(String name){</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">name</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">=name;</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       }</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font color="#010101" face="Consolas" size="2"><span style="font-size:10pt"><br/></span></font></div><div align="left"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">MyThread</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>implements</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Runnable{</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       String</span></font> <font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">name</span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       Resource</span></font> <font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">r1</span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       Resource</span></font> <font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">r2</span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       MyThread(Resource r1,Resource r2,String nm){</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">r1</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">=r1;</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">r2</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">=r2;</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font> <font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">name</span></font><font face="Consolas" size="2"><span style="font-size:10pt">=nm;</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       }</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">run() {</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>synchronized</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">r1</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">) {</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                     System.</span></font> <font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(</span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>this</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">name</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">+</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;获得&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">+</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">r1</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">name</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>try</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">{</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                           Thread.</span> <span style="font-size:10pt"><i>sleep</i></span><span style="font-size:10pt">(1000);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                     }</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>catch</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(InterruptedException e) {</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                           </span></font> <font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">//</span></font> <font color="#7F9FBF" face="Consolas" size="2"><span style="font-size:10pt"><b>TODO</b></span></font> <font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">自动生成的 catch 块</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                           e.printStackTrace();</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                     }</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              System.</span></font> <font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(</span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>this</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">name</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">+</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;等待&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">+</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">r2</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">name</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              }</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>synchronized</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">r2</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">) {</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>try</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">{</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                           Thread.</span> <span style="font-size:10pt"><i>sleep</i></span><span style="font-size:10pt">(1000);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                     }</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>catch</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(InterruptedException e) {</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                           </span></font> <font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">//</span></font> <font color="#7F9FBF" face="Consolas" size="2"><span style="font-size:10pt"><b>TODO</b></span></font> <font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">自动生成的 catch 块</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                           e.printStackTrace();</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">                     }</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              }</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       }</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font color="#010101" face="Consolas" size="2"><span style="font-size:10pt"><br/></span></font></div><div align="left"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Deadlock {</span></font></div><div align="left"><font color="#010101" face="Consolas" size="2"><span style="font-size:10pt"><br/></span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">main(String[] args) {</span></font></div><div align="left"><font color="#010101" face="Consolas" size="2"><span style="font-size:10pt"><br/></span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              Resource r1=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Resource(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;资源1&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              Resource r2=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Resource(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;资源2&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              Resource r3=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Resource(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;资源3&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              MyThread m1=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">MyThread(r1, r2,</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;线程1&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              MyThread m2=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">MyThread(r2, r3,</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;线程2&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              MyThread m3=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">MyThread(r3, r1,</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;线程3&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              Thread t1=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Thread(m1);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              Thread t2=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Thread(m2);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              Thread t3=</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Thread(m3);</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              t1.start();</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              t2.start();</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              t3.start();</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       }</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font></div><div align="left"><font color="#010101" face="Consolas" size="2"><span style="font-size:10pt"><br/></span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Consolas" size="2"><span style="font-size:10pt"><br/></span></font></div></span>
</div></body></html> 