<html>
<head>
  <title>AES/CBC/PKCS5Padding 加密</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="9273"/>
<h1>AES/CBC/PKCS5Padding 加密</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2016/9/14 18:48</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2016/9/14 18:50</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div align="left" style="min-height: 11pt;"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>package</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">jinri;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>import</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">javax.crypto.Cipher;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>import</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">javax.crypto.spec.IvParameterSpec;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>import</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">javax.crypto.spec.SecretKeySpec;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>import</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">sun.misc.BASE64Decoder;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>import</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">sun.misc.BASE64Encoder;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Encryption {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 加密</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">String Encrypt(String sSrc, String sKey,</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>byte</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">[] ivKey)</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Exception {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(ivKey ==</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">) {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.print(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;ivKey为空null&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 判断ivKey是否为16位</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(ivKey.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt">length</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">!= 16) {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.print(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;ivKey长度不是16位&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(sKey ==</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">) {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.print(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;Key为空null&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 判断Key是否为16位</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(sKey.length() != 16) {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.print(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;Key长度不是16位&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              SecretKeySpec skeySpec =</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">SecretKeySpec(sKey.getBytes(),</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;AES&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              Cipher cipher = Cipher.</span><span style="font-size:10pt"><i>getInstance</i></span><span style="font-size:10pt">(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;AES/CBC/PKCS5Padding&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// &quot;算法/模式/补码方式&quot;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              IvParameterSpec iv =</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">IvParameterSpec(ivKey);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 使用CBC模式，需要一个向量iv，可增加加密算法的强度</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              cipher.init(Cipher.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>ENCRYPT_MODE</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">, skeySpec, iv);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>byte</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">[] encrypted = cipher.doFinal(sSrc.getBytes());</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">BASE64Encoder().encode(encrypted);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 此处使用BASE64做转码功能，同时能起到2次加密的作用。</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">       }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 解密</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">String Decrypt(String sSrc, String sKey,</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>byte</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">[] ivKey)</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Exception {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>try</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">{</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 判断Key是否正确</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(sKey ==</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">) {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.print(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;Key为空null&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 判断Key是否为16位</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(sKey.length() != 16) {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.print(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;Key长度不是16位&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>byte</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">[] raw = sKey.getBytes(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;ASCII&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     SecretKeySpec skeySpec =</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">SecretKeySpec(raw,</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;AES&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     Cipher cipher = Cipher.</span><span style="font-size:10pt"><i>getInstance</i></span><span style="font-size:10pt">(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;AES/CBC/PKCS5Padding&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     IvParameterSpec iv =</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">IvParameterSpec(ivKey);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     cipher.init(Cipher.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>DECRYPT_MODE</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">, skeySpec, iv);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>byte</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">[] encrypted1 =</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">BASE64Decoder().decodeBuffer(sSrc);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 先用base64解密</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>try</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">{</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>byte</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">[] original = cipher.doFinal(encrypted1);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           String originalString =</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">String(original);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">originalString;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     }</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>catch</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(Exception e) {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(e.toString());</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                           </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              }</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>catch</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">(Exception ex) {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(ex.toString());</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">                     </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">       }</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">       </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">main(String[] args)</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">Exception {</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">/*</span></font></div><div align="left" style="min-height: 11pt;"><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">               *  加密用的Key 可以用26个字母和数字组成 ，最好不要用保留字符 ，虽然不会错，至于怎么裁决 ，个人看情况而定  此处使用AES</span></font></div><div align="left" style="min-height: 11pt;"><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">               *  使用CBC模式，需要一个向量iv，可增加加密算法的强度</span></font></div><div align="left" style="min-height: 11pt;"><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">               * -128-CBC加密模式 ，key需要为16位。</span></font></div><div align="left" style="min-height: 11pt;"><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">               */</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              String cKey =</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;1234567890123456&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>byte</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">[] ivKey =</span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>byte</b></span></font><font face="Consolas" size="2"><span style="font-size:10pt">[16];</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 需要加密的字串</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              String cSrc =</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;abcdefghigklmnopqrstuvwxyz0123456789&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(cSrc);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 加密</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>long</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">lStart = System.</span><span style="font-size:10pt"><i>currentTimeMillis</i></span><span style="font-size:10pt">();</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              String enString = Encryption.</span><span style="font-size:10pt"><i>Encrypt</i></span><span style="font-size:10pt">(cSrc, cKey,ivKey);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;加密后的字串是：&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">+ enString);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#7F0055" face="Consolas" size="2"><span style="font-size:10pt"><b>long</b></span></font> <font face="Consolas" size="2"><span style="font-size:10pt">lUseTime = System.</span><span style="font-size:10pt"><i>currentTimeMillis</i></span><span style="font-size:10pt">() - lStart;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;加密耗时：&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">+ lUseTime +</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;毫秒&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              </span></font><font color="#3F7F5F" face="Consolas" size="2"><span style="font-size:10pt">// 解密 lStart = System.currentTimeMillis();</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              String DeString = Encryption.</span><span style="font-size:10pt"><i>Decrypt</i></span><span style="font-size:10pt">(enString, cKey,ivKey);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;解密后的字串是：&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">+ DeString);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              lUseTime = System.</span><span style="font-size:10pt"><i>currentTimeMillis</i></span><span style="font-size:10pt">() - lStart;</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">              System.</span></font><font color="#0000C0" face="Consolas" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Consolas" size="2"><span style="font-size:10pt">.println(</span></font><font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;解密耗时：&quot;</span></font> <font face="Consolas" size="2"><span style="font-size:10pt">+ lUseTime +</span></font> <font color="#2A00FF" face="Consolas" size="2"><span style="font-size:10pt">&quot;毫秒&quot;</span></font><font face="Consolas" size="2"><span style="font-size:10pt">);</span></font></div><div align="left" style="min-height: 11pt;"><font face="Consolas" size="2"><span style="font-size:10pt">       }</span></font></div><div align="left" style="min-height: 11pt;"><div><font face="Consolas" size="2"><span style="font-size:10pt">}</span></font></div><div><span style="font-family: Consolas;"><br/></span></div><div><span style="font-family: Consolas;"><br/></span></div><div><span style="font-family: Consolas;"><br/></span></div><div>加密模式：AES/CBC/PKCS5Padding</div><div>加密初始化向量： 长度为 16 的空字节数组</div><div>测试密钥： 1234567890123456</div><div>加密样例如 下原文：</div><div>abcdefghigklmnopqrstuvwxyz0123456789</div><div>加密后： 8Z3dZzqn05FmiuBLowExK0CAbs4TY2GorC2dDPVlsn/tP+VuJGePqIMv1uSaVErr</div></div></span>
</div></body></html> 