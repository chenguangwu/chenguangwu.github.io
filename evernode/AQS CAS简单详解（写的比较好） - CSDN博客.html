<html>
<head>
  <title>AQS CAS简单详解（写的比较好） - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3195"/>
<h1>AQS CAS简单详解（写的比较好） - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/7/27 13:39</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://blog.csdn.net/zcw4237256/article/details/78552741"><i>https://blog.csdn.net/zcw4237256/article/details/78552741</i></a></td></tr>
</table>
</div>
<br/>

<div><span>
  <div>
<div style="font-size: 16px; display: inline-block; min-width: 100%;position: relative;"><div style="outline:0px;box-sizing:border-box;"><div style="box-sizing:inherit;outline:0px;background:url(https://csdnimg.cn/release/phoenix/themes/skin-yellow/images/bg.png) repeat;font-family:&quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, sans-serif;font-size:14px;line-height:1.57143;color:rgb(51, 51, 51);"><div style="outline:0px;box-sizing:border-box;"><span style="box-sizing:inherit;outline:0px;"><div style="box-sizing:inherit;outline:0px;background:rgb(255, 255, 255);box-shadow:rgba(0, 0, 0, 0.0470588) 0px 2px 4px 0px;">
	<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-bottom:16px;">
			<span style="border-radius:50%;display:inline-block;width:26px;height:26px;line-height:26px;text-align:center;font-size:12px;outline:0px;box-sizing:inherit;border:1px solid rgb(231, 244, 223);color:rgb(134, 202, 94);margin-right:8px;margin-top:4px;float:left;">转</span>		<h1 style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:24px;word-break:break-all;">AQS CAS简单详解（写的比较好）</h1>
	</div>
	<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;padding-bottom:14px;border-bottom:1px solid rgb(227, 227, 227);">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;color:rgb(133, 133, 133);display:flex;">
												<span style="box-sizing:inherit;outline:0px;margin-right:14px;">2017年11月16日 16:31:01</span>
			<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-left:auto;float:right;">
				<span style="box-sizing:inherit;outline:0px;margin-right:14px;">阅读数：5485</span>
											</div>
		</div>
	</div>
	<div style="box-sizing:inherit;outline:0px;display:block;position:relative;padding-top:16px;">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;word-break:break-all;">
                    
						<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun;word-break:break-all;">
                
<h2 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;word-break:break-all;font-size:2.15em;color:rgb(63,63,63);font-weight:100;line-height:1.1;font-family:'microsoft yahei';"><a name="t0" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>
CAS(Compare And Swap)</h2>
<h3 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;word-break:break-all;font-size:1.7em;color:rgb(63,63,63);font-weight:100;line-height:1.1;font-family:'microsoft yahei';"><a name="t1" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>
<a name="t1" style="word-break:break-all;color:rgb(79,161,219);outline:0px;cursor:pointer;box-sizing:border-box;text-decoration:none;background:transparent;" target="_blank"></a>什么是CAS</h3>
<blockquote style="background:rgb(238, 240, 244);word-break:break-all;outline:0px;padding:16px 16px 0px;margin:0px 0px 24px;display:block;border-left:8px solid rgb(221, 223, 228);box-sizing:border-box;overflow:auto;word-wrap:normal;line-height:27.2px;color:rgb(63,63,63);font-family:'microsoft yahei';font-size:16px;"><span style=""></span>
<p style="font-size:1em;margin-bottom:16px;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(111,111,111);font-weight:400;line-height:1.5;text-align:justify;word-break:break-all;">
CAS(Compare And Swap)，即比较并交换。是解决多线程并行情况下使用锁造成性能损耗的一种机制，CAS操作包含三个操作数——内存位置（V）、预期原值（A）和新值(B)。如果内存位置的值与预期原值相匹配，那么处理器会自动将该位置值更新为新值。否则，处理器不做任何操作。无论哪种情况，它都会在CAS指令之前返回该位置的值。CAS有效地说明了“我认为位置V应该包含值A；如果包含该值，则将B放到这个位置；否则，不要更改该位置，只告诉我这个位置现在的值即可。</p>
<span style=""></span></blockquote>
<p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
在JAVA中，<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">sun.misc.Unsafe</code> 类提供了硬件级别的原子操作来实现这个CAS。 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">java.util.concurrent</code> 包下的大量类都使用了这个 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">Unsafe.java</code> 类的CAS操作。至于 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">Unsafe.java</code> 的具体实现这里就不讨论了。</p>
<h3 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;word-break:break-all;font-size:1.7em;color:rgb(63,63,63);font-weight:100;line-height:1.1;font-family:'microsoft yahei';"><a name="t2" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>
<a name="t2" style="word-break:break-all;color:rgb(79,161,219);outline:0px;cursor:pointer;box-sizing:border-box;text-decoration:none;background:transparent;" target="_blank"></a>CAS典型应用</h3>
<p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">java.util.concurrent.atomic</code> 包下的类大多是使用CAS操作来实现的(eg. <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">AtomicInteger.java</code>,<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">AtomicBoolean</code>,<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">AtomicLong</code>)。下面以 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">AtomicInteger.java</code> 的部分实现来大致讲解下这些原子类的实现。</p>
<pre style="white-space:pre-wrap;word-break:break-all;overflow-y:hidden;overflow-x:auto;box-sizing:border-box;outline:0px;color:rgb(51,51,51);line-height:23.8px;position:relative;word-wrap:break-word;font-family:'Source Code Pro', monospace;font-size:14px;margin:0px 0px 24px;padding:8px 16px 4px 56px;background-color:rgb(246, 248, 250);border:none;"><code style="overflow-x:auto;word-break:break-all;outline:0px;border-radius:4px;display:block;font-size:12.6px;line-height:22px;box-sizing:border-box;white-space:pre;word-wrap:normal;padding:8px;font-family:'Source Code Pro', monospace;color:inherit;background:transparent;"><ol style="outline:0px;list-style:none;box-sizing:border-box;border-collapse:collapse;padding:0px;margin:0px;overflow:hidden;word-break:break-all;"><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">1</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">class</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">AtomicInteger</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">extends</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">Number</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">implements</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">java</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;">.</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">io</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;">.</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">Serializable</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span>{</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">2</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">static</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">long</span></span> serialVersionUID = <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">6214790243416807050</span></span><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">L</span>;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">3</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">4</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// setup to use Unsafe.compareAndSwapInt for updates</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">5</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">static</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span> Unsafe unsafe = Unsafe.getUnsafe();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">6</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">7</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">volatile</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> value;<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 初始int大小</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">8</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 省略了部分代码...</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">9</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">10</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 带参数构造函数，可设置初始int大小</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">11</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">AtomicInteger</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">(</span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> initialValue)</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">12</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        value = initialValue;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">13</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">14</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 不带参数构造函数,初始int大小为0</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">15</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">AtomicInteger</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">16</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">17</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">18</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 获取当前值</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">19</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">get</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">20</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> value;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">21</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">22</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">23</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 设置值为 newValue</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">24</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">void</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">set</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">(</span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> newValue)</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">25</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        value = newValue;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">26</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">27</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">28</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">//返回旧值，并设置新值为　newValue</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">29</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">getAndSet</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">(</span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> newValue)</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">30</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">/**</span></span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">31</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">        * 这里使用for循环不断通过CAS操作来设置新值</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">32</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">        * CAS实现和加锁实现的关系有点类似乐观锁和悲观锁的关系</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">33</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">        * */</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">34</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">for</span></span> (;;) {</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">35</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> current = get();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">36</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">if</span></span> (compareAndSet(current, newValue))</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">37</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">                <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> current;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">38</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">39</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">40</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">41</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 原子的设置新值为update, expect为期望的当前的值</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">42</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">boolean</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">compareAndSet</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">(</span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> expect, </span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> update)</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">43</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> unsafe.compareAndSwapInt(<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">this</span></span>, valueOffset, expect, update);</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">44</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">45</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">46</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 获取当前值current，并设置新值为current+1</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">47</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">getAndIncrement</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">48</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">for</span></span> (;;) {</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">49</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> current = get();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">50</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> next = current + <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span></span>;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">51</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">if</span></span> (compareAndSet(current, next))</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">52</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">                <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> current;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">53</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">54</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">55</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">56</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 此处省略部分代码，余下的代码大致实现原理都是类似的</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">57</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">}</div></div></li></ol></code></pre><ul style="list-style:none;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;box-sizing:border-box;line-height:23.8px;width:50px;background-color:rgb(238,238,238);border-right:1px solid rgb(221,221,221);text-align:right;"><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">1</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">2</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">3</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">4</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">5</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">6</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">7</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">8</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">9</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">10</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">11</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">12</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">13</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">14</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">15</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">16</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">17</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">18</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">19</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">20</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">21</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">22</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">23</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">24</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">25</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">26</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">27</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">28</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">29</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">30</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">31</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">32</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">33</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">34</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">35</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">36</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">37</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">38</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">39</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">40</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">41</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">42</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">43</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">44</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">45</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">46</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">47</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">48</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">49</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">50</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">51</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">52</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">53</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">54</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">55</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">56</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">57</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">58</li></ul><p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
一般来说在竞争不是特别激烈的时候，使用该包下的原子操作性能比使用 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">synchronized</code> 关键字的方式高效的多(查看<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">getAndSet()</code>，可知如果资源竞争十分激烈的话，这个for循环可能换持续很久都不能成功跳出。不过这种情况可能需要考虑降低资源竞争才是)。 <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
在较多的场景我们都可能会使用到这些原子类操作。一个典型应用就是计数了，在多线程的情况下需要考虑线程安全问题。通常第一映像可能就是:</p>
<pre style="white-space:pre-wrap;word-break:break-all;overflow-y:hidden;overflow-x:auto;box-sizing:border-box;outline:0px;color:rgb(51,51,51);line-height:23.8px;position:relative;word-wrap:break-word;font-family:'Source Code Pro', monospace;font-size:14px;margin:0px 0px 24px;padding:8px 16px 4px 56px;background-color:rgb(246, 248, 250);border:none;"><code style="overflow-x:auto;word-break:break-all;outline:0px;border-radius:4px;display:block;font-size:12.6px;line-height:22px;box-sizing:border-box;white-space:pre;word-wrap:normal;padding:8px;font-family:'Source Code Pro', monospace;color:inherit;background:transparent;"><ol style="outline:0px;list-style:none;box-sizing:border-box;border-collapse:collapse;padding:0px;margin:0px;overflow:hidden;word-break:break-all;"><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">1</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">class</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">Counter</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span>{</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">2</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> count;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">3</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">Counter</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{}</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">4</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">getCount</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">5</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> count;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">6</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">7</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">void</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">increase</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">8</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        count++;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">9</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">10</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">}</div></div></li></ol></code></pre><ul style="list-style:none;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;box-sizing:border-box;line-height:23.8px;width:50px;background-color:rgb(238,238,238);border-right:1px solid rgb(221,221,221);text-align:right;"><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">1</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">2</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">3</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">4</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">5</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">6</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">7</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">8</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">9</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">10</li></ul><p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
上面这个类在多线程环境下会有线程安全问题，要解决这个问题最简单的方式可能就是通过加锁的方式,调整如下:</p>
<pre style="white-space:pre-wrap;word-break:break-all;overflow-y:hidden;overflow-x:auto;box-sizing:border-box;outline:0px;color:rgb(51,51,51);line-height:23.8px;position:relative;word-wrap:break-word;font-family:'Source Code Pro', monospace;font-size:14px;margin:0px 0px 24px;padding:8px 16px 4px 56px;background-color:rgb(246, 248, 250);border:none;"><code style="overflow-x:auto;word-break:break-all;outline:0px;border-radius:4px;display:block;font-size:12.6px;line-height:22px;box-sizing:border-box;white-space:pre;word-wrap:normal;padding:8px;font-family:'Source Code Pro', monospace;color:inherit;background:transparent;"><ol style="outline:0px;list-style:none;box-sizing:border-box;border-collapse:collapse;padding:0px;margin:0px;overflow:hidden;word-break:break-all;"><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">1</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">class</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">Counter</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span>{</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">2</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> count;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">3</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">Counter</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{}</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">4</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">synchronized</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">getCount</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">5</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> count;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">6</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">7</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">synchronized</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">void</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">increase</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">8</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        count++;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">9</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">10</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">}</div></div></li></ol></code></pre><ul style="list-style:none;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;box-sizing:border-box;line-height:23.8px;width:50px;background-color:rgb(238,238,238);border-right:1px solid rgb(221,221,221);text-align:right;"><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">1</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">2</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">3</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">4</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">5</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">6</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">7</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">8</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">9</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">10</li></ul><p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
这类似于悲观锁的实现，我需要获取这个资源，那么我就给他加锁，别的线程都无法访问该资源，直到我操作完后释放对该资源的锁。我们知道，悲观锁的效率是不如乐观锁的，上面说了Atomic下的原子类的实现是类似乐观锁的，效率会比使用 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">synchronized</code> 关系字高，推荐使用这种方式，实现如下:</p>
<pre style="white-space:pre-wrap;word-break:break-all;overflow-y:hidden;overflow-x:auto;box-sizing:border-box;outline:0px;color:rgb(51,51,51);line-height:23.8px;position:relative;word-wrap:break-word;font-family:'Source Code Pro', monospace;font-size:14px;margin:0px 0px 24px;padding:8px 16px 4px 56px;background-color:rgb(246, 248, 250);border:none;"><code style="overflow-x:auto;word-break:break-all;outline:0px;border-radius:4px;display:block;font-size:12.6px;line-height:22px;box-sizing:border-box;white-space:pre;word-wrap:normal;padding:8px;font-family:'Source Code Pro', monospace;color:inherit;background:transparent;"><ol style="outline:0px;list-style:none;box-sizing:border-box;border-collapse:collapse;padding:0px;margin:0px;overflow:hidden;word-break:break-all;"><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">1</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">class</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">Counter</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span>{</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">2</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> AtomicInteger count = <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">new</span></span> AtomicInteger();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">3</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">Counter</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{}</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">4</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">getCount</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">5</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> count.get();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">6</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">7</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">void</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">increase</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span></span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">8</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        count.getAndIncrement();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">9</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">10</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">}</div></div></li></ol></code></pre><ul style="list-style:none;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;box-sizing:border-box;line-height:23.8px;width:50px;background-color:rgb(238,238,238);border-right:1px solid rgb(221,221,221);text-align:right;"><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">1</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">2</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">3</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">4</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">5</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">6</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">7</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">8</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">9</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">10</li></ul><hr style="border-left:0px;word-break:break-all;outline:0px;margin:24px 0px;border-top:none;border-right:0px;box-sizing:border-box;border-image:initial;border-bottom:0px;border-top-style:solid;color:rgb(63,63,63);font-family:'microsoft yahei';font-size:16px;"/><h2 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;word-break:break-all;font-size:2.15em;color:rgb(63,63,63);font-weight:100;line-height:1.1;font-family:'microsoft yahei';"><a name="t3" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>
<a name="t3" style="word-break:break-all;color:rgb(79,161,219);outline:0px;cursor:pointer;box-sizing:border-box;text-decoration:none;background:transparent;" target="_blank"></a>AQS(<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:30.96px;">AbstractQueuedSynchronizer</code>)</h2>
<h3 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;word-break:break-all;font-size:1.7em;color:rgb(63,63,63);font-weight:100;line-height:1.1;font-family:'microsoft yahei';"><a name="t4" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>
<a name="t4" style="word-break:break-all;color:rgb(79,161,219);outline:0px;cursor:pointer;box-sizing:border-box;text-decoration:none;background:transparent;" target="_blank"></a>什么是AQS</h3>
<p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
AQS(<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">AbstractQueuedSynchronizer</code>)，AQS是JDK下提供的一套用于实现基于FIFO等待队列的阻塞锁和相关的同步器的一个同步框架。这个抽象类被设计为作为一些可用原子int值来表示状态的同步器的基类。如果你有看过类似 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">CountDownLatch</code> 类的源码实现，会发现其内部有一个继承了 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">AbstractQueuedSynchronizer</code> 的内部类 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">Sync</code>。可见 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">CountDownLatch</code> 是基于AQS框架来实现的一个同步器.类似的同步器在JUC下还有不少。(eg. <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">Semaphore</code>)</p>
<h3 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;word-break:break-all;font-size:1.7em;color:rgb(63,63,63);font-weight:100;line-height:1.1;font-family:'microsoft yahei';"><a name="t5" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>
<a name="t5" style="word-break:break-all;color:rgb(79,161,219);outline:0px;cursor:pointer;box-sizing:border-box;text-decoration:none;background:transparent;" target="_blank"></a>AQS用法</h3>
<p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
如上所述，AQS管理一个关于状态信息的单一整数，该整数可以表现任何状态。比如， <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">Semaphore</code> 用它来表现剩余的许可数，<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">ReentrantLock</code> 用它来表现拥有它的线程已经请求了多少次锁；<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">FutureTask</code> 用它来表现任务的状态(尚未开始、运行、完成和取消)</p>
<pre style="white-space:pre-wrap;word-break:break-all;overflow-y:hidden;overflow-x:auto;box-sizing:border-box;outline:0px;color:rgb(51,51,51);line-height:23.8px;position:relative;word-wrap:break-word;font-family:'Source Code Pro', monospace;font-size:14px;margin:0px 0px 24px;padding:8px 16px 4px 56px;background-color:rgb(246, 248, 250);border:none;"><code style="overflow-x:auto;word-break:break-all;outline:0px;border-radius:4px;display:block;font-size:12.6px;line-height:22px;box-sizing:border-box;white-space:pre;word-wrap:normal;padding:8px;font-family:'Source Code Pro', monospace;color:inherit;background:transparent;"><ol style="outline:0px;list-style:none;box-sizing:border-box;border-collapse:collapse;padding:0px;margin:0px;overflow:hidden;word-break:break-all;"><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">1</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);">To</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">use</span> this <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">class</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">as</span> the basis <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">of</span> a synchronizer, redefine the</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">2</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">following</span> methods, <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">as</span> applicable, <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">by</span></span> inspecting <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">and</span></span>/<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">or</span></span> modifying</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">3</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> the synchronization state <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">using</span> {@<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">link</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);">#getState</span>}, {@<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">link</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">4</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);">#setState</span>} <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">and</span></span>/<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">or</span></span> {@<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">link</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);">#compareAndSetState</span>}:</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">5</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">6</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&lt;</span>ul<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&gt;</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">7</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&lt;</span>li<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&gt;</span> {@<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">link</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);">#tryAcquire</span>}</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">8</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&lt;</span>li<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&gt;</span> {@<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">link</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);">#tryRelease</span>}</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">9</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&lt;</span>li<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&gt;</span> {@<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">link</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);">#tryAcquireShared</span>}</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">10</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&lt;</span>li<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&gt;</span> {@<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">link</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);">#tryReleaseShared</span>}</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">11</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&lt;</span>li<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&gt;</span> {@<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">link</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);">#isHeldExclusively</span>}</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">12</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">*</span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&lt;</span>/ul<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,0);">&gt;</span></div></div></li></ol></code></pre><ul style="list-style:none;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;box-sizing:border-box;line-height:23.8px;width:50px;background-color:rgb(238,238,238);border-right:1px solid rgb(221,221,221);text-align:right;"><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">1</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">2</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">3</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">4</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">5</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">6</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">7</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">8</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">9</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">10</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">11</li><li style="outline:0px;box-sizing:border-box;list-style-type:disc;word-break:break-all;padding:0px 8px;margin:0px;list-style:none;color:rgb(153,153,153);">12</li></ul><p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
如JDK的文档中所说，使用AQS来实现一个同步器需要覆盖实现如下几个方法，并且使用<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">getState</code>,<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">setState</code>,<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">compareAndSetState</code>这几个方法来设置获取状态 <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
1. <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">boolean tryAcquire(int arg)</code> <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
2. <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">boolean tryRelease(int arg)</code> <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
3. <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">int tryAcquireShared(int arg)</code> <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
4. <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">boolean tryReleaseShared(int arg)</code> <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
5. <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">boolean isHeldExclusively()</code></p>
<p style="font-size:16px;word-break:break-all;outline:0px;padding:0px;margin:0px 0px 16px;box-sizing:border-box;color:rgb(63,63,63);font-weight:400;line-height:27.2px;text-align:justify;font-family:'microsoft yahei';">
以上方法不需要全部实现，根据获取的锁的种类可以选择实现不同的方法，支持独占(排他)获取锁的同步器应该实现<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">tryAcquire</code>、 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">tryRelease</code>、<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">isHeldExclusively</code>而支持共享获取的同步器应该实现<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">tryAcquireShared</code>、<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">tryReleaseShared</code>、<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">isHeldExclusively</code>。下面以 <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">CountDownLatch</code> 举例说明基于AQS实现同步器, <code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">CountDownLatch</code> 用同步状态持有当前计数，<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">countDown</code>方法调用
 release从而导致计数器递减；当计数器为0时，解除所有线程的等待；<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">await</code>调用acquire，如果计数器为0，<code style="outline:0px;box-sizing:border-box;border-radius:4px;word-break:break-all;font-family:'Source Code Pro', monospace;font-size:14.4px;">acquire</code> 会立即返回，否则阻塞。通常用于某任务需要等待其他任务都完成后才能继续执行的情景。源码如下:</p>
<pre style="white-space:pre-wrap;word-break:break-all;overflow-y:hidden;overflow-x:auto;box-sizing:border-box;outline:0px;color:rgb(51,51,51);line-height:23.8px;position:relative;word-wrap:break-word;font-family:'Source Code Pro', monospace;font-size:14px;margin:0px 0px 24px;padding:8px 16px 4px 56px;background-color:rgb(246, 248, 250);border:none;"><code style="overflow-x:auto;word-break:break-all;outline:0px;border-radius:4px;display:block;font-size:12.6px;line-height:22px;box-sizing:border-box;white-space:pre;word-wrap:normal;padding:8px;font-family:'Source Code Pro', monospace;color:inherit;background:transparent;"><ol style="outline:0px;list-style:none;box-sizing:border-box;border-collapse:collapse;padding:0px;margin:0px;overflow:hidden;word-break:break-all;"><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">1</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">class</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">CountDownLatch</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span>{</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">2</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">/**</span></span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">3</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">     * 基于AQS的内部Sync</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">4</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">     * 使用AQS的state来表示计数count.</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">5</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">     */</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">6</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">static</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">class</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">Sync</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">extends</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(102,0,102);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(230, 192, 123);">AbstractQueuedSynchronizer</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span>{</span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">7</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">static</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">long</span></span> serialVersionUID = <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">4982264981922014374</span></span><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">L</span>;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">8</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">9</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        Sync(<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> count) {</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">10</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 使用AQS的getState()方法设置状态</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">11</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            setState(count);</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">12</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">13</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">14</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> <span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">getCount</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">15</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 使用AQS的getState()方法获取状态</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">16</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> getState();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">17</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">18</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">19</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 覆盖在共享模式下尝试获取锁</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">20</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">protected</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">tryAcquireShared</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">(</span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> acquires)</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">21</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 这里用状态state是否为0来表示是否成功，为0的时候可以获取到返回1，否则不可以返回-1</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">22</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> (getState() == <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">0</span></span>) ? <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span></span> : -<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span></span>;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">23</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">24</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">25</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 覆盖在共享模式下尝试释放锁</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">26</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">protected</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">boolean</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">tryReleaseShared</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">(</span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> releases)</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">27</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 在for循环中Decrement count直至成功;</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">28</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 当状态值即count为0的时候，返回false表示 signal when transition to zero</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">29</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">for</span></span> (;;) {</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">30</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">                <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> c = getState();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">31</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">                <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">if</span></span> (c == <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">0</span></span>)</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">32</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">                    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">false</span></span>;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">33</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">                <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span> nextc = c-<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span></span>;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">34</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">                <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">if</span></span> (compareAndSetState(c, nextc))</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">35</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">                    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> nextc == <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">0</span></span>;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">36</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">            }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">37</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">38</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">39</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">40</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">private</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">final</span></span> Sync sync;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">41</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">42</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 使用给定计数值构造CountDownLatch</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">43</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">CountDownLatch</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">(</span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">int</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> count)</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">44</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">if</span></span> (count &lt; <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">0</span></span>) <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">throw</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">new</span></span> IllegalArgumentException(<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,136,0);"><span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">&quot;count &lt; 0&quot;</span></span>);</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">45</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">this</span></span>.sync = <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">new</span></span> Sync(count);</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">46</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">47</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">48</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 让当前线程阻塞直到计数count变为0，或者线程被中断</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">49</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">void</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">await</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">throws</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> InterruptedException </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">50</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        sync.acquireSharedInterruptibly(<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span></span>);</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">51</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">52</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">53</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 阻塞当前线程，除非count变为0或者等待了timeout的时间。当count变为0时，返回true</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">54</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">boolean</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">await</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">(</span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">long</span></span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> timeout, TimeUnit unit)</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">55</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">throws</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> InterruptedException </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">56</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> sync.tryAcquireSharedNanos(<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span></span>, unit.toNanos(timeout));</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">57</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">58</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">59</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// count递减</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">60</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">void</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">countDown</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">61</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        sync.releaseShared(<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,102,102);"><span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span></span>);</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">62</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">63</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">64</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(136,0,0);font-style:italic;"><span style="outline:0px;box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;word-break:break-all;">// 获取当前count值</span></span></div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">65</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">long</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">getCount</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">66</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> sync.getCount();</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">67</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">68</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;"> </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">69</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">public</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"> String </span><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(97, 174, 238);word-break:break-all;">toString</span></span></span><span style="outline:0px;box-sizing:border-box;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;">()</span> </span>{</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">70</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">        <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">return</span></span> <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,0,136);"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">super</span></span>.toString() + <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,136,0);"><span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">&quot;[Count = &quot;</span></span> + sync.getCount() + <span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(0,136,0);"><span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">&quot;]&quot;</span></span>;</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">71</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">    }</div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">72</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">}</div></div></li></ol></code></pre>
            </div>
                <span style="display:block;clear:both;"></span></div>
				
        	</div>
	
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;padding-bottom:16px;margin-top:16px;border-bottom:1px solid rgb(227, 227, 227);">
								<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-bottom:8px;font-size:12px;">
			<span style="box-sizing:inherit;outline:0px;color:rgb(77, 77, 77);">个人分类：</span>
						<a href="https://blog.csdn.net/zcw4237256/article/category/7232699" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(200, 131, 38);word-break:break-all;" target="_blank">java						</a>
		</div>
								<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:12px;margin-bottom:0px;">
			<span style="box-sizing:inherit;outline:0px;color:rgb(77, 77, 77);">相关热词：</span>
						<a href="https://blog.csdn.net/chenssy/article/details/65449785" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(200, 131, 38);word-break:break-all;" target="_blank">
			并发aqs			</a>
						<a href="https://blog.csdn.net/notonlyrush/article/details/51333490" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(200, 131, 38);word-break:break-all;" target="_blank">
			aqs体系			</a>
						<a href="https://blog.csdn.net/chenwanli1111/article/details/51115875" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(200, 131, 38);word-break:break-all;" target="_blank">
			aqs实现原理			</a>
						<a href="https://blog.csdn.net/u010862794/article/details/72892300" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(200, 131, 38);word-break:break-all;" target="_blank">
			aqs乐观锁			</a>
						<a href="https://blog.csdn.net/wojiaolinaaa/article/details/50070031" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(200, 131, 38);word-break:break-all;" target="_blank">
			aqs源码			</a>
					</div>
			</div>
	
	
			<div style="outline:0px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin:0px;box-sizing:inherit;padding:0px;line-height:28px;display:inline-block;width:48%;margin-top:18px;margin-right:16px;">
		<a href="https://blog.csdn.net/zcw4237256/article/details/78551235" style="box-sizing:inherit;outline:0px;color:rgb(51, 51, 51);text-decoration:none;cursor:pointer;">
			<span style="box-sizing:inherit;outline:0px;margin-right:8px;padding:6px 8px;font-size:12px;border:1px solid rgb(227, 227, 227);color:rgb(77, 77, 77);">上一篇</span>Lock锁  Condition 和线程的关系详解		</a>
	</div>
				<div style="outline:0px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin:0px;box-sizing:inherit;padding:0px;line-height:28px;display:inline-block;width:48%;margin-bottom:0px;margin-top:0px;">
		<a href="https://blog.csdn.net/zcw4237256/article/details/78557980" style="box-sizing:inherit;outline:0px;color:rgb(51, 51, 51);text-decoration:none;cursor:pointer;">
			<span style="box-sizing:inherit;outline:0px;margin-right:8px;padding:6px 8px;font-size:12px;border:1px solid rgb(227, 227, 227);color:rgb(77, 77, 77);">下一篇</span>classpath和path详解配置原因 classpath、path、JAVA_HOME的作用及JAVA环境变量配置		</a>
	</div>
	</div></span></div></div></div></div>
</div>
</span>
</div></body></html> 