<html>
<head>
  <title>深入浅出 spring-data-elasticsearch 系列 – 概述及入门（二） | Spring For All</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5905"/>
<h1>深入浅出 spring-data-elasticsearch 系列 – 概述及入门（二） | Spring For All</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2017/12/8 17:16</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://www.spring4all.com/article/331"><i>http://www.spring4all.com/article/331</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="box-sizing:border-box;font-family:sans-serif;text-size-adjust:100%;font-size:14px;"><div style="box-sizing:inherit;overflow-x:hidden;min-width:320px;background:rgb(255, 255, 255);font-family:Lato, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif;font-size:14px;line-height:1.4285em;color:rgba(0, 0, 0, 0.870588);background-color:#f3f3f3;"><div style="box-sizing:inherit;"><div style="box-sizing:inherit;"><div style="box-sizing:inherit;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;-webkit-box-align:stretch;align-items:stretch;"><div style="box-sizing:inherit;vertical-align:top;"><div style="box-sizing:inherit;background:rgb(255, 255, 255);box-shadow:rgba(34, 36, 38, 0.14902) 0px 1px 2px 0px;border-radius:0.285714rem;font-size:1rem;"><h3 style="font-size:1.28571rem;box-sizing:inherit;border:none;line-height:1.28571em;font-weight:700;padding:0px;font-family:Lato, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif;margin:calc(2rem - 0.142857em) 0px 1rem;text-transform:none;margin-top:-0.142857em;padding-bottom:0.214286rem;border-bottom:2px solid rgb(219, 40, 40);color:rgb(219, 40, 40);"><i style="height:1em;box-sizing:inherit;font-family:Icons;backface-visibility:hidden;-webkit-font-smoothing:antialiased;speak:none;text-align:center;margin:0px 0.25rem 0px 0px;width:1.18em;text-decoration:inherit;font-weight:400;font-style:normal;font-size:1.5em;display:table-cell;vertical-align:middle;padding-top:0.142857em;opacity:1;margin-bottom:0px;"><span style="font-size:1.5em;font-family:Icons;font-style:normal;font-weight:400;text-align:center;background:0px 0px !important;"></span></i> <div style="box-sizing:inherit;display:table-cell;vertical-align:middle;padding-left:0.75rem;">深入浅出 spring-data-elasticsearch 系列 – 概述及入门（二）</div></h3> <div style="line-height:1.6;box-sizing:inherit;padding:0px;overflow:auto;font-family:&quot;Microsoft YaHei&quot;, Helvetica, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &quot;Helvetica Neue&quot;, &quot;Droid Sans&quot;, &quot;wenquanyi micro hei&quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif;font-size:14px;text-size-adjust:100%;word-wrap:break-word;text-align:left;color:rgb(51, 51, 51);width:100%;background-color:rgb(255, 255, 255);"><p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-bottom:16px;margin-top:0px;">本文目录<br style="box-sizing:border-box;"/>一、spring-data-elasticsearch 是什么？<br style="box-sizing:border-box;"/>1.1 Spring Data<br style="box-sizing:border-box;"/>1.2 Spring Data Elasticsearch<br style="box-sizing:border-box;"/>二、spring-data-elasticsearch 快速入门<br style="box-sizing:border-box;"/>2.1 pom.xml 依赖<br style="box-sizing:border-box;"/>2.2 ElasticsearchRepository<br style="box-sizing:border-box;"/>2.3 ElasticsearchTemplate<br style="box-sizing:border-box;"/>2.4 使用案例<br style="box-sizing:border-box;"/>三、spring-data-elasticsearch 和 elasticsearch 版本<br style="box-sizing:border-box;"/>四、小结</p>
<blockquote style="font-size:14px;box-sizing:border-box;padding:0px 15px;color:rgb(102, 102, 102);border-left:4px solid rgb(221, 221, 221);margin:0px;font-style:italic;margin-top:0px;margin-bottom:16px;padding-left:20px;margin-left:0px;">
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:0px;">这里我们只是把人生大致分成“学习阶段”以及之后的“工作阶段”。<br style="box-sizing:border-box;"/>-《未来简史》</p>
</blockquote>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;"><strong style="box-sizing:border-box;font-weight:bold;">一、spring-data-elasticsearch 是什么？</strong><br style="box-sizing:border-box;"/>1.1 Spring Data<br style="box-sizing:border-box;"/>要了解 spring-data-elasticsearch 是什么，首先了解什么是 Spring Data。<br style="box-sizing:border-box;"/>Spring Data 基于 Spring 为数据访问提供一种相似且一致性的编程模型，并保存底层数据存储的。</p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;">1.2 Spring Data Elasticsearch<br style="box-sizing:border-box;"/>spring-data-elasticsearch 是 Spring Data 的 Community modules 之一，是 Spring Data 对 Elasticsearch 引擎的实现。<br style="box-sizing:border-box;"/>Elasticsearch 默认提供轻量级的 HTTP Restful 接口形式的访问。相对来说，使用 HTTP Client 调用也很简单。但 spring-data-elasticsearch 可以更快的支持构建在 Spring 应用上，比如在 application.properties 配置 ES 节点信息和 spring-boot-starter-data-elasticsearch 依赖，直接在 Spring Boot 应用上使用。</p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;"><strong style="box-sizing:border-box;font-weight:bold;">二、spring-data-elasticsearch 快速入门</strong><br style="box-sizing:border-box;"/>2.1 pom.xml 依赖</p>
<pre style="font-weight:normal;box-sizing:border-box;font-stretch:normal;font-family:&quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace;margin-top:0px;margin-bottom:16px;font-style:normal;font-variant:normal;overflow:auto;font-size:85%;line-height:1.6;padding:10px;border-radius:3px;word-wrap:normal;border:1px solid rgb(221, 221, 221);background:rgb(246, 246, 246);"><code style="background:transparent;box-sizing:border-box;border:0px;font-size:100%;margin:0px;border-radius:3px;word-break:normal;white-space:pre;font-family:&quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace;padding:0px;display:inline;max-width:initial;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;"><span style="font-family:&quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace;font-size:100%;white-space:pre;line-height:inherit;letter-spacing:-0.2em;"></span>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;
    &lt;artifactId&gt;spring-data-elasticsearch&lt;/artifactId&gt;
    &lt;version&gt;x.y.z.RELEASE&lt;/version&gt;
&lt;/dependency&gt;
<span style="font-family:&quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace;font-size:100%;white-space:pre;line-height:inherit;letter-spacing:-0.2em;"></span></code></pre><p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;">2.2 ElasticsearchRepository<br style="box-sizing:border-box;"/>ES 通用的存储接口的一种默认实现。Spring 根据接口定义的方法名，具体执行对应的数据存储实现。<br style="box-sizing:border-box;"/>ElasticsearchRepository 继承 ElasticsearchCrudRepository ，ElasticsearchCrudRepository 继承 PagingAndSortingRepository。所以一般 CRUD 带分页已经支持。如图：</p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;"><img src="深入浅出 spring-data-elasticsearch 系列 – 概述及入门（二） _files/ed0a269bbe277c71e09e5e3e6647057d1512459.png" type="image/png" data-filename="ed0a269bbe277c71e09e5e3e6647057d1512459.png" alt="" height="394" style="box-sizing:border-box;border:0px;max-width:100%;" width="381"/></p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;">2.3 ElasticsearchTemplate<br style="box-sizing:border-box;"/>ES 数据操作的中心支持类。和 JdbcTemplate 一样，几乎所有操作都可以使用 ElasticsearchTemplate 来完成。<br style="box-sizing:border-box;"/>ElasticsearchTemplate 实现了 ElasticsearchOperations 和 ApplicationContextAware 接口。ElasticsearchOperations 接口提供了 ES 相关的操作，并将 ElasticsearchTemplate 加入到 Spring 上下文。如图：</p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;"><img src="深入浅出 spring-data-elasticsearch 系列 – 概述及入门（二） _files/a1d036e18b15e162f265183612591f021512459.png" type="image/png" data-filename="a1d036e18b15e162f265183612591f021512459.png" alt="" height="249" style="box-sizing:border-box;border:0px;max-width:100%;" width="438"/></p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;">2.4 使用案例<br style="box-sizing:border-box;"/>拿官方案例来吧，详细介绍了 Book ES 对象的接口实现。<br style="box-sizing:border-box;"/>可以看出，book 拥有 name 和 price 两个属性。下面支持  name 和 price 列表 ES 查询，分页查询，范围查询等。还有可以利用注解实现 DSL 操作。</p>
<pre style="font-weight:normal;box-sizing:border-box;font-stretch:normal;font-family:&quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace;margin-top:0px;margin-bottom:16px;font-style:normal;font-variant:normal;overflow:auto;font-size:85%;line-height:1.6;padding:10px;border-radius:3px;word-wrap:normal;border:1px solid rgb(221, 221, 221);background:rgb(246, 246, 246);"><code style="background:transparent;box-sizing:border-box;border:0px;font-size:100%;margin:0px;border-radius:3px;word-break:normal;white-space:pre;font-family:&quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace;padding:0px;display:inline;max-width:initial;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;"><span style="font-family:&quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace;font-size:100%;white-space:pre;line-height:inherit;letter-spacing:-0.2em;"></span>    public interface BookRepository extends Repository&lt;Book, String&gt; {
        List&lt;Book&gt; findByNameAndPrice(String name, Integer price);
        List&lt;Book&gt; findByNameOrPrice(String name, Integer price);
        Page&lt;Book&gt; findByName(String name,Pageable page);
        Page&lt;Book&gt; findByNameNot(String name,Pageable page);
        Page&lt;Book&gt; findByPriceBetween(int price,Pageable page);
        Page&lt;Book&gt; findByNameLike(String name,Pageable page);
        @Query(&quot;{\&quot;bool\&quot; : {\&quot;must\&quot; : {\&quot;term\&quot; : {\&quot;message\&quot; : \&quot;?0\&quot;}}}}&quot;)
        Page&lt;Book&gt; findByMessage(String message, Pageable pageable);
    }
<span style="font-family:&quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace;font-size:100%;white-space:pre;line-height:inherit;letter-spacing:-0.2em;"></span></code></pre>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;"><strong style="box-sizing:border-box;font-weight:bold;">三、spring-data-elasticsearch 和 elasticsearch 版本</strong><br style="box-sizing:border-box;"/>SpringBoot 1.5+ 目前仅支持 ElasticSearch 2.3.2，所以如果想要使用最新的 ES。可以通过默认的轻量级的 HTTP 去调用实现。其版本对应如下:</p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;">spring data elasticsearch    elasticsearch<br style="box-sizing:border-box;"/>3.0.0.BUILD-SNAPSHOT    5.4.0<br style="box-sizing:border-box;"/>2.0.4.RELEASE                    2.4.0<br style="box-sizing:border-box;"/>2.0.0.RELEASE                    2.2.0<br style="box-sizing:border-box;"/>1.4.0.M1                               1.7.3<br style="box-sizing:border-box;"/>1.3.0.RELEASE                    1.5.2<br style="box-sizing:border-box;"/>1.2.0.RELEASE                    1.4.4<br style="box-sizing:border-box;"/>1.1.0.RELEASE                    1.3.2<br style="box-sizing:border-box;"/>1.0.0.RELEASE                    1.1.1</p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;"><strong style="box-sizing:border-box;font-weight:bold;">四、小结</strong><br style="box-sizing:border-box;"/>本小结介绍了 spring-data-elasticsearch 是概述以及它的入门，还有 spring-data-elasticsearch 核心接口及版本的情况。</p>
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:16px;">资料：<br style="box-sizing:border-box;"/>项目地址<br style="box-sizing:border-box;"/><a href="https://github.com/spring-projects/spring-data-elasticsearch" style="box-sizing:border-box;background:transparent;color:rgb(65, 131, 196);text-decoration:none;">https://github.com/spring-proj … earch</a><br style="box-sizing:border-box;"/>官方文档<br style="box-sizing:border-box;"/><a href="http://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/" style="box-sizing:border-box;background:transparent;color:rgb(65, 131, 196);text-decoration:none;">http://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/</a></p>
<blockquote style="border-left:4px solid rgb(221, 221, 221);box-sizing:border-box;padding:0px 15px;color:rgb(102, 102, 102);margin:0px;font-size:14px;font-style:italic;margin-top:0px;padding-left:20px;margin-left:0px;margin-bottom:0px;">
<p style="margin:0px 0px 1em;line-height:1.4285em;box-sizing:border-box;margin-top:0px;margin-bottom:0px;">本文作者： 泥瓦匠<br style="box-sizing:border-box;"/>原文链接： <a href="http://www.bysocket.com/" style="box-sizing:border-box;background:transparent;color:rgb(65, 131, 196);text-decoration:none;">http://www.bysocket.com</a><br style="box-sizing:border-box;"/>版权归作者所有，转载请注明出处</p>
</blockquote>
</div></div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 