<html>
<head>
  <title>oracle常用函数详解（详细） - 李慕白520 - 博客园</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="9538"/>
<h1>oracle常用函数详解（详细） - 李慕白520 - 博客园</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/6/21 9:30</i></td></tr>
<tr><td><b>标签：</b></td><td><i>oracle</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://www.cnblogs.com/lxl57610/p/7442130.html"><i>https://www.cnblogs.com/lxl57610/p/7442130.html</i></a></td></tr>
</table>
</div>
<br/>

<div><span>
  <div>
<div style="font-size: 16px; display: inline-block; min-width: 100%;position: relative;"><div style="background-color:rgb(255, 255, 255);color:rgb(51, 51, 51);font-family:verdana, arial, helvetica, sans-serif;font-size:13px;"><div style="font-family:&quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;background-color:rgb(255, 255, 255);color:rgb(51, 51, 51);font-size:14px;"><div style="background:rgb(245, 245, 245);"><div><div><div style="border-image:initial;background-color:rgb(255, 255, 255);color:rgb(0, 0, 102);"><div style="line-height:1.5;"><div style="word-break:break-word;font-family:&quot;Microsoft Yahei&quot;;font-size:16px;"><p style="margin:10px auto;text-indent:0px;"><a href="http://blog.csdn.net/u011955534/article/details/14168913" style="color:rgb(0, 107, 173);text-decoration:none;" target="_blank">作者：红旗飘扬</a></p>
<p style="margin:10px auto;text-indent:0px;"><a href="http://lib.csdn.net/base/oracle" style="color:rgb(0, 107, 173);text-decoration:none;" target="_blank" title="Oracle知识库">Oracle</a> SQL 提供了用于执行特定操作的专用函数。这些函数大大增强了 SQL 语言的功能。函数可以接受零个或者多个输入参数，并返回一个输出结果。 <a href="http://lib.csdn.net/base/oracle" style="color:rgb(0, 107, 173);text-decoration:none;" target="_blank" title="Oracle知识库">oracle</a> <a href="http://lib.csdn.net/base/mysql" style="color:rgb(0, 107, 173);text-decoration:none;" target="_blank" title="MySQL知识库">数据库</a>中主要使用两种类型的函数：</p>
<p style="margin:10px auto;text-indent:0px;">1.  单行函数：对每一个函数应用在表的记录中时，只能输入一行结果，返回一个结果，</p>
<p style="margin:10px auto;text-indent:0px;">比如：MOD(x,y)返回 x 除以 y 的余数（x 和 y 可以是两个整数，也可以是表中的整</p>
<p style="margin:10px auto;text-indent:0px;">数列）。常用的单行函数有：</p>
<p style="margin:10px auto;text-indent:0px;">Ø  字符函数：对字符串操作。</p>
<p style="margin:10px auto;text-indent:0px;">Ø  数字函数：对数字进行计算，返回一个数字。</p>
<p style="margin:10px auto;text-indent:0px;">Ø  转换函数：可以将一种数据类型转换为另外一种数据类型。</p>
<p style="margin:10px auto;text-indent:0px;">Ø  日期函数：对日期和时间进行处理。</p>
<p style="margin:10px auto;text-indent:0px;">2.  聚合函数：聚合函数同时可以对多行数据进行操作，并返回一个结果。比如 SUM(x)</p>
<p style="margin:10px auto;text-indent:0px;">返回结果集中 x 列的总合。</p>
<p style="margin:10px auto;text-indent:0px;"><strong>一、字符函数</strong></p>
<p style="margin:10px auto;text-indent:0px;">字符函数接受字符参数，这些参数可以是表中的列，也可以是一个字符串表达式。</p>
<p style="margin:10px auto;text-indent:0px;">常用的字符函数：</p>
<table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border:1px solid silver;border-collapse:collapse;word-break:break-word;display:block;overflow-x:scroll;">
<tbody>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">函数</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">说明</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">ASCII(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">返回字符X的ASCII码</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">CONCAT(X,Y)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">连接字符串X和Y</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">INSTR(X,STR[,START][,N)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">从X中查找str，可以指定从start开始，也可以指定从n开始</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">LENGTH(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">返回X的长度</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">LOWER(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X转换成小写</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">UPPER(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X转换成大写</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">LTRIM(X[,TRIM_STR])</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">把X的左边截去trim_str字符串，缺省截去空格</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">RTRIM(X[,TRIM_STR])</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">把X的右边截去trim_str字符串，缺省截去空格</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">TRIM([TRIM_STR  FROM]X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">把X的两边截去trim_str字符串，缺省截去空格</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">REPLACE(X,old,new)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">在X中查找old，并替换成new</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SUBSTR(X,start[,length])</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">返回X的字串，从start处开始，截取length个字符，缺省length，默认到结尾</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:10px auto;text-indent:0px;">上面各函数的例子：</p>
<table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border:1px solid silver;border-collapse:collapse;word-break:break-word;display:block;overflow-x:scroll;">
<tbody>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">示例</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">示例结果</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT ASCII('a') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">97</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT CONCAT('Hello','world') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">Helloworld</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT INSTR('Hello world','or') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">8</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT LENGTH('Hello') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">5</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT LOWER('Hello') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">hello</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT UPPER('hello') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">HELLO</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT LTRIM('=Hello=','=') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">Hello=</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT RTRIM('=Hello=','=') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">=Hello</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT TRIM('='FROM'=Hello=') FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">Hello</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT REPLACE('ABCDE','CD','AAA')FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">ABAAAE</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SELECT SUBSTR('ABCDE',2,3) FROM dual;</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">BCD</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:10px auto;text-indent:0px;"><strong>二、数字函数</strong></p>
<p style="margin:10px auto;text-indent:0px;">数字函数接受数字参数，参数可以来自表中的一列，也可以是一个数字表达式。</p>
<table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border:1px solid silver;border-collapse:collapse;word-break:break-word;display:block;overflow-x:scroll;">
<tbody>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">函数</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">说明</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">示例</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">ABS(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X的绝对值</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">ABS(-3)=3</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">ACOS(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X的反余弦</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">ACOS(1)=0</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">COS(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">余弦</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">COS(1)=0.54030230586814</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">CEIL(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">大于或等于X的最小值</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">CEIL(5.4)=6</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">FLOOR(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">小于或等于X的最大值</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">FLOOR(5.8)=5</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">LOG(X,Y)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X为底Y的对数</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">LOG(2，4)=2</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">MOD(X,Y)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X除以Y的余数</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">MOD(8，3)=2</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">POWER(X,Y)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X的Y次幂</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">POWER(2，3)=8</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">ROUND(X[,Y])</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X在第Y位四舍五入</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">ROUND(3.456，2)=3.46</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SQRT(X)</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X的平方根</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SQRT(4)=2</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">TRUNC(X[,Y])</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">X在第Y位截断</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">TRUNC(3.456，2)=3.45</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:10px auto;text-indent:0px;">说明：</p>
<p style="margin:10px auto;text-indent:0px;"><strong>1.  ROUND(X[,Y])</strong><strong>，</strong>四舍五入。</p>
<p style="margin:10px auto;text-indent:0px;">在缺省 y 时，默认 y=0；比如：ROUND(3.56)=4。</p>
<p style="margin:10px auto;text-indent:0px;">y 是正整数，就是四舍五入到小数点后 y 位。ROUND(5.654,2)=5.65。</p>
<p style="margin:10px auto;text-indent:0px;">y 是负整数，四舍五入到小数点左边|y|位。ROUND(351.654,-2)=400。</p>
<p style="margin:10px auto;text-indent:0px;"><strong>2.  TRUNC(x[,y])</strong>，直接截取，不四舍五入。</p>
<p style="margin:10px auto;text-indent:0px;">在缺省 y 时，默认 y=0；比如：TRUNC (3.56)=3。</p>
<p style="margin:10px auto;text-indent:0px;">Y是正整数，就是四舍五入到小数点后 y 位。TRUNC (5.654,2)=5.65。</p>
<p style="margin:10px auto;text-indent:0px;">y 是负整数，四舍五入到小数点左边|y|位。TRUNC (351.654,-2)=300。</p>
<p style="margin:10px auto;text-indent:0px;"><strong>三、日期函数</strong></p>
<p style="margin:10px auto;text-indent:0px;">日期函数对日期进行运算。常用的日期函数有：</p>
<p style="margin:10px auto;text-indent:0px;"><strong>1、ADD_MONTHS(d,n)</strong>，在某一个日期 d 上，加上指定的月数 n，返回计算后的新日期。</p>
<p style="margin:10px auto;text-indent:0px;">d 表示日期，n 表示要加的月数。</p>
<p style="margin:10px auto;text-indent:0px;">例：SELECT SYSDATE,add_months(SYSDATE,5) FROM dual;</p>
<p style="margin:10px auto;text-indent:0px;"> <img src="oracle常用函数详解（详细） - 李慕白520 - 博客园_files/SouthEast" type="image/png" data-filename="SouthEast" height="43" style="border:none;height:auto;max-width:300px;" width="359"/></p>
<p style="margin:10px auto;text-indent:0px;"><strong>2、LAST_DAY(d)</strong>，返回指定日期当月的最后一天。</p>
<p style="margin:10px auto;text-indent:0px;">例：SELECT SYSDATE,last_day(SYSDATE) FROM dual;</p>
<p style="margin:10px auto;text-indent:0px;"> <img src="oracle常用函数详解（详细） - 李慕白520 - 博客园_files/SouthEast [1]" type="image/png" data-filename="SouthEast" height="43" style="border:none;height:auto;max-width:300px;" width="338"/></p>
<p style="margin:10px auto;text-indent:0px;"><strong>3、ROUND(d[,fmt])</strong>，返回一个以 fmt 为格式的四舍五入日期值， d 是日期， fmt 是格式</p>
<p style="margin:10px auto;text-indent:0px;">模型。默认 fmt 为 DDD，即月中的某一天。</p>
<p style="margin:10px auto;text-indent:0px;">Ø  ① 如果 fmt 为“YEAR”则舍入到某年的 1 月 1 日，即前半年舍去，后半年作为下一年。</p>
<p style="margin:10px auto;text-indent:0px;">Ø  ② 如果 fmt 为“MONTH”则舍入到某月的 1 日，即前月舍去，后半月作为下一月。</p>
<p style="margin:10px auto;text-indent:0px;">Ø  ③ 默认为“DDD”，即月中的某一天，最靠近的天，前半天舍去，后半天作为第二天。</p>
<p style="margin:10px auto;text-indent:0px;">Ø  ④ 如果 fmt 为“DAY”则舍入到最近的周的周日，即上半周舍去，下半周作为下一周周日。</p>
<p style="margin:10px auto;text-indent:0px;">例：SELECT SYSDATE,ROUND(SYSDATE),ROUND(SYSDATE,'day'),</p>
<p style="margin:10px auto;text-indent:0px;">ROUND(SYSDATE,'month'),ROUND(SYSDATE,'year') FROM dual;</p>
<p style="margin:10px auto;text-indent:0px;"> <img src="oracle常用函数详解（详细） - 李慕白520 - 博客园_files/SouthEast [2]" type="image/png" data-filename="SouthEast" height="53" style="border:none;height:auto;max-width:300px;" width="764"/></p>
<p style="margin:10px auto;text-indent:0px;">与 ROUND 对应的函数时 TRUNC(d[,fmt])对日期的操作， TRUNC 与 ROUND 非常相似，只是不对日期进行舍入，直接截取到对应格式的第一天。</p>
<p style="margin:10px auto;text-indent:0px;"><strong>4、EXTRACT(fmt FROM d)</strong>，提取日期中的特定部分。</p>
<p style="margin:10px auto;text-indent:0px;">fmt 为：YEAR、MONTH、DAY、HOUR、MINUTE、SECOND。其中 YEAR、MONTH、DAY可以为 DATE 类型匹配，也可以与 TIMESTAMP 类型匹配；但是 HOUR、MINUTE、SECOND 必须与 TIMESTAMP 类型匹配。</p>
<p style="margin:10px auto;text-indent:0px;">HOUR 匹配的结果中没有加上时区，因此在中国运行的结果小 8 小时。</p>
<p style="margin:10px auto;text-indent:0px;">例：SELECT SYSDATE &quot;date&quot;,</p>
<p style="margin:10px auto;text-indent:0px;">       EXTRACT(YEAR FROM SYSDATE)&quot;year&quot;,</p>
<p style="margin:10px auto;text-indent:0px;">       EXTRACT(MONTH FROM SYSDATE)&quot;month&quot;,</p>
<p style="margin:10px auto;text-indent:0px;">       EXTRACT(DAY FROM SYSDATE)&quot;day&quot;,</p>
<p style="margin:10px auto;text-indent:0px;">       EXTRACT(HOUR FROM SYSTIMESTAMP)&quot;hour&quot;,</p>
<p style="margin:10px auto;text-indent:0px;">       EXTRACT(MINUTE FROM SYSTIMESTAMP)&quot;minute&quot;,</p>
<p style="margin:10px auto;text-indent:0px;">       EXTRACT(SECOND FROM SYSTIMESTAMP)&quot;second&quot;</p>
<p style="margin:10px auto;text-indent:0px;">FROM dual;</p>
<p style="margin:10px auto;text-indent:0px;"><img src="oracle常用函数详解（详细） - 李慕白520 - 博客园_files/SouthEast [3]" type="image/png" data-filename="SouthEast" height="54" style="border:none;height:auto;max-width:300px;" width="498"/></p>
<p style="margin:10px auto;text-indent:0px;"> </p>
<div>
<p style="margin:10px auto;text-indent:0px;"><strong>四、转换函数</strong></p>
<p style="margin:10px auto;text-indent:0px;">转换函数将值从一种数据类型转换为另外一种数据类型。常见的转换函数有：</p>
<p style="margin:10px auto;text-indent:0px;"><strong>1、TO_CHAR(d|n[,fmt])</strong></p>
<p style="margin:10px auto;text-indent:0px;">把日期和数字转换为制定格式的字符串。Fmt是格式化字符串</p>
<p style="margin:10px auto;text-indent:0px;">代码演示：TO_CHAR对日期的处理</p>
<p style="margin:10px auto;text-indent:0px;">SELECT TO_CHAR(SYSDATE,'YYYY&quot;年&quot;MM&quot;月&quot;DD&quot;日&quot; HH24:MI:SS')&quot;date&quot; FROM dual;</p>
<p style="margin:10px auto;text-indent:0px;"> <img src="oracle常用函数详解（详细） - 李慕白520 - 博客园_files/SouthEast [4]" type="image/png" data-filename="SouthEast" height="49" style="border:none;height:auto;max-width:300px;" width="312"/></p>
<p style="margin:10px auto;text-indent:0px;">代码解析：</p>
<p style="margin:10px auto;text-indent:0px;">在格式化字符串中，使用双引号对非格式化字符进行引用</p>
<p style="margin:10px auto;text-indent:0px;">针对数字的格式化，格式化字符有：</p>
<table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border:1px solid silver;border-collapse:collapse;word-break:break-word;display:block;overflow-x:scroll;">
<tbody>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">参数</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">示例</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">说明</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">9</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">999</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">指定位置处显示数字</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">.</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">9.9</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">指定位置返回小数点</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">,</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">99,99</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">指定位置返回一个逗号</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">$</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">$999</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">数字开头返回一个美元符号</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">EEEE</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">9.99EEEE</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">科学计数法表示</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">L</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">L999</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">数字前加一个本地货币符号</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">PR</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">999PR</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">如果数字式负数则用尖括号进行表示</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:10px auto;text-indent:0px;">代码演示：TO_CHAR对数字的处理</p>
<p style="margin:10px auto;text-indent:0px;">SELECT TO_CHAR(-123123.45,'L9.9EEEEPR')&quot;date&quot; FROM dual;</p>
<p style="margin:10px auto;text-indent:0px;"> <img src="oracle常用函数详解（详细） - 李慕白520 - 博客园_files/SouthEast [5]" type="image/png" data-filename="SouthEast" height="45" style="border:none;height:auto;max-width:300px;" width="272"/></p>
<p style="margin:10px auto;text-indent:0px;"><strong>2、TO_DATE(X,[,fmt])</strong></p>
<p style="margin:10px auto;text-indent:0px;">把一个字符串以fmt格式转换成一个日期类型</p>
<p style="margin:10px auto;text-indent:0px;"><strong>3、TO_NUMBER(X,[,fmt])</strong></p>
<p style="margin:10px auto;text-indent:0px;">把一个字符串以fmt格式转换为一个数字</p>
<p style="margin:10px auto;text-indent:0px;">代码演示：TO_NUM函数</p>
<p style="margin:10px auto;text-indent:0px;">SELECT TO_NUMBER('-$12,345.67','$99,999.99')&quot;num&quot; FROM dual;</p>
<p style="margin:10px auto;text-indent:0px;"> <img src="oracle常用函数详解（详细） - 李慕白520 - 博客园_files/SouthEast [6]" type="image/png" data-filename="SouthEast" height="51" style="border:none;height:auto;max-width:300px;" width="340"/></p>
<p style="margin:10px auto;text-indent:0px;"><strong>五、其它单行函数</strong></p>
<p style="margin:10px auto;text-indent:0px;"><strong>1、NVL(X,VALUE)</strong></p>
<p style="margin:10px auto;text-indent:0px;">如果X为空，返回value，否则返回X</p>
<p style="margin:10px auto;text-indent:0px;">例：对工资是2000元以下的员工，如果没发奖金，每人奖金100元</p>
<p style="margin:10px auto;text-indent:0px;">代码演示：NVL函数</p>
<p style="margin:10px auto;text-indent:0px;">SQL&gt; SELECT ENAME,JOB,SAL,NVL(COMM,100) FROM EMP WHERE SAL&lt;2000;</p>
<p style="margin:10px auto;text-indent:0px;">-------------------------------------------------------------------</p>
<p style="margin:10px auto;text-indent:0px;">ENAME    JOB    SAL    NVL(COMM,100) </p>
<p style="margin:10px auto;text-indent:0px;">SMITH    CLERK    800    100 </p>
<p style="margin:10px auto;text-indent:0px;">ALLEN    SALESMAN    1600    300 </p>
<p style="margin:10px auto;text-indent:0px;">WARD    SALESMAN    1250    500 </p>
<p style="margin:10px auto;text-indent:0px;">MARTIN    SALESMAN    1250    1400 </p>
<p style="margin:10px auto;text-indent:0px;">TURNER    SALESMAN    1500    50 </p>
<p style="margin:10px auto;text-indent:0px;">ADAMS    CLERK    1100    100 </p>
<p style="margin:10px auto;text-indent:0px;">JAMES    CLERK    950    100 </p>
<p style="margin:10px auto;text-indent:0px;">-------------------------------------------------------------------</p>
<p style="margin:10px auto;text-indent:0px;">7 rows selected</p>
<p style="margin:10px auto;text-indent:0px;"><strong>2、NVL2(x,value1,value2)</strong></p>
<p style="margin:10px auto;text-indent:0px;">如果x非空，返回value1，否则返回value2</p>
<p style="margin:10px auto;text-indent:0px;">例：对EMP表中工资为2000元以下的员工，如果没有奖金，则奖金为200元，如果有奖金，则在原来的奖金基础上加100元</p>
<p style="margin:10px auto;text-indent:0px;">代码演示：NVL2函数</p>
<p style="margin:10px auto;text-indent:0px;">SQL&gt; SELECT ENAME,JOB,SAL,NVL2(COMM,comm+100,200) &quot;comm&quot;</p>
<p style="margin:10px auto;text-indent:0px;">2   FROM EMP WHERE SAL&lt;2000;</p>
<p style="margin:10px auto;text-indent:0px;">-------------------------------------------------------------------</p>
<p style="margin:10px auto;text-indent:0px;">ENAME    JOB    SAL    comm </p>
<p style="margin:10px auto;text-indent:0px;">SMITH    CLERK    800    200 </p>
<p style="margin:10px auto;text-indent:0px;">ALLEN    SALESMAN    1600    400 </p>
<p style="margin:10px auto;text-indent:0px;">WARD    SALESMAN    1250    600 </p>
<p style="margin:10px auto;text-indent:0px;">MARTIN    SALESMAN    1250    1500 </p>
<p style="margin:10px auto;text-indent:0px;">TURNER    SALESMAN    1500    150 </p>
<p style="margin:10px auto;text-indent:0px;">ADAMS    CLERK    1100    200 </p>
<p style="margin:10px auto;text-indent:0px;">JAMES    CLERK    950    200 </p>
<p style="margin:10px auto;text-indent:0px;">MILLER    CLERK    1300    200</p>
<p style="margin:10px auto;text-indent:0px;">-------------------------------------------------------------------------------------------------------</p>
<p style="margin:10px auto;text-indent:0px;">8 rows selected</p>
<p style="margin:10px auto;text-indent:0px;"><strong>六、聚合函数</strong></p>
<p style="margin:10px auto;text-indent:0px;">聚合函数同时对一组数据进行操作，返回一行结果，比如计算一组数据的总和，平均值</p>
<p style="margin:10px auto;text-indent:0px;">等。</p>
<table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border:1px solid silver;border-collapse:collapse;word-break:break-word;display:block;overflow-x:scroll;">
<tbody>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">名称</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">作用</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">语法</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">AVG</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">平均值</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">AVG（表达式）</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SUM</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">求和</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">SUM(表达式)</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">MIN、MAX</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">最小值、最大值</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">MIN(表达式)、MAX(表达式)</p>
</td>
</tr>
<tr>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">COUNT</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">数据统计</p>
</td>
<td style="border:1px solid silver;border-collapse:collapse;padding:3px;white-space:nowrap;" valign="top">
<p style="margin:10px auto;text-indent:0px;">COUNT（表达式）</p>
</td>
</tr>
</tbody>
</table>
<p style="margin:10px auto;text-indent:0px;"> </p>
<p style="margin:10px auto;text-indent:0px;">例：求本月所有员工的基本工资总和</p>
<p style="margin:10px auto;text-indent:0px;">代码演示：sum函数</p>
<p style="margin:10px auto;text-indent:0px;">SQL&gt; SELECT SUM(sal) FROM emp;</p>
<p style="margin:10px auto;text-indent:0px;">-------------------------------------------------------------------</p>
<p style="margin:10px auto;text-indent:0px;">SUM(SAL)</p>
<p style="margin:10px auto;text-indent:0px;">29025</p>
<p style="margin:10px auto;text-indent:0px;">例：求不同部门的平均工资</p>
<p style="margin:10px auto;text-indent:0px;">代码演示：AVG函数下的分组查询</p>
<p style="margin:10px auto;text-indent:0px;">SQL&gt; SELECT DEPTNO,AVG(SAL) FROM EMP GROUP BY DEPTNO;  </p>
<p style="margin:10px auto;text-indent:0px;">-------------------------------------------------------------------</p>
<p style="margin:10px auto;text-indent:0px;">DEPTNO    AVG(SAL)</p>
<p style="margin:10px auto;text-indent:0px;">---------    ----------</p>
<p style="margin:10px auto;text-indent:0px;">30    1566.66666</p>
<p style="margin:10px auto;text-indent:0px;">20     2175</p>
<p style="margin:10px auto;text-indent:0px;">10    2916.66666</p>
</div></div></div></div></div></div></div></div></div></div>
</div>
</span>
</div></body></html> 