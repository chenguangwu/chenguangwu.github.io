<html>
<head>
  <title>docker搭建redis3.2官方集群 - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="8737"/>
<h1>docker搭建redis3.2官方集群 - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/3/2 14:36</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://blog.csdn.net/zeroctu/article/details/53380636"><i>http://blog.csdn.net/zeroctu/article/details/53380636</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div><div style="font-family:&quot;microsoft yahei&quot;;background:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/skin/skin-yellow/css/../images/bg-yellow.png&quot;) repeat;"><div><div style="min-width:980px;font-size:12px;"><div style="box-sizing:border-box;"><div style="overflow:hidden;"><div style="overflow:hidden;"><div style="background:rgb(255, 255, 255);border-image:initial;">
        <div style="margin-bottom:21px;">
            <span style="display:inline-block;vertical-align:middle;width:19px;height:19px;margin-right:10px;background-image:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/skin/skin-yellow/css/../images/skin-type-icon.png&quot;);background-repeat:no-repeat;background-position:0px 0px;"></span>
            <h1 style="margin:0px;padding:0px;display:inline-block;vertical-align:middle;font-size:18px;">
                <span>
                    <a href="http://blog.csdn.net/zeroctu/article/details/53380636" style="text-decoration:none;color:rgb(0, 0, 0);">
                        
                                                docker搭建redis3.2官方集群                    </a>
                </span>
            </h1>
        </div>
        <div style="line-height:22px;border-bottom:1px solid rgb(237, 237, 237);font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:12px;overflow:hidden;font-family:Arial;padding:0px 20px 5px;margin:0px -20px;text-align:right;color:rgb(153, 153, 153);margin-bottom:10px;"><span style="color:rgb(153, 153, 153);font-style:normal;font-variant:normal;font-weight:400;font-size:12px;line-height:22px;font-family:Arial;text-align:right;display:table;"> </span>
        <div style="width:100%;float:left;">
        <span style="margin:0px 5px;float:left;margin-right:0px;">
        标签：
                            <a href="http://so.csdn.net/so/search/s.do?q=redis&amp;t=blog" style="text-decoration:none;display:inline-block;margin-right:10px;color:rgb(200, 131, 38);" target="_blank">redis</a>
                    <a href="http://so.csdn.net/so/search/s.do?q=%E9%9B%86%E7%BE%A4&amp;t=blog" style="text-decoration:none;display:inline-block;margin-right:10px;color:rgb(200, 131, 38);" target="_blank">集群</a>
                        </span>
    </div>
        <div>
        <span style="margin:0px 5px 0px 0px;margin-right:16px;">2016年11月28日 17:16:21</span>
        <span style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/css/../../../images/ico_view.png&quot;) left center no-repeat;margin-right:16px;display:inline-block;background-image:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/skin/skin-yellow/css/../images/skin-type-icon.png&quot;);background-repeat:no-repeat;background-position:0px -25px;padding-left:24px;" title="阅读次数">4443人阅读</span>
        <span style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/css/../../../images/ico_comm.png&quot;) left center no-repeat;margin-right:16px;display:inline-block;background-repeat:no-repeat;background-position:0px -43px;padding-left:17px;background-image:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/skin/skin-yellow/css/../images/skin-type-icon-yellow.png&quot;);" title="评论次数"> <a href="#" style="text-decoration:none;color:rgb(200, 131, 38);">评论</a>(4)</span>
        <span style="margin:0px 5px;margin-right:16px;display:inline-block;background-repeat:no-repeat;background-position:0px -62px;padding-left:17px;background-image:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/skin/skin-yellow/css/../images/skin-type-icon-yellow.png&quot;);">
            <a href="#" style="text-decoration:none;color:rgb(200, 131, 38);" target="_blank" title="收藏">收藏</a>
        </span>
                <span style="margin:0px 5px;margin-right:16px;display:inline-block;background-repeat:no-repeat;background-position:0px -81px;padding-left:17px;background-image:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/skin/skin-yellow/css/../images/skin-type-icon-yellow.png&quot;);">
            <a href="#" style="text-decoration:none;color:rgb(200, 131, 38);" title="举报">举报</a>
        </span>
                    </div>
<span style="color:rgb(153, 153, 153);font-style:normal;font-variant:normal;font-weight:400;font-size:12px;line-height:22px;font-family:Arial;text-align:right;height:0px;visibility:hidden;display:block;clear:both;">.</span></div>

                <div style="border-bottom:1px solid rgb(237, 237, 237);margin:0px -20px;padding:5px 20px;"><span style="display:table;"> </span>
            <div style="font-size:14px;float:left;display:inline-block;color:rgb(51, 51, 51);width:70px;line-height:28px;">
                <img src="docker搭建redis3.2官方集群 - CSDN博客_files/category_icon.jpg" type="image/jpeg" data-filename="category_icon.jpg" height="13" style="border:none;vertical-align:middle;" width="15"/>
                <span style="vertical-align:middle;display:inline-block;">分类：</span>
            </div>
            <div style="font-size:14px;float:left;display:inline-block;color:rgb(223, 52, 52);width:90%;">
                                            <span style="display:inline-block;margin-left:15px;cursor:pointer;line-height:28px;position:relative;">
                    <span>
                       redis<em style="font-style:normal;">（1）</em>
                    </span>
                    <img src="docker搭建redis3.2官方集群 - CSDN博客_files/arrow_triangle _down.jpg" type="image/jpeg" data-filename="arrow_triangle _down.jpg" height="5" style="border:none;display:inline;" width="10"/>
                    
                    
                </span>
                                                            <span style="display:inline-block;margin-left:15px;cursor:pointer;line-height:28px;position:relative;">
                    <span>
                       docker<em style="font-style:normal;">（3）</em>
                    </span>
                    <img src="docker搭建redis3.2官方集群 - CSDN博客_files/arrow_triangle _down [1].jpg" type="image/jpeg" data-filename="arrow_triangle _down.jpg" height="5" style="border:none;display:inline;" width="10"/>
                    
                    
                </span>
                                        </div>
        <span style="height:0px;visibility:hidden;display:block;clear:both;">.</span></div>
                <div style="padding:20px 0px;">
                        <p style="margin:0px;padding:0px;height:14px;line-height:14px;border-left:3px solid rgb(228, 28, 30);padding-left:10px;color:rgb(102, 102, 102);font-size:14px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
                    </div>
        <div style="margin:35px 0px;font-size:15px;color:rgb(85, 85, 85);line-height:35px;word-break:break-all;overflow:hidden;">
                    <div style="font-family:&quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;font-size:16px;color:rgb(63, 63, 63);">
                <p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;"><strong style="box-sizing:border-box;font-weight:700;">1.集群配置：</strong> <br style="box-sizing:border-box;"/>
 6个节点，一主一备，三个主节点，三个从节点</p>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;"><strong style="box-sizing:border-box;font-weight:700;">2.单节点redis配置</strong> <br style="box-sizing:border-box;"/>
 2.1 DockerFile文件：</p>



<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">FROM redis:<span style="color:rgb(0, 102, 102);box-sizing:border-box;">3.2</span>
MAINTAINER ylzhang

ENV REDIS_HOME /usr/local

RUN mkdir <span style="box-sizing:border-box;color:rgb(0, 153, 0);">$REDIS_HOME</span>/conf
WORKDIR <span style="box-sizing:border-box;color:rgb(0, 153, 0);">$REDIS_HOME</span>/conf

<span style="color:rgb(136, 0, 0);box-sizing:border-box;">## 创建一个redis.conf文件，打开集群相关配置，默认端口不写的话为6379</span>
RUN <span style="color:rgb(79, 79, 79);box-sizing:border-box;">echo</span> <span style="color:rgb(0, 153, 0);box-sizing:border-box;">&quot;cluster-enabled yes&quot;</span> &gt; redis.conf
RUN <span style="color:rgb(79, 79, 79);box-sizing:border-box;">echo</span> <span style="color:rgb(0, 153, 0);box-sizing:border-box;">&quot;cluster-config-file nodes_6379.conf&quot;</span> &gt;&gt; redis.conf

<span style="color:rgb(136, 0, 0);box-sizing:border-box;">## 初始化容器时启动redis实例</span>
CMD [<span style="color:rgb(0, 153, 0);box-sizing:border-box;">&quot;redis-server&quot;</span>,<span style="color:rgb(0, 153, 0);box-sizing:border-box;">&quot;/usr/local/conf/redis.conf&quot;</span>]
</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">2</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">3</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">4</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">5</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">6</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">7</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">8</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">9</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">10</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">11</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">12</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">13</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">14</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">15</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">2.2 镜像创建</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">docker build <span style="box-sizing:border-box;">-t</span> ylzhang/redis53 <span style="color:rgb(79, 79, 79);box-sizing:border-box;">.</span> </code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">2.3 创建redis容器：</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;"><span style="color:rgb(136, 0, 0);box-sizing:border-box;">docker</span> <span style="color:rgb(136, 0, 0);box-sizing:border-box;">run</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">-</span><span style="color:rgb(136, 0, 0);box-sizing:border-box;">d</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">-</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">-</span><span style="color:rgb(136, 0, 0);box-sizing:border-box;">name</span> <span style="color:rgb(136, 0, 0);box-sizing:border-box;">redis53</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">-</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">-</span><span style="color:rgb(136, 0, 0);box-sizing:border-box;">net=host</span> <span style="color:rgb(136, 0, 0);box-sizing:border-box;">ylzhang/redis</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">-</span><span style="color:rgb(136, 0, 0);box-sizing:border-box;">cluster</span></code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">2.3.1 为了容易更改配置文件，我们也可以将redis的conf目录volumn出来，在宿主机器下创建conf文件,例如在宿主机的/usr/local/redis/conf下 新建redis.conf文件，那么相应的docker run命令就是：</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">docker run -d --name redis53 -v /usr/local/redis/conf/<span style="box-sizing:border-box;color:rgb(0, 153, 0);">:/usr/local/conf</span> --net=host ylzhang/redis-cluster</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">2.4 检查redis实例运行：</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">docker ps</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">可以看到docker容器的redis实例已经起来了，进入容器：</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">docker <span style="color:rgb(0, 0, 136);box-sizing:border-box;">exec</span> -it redis53 /bin/bash</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">进入容器后:</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">redis<span style="box-sizing:border-box;">-cli</span> <span style="box-sizing:border-box;">-p</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">6379</span></code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">出现命令行提示：127.0.0.1:6379&gt;  <br style="box-sizing:border-box;"/>
 大功告成！</p>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;"><strong style="box-sizing:border-box;font-weight:700;">3.创建6个redis实例</strong> <br style="box-sizing:border-box;"/>
按照步骤2依次创建6个redis实例，<strong style="box-sizing:border-box;font-weight:700;">注意</strong>：如果在一个宿主机上请更改redis.conf中的端口，不要端口冲突了。</p>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;"><strong style="box-sizing:border-box;font-weight:700;">4.集群create</strong></p>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">4.1 下载redis.tar.gz，由于我宿主机下载不下来，所以选择本地下载放到宿主机上，放在与Dockerfile同级目录下，Dockerfile文件：</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">FROM ruby:<span style="color:rgb(0, 102, 102);box-sizing:border-box;">2.2</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.5</span>
MAINTAINER ylzhang

RUN gem install redis
ADD ./redis-<span style="color:rgb(0, 102, 102);box-sizing:border-box;">3.2</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.5</span>.tar.gz /usr/<span style="color:rgb(79, 79, 79);box-sizing:border-box;">local</span>
RUN cd /usr/<span style="color:rgb(79, 79, 79);box-sizing:border-box;">local</span> &amp;&amp; <span style="color:rgb(79, 79, 79);box-sizing:border-box;">ln</span> -s redis-<span style="color:rgb(0, 102, 102);box-sizing:border-box;">3.2</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.5</span> redis</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">2</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">3</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">4</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">5</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">6</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">4.2 创建ruby_redis镜像</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">docker build <span style="box-sizing:border-box;">-t</span> ylzhang/ruby_redis <span style="color:rgb(79, 79, 79);box-sizing:border-box;">.</span></code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">4.3 创建ruby_redis容器</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">docker <span style="box-sizing:border-box;">run</span> -<span style="color:rgb(0, 0, 136);box-sizing:border-box;">it</span> ylzhang/ruby_redis /bin/bash</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">4.4 创建集群 <br style="box-sizing:border-box;"/>
进入ruby_redis集群后</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">/usr/<span style="color:rgb(79, 79, 79);box-sizing:border-box;">local</span>/redis/src/redis-trib.rb <span style="color:rgb(79, 79, 79);box-sizing:border-box;">create</span> <span style="color:rgb(136, 0, 0);box-sizing:border-box;">--replicas 1 \</span>
<span style="color:rgb(0, 102, 102);box-sizing:border-box;">10.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.52</span>:<span style="color:rgb(0, 102, 102);box-sizing:border-box;">6379</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">10.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.52</span>:<span style="color:rgb(0, 102, 102);box-sizing:border-box;">7379</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">10.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.53</span>:<span style="color:rgb(0, 102, 102);box-sizing:border-box;">6379</span> \
<span style="color:rgb(0, 102, 102);box-sizing:border-box;">10.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.53</span>:<span style="color:rgb(0, 102, 102);box-sizing:border-box;">7379</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">10.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.54</span>:<span style="color:rgb(0, 102, 102);box-sizing:border-box;">6379</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">10.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.0</span><span style="color:rgb(0, 102, 102);box-sizing:border-box;">.54</span>:<span style="color:rgb(0, 102, 102);box-sizing:border-box;">7379</span>
</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">2</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">3</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">4</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">会看到 “Can I set the above configuration” 输入yes，集群创建完成。</p>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;"><strong style="box-sizing:border-box;font-weight:700;">5.验证集群创建</strong></p>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">进入其中一个节点：</p>

<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">docker <span style="color:rgb(0, 0, 136);box-sizing:border-box;">exec</span> -it redis53 /bin/bash</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">输入：</p>



<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;">redis<span style="box-sizing:border-box;">-cli</span> <span style="box-sizing:border-box;">-c</span> <span style="box-sizing:border-box;">-p</span> <span style="color:rgb(0, 102, 102);box-sizing:border-box;">6379</span></code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">输入：</p>



<pre style="word-wrap:break-word;box-sizing:border-box;color:rgb(0, 0, 0);font-family:Consolas, Inconsolata, Courier, monospace;border-radius:0px;font-size:14px;line-height:22px;word-break:break-all;display:block;position:relative;overflow-y:hidden;overflow-x:auto;white-space:nowrap;margin:0px 0px 24px;background-color:rgb(246, 248, 250);border:none;padding:8px 16px 4px 56px;"><code style="font-size:14px;display:block;background:rgb(255, 255, 255);color:rgb(0, 0, 0);box-sizing:border-box;font-family:Consolas, Inconsolata, Courier, monospace;padding:0px;background-color:rgb(246, 248, 250);white-space:pre;border-radius:4px;overflow-x:auto;word-wrap:normal;line-height:22px;"><span style="color:rgb(0, 0, 136);box-sizing:border-box;">cluster</span> info
<span style="color:rgb(0, 0, 136);box-sizing:border-box;">cluster</span> nodes</code><ul style="left:0px;box-sizing:border-box;width:48px;background-color:rgb(238, 240, 244);top:0px;position:absolute;margin:0px;padding:8px 0px;border-right:1px solid rgb(221, 221, 221);list-style:none;text-align:right;"><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">1</li><li style="box-sizing:border-box;list-style-type:disc;margin:0px;padding:0px 5px;list-style:none;margin-left:0px;">2</li></ul></pre>

<p style="padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-wrap:break-word;word-break:normal;">显示集群信息，集群搭建成功！ <br style="box-sizing:border-box;"/>
插个数据看看： <br style="box-sizing:border-box;"/>
<img src="docker搭建redis3.2官方集群 - CSDN博客_files/20161128171254976.png" type="image/png" data-filename="20161128171254976.png" alt="结果显示" height="93" style="border:none;box-sizing:border-box;margin:24px 0px;max-height:100%;max-width:602px;height:auto;" title="" width="394"/></p>            </div>
                        
                        
            
                
        </div>
        
        <ul style="margin-top:30px;">
                                    <li style="margin-bottom:16px;">
                <span style="padding-left:27px;width:51px;line-height:26px;display:inline-block;color:rgb(255, 255, 255);height:26px;margin-right:7px;background:rgb(153, 153, 153);background-image:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/skin/skin-yellow/css/../images/skin-type-icon.png&quot;);background-repeat:no-repeat;background-position:8px -111px;">上一篇</span>
                <a href="http://blog.csdn.net/zeroctu/article/details/53187750" style="text-decoration:none;color:rgb(51, 51, 51);">Docker网络详解</a>
            </li>
            
                                    <li>
                <span style="padding-left:27px;width:51px;line-height:26px;display:inline-block;color:rgb(255, 255, 255);height:26px;background:rgb(153, 153, 153);margin-right:7px;background-image:url(&quot;http://csdnimg.cn/release/phoenix/dotnet/skin/skin-yellow/css/../images/skin-type-icon.png&quot;);background-repeat:no-repeat;background-position:8px -140px;">下一篇</span>
                <a href="http://blog.csdn.net/zeroctu/article/details/53818185" style="text-decoration:none;color:rgb(51, 51, 51);">JAVA 爬虫获取js动态生成的网页数据</a>
            </li>
                    </ul>
        <div style="clear:both;height:10px;"></div>
    </div></div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 