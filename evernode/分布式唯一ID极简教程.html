<html>
<head>
  <title>分布式唯一ID极简教程</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="6292"/>
<h1>分布式唯一ID极简教程</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/4/29 23:07</i></td></tr>
<tr><td><b>标签：</b></td><td><i>微信</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&mid=2247484184&idx=1&sn=e0aed5908e4cd83fdb883e5c6f8d04a5&chksm=fbb28ae6ccc503f0c565cb95a8bcb37de85c7760cb8059828af7913e4b4bb6b0317dd8651460&mpshare=1&scene=1&srcid=0429M1kMu4gAVAEQvcfj4uOn#rd"><i>http://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&amp;mid=2247484184&amp;idx=1&amp;sn=e0aed5908e4cd83fdb883e5c6f8d04a5&amp;chksm=fbb28ae6ccc503f0c565cb95a8bcb37de85c7760cb8059828af7913e4b4bb6b0317dd8651460&amp;mpshare=1&amp;scene=1&amp;srcid=0429M1kMu4gAVAEQvcfj4uOn#rd</i></a></td></tr>
</table>
</div>
<br/>

<div><span style="margin:0px;"><div style="padding:8px 0px;margin:8px auto;max-width:700px;"> <div style="margin:0;position:relative;padding:20px 15px 15px;background-color:#fff"><div style="margin:0;padding:0"><h2 style="margin:0;padding:0;margin-bottom:10px;line-height:1.4;font-weight:400;font-size:24px"> 分布式唯一ID极简教程 </h2><div style="margin:0;padding:0;margin-bottom:18px;line-height:20px;font-size:0"><span style="margin:0;margin-right:8px;margin-bottom:10px;display:inline-block;vertical-align:middle;padding:1px .5em;border:1px solid #9e9e9e;color:#8c8c8c;border-top-left-radius:20% 50%;-moz-border-radius-topleft:20% 50%;-webkit-border-top-left-radius:20% 50%;border-top-right-radius:20% 50%;-moz-border-radius-topright:20% 50%;-webkit-border-top-right-radius:20% 50%;border-bottom-left-radius:20% 50%;-moz-border-radius-bottomleft:20% 50%;-webkit-border-bottom-left-radius:20% 50%;border-bottom-right-radius:20% 50%;-moz-border-radius-bottomright:20% 50%;-webkit-border-bottom-right-radius:20% 50%;font-size:15px;line-height:1.1">原创</span><em style="margin:0;padding:0;font-style:normal;display:inline-block;vertical-align:middle;margin-right:8px;margin-bottom:10px;font-size:16px;color:#8c8c8c">2017-11-21</em><em style="margin:0;padding:0;font-style:normal;display:inline-block;vertical-align:middle;margin-right:8px;margin-bottom:10px;font-size:16px;color:#8c8c8c">帝都羊</em><a href="http://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&amp;mid=2247484184&amp;idx=1&amp;sn=e0aed5908e4cd83fdb883e5c6f8d04a5&amp;chksm=fbb28ae6ccc503f0c565cb95a8bcb37de85c7760cb8059828af7913e4b4bb6b0317dd8651460&amp;mpshare=1&amp;scene=1&amp;srcid=0429M1kMu4gAVAEQvcfj4uOn##" style="margin:0;padding:0;color:#607fa6;text-decoration:none;display:inline-block;vertical-align:middle;margin-right:8px;margin-bottom:10px;font-size:16px">架构师小秘圈</a></div><div style="margin:0;padding:0;overflow:hidden;color:#3e3e3e"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">一，题记</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">所有的业务系统，都有生成ID的需求，如订单id，商品id，文章ID等。这个ID会是数据库中的唯一主键，在它上面会建立聚集索引！</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">ID生成的核心需求有两点：</p><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">全局唯一</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">趋势有序</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">二，为什么要全局唯一？</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">著名的例子就是身份证号码，<span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;line-height:inherit;box-sizing:border-box !important;word-wrap:break-word !important">身份证号码确实是对人唯一的，然而一个人是可以办理多个身份证的，例如你身份证丢了，又重新补办了一张，号码不变。</span></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;line-height:inherit;box-sizing:border-box !important;word-wrap:break-word !important">问题来了，因为系统是按照身份证号码做唯一主键的。此时，如果身份证是被盗的情况下，你是没有办法在系统里面注销的，因为新旧2个身份证的“主键”都是身份证号码。</span></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;line-height:inherit;box-sizing:border-box !important;word-wrap:break-word !important">也就是说，旧的身份证仍然逍遥在外，完全有效。这个时候，还好有一个身份证有效时间的东西，只有靠身份证有效期来辨识了。不过，这就是现在这么多银行，电信诈骗的由来，捡到一张身份证，去很多银行，手机，酒店都可以使用！身份证缺乏注销机制！</span></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">所以，经验告诉我们。不要相信自己的直觉，业务上所谓的唯一往往都是不靠谱的，经不起时间的考研的。所以需要单独设置一个和业务无关的主键，专业术语叫做代理主键（surrogate key）。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">这也是为什么数据库设计范式，唯一主键是第一范式！</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">三，为什么要趋势有序</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">以mysql为例，InnoDB引擎表是基于B+树的索引组织表(IOT)；每个表都需要有一个聚集索引(clustered index)；所有的行记录都存储在B+树的叶子节点(leaf pages of the tree)；基于聚集索引的增、删、改、查的效率相对是最高的；如下图：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><img src="分布式唯一ID极简教程_files/0.jpg" type="image/jpeg" data-filename="0.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;height:auto !important;box-sizing:border-box !important;word-wrap:break-word !important"/></p><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">如果我们定义了主键(PRIMARY KEY)，那么InnoDB会选择其作为聚集索引；</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">如果没有显式定义主键，则InnoDB会选择第一个不包含有NULL值的唯一索引作为主键索引；</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">如果也没有这样的唯一索引，则InnoDB会选择内置6字节长的ROWID作为隐含的聚集索引(ROWID随着行记录的写入而主键递增，这个ROWID不像ORACLE的ROWID那样可引用，是隐含的)。</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;line-height:inherit;box-sizing:border-box !important;word-wrap:break-word !important">综上总结，如果InnoDB表的数据写入顺序能和B+树索引的叶子节点顺序一致的话，这时候存取效率是最高的，也就是下面这几种情况的存取效率最高</span></p><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">使用自增列(INT/BIGINT类型)做主键，这时候写入顺序是自增的，和B+数叶子节点分裂顺序一致；</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">该表不指定自增列做主键，同时也没有可以被选为主键的唯一索引(上面的条件)，这时候InnoDB会选择内置的ROWID作为主键，写入顺序和ROWID增长顺序一致；</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">除此以外，如果一个InnoDB表又没有显示主键，又有可以被选择为主键的唯一索引，但该唯一索引可能不是递增关系时(例如字符串、UUID、多字段联合唯一索引的情况)，该表的存取效率就会比较差。）</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">这就是为什么我们的分布式ID一定要是趋势递增的！那么在开发当中，面对这种分布式ID需求，常见的处理方案有哪些呢？</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="分布式唯一ID极简教程_files/0 [1].jpg" type="image/jpeg" data-filename="0.jpg" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important"/></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">四，数据库自增长序列或字段</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">最常见的方式。利用数据库，全数据库唯一。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">优点：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">1）简单，代码方便，性能可以接受。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">2）数字ID天然排序，对分页或者需要排序的结果很有帮助。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"> </p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">缺点：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">1）不同数据库语法和实现不同，数据库迁移的时候或多数据库版本支持的时候需要处理。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">2）在单个数据库或读写分离或一主多从的情况下，只有一个主库可以生成。有单点故障的风险。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">3）在性能达不到要求的情况下，比较难于扩展。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">4）如果遇见多个系统需要合并或者涉及到数据迁移会相当痛苦。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">5）分表分库的时候会有麻烦。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">优化方案：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">1）针对主库单点，如果有多个Master库，则每个Master库设置的起始数字不一样，步长一样，可以是Master的个数。比如：Master1 生成的是 1，4，7，10，Master2生成的是2,5,8,11 Master3生成的是 3,6,9,12。这样就可以有效生成集群中的唯一ID，也可以大大降低ID生成数据库操作的负载。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">五，UUID</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">常见的方式。可以利用数据库也可以利用程序生成，一般来说全球唯一。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">优点：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">1）简单，代码方便。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">2）生成ID性能非常好，基本不会有性能问题。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">3）全球唯一，在遇见数据迁移，系统数据合并，或者数据库变更等情况下，可以从容应对。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"> </p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">缺点：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">1）没有排序，无法保证趋势递增。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">2）UUID往往是使用字符串存储，查询的效率比较低。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">3）存储空间比较大，如果是海量数据库，就需要考虑存储量的问题。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">4）传输数据量大</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">5）不可读。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">六，Redis生成ID</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">当使用数据库来生成ID性能不够要求的时候，我们可以尝试使用Redis来生成ID。这主要依赖于Redis是单线程的，所以也可以用生成全局唯一的ID。可以用Redis的原子操作 INCR和INCRBY来实现。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">可以使用Redis集群来获取更高的吞吐量。假如一个集群中有5台Redis。可以初始化每台Redis的值分别是1,2,3,4,5，然后步长都是5。各个Redis生成的ID为：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">A：1,6,11,16,21</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">B：2,7,12,17,22</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">C：3,8,13,18,23</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">D：4,9,14,19,24</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">E：5,10,15,20,25</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">这个，随便负载到哪个机确定好，未来很难做修改。但是3-5台服务器基本能够满足器上，都可以获得不同的ID。但是步长和初始值一定需要事先需要了。使用Redis集群也可以方式单点故障的问题。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">另外，比较适合使用Redis来生成每天从0开始的流水号。比如订单号=日期+当日自增长号。可以每天在Redis中生成一个Key，使用INCR进行累加。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"> </p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">优点：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">1）不依赖于数据库，灵活方便，且性能优于数据库。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">2）数字ID天然排序，对分页或者需要排序的结果很有帮助。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">缺点：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">1）如果系统中没有Redis，还需要引入新的组件，增加系统复杂度。</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">2）需要编码和配置的工作量比较大。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">七，twitter</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">twitter在把存储系统从MySQL迁移到Cassandra的过程中由于Cassandra没有顺序ID生成机制，于是自己开发了一套全局唯一ID生成服务：Snowflake。<br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/>1 41位的时间序列（精确到毫秒，41位的长度可以使用69年）<br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/>2 10位的机器标识（10位的长度最多支持部署1024个节点） <br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/>3 12位的计数顺序号（12位的计数顺序号支持每个节点每毫秒产生4096个ID序号） 最高位是符号位，始终为0。<br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/>优点：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/></p><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;list-style-type:square"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">高性能，低延迟；独立的应用；</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">按时间有序。 </p></li></ul><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">缺点：</p><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;list-style-type:square"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">需要独立的开发和部署。</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">强依赖时钟,如果主机时间回拨,则会造成重复ID,会产生</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">ID虽然有序,但是不连续</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">原理</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important"><img src="分布式唯一ID极简教程_files/0 [2].jpg" type="image/jpeg" data-filename="0.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;height:auto !important;border-width:initial;border-style:none;border-color:initial;box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">八，MongoDB的ObjectId</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">MongoDB的ObjectId和snowflake算法类似。它设计成轻量型的，不同的机器都能用全局唯一的同种方法方便地生成它。MongoDB 从一开始就设计用来作为分布式数据库，处理多个节点是一个核心要求。使其在分片环境中要容易生成得多。</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">ObjectId使用12字节的存储空间，其生成方式如下：</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">|0|1|2|3|4|5|6 |7|8|9|10|11|</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">|时间戳 |机器ID|PID|计数器 |</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">前四个字节时间戳是从标准纪元开始的时间戳，单位为秒，有如下特性：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"> 1 时间戳与后边5个字节一块，保证秒级别的唯一性；<br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/> 2 保证插入顺序大致按时间排序；<br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/> 3 隐含了文档创建时间；<br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/> 4 时间戳的实际值并不重要，不需要对服务器之间的时间进行同步（因为加上机器ID和进程ID已保证此值唯一，唯一性是ObjectId的最终诉求）。</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">机器ID是服务器主机标识，通常是机器主机名的散列值。</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">同一台机器上可以运行多个mongod实例，因此也需要加入进程标识符PID。</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">前9个字节保证了同一秒钟不同机器不同进程产生的ObjectId的唯一性。后三个字节是一个自动增加的计数器（一个mongod进程需要一个全局的计数器），保证同一秒的ObjectId是唯一的。同一秒钟最多允许每个进程拥有（256^3 = 16777216）个不同的ObjectId。</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">总结一下：时间戳保证秒级唯一，机器ID保证设计时考虑分布式，避免时钟同步，PID保证同一台服务器运行多个mongod实例时的唯一性，最后的计数器保证同一秒内的唯一性（选用几个字节既要考虑存储的经济性，也要考虑并发性能的上限）。</p><p style="padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin:10px auto;min-height:1em;white-space:normal;color:rgb(51,51,51);font-family:Verdana,Arial,Helvetica,sans-serif;font-size:14px;box-sizing:border-box !important;word-wrap:break-word !important">&quot;_id&quot;既可以在服务器端生成也可以在客户端生成，在客户端生成可以降低服务器端的压力。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">九，类snowflake算法</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">国内有很多厂家基于snowflake算法进行了国产化，例如</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;line-height:inherit;box-sizing:border-box !important;word-wrap:break-word !important">百度的</span><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;line-height:inherit;box-sizing:border-box !important;word-wrap:break-word !important">uid-generator：</span></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">https://github.com/baidu/uid-generator</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">美团Leaf：</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">https://github.com/zhuzhong/idleaf</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">基本是对snowflake的进一步优化，比如解决时钟 回拨问题！</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-right:auto;margin-left:auto;clear:both;width:591px;overflow:hidden;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;margin-top:0.5em;margin-bottom:0.5em;border-bottom:2px solid rgb(84,141,212);clear:both;box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;padding-top:3px;padding-right:10px;padding-left:10px;display:inline-block;color:rgb(255,255,255);border-top-left-radius:3px;border-top-right-radius:3px;height:28px;background-color:rgb(84,141,212);box-sizing:border-box !important;word-wrap:break-word !important">十，总结</div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">总体而言，分布式唯一ID需要满足以下条件：<br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/></p><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;list-style-type:square"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">高可用性：不能有单点故障。</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">全局唯一性：不能出现重复的ID号，既然是唯一标识，这是最基本的要求。<br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;word-wrap:break-word !important"/></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">趋势递增：在MySQL InnoDB引擎中使用的是聚集索引，由于多数RDBMS使用B-tree的数据结构来存储索引数据，在主键的选择上面我们应该尽量使用有序的主键保证写入性能。</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">时间有序：以时间为序，或者ID里包含时间。这样一是可以少一个索引，二是冷热数据容易分离。</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">分片支持：可以控制ShardingId。比如某一个用户的文章要放在同一个分片内，这样查询效率高，修改也容易。</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">单调递增：保证下一个ID一定大于上一个ID，例如事务版本号、IM增量消息、排序等特殊需求。</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">长度适中：<span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;line-height:inherit;box-sizing:border-box !important;word-wrap:break-word !important">不要太长，最好64bit。使用long比较好操作，如果是96bit，那就要各种移位相当的不方便，还有可能有些组件不能支持这么大的ID。</span></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;box-sizing:border-box !important;word-wrap:break-word !important">信息安全：如果ID是连续的，恶意用户的扒取工作就非常容易做了，直接按照顺序下载指定URL即可；如果是订单号就更危险了，竞争对手可以直接知道我们一天的单量。所以在一些应用场景下，会需要ID无规则、不规则。</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;min-height:1em;color:rgb(62,62,62);font-size:16px;line-height:25.6px;white-space:normal;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">文章参考出处：叶金荣博客 http://imysql.com/，欢迎大家积极留言，您使用的是哪种方式?</p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;clear:both;margin-top:5px;margin-bottom:5px;font-size:16px;min-height:1em;white-space:pre-wrap;color:rgb(62,62,62);line-height:25.6px;widows:1;box-sizing:border-box !important;word-wrap:break-word !important">推荐阅读：<a href="http://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&amp;mid=2247483707&amp;idx=1&amp;sn=168c163e852e826d52c07b887977ff2f&amp;chksm=fbb288c5ccc501d3b0e43d8aca0cffcadfd0dd859f6840ca76fb8593d4593ef48134b22bb368&amp;scene=21#wechat_redirect" style="margin:0;padding:0;color:#607fa6;text-decoration:none;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;white-space:normal" target="_blank">2T架构师教学视频分享</a></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;text-align:center"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(255,104,39);font-family:宋体;font-size:15px;text-align:center;text-indent:32px;background-color:rgb(255,255,255)">觉得有帮助？请转发给更多人！</span></p><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;padding-top:10px;padding-bottom:10px;white-space:normal;border-width:initial;border-style:none;border-color:initial;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial"><img src="分布式唯一ID极简教程_files/0.png" type="image/png" data-filename="0.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;margin-right:auto;margin-left:auto;width:160px;display:block"/></div><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-right:auto;margin-left:auto;white-space:normal;border-width:initial;border-style:none;border-color:initial;width:20em"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;width:320px;height:auto;overflow:hidden"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:0.5em;width:128px;display:inline-block;vertical-align:top;text-align:center"><img src="分布式唯一ID极简教程_files/0 [1].png" type="image/png" data-filename="0.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;width:108px" title="http://7xo6kd.com1.z0.glb.clouddn.com/upload-ueditor-image-20170810-1502363196469045824.png"/></div><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:0.5em;width:192px;display:inline-block;border-left:1px solid rgb(173,173,173);font-size:0.875em;line-height:1.5em;vertical-align:top"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em">架构师小秘圈，聚集10万架构师的小圈子！不定期分享技术干货，行业秘闻！汇集各类奇妙好玩的话题和流行动向！长按左侧图片，扫码加入架构师微信群！</p></div></div></div></div></div><ul style="margin:0;padding:0"></ul></div></div></span>
</div></body></html> 