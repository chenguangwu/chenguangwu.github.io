<html>
<head>
  <title>SQL 分析函数之KEEP (DENSE_RANK FIRST/LAST) - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="678"/>
<h1>SQL 分析函数之KEEP (DENSE_RANK FIRST/LAST) - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/9/3 15:47</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://blog.csdn.net/hustzw07/article/details/51190201"><i>https://blog.csdn.net/hustzw07/article/details/51190201</i></a></td></tr>
</table>
</div>
<br/>

<div><span>
  <div>
<div style="font-size: 16px; display: inline-block; min-width: 100%;position: relative;"><div style="outline:0px;box-sizing:border-box;"><div style="box-sizing:inherit;outline:0px;font-family:&quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, sans-serif;font-size:14px;line-height:1.57143;background-color:rgb(245, 246, 247);color:rgb(51, 51, 51);"><div style="outline:0px;box-sizing:border-box;"><span style="box-sizing:inherit;outline:0px;"><div style="box-sizing:inherit;outline:0px;background:rgb(255, 255, 255);box-shadow:rgba(0, 0, 0, 0.0470588) 0px 2px 4px 0px;">
	<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;border-bottom:1px solid rgb(224, 224, 224);padding-top:16px;z-index:9;background-color:rgb(255, 255, 255);">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
			<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-bottom:8px;">
				<span style="border-radius:50%;display:inline-block;width:26px;height:26px;line-height:26px;text-align:center;font-size:12px;outline:0px;box-sizing:inherit;border:1px solid rgb(244, 206, 208);color:rgb(202, 12, 22);margin-right:8px;margin-top:4px;float:left;">原</span>				<h1 style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:24px;word-break:break-all;">SQL 分析函数之KEEP (DENSE_RANK FIRST/LAST)</h1>
			</div>
			<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;padding-bottom:14px;position:relative;">
				<div style="color:rgb(133, 133, 133);width:88%;height:25px;box-sizing:inherit;outline:0px;padding:0px;margin:0px;overflow:hidden;">
																				<span style="box-sizing:inherit;outline:0px;margin-right:14px;">2016年04月19日 14:53:23</span>
						<span style="box-sizing:inherit;outline:0px;margin-right:14px;">阅读数：2478</span>
												
														<span style="box-sizing:inherit;outline:0px;margin-right:14px;margin-bottom:8px;font-size:12px;">
								<span style="box-sizing:inherit;outline:0px;margin-right:14px;color:rgb(77, 77, 77);">标签：</span>
																<a href="http://so.csdn.net/so/search/s.do?q=sql&amp;t=blog" style="text-align:center;cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;border:1px solid rgb(204, 204, 204);color:rgb(77, 77, 77);padding:0px 8px;margin-bottom:4px;border-radius:100px;word-break:break-all;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">sql																</a><a href="http://so.csdn.net/so/search/s.do?q=%E5%87%BD%E6%95%B0&amp;t=blog" style="text-align:center;cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;border:1px solid rgb(204, 204, 204);color:rgb(77, 77, 77);padding:0px 8px;margin-bottom:4px;border-radius:100px;word-break:break-all;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">函数																</a><a href="http://so.csdn.net/so/search/s.do?q=KEEP%20DENSE_RANK%20FIRS&amp;t=blog" style="text-align:center;cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;border:1px solid rgb(204, 204, 204);color:rgb(77, 77, 77);padding:0px 8px;margin-bottom:4px;border-radius:100px;word-break:break-all;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">KEEP DENSE_RANK FIRS																</a>
							<span style="background-color:rgb(255, 255, 255);outline:0px;box-sizing:inherit;letter-spacing:0px;line-height:20px;cursor:pointer;font-size:12px;top:0px;right:101px;width:45px;display:inline-block;color:rgb(51, 153, 234);margin-right:0px;">更多</span></span>
																					<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:12px;margin-top:6px;margin-bottom:0px;">
								<span style="box-sizing:inherit;outline:0px;margin-right:14px;color:rgb(77, 77, 77);">个人分类：</span>
																<a href="https://blog.csdn.net/hustzw07/article/category/6127244" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(121, 165, 229);word-break:break-all;" target="_blank">SQL																</a>
							</div>
																								</div>
				<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;position:absolute;top:0px;right:0px;">
														</div>
			</div>
			
		</div>
	</div>
	<div style="box-sizing:inherit;outline:0px;display:block;position:relative;padding-top:16px;">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;word-break:break-all;">
								            
						<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun;word-break:break-all;">
                
<h2 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;font-size:24px;color:rgb(79, 79, 79);font-weight:700;line-height:32px;word-break:break-all;"><a name="t0" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>场景</h2>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">在业务数据中可能遇到这样的需求。希望获取部门内年龄最小的人中，工资最高的记录。此时就需要使用KEEP(DENSE_RANK FIRST/LAST)来处理数据了。</p>
<h2 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;font-size:24px;color:rgb(79, 79, 79);font-weight:700;line-height:32px;word-break:break-all;"><a name="t1" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>使用</h2>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">首先构造一下临时数据。</p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p>
<pre style="white-space:pre-wrap;color:rgb(0, 0, 0);outline:0px;padding:8px;margin:0px 0px 24px;position:relative;box-sizing:border-box;word-wrap:break-word;overflow-x:auto;font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;line-height:22px;word-break:break-all;"><code style="overflow-x:auto;background:rgb(40, 44, 52);outline:0px;color:rgb(171, 178, 191);box-sizing:border-box;font-size:14px;line-height:22px;display:block;white-space:pre;word-wrap:normal;padding:8px;font-family:Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif;border-radius:4px;word-break:break-all;"><ol style="outline:0px;list-style:none;box-sizing:border-box;border-collapse:collapse;padding:0px;margin:0px;overflow:hidden;word-break:break-all;"><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">1</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">WITH workers AS(  </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">2</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">  <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">SELECT</span> <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'DOM1'</span> dept, <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'zhangsan'</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">names</span> , <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">23</span> age, <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">4000</span> salaries <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FROM</span> dual <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">UNION</span> ALL  </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">3</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">  <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">SELECT</span> <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'DOM1'</span> dept, <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'lisi'</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">names</span>     , <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">35</span> age, <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">9000</span> salaries <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FROM</span> dual <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">UNION</span> ALL  </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">4</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">  <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">SELECT</span> <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'DOM2'</span> dept, <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'wangwu'</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">names</span>   , <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">26</span> age, <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">6500</span> salaries <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FROM</span> dual <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">UNION</span> ALL  </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">5</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">  <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">SELECT</span> <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'DOM2'</span> dept, <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'maliu'</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">names</span>    , <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">28</span> age, <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">6000</span> salaries <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FROM</span> dual <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">UNION</span> ALL  </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">6</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">  <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">SELECT</span> <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'DOM2'</span> dept, <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'zhaoqi'</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">names</span>   , <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">26</span> age, <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">5000</span> salaries <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FROM</span> dual <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">UNION</span> ALL  </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">7</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">  <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">SELECT</span> <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'DOM1'</span> dept, <span style="outline:0px;box-sizing:border-box;color:rgb(152, 195, 121);word-break:break-all;">'liba'</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">names</span>     , <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">23</span> age, <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">3000</span> salaries <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FROM</span> dual   </div></div></li><li style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;list-style-type:none;margin-left:0px;margin-top:0px;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;float:left;height:22px;width:24px;border-right:1px solid rgb(197, 197, 197);"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;text-align:right;padding-right:8px;word-break:break-all;"><span style="text-align:right;">8</span></div></div><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;margin-left:8px;float:left;height:22px;"><div style="outline:0px;padding:0px;margin:0px;box-sizing:border-box;word-break:break-all;">)</div></div></li></ol></code><div style="right:4px;box-shadow:rgba(0, 0, 0, 0.0470588) 0px 2px 4px, rgba(0, 0, 0, 0.0470588) 0px 2px 4px;outline:0px;padding:2px 8px;margin:8px;cursor:pointer;position:absolute;box-sizing:border-box;top:4px;font-size:12px;color:rgb(77, 77, 77);background-color:white;border-radius:4px;word-break:break-all;display:block;"><span style="font-size:12px;color:rgb(77, 77, 77);cursor:pointer;">复制</span></div></pre>在这六条数据中，我们期望的数据是：(DOM1,4000)和(DOM2,6500)。
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">我们的sql如下：</p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p>
<pre style="white-space:pre-wrap;color:rgb(0, 0, 0);outline:0px;padding:8px;margin:0px 0px 24px;position:relative;box-sizing:border-box;word-wrap:break-word;overflow-x:auto;font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;line-height:22px;word-break:break-all;"><code style="overflow-x:auto;background:rgb(40, 44, 52);outline:0px;color:rgb(171, 178, 191);box-sizing:border-box;font-size:14px;line-height:22px;display:block;white-space:pre;word-wrap:normal;padding:8px;font-family:Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif;border-radius:4px;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">SELECT</span> w.dept, <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">MAX</span>(w.salaries) <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">KEEP</span>(<span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">DENSE_RANK</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FIRST</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">ORDER</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">BY</span> w.age) max_salary <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FROM</span> workers w <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">WHERE</span> <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span>=<span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">GROUP</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">BY</span> dept;</code></pre><img src="SQL 分析函数之KEEP (DENSE_RANK FIRSTLAST) - CSDN博客_files/Center" type="image/png" data-filename="Center" height="292" style="outline:0px;box-sizing:border-box;word-break:break-all;max-width:100%;cursor:zoom-in;" width="852"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">此图就是我们的查询结果。</p>
<h2 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;font-size:24px;color:rgb(79, 79, 79);font-weight:700;line-height:32px;word-break:break-all;"><a name="t2" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>解释</h2>
<h3 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;font-size:22px;color:rgb(79, 79, 79);font-weight:700;line-height:30px;word-break:break-all;"><a name="t3" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>KEEP</h3>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">keep的意思就是“保持”，会保持满足括号内条件的记录，用ORDER BY 后自然会有FIRST和LAST了。</p>
<h3 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;font-size:22px;color:rgb(79, 79, 79);font-weight:700;line-height:30px;word-break:break-all;"><a name="t4" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>DENSE_RANK</h3>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">DENSE_RANK是排序策略。例如，它会将两个第二名排在第一名之后，之后还是第三名排在第二名之后。</p>
<h3 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;font-size:22px;color:rgb(79, 79, 79);font-weight:700;line-height:30px;word-break:break-all;"><a name="t5" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>FIRST/LAST</h3>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">FIRST/LAST就是对数据进行筛选了。这里我们筛选age最小的记录。当然不止一条了。然后使用MAX()选取最大salaries了。</p>
<h2 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;font-size:24px;color:rgb(79, 79, 79);font-weight:700;line-height:32px;word-break:break-all;"><a name="t6" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>延伸</h2>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">同样的，年龄最大人中的最低工资查询如下：</p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p><pre style="white-space:pre-wrap;color:rgb(0, 0, 0);outline:0px;padding:8px;margin:0px 0px 24px;position:relative;box-sizing:border-box;word-wrap:break-word;overflow-x:auto;font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;line-height:22px;word-break:break-all;"><code style="overflow-x:auto;background:rgb(40, 44, 52);outline:0px;color:rgb(171, 178, 191);box-sizing:border-box;font-size:14px;line-height:22px;display:block;white-space:pre;word-wrap:normal;padding:8px;font-family:Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif;border-radius:4px;word-break:break-all;"><span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">SELECT</span> w.dept, <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">MIN</span>(w.salaries) <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">KEEP</span>(<span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">DENSE_RANK</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">LAST</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">ORDER</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">BY</span> w.age) min_salary <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">FROM</span> workers w <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">WHERE</span> <span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span>=<span style="outline:0px;box-sizing:border-box;color:rgb(209, 154, 102);word-break:break-all;">1</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">GROUP</span> <span style="outline:0px;box-sizing:border-box;color:rgb(198, 120, 221);word-break:break-all;">BY</span> dept;</code></pre><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><h2 style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 16px;font-size:24px;color:rgb(79, 79, 79);font-weight:700;line-height:32px;word-break:break-all;"><a name="t7" style="outline:0px;cursor:pointer;box-sizing:border-box;color:rgb(78, 161, 219);text-decoration:none;word-break:break-all;"></a>注意</h2>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">模拟数据的sql一定要跟select语句同时执行。</p>
            </div>
                <span style="display:block;height:0px;visibility:hidden;clear:both;"></span></div>
				
        	</div>
	
</div></span></div></div></div></div>
</div>
</span>
</div></body></html> 