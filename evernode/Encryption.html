<html>
<head>
  <title>Encryption</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="8863"/>
<h1>Encryption</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2016/9/14 18:48</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2018/1/9 14:33</i></td></tr>
<tr><td><b>标签：</b></td><td><i>util</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div align="left" style="min-height: 11pt;"><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">package</span></span> <span style="font-size: 10pt; font-family: Consolas;">jinri;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">import</span></span> <span style="font-size: 10pt; font-family: Consolas;">javax.crypto.Cipher;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">import</span></span> <span style="font-size: 10pt; font-family: Consolas;">javax.crypto.spec.IvParameterSpec;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">import</span></span> <span style="font-size: 10pt; font-family: Consolas;">javax.crypto.spec.SecretKeySpec;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">import</span></span> <span style="font-size: 10pt; font-family: Consolas;">sun.misc.BASE64Decoder;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">import</span></span> <span style="font-size: 10pt; font-family: Consolas;">sun.misc.BASE64Encoder;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">public</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">class</span></span> <span style="font-size: 10pt; font-family: Consolas;">Encryption {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">       </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 加密</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">       </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">public</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">static</span></span> <span style="font-size: 10pt; font-family: Consolas;">String Encrypt(String sSrc, String sKey,</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">byte</span></span><span style="font-size: 10pt; font-family: Consolas;">[] ivKey)</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">throws</span></span> <span style="font-size: 10pt; font-family: Consolas;">Exception {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">if</span></span> <span style="font-size: 10pt; font-family: Consolas;">(ivKey ==</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">) {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.print(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;ivKey为空null&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 判断ivKey是否为16位</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">if</span></span> <span style="font-size: 10pt; font-family: Consolas;">(ivKey.</span><span style="font-size: 10pt; color: rgb(0, 0, 192); font-family: Consolas;">length</span> <span style="font-size: 10pt; font-family: Consolas;">!= 16) {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.print(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;ivKey长度不是16位&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">if</span></span> <span style="font-size: 10pt; font-family: Consolas;">(sKey ==</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">) {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.print(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;Key为空null&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 判断Key是否为16位</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">if</span></span> <span style="font-size: 10pt; font-family: Consolas;">(sKey.length() != 16) {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.print(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;Key长度不是16位&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              SecretKeySpec skeySpec =</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">new</span></span> <span style="font-size: 10pt; font-family: Consolas;">SecretKeySpec(sKey.getBytes(),</span> <span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;AES&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              Cipher cipher = Cipher.</span><span style="font-size:10pt"><span style="font-family: Consolas; font-size: 10pt; font-style: italic;">getInstance</span></span><span style="font-size: 10pt; font-family: Consolas;">(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;AES/CBC/PKCS5Padding&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// &quot;算法/模式/补码方式&quot;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              IvParameterSpec iv =</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">new</span></span> <span style="font-size: 10pt; font-family: Consolas;">IvParameterSpec(ivKey);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 使用CBC模式，需要一个向量iv，可增加加密算法的强度</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              cipher.init(Cipher.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">ENCRYPT_MODE</span></span><span style="font-size: 10pt; font-family: Consolas;">, skeySpec, iv);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">byte</span></span><span style="font-size: 10pt; font-family: Consolas;">[] encrypted = cipher.doFinal(sSrc.getBytes());</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">new</span></span> <span style="font-size: 10pt; font-family: Consolas;">BASE64Encoder().encode(encrypted);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 此处使用BASE64做转码功能，同时能起到2次加密的作用。</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">       }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">       </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 解密</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">       </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">public</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">static</span></span> <span style="font-size: 10pt; font-family: Consolas;">String Decrypt(String sSrc, String sKey,</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">byte</span></span><span style="font-size: 10pt; font-family: Consolas;">[] ivKey)</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">throws</span></span> <span style="font-size: 10pt; font-family: Consolas;">Exception {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">try</span></span> <span style="font-size: 10pt; font-family: Consolas;">{</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 判断Key是否正确</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">if</span></span> <span style="font-size: 10pt; font-family: Consolas;">(sKey ==</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">) {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.print(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;Key为空null&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 判断Key是否为16位</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">if</span></span> <span style="font-size: 10pt; font-family: Consolas;">(sKey.length() != 16) {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.print(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;Key长度不是16位&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">byte</span></span><span style="font-size: 10pt; font-family: Consolas;">[] raw = sKey.getBytes(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;ASCII&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     SecretKeySpec skeySpec =</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">new</span></span> <span style="font-size: 10pt; font-family: Consolas;">SecretKeySpec(raw,</span> <span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;AES&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     Cipher cipher = Cipher.</span><span style="font-size:10pt"><span style="font-family: Consolas; font-size: 10pt; font-style: italic;">getInstance</span></span><span style="font-size: 10pt; font-family: Consolas;">(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;AES/CBC/PKCS5Padding&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     IvParameterSpec iv =</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">new</span></span> <span style="font-size: 10pt; font-family: Consolas;">IvParameterSpec(ivKey);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     cipher.init(Cipher.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">DECRYPT_MODE</span></span><span style="font-size: 10pt; font-family: Consolas;">, skeySpec, iv);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">byte</span></span><span style="font-size: 10pt; font-family: Consolas;">[] encrypted1 =</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">new</span></span> <span style="font-size: 10pt; font-family: Consolas;">BASE64Decoder().decodeBuffer(sSrc);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 先用base64解密</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">try</span></span> <span style="font-size: 10pt; font-family: Consolas;">{</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">byte</span></span><span style="font-size: 10pt; font-family: Consolas;">[] original = cipher.doFinal(encrypted1);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           String originalString =</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">new</span></span> <span style="font-size: 10pt; font-family: Consolas;">String(original);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size: 10pt; font-family: Consolas;">originalString;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     }</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">catch</span></span> <span style="font-size: 10pt; font-family: Consolas;">(Exception e) {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.println(e.toString());</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                           </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              }</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">catch</span></span> <span style="font-size: 10pt; font-family: Consolas;">(Exception ex) {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.println(ex.toString());</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">                     </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">return</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">null</span></span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">       }</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">       </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">public</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">static</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">void</span></span> <span style="font-size: 10pt; font-family: Consolas;">main(String[] args)</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">throws</span></span> <span style="font-size: 10pt; font-family: Consolas;">Exception {</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">/*</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">               *  加密用的Key 可以用26个字母和数字组成 ，最好不要用保留字符 ，虽然不会错，至于怎么裁决 ，个人看情况而定  此处使用AES</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">               *  使用CBC模式，需要一个向量iv，可增加加密算法的强度</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">               * -128-CBC加密模式 ，key需要为16位。</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">               */</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              String cKey =</span> <span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;1234567890123456&quot;</span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">byte</span></span><span style="font-size: 10pt; font-family: Consolas;">[] ivKey =</span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">new</span></span> <span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">byte</span></span><span style="font-size: 10pt; font-family: Consolas;">[16];</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 需要加密的字串</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              String cSrc =</span> <span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;abcdefghigklmnopqrstuvwxyz0123456789&quot;</span><span style="font-size: 10pt; font-family: Consolas;">;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.println(cSrc);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 加密</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">long</span></span> <span style="font-size: 10pt; font-family: Consolas;">lStart = System.</span><span style="font-size:10pt"><span style="font-family: Consolas; font-size: 10pt; font-style: italic;">currentTimeMillis</span></span><span style="font-size: 10pt; font-family: Consolas;">();</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              String enString = Encryption.</span><span style="font-size:10pt"><span style="font-family: Consolas; font-size: 10pt; font-style: italic;">Encrypt</span></span><span style="font-size: 10pt; font-family: Consolas;">(cSrc, cKey,ivKey);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.println(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;加密后的字串是：&quot;</span> <span style="font-size: 10pt; font-family: Consolas;">+ enString);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size:10pt"><span style="color: rgb(127, 0, 85); font-family: Consolas; font-size: 10pt; font-weight: bold;">long</span></span> <span style="font-size: 10pt; font-family: Consolas;">lUseTime = System.</span><span style="font-size:10pt"><span style="font-family: Consolas; font-size: 10pt; font-style: italic;">currentTimeMillis</span></span><span style="font-size: 10pt; font-family: Consolas;">() - lStart;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.println(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;加密耗时：&quot;</span> <span style="font-size: 10pt; font-family: Consolas;">+ lUseTime +</span> <span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;毫秒&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              </span><span style="font-size: 10pt; color: rgb(63, 127, 95); font-family: Consolas;">// 解密 lStart = System.currentTimeMillis();</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              String DeString = Encryption.</span><span style="font-size:10pt"><span style="font-family: Consolas; font-size: 10pt; font-style: italic;">Decrypt</span></span><span style="font-size: 10pt; font-family: Consolas;">(enString, cKey,ivKey);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.println(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;解密后的字串是：&quot;</span> <span style="font-size: 10pt; font-family: Consolas;">+ DeString);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              lUseTime = System.</span><span style="font-size:10pt"><span style="font-family: Consolas; font-size: 10pt; font-style: italic;">currentTimeMillis</span></span><span style="font-size: 10pt; font-family: Consolas;">() - lStart;</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">              System.</span><span style="font-size:10pt"><span style="color: rgb(0, 0, 192); font-family: Consolas; font-size: 10pt; font-style: italic;">out</span></span><span style="font-size: 10pt; font-family: Consolas;">.println(</span><span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;解密耗时：&quot;</span> <span style="font-size: 10pt; font-family: Consolas;">+ lUseTime +</span> <span style="font-size: 10pt; color: rgb(42, 0, 255); font-family: Consolas;">&quot;毫秒&quot;</span><span style="font-size: 10pt; font-family: Consolas;">);</span></div><div align="left" style="min-height: 11pt;"><span style="font-size: 10pt; font-family: Consolas;">       }</span></div><div align="left" style="min-height: 11pt;"><div><span style="font-size: 10pt; font-family: Consolas;">}</span></div></div></span>
</div></body></html> 