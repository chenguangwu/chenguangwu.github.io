<html>
<head>
  <title>用java 打印的例子程序-emanbox-ChinaUnix博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="9797"/>
<h1>用java 打印的例子程序-emanbox-ChinaUnix博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2015/10/28 22:02</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://blog.chinaunix.net/uid-20559650-id-1925802.html"><i>http://blog.chinaunix.net/uid-20559650-id-1925802.html</i></a></td></tr>
</table>
</div>
<br/>

<div><span><br/><div style="font-size: 16px"><div style="word-wrap:break-word;"><div style="word-wrap:break-word;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:1;font-family:宋体, Arial;background:rgb(243, 247, 249);"><div style="word-wrap:break-word;text-align:left;color:rgb(86, 86, 86);"><div style="word-wrap:break-word;"><div style="word-wrap:break-word;"><div style="word-wrap:break-word;background:rgb(255, 255, 255);"><div style="word-wrap:break-word;"><div style="word-wrap:break-word;color:rgb(102, 102, 102);line-height:26px;"><div style="word-wrap:break-word;font-size:16px;">
			package aa;<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>import java.awt.Color;<br style="word-wrap:break-word;"/>import java.awt.Font;<br style="word-wrap:break-word;"/>import java.awt.Graphics;<br style="word-wrap:break-word;"/>import java.awt.Graphics2D;<br style="word-wrap:break-word;"/>import java.awt.print.PageFormat;<br style="word-wrap:break-word;"/>import java.awt.print.Printable;<br style="word-wrap:break-word;"/>import java.awt.print.PrinterException;<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>import javax.print.Doc;<br style="word-wrap:break-word;"/>import javax.print.DocFlavor;<br style="word-wrap:break-word;"/>import javax.print.DocPrintJob;<br style="word-wrap:break-word;"/>import javax.print.PrintException;<br style="word-wrap:break-word;"/>import javax.print.PrintService;<br style="word-wrap:break-word;"/>import javax.print.PrintServiceLookup;<br style="word-wrap:break-word;"/>import javax.print.SimpleDoc;<br style="word-wrap:break-word;"/>import javax.print.attribute.DocAttributeSet;<br style="word-wrap:break-word;"/>import javax.print.attribute.HashDocAttributeSet;<br style="word-wrap:break-word;"/>import javax.print.attribute.HashPrintRequestAttributeSet;<br style="word-wrap:break-word;"/>import javax.print.attribute.PrintRequestAttributeSet;<br style="word-wrap:break-word;"/>import javax.print.attribute.standard.MediaSizeName;<br style="word-wrap:break-word;"/>import javax.swing.JOptionPane;<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>/**<br style="word-wrap:break-word;"/> * java定位打印，把打印内容打到指定的地方。<br style="word-wrap:break-word;"/> *<br style="word-wrap:break-word;"/> * @author lyb<br style="word-wrap:break-word;"/> *<br style="word-wrap:break-word;"/> */<br style="word-wrap:break-word;"/>public class throwadv implements Printable<br style="word-wrap:break-word;"/>{<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>    private int PAGES = 0;<br style="word-wrap:break-word;"/>    private String printStr;<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>    /*<br style="word-wrap:break-word;"/>     * Graphic指明打印的图形环境；PageFormat指明打印页格式（页面大小以点为计量单位，<br style="word-wrap:break-word;"/>     * 1点为1英寸的1/72，1英寸为25.4毫米。A4纸大致为595×842点）；page指明页号<br style="word-wrap:break-word;"/>     */<br style="word-wrap:break-word;"/>    public int print(Graphics gp, PageFormat pf, int page)<br style="word-wrap:break-word;"/>            throws PrinterException<br style="word-wrap:break-word;"/>    {<br style="word-wrap:break-word;"/>        Graphics2D g2 = (Graphics2D) gp;<br style="word-wrap:break-word;"/>        g2.setPaint(Color.black); // 设置打印颜色为黑色<br style="word-wrap:break-word;"/>        if (page &gt;= PAGES) // 当打印页号大于需要打印的总页数时，打印工作结束<br style="word-wrap:break-word;"/>        {<br style="word-wrap:break-word;"/>            return Printable.NO_SUCH_PAGE;<br style="word-wrap:break-word;"/>        }<br style="word-wrap:break-word;"/>        g2.translate(pf.getImageableX(), pf.getImageableY());// 转换坐标，确定打印边界<br style="word-wrap:break-word;"/>        Font font = new Font(&quot;宋体&quot;, Font.PLAIN, 24);// 创建字体<br style="word-wrap:break-word;"/>        g2.setFont(font);<br style="word-wrap:break-word;"/>        // 打印当前页文本<br style="word-wrap:break-word;"/>        int printFontCount = printStr.length();// 打印字数<br style="word-wrap:break-word;"/>        int printFontSize = font.getSize();// Font 的磅值大小<br style="word-wrap:break-word;"/>        float printX = 595 / 2; // 给定字符点阵，X页面正中<br style="word-wrap:break-word;"/>        float printY = 842 / 2; // 给定字符点阵，Y页面正中<br style="word-wrap:break-word;"/>        float printMX = printX - (printFontCount * printFontSize / 2);// 打印到正中间<br style="word-wrap:break-word;"/>        float printMY = printY - printFontSize / 2;// 打印到正中间<br style="word-wrap:break-word;"/>        g2.drawString(printStr, printMX, printMY); // 具体打印每一行文本，在指定位置<br style="word-wrap:break-word;"/>        g2.drawString(printStr, printMX - printFontSize * printFontCount,<br style="word-wrap:break-word;"/>                printMY + printFontSize); // 具体打印每一行文本 <br style="word-wrap:break-word;"/>        g2.drawString(printStr, printMX + printFontSize * printFontCount,<br style="word-wrap:break-word;"/>                printMY + printFontSize); // 具体打印每一行文本 <br style="word-wrap:break-word;"/>        g2.drawString(printStr, printMX, printMY + printFontSize * 2); // 具体打印每一行文本 <br style="word-wrap:break-word;"/>        g2.drawString(printStr, printMX, printMY + printFontSize * 2);<br style="word-wrap:break-word;"/>         g2.drawString(printStr, printMX, printMY + printFontSize * 2);<br style="word-wrap:break-word;"/>          g2.drawString(printStr, printMX, printMY + printFontSize * 2);<br style="word-wrap:break-word;"/>        return Printable.PAGE_EXISTS; // 存在打印页时，继续打印工作<br style="word-wrap:break-word;"/>    }<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>    // 打印内容到指定位置<br style="word-wrap:break-word;"/>    public void printContent()<br style="word-wrap:break-word;"/>    {<br style="word-wrap:break-word;"/>        printStr = &quot;打印测试内容&quot;;// 获取需要打印的目标文本<br style="word-wrap:break-word;"/>        if (printStr != null &amp;&amp; printStr.length() &gt; 0) // 当打印内容不为空时<br style="word-wrap:break-word;"/>        {<br style="word-wrap:break-word;"/>            PAGES = 1; // 获取打印总页数<br style="word-wrap:break-word;"/>            // 指定打印输出格式<br style="word-wrap:break-word;"/>            DocFlavor flavor = DocFlavor.SERVICE_FORMATTED.PRINTABLE;<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>            // 设置打印属性<br style="word-wrap:break-word;"/>            PrintRequestAttributeSet pras = new HashPrintRequestAttributeSet();<br style="word-wrap:break-word;"/>            // 设置纸张大小,也可以新建MediaSize类来自定义大小<br style="word-wrap:break-word;"/>            pras.add(MediaSizeName.ISO_A4);<br style="word-wrap:break-word;"/>            DocAttributeSet das = new HashDocAttributeSet();<br style="word-wrap:break-word;"/>            // 指定打印内容<br style="word-wrap:break-word;"/>            Doc doc = new SimpleDoc(this, flavor, das);<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>            // 定位默认的打印服务<br style="word-wrap:break-word;"/>            PrintService printService = null;<br style="word-wrap:break-word;"/>            printService = PrintServiceLookup.lookupPrintServices(flavor, pras)[0];<br style="word-wrap:break-word;"/>            System.out.println(printService);<br style="word-wrap:break-word;"/>            // 创建打印作业<br style="word-wrap:break-word;"/>            DocPrintJob job = printService.createPrintJob();<br style="word-wrap:break-word;"/>            try<br style="word-wrap:break-word;"/>            {<br style="word-wrap:break-word;"/>                job.print(doc, pras); // 进行每一页的具体打印操作<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>            }<br style="word-wrap:break-word;"/>            catch (PrintException pe)<br style="word-wrap:break-word;"/>            {<br style="word-wrap:break-word;"/>                pe.printStackTrace();<br style="word-wrap:break-word;"/>            }<br style="word-wrap:break-word;"/>        }<br style="word-wrap:break-word;"/>        else<br style="word-wrap:break-word;"/>        {<br style="word-wrap:break-word;"/>            // 如果打印内容为空时，提示用户打印将取消<br style="word-wrap:break-word;"/>            JOptionPane.showConfirmDialog(null,<br style="word-wrap:break-word;"/>                    &quot;Sorry, Printer Job is Empty, Print Cancelled!&quot;,<br style="word-wrap:break-word;"/>                    &quot;Empty&quot;, JOptionPane.DEFAULT_OPTION,<br style="word-wrap:break-word;"/>                    JOptionPane.WARNING_MESSAGE);<br style="word-wrap:break-word;"/>        }<br style="word-wrap:break-word;"/>    }<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>    public static void main(String[] args)<br style="word-wrap:break-word;"/>    {<br style="word-wrap:break-word;"/>        throwadv lp = new throwadv();<br style="word-wrap:break-word;"/>        lp.printContent();<br style="word-wrap:break-word;"/>    }<br style="word-wrap:break-word;"/>}<br style="word-wrap:break-word;"/><br style="word-wrap:break-word;"/>
		
		
		           </div></div></div></div></div></div></div></div></div></div><br/></span>
</div></body></html> 