<html>
<head>
  <title>springboot中使用validation在service层判断参数 - weixin_39655625的博客 - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="13129"/>
<h1>springboot中使用validation在service层判断参数 - weixin_39655625的博客 - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2019/11/14 11:01</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://blog.csdn.net/weixin_39655625/article/details/88621936"><i>https://blog.csdn.net/weixin_39655625/article/details/88621936</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="box-sizing:border-box;outline:0px;"><div style="-webkit-font-smoothing:antialiased;min-width:1200px;box-sizing:inherit;outline:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;font-size:14px;line-height:1.57143;background-color:rgb(245, 246, 247);color:rgb(51, 51, 51);"><div style="box-sizing:inherit;outline:0px;-webkit-box-pack:center;justify-content:center;"><div style="box-sizing:border-box;outline:0px;"><span style="box-sizing:inherit;outline:0px;"><div style="background:rgb(255, 255, 255);box-sizing:inherit;outline:0px;">
    <div style="border-bottom:1px solid rgb(224, 224, 224);padding-top:16px;z-index:9;background-color:rgb(255, 255, 255);box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
        <div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
            <div style="margin-bottom:8px;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
                <span style="display:inline-block;margin-top:9px;width:34px;height:20px;line-height:20px;text-align:center;font-size:12px;border-radius:2px;vertical-align:1px;color:rgb(202, 12, 22);border:1px solid rgb(244, 206, 208);margin-right:8px;box-sizing:inherit;outline:0px;float:left;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">原创</span>                <h1 style="font-size:24px;overflow-wrap:break-word;box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">springboot中使用validation在service层判断参数</h1>
            </div>
            <div style="padding-bottom:14px;position:relative;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
                <div style="color:rgb(133, 133, 133);width:88%;height:24px;overflow:hidden;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
                                                                                                                                                                <span style="margin-right:14px;box-sizing:inherit;outline:0px;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">2019-03-17 16:59:25</span>
                    <a href="https://me.csdn.net/weixin_39655625" rel="noopener" style="color:rgb(120, 165, 241);margin-right:14px;box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;" target="_blank">picc程序员</a>
                    <span style="margin-right:14px;box-sizing:inherit;outline:0px;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">阅读数 1811</span><span style="margin-right:0px;font-size:12px;color:rgb(51, 153, 234);letter-spacing:0px;line-height:20px;cursor:pointer;background-color:rgb(255, 255, 255);top:0px;right:101px;width:45px;display:inline-block;box-sizing:inherit;outline:0px;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;position:static;">更多</span>
                                                                    <div style="margin-bottom:0px;font-size:12px;margin-top:6px;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
                                <span style="margin-right:14px;color:rgb(77, 77, 77);box-sizing:inherit;outline:0px;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">分类专栏：</span>
                                                                                                            <a href="https://blog.csdn.net/weixin_39655625/article/category/7689185" rel="noopener" style="color:rgb(121, 165, 229);display:inline-block;margin-right:24px;overflow-wrap:break-word;box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;" target="_blank">
                                            springboot                                        </a>
                                                                                                </div>
                                        </div>
                <div style="position:absolute;top:0px;right:0px;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
                                    </div>
            </div>
        </div>
    </div>
    <div style="position:relative;padding-top:16px;box-sizing:inherit;outline:0px;display:block;margin:0px;padding:0px;">
                 <div style="overflow-wrap:break-word;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
                                                <div style="overflow-wrap:break-word;font-size:12px;color:rgb(153, 153, 153);margin-bottom:16px;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
                <span style="overflow-wrap:break-word;color:rgb(77, 77, 77);word-break:break-all;box-sizing:inherit;outline:0px;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">
                <a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license" style="color:rgb(51, 153, 234);overflow-wrap:break-word;font-size:14px;box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">
                    </a>
            <span style="overflow-wrap:break-word;vertical-align:text-bottom;box-sizing:inherit;outline:0px;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">
                版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="noopener" style="color:rgb(51, 153, 234);overflow-wrap:break-word;font-size:14px;box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;" target="_blank"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。            </span>
               <div style="overflow-wrap:break-word;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
                    本文链接：<a href="https://blog.csdn.net/weixin_39655625/article/details/88621936" style="color:rgb(51, 153, 234);overflow-wrap:break-word;font-size:14px;box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">https://blog.csdn.net/weixin_39655625/article/details/88621936</a>
                </div>
            </span>
                    </div>
                                                    
             
             
            
                                        
                <div style="overflow-wrap:break-word;position:relative;min-height:70px;box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun;">
                                            <pre style="overflow-wrap:break-word;box-sizing:border-box;outline:0px;padding:8px;margin:0px 0px 24px;position:relative;font-family:Consolas, Inconsolata, Courier, monospace;white-space:pre-wrap;overflow-x:auto;font-size:14px;line-height:22px;color:rgb(0, 0, 0);">众所周知，validation在controller层很简单。加一个@Valid，加一个bindingresult就行了。

但是在service里怎么判断，查了半天也没查到例子。

业务场景是，json报文的body部分是整体加密的，所以不可能在controller接收的时候用@Requestbody和@Valid就直接检查了，必须先解密，然后在service层判断。

看了一篇分析validation的文章时，<a href="https://www.cnblogs.com/mr-yang-localhost/p/7812038.html" rel="nofollow" style="color:rgb(78, 161, 219);overflow-wrap:break-word;box-sizing:border-box;outline:0px;text-decoration:none;cursor:pointer;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">https://www.cnblogs.com/mr-yang-localhost/p/7812038.html</a>，介绍了hibernate的校验模式，于是参考写了一个方法。可以实现valid检查参数的目的。


public static void serviceValid(Object object){
   String validMessage = &quot;&quot;;
   //初始化检查器。
   ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
         .configure()
         .failFast( false )
         .buildValidatorFactory();
   Validator validator = validatorFactory.getValidator();
   //检查object
   Set&lt;ConstraintViolation&lt;Object&gt;&gt; set = validator.validate(object);
   //循环set，获取检查结果
   for(ConstraintViolation&lt;Object&gt; voset : set){
      validMessage = validMessage + voset.getMessage() +&quot;;&quot;;
   }
   if(!StringUtils.isEmpty(validMessage)){
      //抛出业务异常
      throw new XXXException(validMessage);
   }
}</pre>
                                    </div>
                    <span style="display:block;height:0px;visibility:hidden;clear:both;"> </span></div>
    </div>
    <div style="position:relative;overflow:hidden;box-sizing:inherit;outline:0px;padding:0px;margin:0px;"> 
        <div style="padding-bottom:16px;margin-top:16px;border-bottom:1px solid rgb(227, 227, 227);position:relative;padding-top:16px;box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
            <span style="position:absolute;top:0px;right:0px;color:rgb(204, 204, 204);font-size:12px;box-sizing:inherit;outline:0px;margin:0px;padding:0px;font-family:&quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif;">
                文章最后发布于: 2019-03-17 16:59:25            </span>
        </div>
    </div>
</div></span></div></div></div></div></div><br/></div></span>
</div></body></html> 