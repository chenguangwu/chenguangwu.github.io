<html>
<head>
  <title>Splash的简单使用 和 服务压力测试 - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="8721"/>
<h1>Splash的简单使用 和 服务压力测试 - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/3/2 17:04</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://blog.csdn.net/u013055678/article/details/58735626"><i>http://blog.csdn.net/u013055678/article/details/58735626</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div><div style="font-size:16px;font-family:&quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;font-weight:400;box-sizing:border-box;background-color:rgb(245, 246, 247);line-height:24px;"><div style="font-weight:400;box-sizing:border-box;"><span><div style="box-shadow:rgba(0, 0, 0, 0.0470588) 0px 2px 4px 0px;background-color:rgb(255, 255, 255);">
        <h1 style="font-family:&quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;margin:0px;box-sizing:border-box;word-break:break-all;word-wrap:break-word;padding:0px 29px;font-weight:700;color:rgb(44, 48, 51);font-size:24px;line-height:38px;">Splash的简单使用 和 服务压力测试</h1>
        <div style="margin:0px;font-weight:400;box-sizing:border-box;padding:0px 29px 8px;color:rgb(136, 136, 136);border-bottom:1px solid rgb(229, 229, 229);font-size:14px;line-height:38px;margin-top:5px;">
            <div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;float:left;">
                <span style="margin:0px;font-weight:400;box-sizing:border-box;padding:2px 6px;border:1px solid rgb(228, 235, 244);font-size:14px;color:rgb(120, 144, 156);margin-right:20px;">
                原创                </span>
                <span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;display:inline-block;color:rgb(187, 187, 187);font-size:14px;">2017年03月01日 00:19:59</span>
            </div>

            <ul style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:left;margin-left:26px;background-color:rgb(255, 255, 255);font-size:14px;">
                <li style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:left;color:rgb(187, 187, 187);">标签：</li>


                                                            <li style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:left;"><a href="http://so.csdn.net/so/search/s.do?q=%E7%88%AC%E8%99%AB&amp;t=blog" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;text-decoration:none;color:rgb(64, 147, 198);display:inline-block;" target="_blank">爬虫</a> <span style="padding:0px;font-weight:400;box-sizing:border-box;margin:0px 10px 0px 5px;color:rgb(229, 229, 229);display:inline-block;">/</span></li>
                                            <li style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:left;"><a href="http://so.csdn.net/so/search/s.do?q=Splash&amp;t=blog" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;text-decoration:none;color:rgb(64, 147, 198);display:inline-block;" target="_blank">Splash</a> <span style="padding:0px;font-weight:400;box-sizing:border-box;margin:0px 10px 0px 5px;color:rgb(229, 229, 229);display:inline-block;">/</span></li>
                                            <li style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:left;"><a href="http://so.csdn.net/so/search/s.do?q=lua&amp;t=blog" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;text-decoration:none;color:rgb(64, 147, 198);display:inline-block;" target="_blank">lua</a> <span style="padding:0px;font-weight:400;box-sizing:border-box;margin:0px 10px 0px 5px;color:rgb(229, 229, 229);display:inline-block;">/</span></li>
                                            <li style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:left;"><a href="http://so.csdn.net/so/search/s.do?q=javascript&amp;t=blog" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;text-decoration:none;color:rgb(64, 147, 198);display:inline-block;" target="_blank">javascript</a> <span style="padding:0px;font-weight:400;box-sizing:border-box;margin:0px 10px 0px 5px;color:rgb(229, 229, 229);display:inline-block;">/</span></li>
                                            <li style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:left;"><a href="http://so.csdn.net/so/search/s.do?q=docker&amp;t=blog" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;text-decoration:none;color:rgb(64, 147, 198);display:inline-block;" target="_blank">docker</a> </li>
                                    
            <span style="font-weight:400;list-style:none;font-size:14px;height:0px;visibility:hidden;display:block;clear:both;">.</span></ul>
            <ul style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:right;margin-top:5px;">
                <li style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;list-style:none;float:left;margin-left:30px;line-height:28px;"></li>
                
                
            </ul>
        <span style="font-weight:400;color:rgb(136, 136, 136);font-size:14px;line-height:38px;height:0px;visibility:hidden;display:block;clear:both;">.</span></div>
        <div style="margin:0px;font-weight:400;box-sizing:border-box;padding:20px 30px 0px;word-break:break-all;margin-bottom:30px;color:rgb(69, 69, 69);word-wrap:break-word;overflow:hidden;">
                            <div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;font-family:&quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;">
                        
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">mac 安装</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">先安装docker</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">下载地址：<a href="https://www.docker.com/products/docker-toolbox" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;color:rgb(66, 139, 202);text-decoration:none;" target="_blank">https://www.docker.com/products/docker-toolbox</a></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">一路默认安装直到让你选择Docker Quickstart Terminal还是Kitematic ，选择docker<br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">会自动默认安装，继续就ok了</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"><br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">验证是否成功：</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">docker-machine start default</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">docker-machine ssh default<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
连接到docker以后输入echo “hello world&quot;，显示出hello world，说明ok<br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"><br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">安装splash</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">安装命令：docker pull scrapinghub/splash</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">启动命令：docker run -p 5023:5023 -p 8050:8050 -p 8051:8051 scrapinghub/splash</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">8050 (http)，8051 (https) ，5023 (telnet)<br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"><br style="box-sizing:border-box;"/><img src="Splash的简单使用 和 服务压力测试 - CSDN博客_files/Center.jpg" type="image/jpeg" data-filename="Center.jpg" alt="" height="438" style="border:0px;outline:0px;box-sizing:border-box;max-width:100%;margin:0px 0px 24px;" width="780"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><img src="Splash的简单使用 和 服务压力测试 - CSDN博客_files/Center [1].jpg" type="image/jpeg" data-filename="Center.jpg" alt="" height="283" style="border:0px;outline:0px;box-sizing:border-box;max-width:100%;margin:0px 0px 24px;" width="780"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">查看ip</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">docker-machine ip default<br style="box-sizing:border-box;"/><img src="Splash的简单使用 和 服务压力测试 - CSDN博客_files/Center [2].jpg" type="image/jpeg" data-filename="Center.jpg" alt="" height="66" style="border:0px;outline:0px;box-sizing:border-box;max-width:100%;margin:0px 0px 24px;" width="752"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><img src="Splash的简单使用 和 服务压力测试 - CSDN博客_files/Center [3].jpg" type="image/jpeg" data-filename="Center.jpg" alt="" height="419" style="border:0px;outline:0px;box-sizing:border-box;max-width:100%;margin:0px 0px 24px;" width="780"/><br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"><br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">浏览器访问ip加8050端口，页面出现说明成功<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">splash使用：</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">使用lua脚本，需要一个main函数</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"><br style="box-sizing:border-box;"/></div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">简单实现：</div>
<div style="overflow-x:auto;text-align:left;font-weight:400;box-sizing:border-box;position:relative;overflow-y:hidden;padding:0px;font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;font-size:12px;background-color:rgb(231, 229, 220);width:99%;padding-top:1px;margin:18px 0px;"><div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;padding-left:45px;"><div style="font-size:9px;margin:0px;line-height:normal;font-weight:normal;font-style:normal;font-variant:normal;font-stretch:normal;padding:3px 8px 10px 10px;box-sizing:border-box;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:rgb(248, 248, 248);border-left:3px solid rgb(108, 226, 108);border-right:1px solid rgb(231, 229, 220);"><b style="box-sizing:border-box;">[plain]</b> <a href="http://blog.csdn.net/u013055678/article/details/58735626#" style="font-size:9px;color:rgb(160, 160, 160);margin:0px;padding:1px;font-weight:400;box-sizing:border-box;text-decoration:none;background:0px 0px;border:none;outline:0px;background-color:inherit;margin-right:10px;background-repeat:no-repeat;background-position:left top;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-image:url(&quot;http://csdnimg.cn//csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);" title="view plain">view plain</a><span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"> <a href="http://blog.csdn.net/u013055678/article/details/58735626#" style="font-size:9px;color:rgb(160, 160, 160);margin:0px;padding:1px;font-weight:400;box-sizing:border-box;text-decoration:none;background:0px 0px;border:none;outline:0px;background-color:inherit;margin-right:10px;background-repeat:no-repeat;background-position:left top;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-image:url(&quot;http://csdnimg.cn//csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);" title="copy">copy</a><div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;position:absolute;left:264px;top:2268px;width:16px;height:16px;z-index:99;"><div align="middle" style="box-sizing:border-box;visibility:hidden;background-color:rgb(255, 255, 255);"></div></div></span><span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"> </span></div></div><ol start="1" style="font-weight:400;box-sizing:border-box;padding:0px;list-style:decimal;border:none;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);border-right:1px solid rgb(231, 229, 220);margin:0px 0px 1px 45px;"><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">function main(splash)  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">    splash:go(&quot;http://www.baidu.com&quot;)  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">    splash:wait(0.5)  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">    return {c=splash:get_cookies()}  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">end  </span></li></ol></div>获得百度页面的cookies，有些网站会在页面用js生成各种cookie用来加大爬虫难度<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
python调用方法：<br style="box-sizing:border-box;"/><div style="overflow-x:auto;text-align:left;font-weight:400;box-sizing:border-box;position:relative;overflow-y:hidden;padding:0px;font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;font-size:12px;background-color:rgb(231, 229, 220);width:99%;padding-top:1px;margin:18px 0px;"><div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;padding-left:45px;"><div style="font-size:9px;margin:0px;line-height:normal;font-weight:normal;font-style:normal;font-variant:normal;font-stretch:normal;padding:3px 8px 10px 10px;box-sizing:border-box;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:rgb(248, 248, 248);border-left:3px solid rgb(108, 226, 108);border-right:1px solid rgb(231, 229, 220);"><b style="box-sizing:border-box;">[python]</b> <a href="http://blog.csdn.net/u013055678/article/details/58735626#" style="font-size:9px;color:rgb(160, 160, 160);margin:0px;padding:1px;font-weight:400;box-sizing:border-box;text-decoration:none;background:0px 0px;border:none;outline:0px;background-color:inherit;margin-right:10px;background-repeat:no-repeat;background-position:left top;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-image:url(&quot;http://csdnimg.cn//csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);" title="view plain">view plain</a><span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"> <a href="http://blog.csdn.net/u013055678/article/details/58735626#" style="font-size:9px;color:rgb(160, 160, 160);margin:0px;padding:1px;font-weight:400;box-sizing:border-box;text-decoration:none;background:0px 0px;border:none;outline:0px;background-color:inherit;margin-right:10px;background-repeat:no-repeat;background-position:left top;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-image:url(&quot;http://csdnimg.cn//csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);" title="copy">copy</a><div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;position:absolute;left:278px;top:2497px;width:16px;height:16px;z-index:99;"><div align="middle" style="box-sizing:border-box;visibility:hidden;background-color:rgb(255, 255, 255);"></div></div></span><span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"> </span></div></div><ol start="1" style="font-weight:400;box-sizing:border-box;padding:0px;list-style:decimal;border:none;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);border-right:1px solid rgb(231, 229, 220);margin:0px 0px 1px 45px;"><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;"># -*-coding:utf-8 -*-</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">__author__ = <span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;ayou&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="color:rgb(0, 102, 153);margin:0px;border:none;box-sizing:border-box;background:rgb(0, 102, 170);padding:0px;font-size:14px;border-radius:2px;word-wrap:normal;font-weight:700;background-color:inherit;">import</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"> requests  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="color:rgb(0, 102, 153);margin:0px;border:none;box-sizing:border-box;background:rgb(0, 102, 170);padding:0px;font-size:14px;border-radius:2px;word-wrap:normal;font-weight:700;background-color:inherit;">import</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"> json  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">s = requests.session()  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">#execute是执行脚本</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">#脚本为lu，也可以使用js脚本</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">url=<span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;http://192.168.99.100:8050/execute?lua_source=&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">#以下脚本为访问百度，并返回cookies</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">script = <span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">''</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">'''</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">function main(splash)</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">    splash:go(&quot;http://www.baidu.com&quot;)</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">    splash:wait(0.5)</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">    return {c=splash:get_cookies()}</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">end</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">'''</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">cc={}  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">r = s.get(url+script)  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">a = str(r.content, encoding = <span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;utf-8&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">)  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">jsondata = json.loads(a)  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="color:rgb(0, 102, 153);margin:0px;border:none;box-sizing:border-box;background:rgb(0, 102, 170);padding:0px;font-size:14px;border-radius:2px;word-wrap:normal;font-weight:700;background-color:inherit;">for</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"> line </span><span style="color:rgb(0, 102, 153);margin:0px;border:none;box-sizing:border-box;background:rgb(0, 102, 170);padding:0px;font-size:14px;border-radius:2px;word-wrap:normal;font-weight:700;background-color:inherit;">in</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"> jsondata[</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;c&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">]:  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">    cc[line[<span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;name&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">]]= line[</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;value&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">]  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="color:rgb(0, 102, 153);margin:0px;border:none;box-sizing:border-box;background:rgb(0, 102, 170);padding:0px;font-size:14px;border-radius:2px;word-wrap:normal;font-weight:700;background-color:inherit;">print</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">(cc)  </span></span></li></ol></div>splash的execute是用来执行lua脚本，返回一段json，里面就是百度cookies<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
通过代理ip访问：<br style="box-sizing:border-box;"/><div style="overflow-x:auto;text-align:left;font-weight:400;box-sizing:border-box;position:relative;overflow-y:hidden;padding:0px;font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;font-size:12px;background-color:rgb(231, 229, 220);width:99%;padding-top:1px;margin:18px 0px;"><div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;padding-left:45px;"><div style="font-size:9px;margin:0px;line-height:normal;font-weight:normal;font-style:normal;font-variant:normal;font-stretch:normal;padding:3px 8px 10px 10px;box-sizing:border-box;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:rgb(248, 248, 248);border-left:3px solid rgb(108, 226, 108);border-right:1px solid rgb(231, 229, 220);"><b style="box-sizing:border-box;">[python]</b> <a href="http://blog.csdn.net/u013055678/article/details/58735626#" style="font-size:9px;color:rgb(160, 160, 160);margin:0px;padding:1px;font-weight:400;box-sizing:border-box;text-decoration:none;background:0px 0px;border:none;outline:0px;background-color:inherit;margin-right:10px;background-repeat:no-repeat;background-position:left top;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-image:url(&quot;http://csdnimg.cn//csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);" title="view plain">view plain</a><span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"> <a href="http://blog.csdn.net/u013055678/article/details/58735626#" style="font-size:9px;color:rgb(160, 160, 160);margin:0px;padding:1px;font-weight:400;box-sizing:border-box;text-decoration:none;background:0px 0px;border:none;outline:0px;background-color:inherit;margin-right:10px;background-repeat:no-repeat;background-position:left top;display:inline-block;width:16px;height:16px;text-indent:-2000px;background-image:url(&quot;http://csdnimg.cn//csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);" title="copy">copy</a><div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;position:absolute;left:278px;top:3110px;width:16px;height:16px;z-index:99;"><div align="middle" style="box-sizing:border-box;visibility:hidden;background-color:rgb(255, 255, 255);"></div></div></span><span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"> </span></div></div><ol start="1" style="font-weight:400;box-sizing:border-box;padding:0px;list-style:decimal;border:none;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);border-right:1px solid rgb(231, 229, 220);margin:0px 0px 1px 45px;"><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;"># -*-coding:utf-8 -*-</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">__author__ = <span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;ayou&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="color:rgb(0, 102, 153);margin:0px;border:none;box-sizing:border-box;background:rgb(0, 102, 170);padding:0px;font-size:14px;border-radius:2px;word-wrap:normal;font-weight:700;background-color:inherit;">import</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"> requests  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">s = requests.session()  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">#execute是执行脚本</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">#脚本为lu，也可以使用js脚本</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">url=<span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;http://192.168.99.100:8050/execute?lua_source=&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">#以下代码是通过代理ip访问</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">script_1=<span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">''</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">'''</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">function main(splash)</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">    splash:on_request(function(request)</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">        request:set_proxy{</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">        host = &quot;60.21.132.218&quot;,</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">        port = 63000,</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">    }</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">    end)</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">    assert(splash:go(&quot;http://1212.ip138.com/ic.asp&quot;))</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">    return splash:html()</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">end</span> </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">'''</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">r = s.get(url+script_1)  </span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(248, 248, 248);color:rgb(92, 92, 92);line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">a = str(r.content, encoding = <span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 255);background-color:inherit;">&quot;utf-8&quot;</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">)  </span></span></li><li style="list-style-type:decimal-leading-zero;margin:0px;font-weight:400;box-sizing:border-box;list-style:none;border:none;padding:0px 3px 0px 10px;list-style-image:initial;border-left:3px solid rgb(108, 226, 108);background-color:rgb(255, 255, 255);color:inherit;line-height:150%;list-style-position:outside;"><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;"><span style="color:rgb(0, 102, 153);margin:0px;border:none;box-sizing:border-box;background:rgb(0, 102, 170);padding:0px;font-size:14px;border-radius:2px;word-wrap:normal;font-weight:700;background-color:inherit;">print</span><span style="font-weight:400;box-sizing:border-box;margin:0px;padding:0px;border:none;color:rgb(0, 0, 0);background-color:inherit;">(a)  </span></span></li></ol></div>结果：<br style="box-sizing:border-box;"/><img src="Splash的简单使用 和 服务压力测试 - CSDN博客_files/Center [4].jpg" type="image/jpeg" data-filename="Center.jpg" alt="" height="88" style="border:0px;outline:0px;box-sizing:border-box;max-width:100%;margin:0px 0px 24px;" width="780"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
这是西刺上的一个免费代理ip<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
Splash支持lua脚本和js脚本，还支持在线脚本测试，并附带简单的函数提示说明<br style="box-sizing:border-box;"/><img src="Splash的简单使用 和 服务压力测试 - CSDN博客_files/Center [5].jpg" type="image/jpeg" data-filename="Center.jpg" alt="" height="258" style="border:0px;outline:0px;box-sizing:border-box;max-width:100%;margin:0px 0px 24px;" width="780"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;"><br style="box-sizing:border-box;"/>
关闭splash :</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">先用 docker ps 命令找出splash的CONTAINER ID</div>
<div style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;">然后用 docker stop 7b1f1412e7dc(CONTAINER ID) 命令关闭</div>
<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
Splash作为服务可以提供给各种语言使用<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
Splash文档：<a href="http://splash.readthedocs.io/en/latest/install.html" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;color:rgb(66, 139, 202);text-decoration:none;" target="_blank">http://splash.readthedocs.io/en/latest/install.html</a><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
Splash文档(英文)很完整，用法很丰富，仔细看会有很多惊喜<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
因为只用了一天Splash，还没法用它和<span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;font-size:15px;">selenium</span>+PhantomJS比较哪个方式更稳定快速，不过目前觉得它是一个神器，貌似用得人挺少，可惜<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
对splash进行了压力测试：<br style="box-sizing:border-box;"/>
使用了siege<br style="box-sizing:border-box;"/>
系统为macos sierra 10.12.3<br style="box-sizing:border-box;"/>
测试命令：<br style="box-sizing:border-box;"/>
siege -c 200 -r 5 http://192.168.99.100:8050/execute?lua_source=function+main%28splash%29%0D%0A++++splash%3Ago%28%22http%3A%2F%2Fwww.baidu.com%22%29%0D%0A++++splash%3Await%280.5%29%0D%0A++++return+%7Bc%3Dsplash%3Aget_cookies%28%29%7D%0D%0Aend<br style="box-sizing:border-box;"/>
结果：<br style="box-sizing:border-box;"/><img src="Splash的简单使用 和 服务压力测试 - CSDN博客_files/Center [6].jpg" type="image/jpeg" data-filename="Center.jpg" alt="" height="288" style="border:0px;outline:0px;box-sizing:border-box;max-width:100%;margin:0px 0px 24px;" width="551"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
添加 nginx，参考：<a href="http://blog.csdn.net/u013055678/article/details/58290143" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;color:rgb(66, 139, 202);text-decoration:none;" target="_blank"> flask笔记：11：gunicorn+gevent+nginx+flask部署,使用siege进行服务器压力测试</a><br style="box-sizing:border-box;"/>
打开nginx.conf 修改：<br style="box-sizing:border-box;"/>
location @pp {<br style="box-sizing:border-box;"/>
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<br style="box-sizing:border-box;"/>
            proxy_set_header Host $http_host;<br style="box-sizing:border-box;"/>
            #修改成splash地址<br style="box-sizing:border-box;"/>
            proxy_pass http://192.168.99.100:8050;<br style="box-sizing:border-box;"/>
        }<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
重启nginx：sudo /usr/local/nginx/sbin/nginx -s reload<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
测试命令：<br style="box-sizing:border-box;"/>
siege -c 200 -r 5 http://127.0.0.1:8088/execute?lua_source=function+main%28splash%29%0D%0A++++splash%3Ago%28%22http%3A%2F%2Fwww.baidu.com%22%29%0D%0A++++splash%3Await%280.5%29%0D%0A++++return+%7Bc%3Dsplash%3Aget_cookies%28%29%7D%0D%0Aend<br style="box-sizing:border-box;"/>
结果：<br style="box-sizing:border-box;"/><img src="Splash的简单使用 和 服务压力测试 - CSDN博客_files/Center [7].jpg" type="image/jpeg" data-filename="Center.jpg" alt="" height="263" style="border:0px;outline:0px;box-sizing:border-box;max-width:100%;margin:0px 0px 24px;" width="507"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
公司用<span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;font-size:15px;">selenium</span>+PhantomJS处理一些复杂网站封装成服务，但是不太稳定，<span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;font-size:15px;"></span>PhantomJS好像释放内存有问题，爆过几次服务器内存，从上面的结果和我这两天用Splash的感受觉得Splash比<span style="margin:0px;padding:0px;font-weight:400;box-sizing:border-box;font-size:15px;">selenium</span>+PhantomJS的模式更适合做成服务式的爬虫服务<br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/>
关于siege请参看：<a href="http://blog.csdn.net/u013055678/article/details/58290143" style="outline:0px;margin:0px;padding:0px;font-weight:400;box-sizing:border-box;color:rgb(66, 139, 202);text-decoration:none;" target="_blank"> flask笔记：11：gunicorn+gevent+nginx+flask部署,使用siege进行服务器压力测试</a><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/><br style="box-sizing:border-box;"/></div>
                </div>
                    </div>
    </div></span></div></div></div></div><br/></div></span>
</div></body></html> 