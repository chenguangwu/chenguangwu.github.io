<html>
<head>
  <title>java读写Excel(JXL) - 改变从现在开始 - ITeye技术网站</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="7862"/>
<h1>java读写Excel(JXL) - 改变从现在开始 - ITeye技术网站</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2015/11/3 13:24</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://hlhpyasd.iteye.com/blog/865865"><i>http://hlhpyasd.iteye.com/blog/865865</i></a></td></tr>
</table>
</div>
<br/>

<div><span><br/><div style="font-size: 16px"><div><div style="text-align:center;font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:12px;line-height:1.5;color:black;background-color:white;"><div style="background-color:rgb(254, 240, 231);text-align:center;"><div style="text-align:left;"><div style="overflow:hidden;background-color:white;"><div style="background-color:white;"><div style="font-size:14px;line-height:1.8em;">
    <p style="margin:0px;padding:0px;">1.找到JXL.jar包，导入程序。</p>
<p style="margin:0px;padding:0px;">2.读取Excel</p>
<p style="margin:0px;padding:0px;"> public static void readExcel() throws BiffException, IOException{<br/>   //创建一个list 用来存储读取的内容<br/>    List list = new ArrayList();<br/>    Workbook rwb = null;<br/>    Cell cell = null;<br/>    <br/>    //创建输入流<br/>    InputStream stream = new FileInputStream(&quot;d:\\testJXL.xls&quot;);<br/>    <br/>    //获取Excel文件对象<br/>    rwb = Workbook.getWorkbook(stream);<br/>    <br/>    //获取文件的指定工作表 默认的第一个<br/>    Sheet sheet = rwb.getSheet(0);  <br/>   <br/>    //行数(表头的目录不需要，从1开始)<br/>    for(int i=0; i&lt;sheet.getRows(); i++){<br/>     <br/>     //创建一个数组 用来存储每一列的值<br/>     String[] str = new String[sheet.getColumns()];<br/>     <br/>     //列数<br/>     for(int j=0; j&lt;sheet.getColumns(); j++){<br/>     <br/>      //获取第i行，第j列的值<br/>      cell = sheet.getCell(j,i);    <br/>      str[j] = cell.getContents();<br/>      <br/>     }<br/>     //把刚获取的列存入list<br/>     list.add(str);<br/>    }<br/>    for(int i=0;i&lt;list.size();i++){<br/>     String[] str = (String[])list.get(i);<br/>     for(int j=0;j&lt;str.length;j++){<br/>      System.out.println(str[j]);<br/>     }<br/>    }<br/>  }</p>
<p style="margin:0px;padding:0px;">3.写入Excel</p>
<p style="margin:0px;padding:0px;">public static void writeExcel(){<br/>   String[] title = {&quot;编号&quot;,&quot;产品名称&quot;,&quot;产品价格&quot;,&quot;产品数量&quot;,&quot;生产日期&quot;,&quot;产地&quot;,&quot;是否出口&quot;};   <br/>         try {   <br/>             // 获得开始时间   <br/>             long start = System.currentTimeMillis();   <br/>             // 输出的excel的路径   <br/>             String filePath = &quot;d:\\testJXL.xls&quot;;   <br/>              // 创建Excel工作薄   <br/>             WritableWorkbook wwb;   <br/>              // 新建立一个jxl文件,即在d盘下生成testJXL.xls   <br/>             OutputStream os = new FileOutputStream(filePath);   <br/>             wwb=Workbook.createWorkbook(os);    <br/>             // 添加第一个工作表并设置第一个Sheet的名字   <br/>             WritableSheet sheet = wwb.createSheet(&quot;产品清单&quot;, 0);   <br/>             Label label;   <br/>             for(int i=0;i&lt;title.length;i++){   <br/>                 // Label(x,y,z) 代表单元格的第x+1列，第y+1行, 内容z   <br/>                 // 在Label对象的子对象中指明单元格的位置和内容   <br/>                 label = new Label(i,0,title[i]); <br/>                 label = new Label(i, 0, title[i], getHeader());<br/>                 // 将定义好的单元格添加到工作表中   <br/>                 sheet.addCell(label);   <br/>             }   <br/>             // 下面是填充数据   <br/>              /*   <br/>               * 保存数字到单元格，需要使用jxl.write.Number <br/>               * 必须使用其完整路径，否则会出现错误 <br/>              * */ <br/>            // 填充产品编号   <br/>             jxl.write.Number number = new jxl.write.Number(0,1,20071001);   <br/>             sheet.addCell(number);   <br/>             // 填充产品名称   <br/>              label = new Label(1,1,&quot;金鸽瓜子&quot;);   <br/>             sheet.addCell(label);   <br/>              /* <br/>             * 定义对于显示金额的公共格式 <br/>               * jxl会自动实现四舍五入 <br/>              * 例如 2.456会被格式化为2.46,2.454会被格式化为2.45 <br/>              * */ <br/>             jxl.write.NumberFormat nf = new jxl.write.NumberFormat(&quot;#,###.00&quot;);   <br/>             jxl.write.WritableCellFormat wcf = new jxl.write.WritableCellFormat(nf);   <br/>              // 填充产品价格   <br/>             jxl.write.Number nb = new jxl.write.Number(2,1,200000.45,wcf);   <br/>             sheet.addCell(nb);   <br/>             // 填充产品数量   <br/>              jxl.write.Number numb = new jxl.write.Number(3,1,200);   <br/>             sheet.addCell(numb);   <br/>             /* <br/>               * 定义显示日期的公共格式 <br/>             * 如:yyyy-MM-dd hh:mm <br/>              * */ <br/>            SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);   <br/>             String newdate = sdf.format(new Date());   <br/>             // 填充出产日期   <br/>             label = new Label(4,1,newdate);   <br/>             sheet.addCell(label);   <br/>             // 填充产地   <br/>              label = new Label(5,1,&quot;陕西西安&quot;);   <br/>             sheet.addCell(label);   <br/>             /* <br/>              * 显示布尔值 <br/>              * */ <br/>             jxl.write.Boolean bool = new jxl.write.Boolean(6,1,true);   <br/>             sheet.addCell(bool);   <br/>              /* <br/>              * 合并单元格 <br/>              * 通过writablesheet.mergeCells(int x,int y,int m,int n);来实现的 <br/>               * 表示将从第x+1列，y+1行到m+1列，n+1行合并 <br/>              *   <br/>              * */ <br/>             sheet.mergeCells(0,3,2,3);   <br/>             label = new Label(0,3,&quot;合并了三个单元格&quot;);   <br/>             sheet.addCell(label);   <br/>             /* <br/>               *   <br/>               * 定义公共字体格式 <br/>               * 通过获取一个字体的样式来作为模板 <br/>              * 首先通过web.getSheet(0)获得第一个sheet <br/>              * 然后取得第一个sheet的第二列，第一行也就是&quot;产品名称&quot;的字体   <br/>             * */ <br/>             CellFormat cf = wwb.getSheet(0).getCell(1, 0).getCellFormat();   <br/>             WritableCellFormat wc = new WritableCellFormat();   <br/>             // 设置居中   <br/>              wc.setAlignment(Alignment.CENTRE);   <br/>              // 设置边框线   <br/>            wc.setBorder(Border.ALL, BorderLineStyle.THIN);   <br/>             // 设置单元格的背景颜色   <br/>            wc.setBackground(jxl.format.Colour.RED);   <br/>             label = new Label(1,5,&quot;字体&quot;,wc);   <br/>            sheet.addCell(label);   <br/>  <br/>             // 设置字体   <br/>            jxl.write.WritableFont wfont = new jxl.write.WritableFont(WritableFont.createFont(&quot;隶书&quot;),20);   <br/>             WritableCellFormat font = new WritableCellFormat(wfont);   <br/>             label = new Label(2,6,&quot;隶书&quot;,font);   <br/>              sheet.addCell(label);   <br/>                <br/>           // 写入数据   <br/>            wwb.write();   <br/>             // 关闭文件   <br/>             wwb.close();   <br/>            long end = System.currentTimeMillis();   <br/>             System.out.println(&quot;----完成该操作共用的时间是:&quot;+(end-start)/1000);   <br/>         } catch (Exception e) {   <br/>             System.out.println(&quot;---出现异常---&quot;);   <br/>              e.printStackTrace();   <br/>        }   <br/> }</p>
<p style="margin:0px;padding:0px;">4.Excel样式</p>
<p style="margin:0px;padding:0px;">  public static WritableCellFormat getHeader(){<br/>   WritableFont font = new  WritableFont(WritableFont.TIMES, 10 ,WritableFont.BOLD);//定义字体<br/>   try {<br/>    font.setColour(Colour.BLUE);//蓝色字体<br/>   } catch (WriteException e1) {<br/>    // TODO 自动生成 catch 块<br/>    e1.printStackTrace();<br/>   }<br/>   WritableCellFormat format = new  WritableCellFormat(font);<br/>   try {<br/>    format.setAlignment(jxl.format.Alignment.CENTRE);//左右居中<br/>    format.setVerticalAlignment(jxl.format.VerticalAlignment.CENTRE);//上下居中<br/>    format.setBorder(Border.ALL,BorderLineStyle.THIN,Colour.BLACK);//黑色边框<br/>    format.setBackground(Colour.YELLOW);//黄色背景<br/>   } catch (WriteException e) {<br/>    // TODO 自动生成 catch 块<br/>    e.printStackTrace();<br/>   }<br/>   return format;<br/>  }</p>
  </div></div></div></div></div></div></div></div><br/></span>
</div></body></html> 