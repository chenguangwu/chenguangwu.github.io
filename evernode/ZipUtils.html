<html>
<head>
  <title>ZipUtils</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="9687"/>
<h1>ZipUtils</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2016/6/13 10:58</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2016/6/15 16:37</i></td></tr>
<tr><td><b>标签：</b></td><td><i>util</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div>import java.io.ByteArrayInputStream;</div><div>import java.io.ByteArrayOutputStream;</div><div>import java.io.IOException;</div><div>import java.util.zip.GZIPInputStream;</div><div>import java.util.zip.GZIPOutputStream;</div><div>import java.util.zip.ZipEntry;</div><div>import java.util.zip.ZipInputStream;</div><div>import java.util.zip.ZipOutputStream;</div><div><br/></div><div>public class ZipUtils {</div><div><br/></div><div>    /**</div><div>     *</div><div>     * 使用gzip进行压缩</div><div>     */</div><div>    public static String gzip(String primStr) {</div><div>        return gzip(primStr,&quot;UTF-8&quot;);</div><div>    }</div><div><br/></div><div>    public static String gzip(String primStr,String encode) {</div><div>        if (primStr == null || primStr.length() == 0) {</div><div>            return primStr;</div><div>        }</div><div><br/></div><div>        ByteArrayOutputStream out = new ByteArrayOutputStream();</div><div><br/></div><div>        GZIPOutputStream gzip = null;</div><div>        try {</div><div>            gzip = new GZIPOutputStream(out);</div><div>            gzip.write(primStr.getBytes(encode));</div><div>        } catch (IOException e) {</div><div>            e.printStackTrace();</div><div>        } finally {</div><div>            if (gzip != null) {</div><div>                try {</div><div>                    gzip.close();</div><div>                } catch (IOException e) {</div><div>                    e.printStackTrace();</div><div>                }</div><div>            }</div><div>        }</div><div><br/></div><div>        return new sun.misc.BASE64Encoder().encode(out.toByteArray());</div><div>    }</div><div><br/></div><div>    /**</div><div>     *</div><div>     * &lt;p&gt;</div><div>     * Description:使用gzip进行解压缩</div><div>     * &lt;/p&gt;</div><div>     *</div><div>     * @param compressedStr</div><div>     * @return</div><div>     */</div><div>    public static String gunzip(String compressedStr) {</div><div>        return gunzip(compressedStr,&quot;UTF-8&quot;);</div><div>    }</div><div><br/></div><div>    public static String gunzip(String compressedStr,String encode) {</div><div>        if (compressedStr == null) {</div><div>            return null;</div><div>        }</div><div><br/></div><div>        ByteArrayOutputStream out = new ByteArrayOutputStream();</div><div>        ByteArrayInputStream in = null;</div><div>        GZIPInputStream ginzip = null;</div><div>        byte[] compressed = null;</div><div>        String decompressed = null;</div><div>        try {</div><div>            compressed = new sun.misc.BASE64Decoder()</div><div>                    .decodeBuffer(compressedStr);</div><div>            in = new ByteArrayInputStream(compressed);</div><div>            ginzip = new GZIPInputStream(in);</div><div><br/></div><div>            byte[] buffer = new byte[1024];</div><div>            int offset = -1;</div><div>            while ((offset = ginzip.read(buffer)) != -1) {</div><div>                out.write(buffer, 0, offset);</div><div>            }</div><div>            decompressed = out.toString(encode);</div><div>        } catch (IOException e) {</div><div>            e.printStackTrace();</div><div>        } finally {</div><div>            if (ginzip != null) {</div><div>                try {</div><div>                    ginzip.close();</div><div>                } catch (IOException e) {</div><div>                }</div><div>            }</div><div>            if (in != null) {</div><div>                try {</div><div>                    in.close();</div><div>                } catch (IOException e) {</div><div>                }</div><div>            }</div><div>            if (out != null) {</div><div>                try {</div><div>                    out.close();</div><div>                } catch (IOException e) {</div><div>                }</div><div>            }</div><div>        }</div><div><br/></div><div>        return decompressed;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * 使用zip进行压缩</div><div>     *</div><div>     * @param str</div><div>     *            压缩前的文本</div><div>     * @return 返回压缩后的文本</div><div>     */</div><div>    public static final String zip(String str) {</div><div>        if (str == null)</div><div>            return null;</div><div>        byte[] compressed;</div><div>        ByteArrayOutputStream out = null;</div><div>        ZipOutputStream zout = null;</div><div>        String compressedStr = null;</div><div>        try {</div><div>            out = new ByteArrayOutputStream();</div><div>            zout = new ZipOutputStream(out);</div><div>            zout.putNextEntry(new ZipEntry(&quot;0&quot;));</div><div>            zout.write(str.getBytes());</div><div>            zout.closeEntry();</div><div>            compressed = out.toByteArray();</div><div>            compressedStr = new sun.misc.BASE64Encoder()</div><div>                    .encodeBuffer(compressed);</div><div>        } catch (IOException e) {</div><div>            compressed = null;</div><div>        } finally {</div><div>            if (zout != null) {</div><div>                try {</div><div>                    zout.close();</div><div>                } catch (IOException e) {</div><div>                }</div><div>            }</div><div>            if (out != null) {</div><div>                try {</div><div>                    out.close();</div><div>                } catch (IOException e) {</div><div>                }</div><div>            }</div><div>        }</div><div>        return compressedStr;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * 使用zip进行解压缩</div><div>     *</div><div>     * @param compressed</div><div>     *            压缩后的文本</div><div>     * @return 解压后的字符串</div><div>     */</div><div>    public static final String unzip(String compressedStr) {</div><div>        if (compressedStr == null) {</div><div>            return null;</div><div>        }</div><div><br/></div><div>        ByteArrayOutputStream out = null;</div><div>        ByteArrayInputStream in = null;</div><div>        ZipInputStream zin = null;</div><div>        String decompressed = null;</div><div>        try {</div><div>            byte[] compressed = new sun.misc.BASE64Decoder()</div><div>                    .decodeBuffer(compressedStr);</div><div>            out = new ByteArrayOutputStream();</div><div>            in = new ByteArrayInputStream(compressed);</div><div>            zin = new ZipInputStream(in);</div><div>            zin.getNextEntry();</div><div>            byte[] buffer = new byte[1024];</div><div>            int offset = -1;</div><div>            while ((offset = zin.read(buffer)) != -1) {</div><div>                out.write(buffer, 0, offset);</div><div>            }</div><div>            decompressed = out.toString();</div><div>        } catch (IOException e) {</div><div>            decompressed = null;</div><div>        } finally {</div><div>            if (zin != null) {</div><div>                try {</div><div>                    zin.close();</div><div>                } catch (IOException e) {</div><div>                }</div><div>            }</div><div>            if (in != null) {</div><div>                try {</div><div>                    in.close();</div><div>                } catch (IOException e) {</div><div>                }</div><div>            }</div><div>            if (out != null) {</div><div>                try {</div><div>                    out.close();</div><div>                } catch (IOException e) {</div><div>                }</div><div>            }</div><div>        }</div><div>        return decompressed;</div><div>    }</div><div>}</div></span>
</div></body></html> 