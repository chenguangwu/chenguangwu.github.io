<html>
<head>
  <title>MFileUtil</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="12273"/>
<h1>MFileUtil</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/1/9 14:30</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2018/1/9 14:30</i></td></tr>
<tr><td><b>标签：</b></td><td><i>util</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div>import java.io.*;</div><div>import java.text.SimpleDateFormat;</div><div>import java.util.Calendar;</div><div>import java.util.Date;</div><div>import java.util.Locale;</div><div><br/></div><div>public class MFileUtil {</div><div>    public static void appendline(String filename, String str) {</div><div>        append(filename, str + &quot;\r\n&quot;);</div><div>    }</div><div><br/></div><div>    public static void appendDaily(String filename, String str) {</div><div>        appendDaily(filename, str, &quot;utf-8&quot;);</div><div>    }</div><div><br/></div><div>    public static void appendDaily(String filename, String str, String encoding) {</div><div>        filename = filename + CalendarToString(Calendar.getInstance()).replaceAll(&quot;-&quot;, &quot;&quot;);</div><div>        File f = new File(filename);</div><div>        if (!f.exists()) {</div><div>            System.out.println(&quot;//Warning: [&quot; + filename + &quot;] not found. &quot;);</div><div><br/></div><div>            try {</div><div>                if (f.createNewFile()) {</div><div>                    System.out.println(&quot;//Warning: [&quot; + filename + &quot;]created. &quot;);</div><div>                }</div><div>            } catch (IOException e) {</div><div>                System.out.println(&quot;//Exception: &quot; + e.toString());</div><div>            }</div><div>        }</div><div><br/></div><div>        if (!f.canWrite()) {</div><div>            System.out.println(&quot;//Error: [&quot; + filename + &quot;] can not write. &quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        try {</div><div>            FileOutputStream fos = new FileOutputStream(f, true);</div><div>            fos.write(str.getBytes());</div><div>            fos.close();</div><div>        } catch (FileNotFoundException e) {</div><div>            e.printStackTrace();</div><div>        } catch (IOException e1) {</div><div>            e1.printStackTrace();</div><div>        }</div><div>    }</div><div><br/></div><div>    private static String CalendarToString(Object object) {</div><div>        Calendar c = Calendar.getInstance();</div><div>        try {</div><div>            c = (Calendar) object;</div><div>        } catch (Exception e) {</div><div>            try {</div><div>                c.setTime(StringToDate((String) object));</div><div>            } catch (Exception e1) {</div><div>                return &quot;&quot;;</div><div>            }</div><div>        }</div><div>        if (c == null) {</div><div>            return &quot;&quot;;</div><div>        }</div><div>        Date d = c.getTime();</div><div><br/></div><div>        String str_date = DateToShortString(d);</div><div>        return str_date;</div><div>    }</div><div><br/></div><div>    private static Date StringToDate(String str_date) {</div><div>        if (str_date == null) return null;</div><div>        if (str_date.indexOf(&quot;-&quot;) &gt; 0) {</div><div>            String arr_date[] = str_date.split(&quot;-&quot;);</div><div>            if (arr_date.length == 3) {</div><div>                if (arr_date[1].length() == 1) {</div><div>                    arr_date[1] = &quot;0&quot; + arr_date[1];</div><div>                }</div><div>                if (arr_date[2].length() == 1 || (arr_date[2].length() &gt; 2 &amp;&amp; arr_date[2].indexOf(&quot; &quot;) == 1)) {</div><div>                    arr_date[2] = &quot;0&quot; + arr_date[2];</div><div>                }</div><div>                str_date = arr_date[0] + &quot;-&quot; + arr_date[1] + &quot;-&quot; + arr_date[2];</div><div>            }</div><div>        }</div><div><br/></div><div>        if (str_date.trim().length() == 10) {</div><div>            str_date += &quot; 00:00:00&quot;;</div><div>        }</div><div>        SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm&quot;, Locale.US);</div><div>        Date d = new Date();</div><div>        try {</div><div>            d = sdf.parse(str_date);</div><div>        } catch (Exception e) {</div><div>            try {</div><div>                sdf = new SimpleDateFormat(&quot;yyyyMMdd&quot;, Locale.CHINA);</div><div>                d = sdf.parse(str_date);</div><div>                return d;</div><div>            } catch (Exception e1) {</div><div>                System.out.println(e1);</div><div>                return null;</div><div>            }</div><div>        }</div><div>        return d;</div><div>    }</div><div><br/></div><div>    private static String DateToShortString(Date date) {</div><div>        return DateToString(date, &quot;yyyy-MM-dd&quot;);</div><div>    }</div><div><br/></div><div>    private static String DateToString(Date date_value, String dateformat) {</div><div>        String dateStr = &quot;&quot;;</div><div>        if (date_value == null) return &quot;&quot;;</div><div>        try {</div><div>            SimpleDateFormat DF = new SimpleDateFormat(dateformat);</div><div>            dateStr = DF.format(date_value);</div><div>        } catch (Exception e) {</div><div>            e.printStackTrace();</div><div>        }</div><div>        return dateStr;</div><div>    }</div><div><br/></div><div>    public static void append(String filename, String str) {</div><div>        File f = new File(filename);</div><div>        if (!f.exists()) {</div><div>            System.out.println(&quot;//Warning: [&quot; + filename + &quot;] not found. &quot;);</div><div>            try {</div><div>                if (f.createNewFile()) {</div><div>                    System.out.println(&quot;//Warning: [&quot; + filename + &quot;]created. &quot;);</div><div>                }</div><div>            } catch (IOException e) {</div><div>                System.out.println(&quot;//Exception: &quot; + e.toString());</div><div>            }</div><div>        }</div><div><br/></div><div>        if (!f.canWrite()) {</div><div>            System.out.println(&quot;//Error: [&quot; + filename + &quot;] can not write. &quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        try {</div><div>            FileOutputStream fos = new FileOutputStream(f, true);</div><div>            fos.write(str.getBytes());</div><div>            fos.close();</div><div>        } catch (FileNotFoundException e) {</div><div>            e.printStackTrace();</div><div>        } catch (IOException e1) {</div><div>            e1.printStackTrace();</div><div>        }</div><div>    }</div><div><br/></div><div>    public static void write(String filename, String str) {</div><div>        write(filename, str, &quot;utf-8&quot;);</div><div>    }</div><div><br/></div><div>    public static void write(String filename, String str, String encoding) {</div><div>        File f = new File(filename);</div><div>        if (f.exists()) {</div><div>            System.out.println(&quot;//Warning: [&quot; + filename + &quot;] exist. rename to [/bak/&quot; + f.getName() + &quot;]. &quot;);</div><div>            File f_bak = new File(f.getParent() + &quot;/bak/&quot;);</div><div>            if (!f_bak.exists()) {</div><div>                f_bak.mkdir();</div><div>            }</div><div>            Calendar c = Calendar.getInstance();</div><div>            String d = c.get(1) + &quot;_&quot; + c.get(2) + &quot;_&quot; + c.get(5) + &quot;_&quot; + c.get(11) + &quot;_&quot; + c.get(12) + &quot;_&quot; + c.get(13);</div><div>            f_bak = new File(f.getParent() + &quot;/bak/&quot; + f.getName() + d);</div><div>            if (f_bak.exists()) {</div><div>                f_bak.delete();</div><div>            }</div><div>            f.renameTo(f_bak);</div><div>        }</div><div>        f = new File(filename);</div><div>        try {</div><div>            if (f.createNewFile()) {</div><div>                System.out.println(&quot;//Warning: [&quot; + filename + &quot;] created. &quot;);</div><div>            }</div><div>        } catch (IOException e) {</div><div>            System.out.println(&quot;//Exception: &quot; + e.toString());</div><div>        }</div><div><br/></div><div>        if (!f.canWrite()) {</div><div>            System.out.println(&quot;//Error: [&quot; + filename + &quot;] can not write. &quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        try {</div><div>            FileOutputStream fos = new FileOutputStream(f);</div><div>            fos.write(str.getBytes(encoding));</div><div>            fos.close();</div><div>        } catch (FileNotFoundException e) {</div><div>            e.printStackTrace();</div><div>        } catch (IOException e1) {</div><div>            e1.printStackTrace();</div><div>        }</div><div>    }</div><div><br/></div><div>    public static String getFileContent(String filename) {</div><div>        return getFileContent(filename, &quot;utf-8&quot;);</div><div>    }</div><div><br/></div><div>    public static String getFileContent(String filename, String encoding) {</div><div>        StringBuffer sb = new StringBuffer();</div><div>        String read = &quot;&quot;;</div><div>        File file = new File(filename);</div><div>        try {</div><div>            FileReader fileread = new FileReader(file);</div><div>            BufferedReader bufread = new BufferedReader(new InputStreamReader(new FileInputStream(filename), encoding));</div><div>            while ((read = bufread.readLine()) != null) {</div><div>                sb.append(read);</div><div>                sb.append(&quot;\r\n&quot;);</div><div>            }</div><div>        } catch (FileNotFoundException e) {</div><div>            System.out.print(&quot;Exception: File not found[&quot; + filename + &quot;]\n&quot;);</div><div>        } catch (IOException e) {</div><div>            e.printStackTrace();</div><div>        }</div><div>        return sb.toString();</div><div>    }</div><div><br/></div><div>    public static boolean isExist(String filename) {</div><div>        File f = new File(filename);</div><div>        return f.exists();</div><div>    }</div><div><br/></div><div>}</div></span>
</div></body></html> 