<html>
<head>
  <title>同事给我埋了个坑：Insert into select语句把生产服务器炸了</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="15144"/>
<h1>同事给我埋了个坑：Insert into select语句把生产服务器炸了</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2020/4/29 22:22</i></td></tr>
<tr><td><b>标签：</b></td><td><i>微信</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://mp.weixin.qq.com/s/zmbaOw46Ki9GgpTe7378rA"><i>https://mp.weixin.qq.com/s/zmbaOw46Ki9GgpTe7378rA</i></a></td></tr>
</table>
</div>
<br/>

<div><span style="margin:0px;"><div style="padding:14px 18px 10px 18px;border-radius: 4px; text-align:start;background-color:#f7f7f7;margin-bottom: 0"><span style="font-family: -webkit-standard;"><span style="font-size: 18px;"><span style="color: rgb(0, 181, 72);"><span style="background-color: #f7f7f7;">速读摘要</span></span></span></span></div><div style="padding:0px 18px;text-align:start;background-color:#f7f7f7;margin-top: 0;margin-bottom: 0"><span style="font-family: -webkit-standard;"><span style="font-size: 14px;"><span style="color: rgb(0, 0, 0);"><span style="background-color: #f7f7f7;">这天xxx接到一个需求，需要将表A的数据迁移到表B中去做一个备份。into select实现，这样就可以避免使用网络I/O，直接使用SQL依靠数据库I/O完成，这样简直不要太棒了。在本地建立一个精简版的数据库，并生成了100w的数据。在navicat中运行迁移的sql，同时开另个一个窗口插入数据，模拟下单。由于锁定的数据越来越多，就导致出现了大量支付失败。</span></span></span></span></div><div style="padding: 8px 18px 16px 16px;margin-top: 0;margin-bottom:12px;text-align:start;background-color:#f7f7f7;"><span style="font-family: -webkit-standard;"><span style="font-size: 12px;"><span style="color:#7B848C ;">原文约 </span><span style="color:#00B548;">1268 </span><span style="color: #7B848C;"> 字 </span><span style="color: #D9D9D9;white-space: pre">  |  </span><span style="color: #7B848C;">图片 </span><span style="color: #00B548;">9</span><span style="color: #7B848C;"> 张</span><span style="color: #D9D9D9;white-space: pre">  |  </span><span style="color: #7B848C;">建议阅读 </span><span style="color: #00B548;">3</span><span style="color:#7B848C ;"> 分钟</span></span><span style="color: #D9D9D9;white-space: pre">  |  </span><a href="https://static.app.yinxiang.com/embedded-web/clipper/#/Evaluating?d=2020-04-29&amp;nu=eb7ca204-d112-479d-a3b7-707c8bf273e8&amp;fr=myyxbj&amp;ud=b85fe2&amp;v=2&amp;sig=D154B69D509794C0DC18573165DCEA0F" name="___yx_evaluation___"><span style="font-size: 12px;color: #7B848C;text-decoration: none">评价反馈</span></a></span></div>
<div style="padding:8px 0px;margin:8px auto;max-width:700px;"> <div style="margin:0;padding:0;background-color:#fff"><div style="margin:0;padding:0"><div style="margin:0;padding:0;position:relative"><h2 style="font-weight:400;margin:0;padding:0;font-size:22px;line-height:1.4;margin-bottom:14px"> 同事给我埋了个坑：Insert into select语句把生产服务器炸了 </h2><div style="margin:0;padding:0;margin-bottom:22px;line-height:20px;font-size:0;word-wrap:break-word;word-break:break-all"><span style="padding:0;display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative"><a style="margin:0;padding:0;color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)"> JAVA技术之家 </a></span><em style="padding:0;font-style:normal;display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0);color:rgba(0,0,0,0.3)"></em></div><div style="margin:0;padding:0;overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0;__visibility:hidden"><blockquote style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:10px;border-left:3px solid #dbdbdb;color:rgba(0,0,0,0.5);font-size:15px;padding-top:4px;margin:1em 0"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;text-align:left"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;color:rgb(136,136,136)">来自：掘金，作者：不一样的科技宅</span></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;text-align:left"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;color:rgb(136,136,136)">链接：https://juejin.im/post/5e670f0151882549274a65ef</span></p></div></div></blockquote><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></h3><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:20px;color:rgb(61,167,66)"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important">前言</strong></span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">Insert into select请慎用。这天xxx接到一个需求，需要将表A的数据迁移到表B中去做一个备份。本想通过程序先查询查出来然后批量插入。但xxx觉得这样有点慢，需要耗费大量的网络I/O，决定采取别的方法进行实现。通过在Baidu的海洋里遨游，他发现了可以使用insert into select实现，这样就可以避免使用网络I/O，直接使用SQL依靠数据库I/O完成，这样简直不要太棒了。然后他就被开除了。</p><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:20px;color:rgb(61,167,66)"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important">事故发生的经过</strong></span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">由于数据数据库中<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">order_today</span>数据量过大，当时好像有700W了并且每天在以30W的速度增加。所以上司命令xxx将<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">order_today</span>内的部分数据迁移到<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">order_record</span>中，并将<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">order_today</span>中的数据删除。这样来降低<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">order_today</span>表中的数据量。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">由于考虑到会占用数据库I/O，为了不影响业务，计划是9:00以后开始迁移，但是xxx在8:00的时候，尝试迁移了少部分数据(1000条)，觉得没啥问题，就开始考虑大批量迁移。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640.jpg" type="image/jpeg" data-filename="640.jpg" style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-style:none;display:block;margin:10px auto;-webkit-tap-highlight-color:transparent"/></p><ul style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;list-style-image:none;list-style-position:outside;padding:20px 30px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;list-style:inherit;-webkit-tap-highlight-color:transparent"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;text-align:left">在迁移的过程中，应急群是先反应有小部分用户出现支付失败，随后反应大批用户出现支付失败的情况，以及初始化订单失败的情况，同时腾讯也开始报警。</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640.png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;background-position:50% 50%;background-repeat:no-repeat;border-style:none;color:inherit;cursor:zoom-in;display:block;font-size:inherit;font-variant-numeric:normal;font-variant-east-asian:normal;line-height:inherit;margin-left:auto;margin-right:auto;max-height:none;text-align:center;__visibility:visible;white-space:normal;width:auto" title=""/></p><ul style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;list-style-image:none;list-style-position:outside;padding:20px 30px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;list-style:inherit;-webkit-tap-highlight-color:transparent"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;text-align:left">然后xxx就慌了，立即停止了迁移。</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">本以为停止迁移就就可以恢复了，但是并没有。后面发生的你们可以脑补一下。</p><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></h3><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(61,167,66);font-size:20px"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important">事故还原</strong></span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">在本地建立一个精简版的数据库，并生成了100w的数据。模拟线上发生的情况。</p><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(61,167,66)"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(61,167,66);font-size:20px">建立表结构</span></strong></span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">订单表</span></p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:16px;color:rgb(62,62,62);line-height:inherit;text-align:start;background-color:rgb(255,255,255)"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-right:2px;margin-left:2px;padding:0.5em;font-size:14px;color:rgb(169,183,198);line-height:18px;border-radius:0;background:rgb(40,43,46);display:block;font-family:Consolas,Inconsolata,Courier,monospace;overflow-x:auto;letter-spacing:0;overflow-wrap:normal !important;word-break:normal !important;overflow-y:auto !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CREATE</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">TABLE</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`order_today`</span> (<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`id`</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">varchar</span>(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">32</span>) <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NOT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NULL</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'主键'</span>,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`merchant_id`</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">varchar</span>(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">32</span>) <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CHARACTER</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">SET</span> utf8 <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COLLATE</span> utf8_general_ci <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NOT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NULL</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'商户编号'</span>,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`amount`</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">decimal</span>(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">15</span>,<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">2</span>) <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NOT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NULL</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'订单金额'</span>,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`pay_success_time`</span> datetime <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NOT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NULL</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'支付成功时间'</span>,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`order_status`</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">varchar</span>(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">10</span>) <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CHARACTER</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">SET</span> utf8 <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COLLATE</span> utf8_general_ci <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NOT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NULL</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'支付状态  S：支付成功、F：订单支付失败'</span>,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`remark`</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">varchar</span>(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">100</span>) <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CHARACTER</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">SET</span> utf8 <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COLLATE</span> utf8_general_ci <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">DEFAULT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NULL</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'备注'</span>,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`create_time`</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">timestamp</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NOT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NULL</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">DEFAULT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CURRENT_TIMESTAMP</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'创建时间'</span>,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`update_time`</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">timestamp</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NOT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(174,135,250);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">NULL</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">DEFAULT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CURRENT_TIMESTAMP</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">ON</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">UPDATE</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CURRENT_TIMESTAMP</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'修改时间 -- 修改时自动更新'</span>,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  PRIMARY <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">KEY</span> (<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`id`</span>) <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">USING</span> BTREE,<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">KEY</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`idx_merchant_id`</span> (<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">`merchant_id`</span>) <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">USING</span> BTREE <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">COMMENT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'商户编号'</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>) <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">ENGINE</span>=<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">InnoDB</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">DEFAULT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CHARSET</span>=utf8;</code></pre><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">订单记录表</span></p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:16px;color:rgb(62,62,62);line-height:inherit;text-align:start;background-color:rgb(255,255,255)"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-right:2px;margin-left:2px;padding:0.5em;font-size:14px;color:rgb(169,183,198);line-height:18px;border-radius:0;background:rgb(40,43,46);display:block;font-family:Consolas,Inconsolata,Courier,monospace;overflow-x:auto;letter-spacing:0;overflow-wrap:normal !important;word-break:normal !important;overflow-y:auto !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">CREATE</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">TABLE</span> order_record <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">like</span> order_today;</code></pre><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">今日订单表数据</span></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640 [1].png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;background-position:50% 50%;background-repeat:no-repeat;border-style:none;color:inherit;cursor:zoom-in;display:block;font-size:inherit;font-variant-numeric:normal;font-variant-east-asian:normal;line-height:inherit;margin-left:auto;margin-right:auto;max-height:none;text-align:center;__visibility:visible;white-space:normal;width:auto" title=""/></p><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:20px;color:rgb(61,167,66)">模拟迁移</span></strong></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">把8号之前的数据都迁移到order_record表中去。</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:16px;color:rgb(62,62,62);line-height:inherit;text-align:start;background-color:rgb(255,255,255)"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-right:2px;margin-left:2px;padding:0.5em;font-size:14px;color:rgb(169,183,198);line-height:18px;border-radius:0;background:rgb(40,43,46);display:block;font-family:Consolas,Inconsolata,Courier,monospace;overflow-x:auto;letter-spacing:0;overflow-wrap:normal !important;word-break:normal !important;overflow-y:auto !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">INSERT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">INTO</span> order_record <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">SELECT</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>    * <br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">FROM</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>    order_today <br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">WHERE</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>    pay_success_time &lt; <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'2020-03-08 00:00:00'</span>;</code></pre><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">在navicat中运行迁移的sql,同时开另个一个窗口插入数据，模拟下单。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640 [2].png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;background-position:50% 50%;background-repeat:no-repeat;border-style:none;color:inherit;cursor:zoom-in;display:block;font-size:inherit;font-variant-numeric:normal;font-variant-east-asian:normal;line-height:inherit;margin-left:auto;margin-right:auto;max-height:none;text-align:center;__visibility:visible;white-space:normal;width:auto" title=""/></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;margin-bottom:16px;margin-top:16px;-webkit-tap-highlight-color:transparent"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640 [3].png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;background-position:50% 50%;background-repeat:no-repeat;border-style:none;color:inherit;cursor:zoom-in;display:block;font-size:inherit;font-variant-numeric:normal;font-variant-east-asian:normal;line-height:inherit;margin-left:auto;margin-right:auto;max-height:none;text-align:center;__visibility:visible;white-space:normal;width:auto" title=""/></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;text-align:center"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640 [4].png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-style:none;cursor:zoom-out;font-family:-apple-system,system-ui,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif;font-size:12px;font-variant-numeric:normal;font-variant-east-asian:normal;left:0;text-align:left;top:68.9px;transition:all 0.2s ease 0;white-space:normal;width:1440px"/></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">从上面可以发现一开始能正常插入，但是后面突然就卡住了，并且耗费了23s才成功，然后才能继续插入。这个时候已经迁移成功了，所以能正常插入了。</p><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:20px;color:rgb(61,167,66)">出现的原因</span></strong></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">在默认的事务隔离级别下：insert into order_record select * from order_today 加锁规则是：order_record表锁，order_today逐步锁（扫描一个锁一个）。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">分析执行过程。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640 [5].png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;background-position:50% 50%;background-repeat:no-repeat;border-style:none;color:inherit;cursor:zoom-in;display:block;font-size:inherit;font-variant-numeric:normal;font-variant-east-asian:normal;line-height:inherit;margin-left:auto;margin-right:auto;max-height:none;text-align:center;__visibility:visible;white-space:normal;width:auto" title=""/></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">通过观察<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">迁移sql</span>的执行情况你会发现order_today是全表扫描，也就意味着在执行insert into select from 语句时，mysql会从上到下扫描order_today内的记录并且加锁，这样一来不就和直接锁表是一样了。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">这也就可以解释，为什么一开始只有少量用户出现支付失败，后续大量用户出现支付失败，初始化订单失败等情况，因为一开始只锁定了少部分数据，没有被锁定的数据还是可以正常被修改为正常状态。由于锁定的数据越来越多，就导致出现了大量支付失败。最后全部锁住，导致无法插入订单，而出现初始化订单失败。</p><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:20px;color:rgb(61,167,66)">解决方案</span></strong></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">由于查询条件会导致order_today全表扫描，什么能避免全表扫描呢，很简单嘛，给pay_success_time字段添加一个idx_pay_suc_time<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">索引</span>就可以了，由于走索引查询，就不会出现扫描全表的情况而锁表了，只会锁定符合条件的记录。</p><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:3em"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:20px;color:rgb(61,167,66)"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important">最终的sql</strong></span></h3><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:16px;color:rgb(62,62,62);line-height:inherit;text-align:start;background-color:rgb(255,255,255)"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-right:2px;margin-left:2px;padding:0.5em;font-size:14px;color:rgb(169,183,198);line-height:18px;border-radius:0;background:rgb(40,43,46);display:block;font-family:Consolas,Inconsolata,Courier,monospace;overflow-x:auto;letter-spacing:0;overflow-wrap:normal !important;word-break:normal !important;overflow-y:auto !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">INSERT</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">INTO</span> order_record <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">SELECT</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>    * <br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">FROM</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>    order_today <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">FORCE</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">INDEX</span> (idx_pay_suc_time)<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(248,35,117);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">WHERE</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:inherit;line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important"/>    pay_success_time &lt;= <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:inherit;color:rgb(238,220,112);line-height:inherit;overflow-wrap:inherit !important;word-break:inherit !important">'2020-03-08 00:00:00'</span>;</code></pre><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">执行过程</span></p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640 [6].png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;background-position:50% 50%;background-repeat:no-repeat;border-style:none;color:inherit;cursor:zoom-in;display:block;font-size:inherit;font-variant-numeric:normal;font-variant-east-asian:normal;line-height:inherit;margin-left:auto;margin-right:auto;max-height:none;text-align:center;__visibility:visible;white-space:normal;width:auto" title=""/></p><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:3em"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(61,167,66)"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(61,167,66);font-size:20px">总结</span></strong></span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal">使用insert into tablA select * from tableB语句时，一定要确保tableB后面的where，order或者其他条件，都需要有对应的<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:700;-webkit-tap-highlight-color:transparent">索引</span>，来避免出现tableB全部记录被锁定的情况。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(34,34,34);font-family:&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;WenQuanYi Micro Hei&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif;font-size:16px;font-variant-numeric:normal;font-variant-east-asian:normal;margin-bottom:16px;margin-top:16px;text-align:left;-webkit-tap-highlight-color:transparent;white-space:normal"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(62,62,62);font-size:15px;letter-spacing:0.544px;white-space:normal;widows:1;word-spacing:2px;background-color:rgb(255,255,255);font-family:-apple-system-font,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei UI&quot;,&quot;Microsoft YaHei&quot;,Arial,sans-serif;caret-color:rgb(51,51,51);font-weight:700;text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-family:微软雅黑;font-size:16px;letter-spacing:0.544px;word-spacing:1px;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(0,82,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="同事给我埋了个坑：Insert into select语句把生产服务器炸了_files/640.gif" type="image/gif" data-filename="640.gif" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;background-color:rgb(238,237,235);border-width:1px;border-style:solid;border-color:rgb(238,237,235);background-size:22px;background-position:center center;background-repeat:no-repeat;color:rgb(62,62,62);letter-spacing:0.544px;border-radius:4px;box-sizing:border-box !important;overflow-wrap:break-word !important;__visibility:visible !important;width:400px !important"/></span></strong></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;color:rgb(62,62,62);font-size:15px;letter-spacing:0.544px;white-space:normal;widows:1;word-spacing:2px;background-color:rgb(255,255,255);font-family:-apple-system-font,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei UI&quot;,&quot;Microsoft YaHei&quot;,Arial,sans-serif;caret-color:rgb(51,51,51);font-weight:700;text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-family:微软雅黑;font-size:16px;letter-spacing:0.544px;word-spacing:1px;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(0,82,255);box-sizing:border-box !important;overflow-wrap:break-word !important">欢迎关注</span></strong></p></div></div><ul style="margin:0;padding:0"></ul><div style="margin:0;padding:0;padding-top:15px;overflow:hidden;line-height:32px;font-size:15px"><div style="margin:0;padding:0;display:flex"><span style="margin:0;padding:0;float:right;margin-left:16px;color:#576b95;__visibility:hidden"><span style="margin:0;-webkit-appearance:none;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0;background-color:transparent;border:0;display:inline-block;vertical-align:middle;white-space:nowrap;padding:0;font-size:15px;font-family:inherit;line-height:2.13333333;color:#576b95"><span style="margin:0;padding:0">在看</span><span style="margin:0;padding:0;font-size:15px;margin-left:.2em"></span></span></span></div></div></div></div></div></span>
</div></body></html> 