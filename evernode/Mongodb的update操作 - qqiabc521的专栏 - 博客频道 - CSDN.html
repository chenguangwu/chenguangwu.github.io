<html>
<head>
  <title>Mongodb的update操作 - qqiabc521的专栏 - 博客频道 - CSDN.NET</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="9532"/>
<h1>Mongodb的update操作 - qqiabc521的专栏 - 博客频道 - CSDN.NET</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2016/7/27 9:22</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://blog.csdn.net/qqiabc521/article/details/6325203"><i>http://blog.csdn.net/qqiabc521/article/details/6325203</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px"><div><div style="color:rgb(51, 51, 51);text-align:center;font-size:12px;font-family:Arial, Console, Verdana, 'Courier New';background:url(http://static.blog.csdn.net/skin/default/images/body_bg.gif) 0px 20px repeat-x;"><div style="background:url(http://static.blog.csdn.net/skin/default/images/head_bg.jpg) 50% 0% no-repeat;"><div style="overflow:hidden;border-radius:8px;text-align:left;background:rgb(255, 255, 255);"><div style="overflow:hidden;border-radius:4px;"><div><div style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:9616px;">
    <div style="line-height:30px;display:block;color:rgb(0, 0, 0);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:20px;margin:5px 0px;font-family:'Microsoft YaHei';border:0px none rgb(0, 0, 0);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:33px;">   
         <span style="display:inline-block;width:19px;height:19px;margin:0px 2px 0px 0px;vertical-align:middle;background:url(http://static.blog.csdn.net/images/ico_Original.gif) 0px 0px no-repeat;border:0px none rgb(0, 0, 0);background-color:rgba(0, 0, 0, 0);background-image:url(http://static.blog.csdn.net/images/ico_Original.gif);box-shadow:none;"></span>


    <h1 style="font-family:'Microsoft YaHei';display:inline;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:20px;line-height:30px;font-style:normal;vertical-align:middle;margin:0px;padding:0px;border:0px none rgb(0, 0, 0);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">
        <span style="border:0px none rgb(0, 0, 0);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"><a href="http://blog.csdn.net/qqiabc521/article/details/6325203" style="color:rgb(0, 0, 0);text-decoration:none;border:0px none rgb(0, 0, 0);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">
        Mongodb的update操作            
        </a></span>
    </h1>
<span style="color:rgb(0, 0, 0);font-style:normal;font-variant:normal;font-weight:normal;font-size:20px;line-height:30px;font-family:'Microsoft YaHei';display:block;height:0px;clear:both;visibility:hidden;">.</span></div>

   

        <div style="border-bottom-style:solid;padding:0px 20px 5px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:22px;font-family:Arial;text-align:right;display:block;color:rgb(153, 153, 153);border-bottom-width:1px;border-bottom-color:rgb(237, 237, 237);margin:0px -20px;overflow:hidden;border:;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:44px;">
        <div style="width:708px;float:left;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;height:22px;">
            <span style="margin:0px 5px;float:left;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:293px;height:22px;">
            标签：
              <a href="http://www.csdn.net/tag/mongodb" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:52px;height:22px;" target="_blank">mongodb</a><a href="http://www.csdn.net/tag/%e6%96%87%e6%a1%a3" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:24px;height:22px;" target="_blank">文档</a><a href="http://www.csdn.net/tag/comments" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:56px;height:22px;" target="_blank">comments</a><a href="http://www.csdn.net/tag/null" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:20px;height:22px;" target="_blank">null</a><a href="http://www.csdn.net/tag/sql" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:16px;height:22px;" target="_blank">sql</a><a href="http://www.csdn.net/tag/shell" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:26px;height:22px;" target="_blank">shell</a>
            </span>
        </div>
        <div style="border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:44px;">
            <span style="margin:0px 5px 0px 0px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">2011-04-15 11:34</span>
            <span style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(http://static.blog.csdn.net/images/ico_view.png) 0% 50% no-repeat;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:url(http://static.blog.csdn.net/images/ico_view.png);box-shadow:none;" title="阅读次数">67789人阅读</span>
            <span style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(http://static.blog.csdn.net/images/ico_comm.png) 0% 50% no-repeat;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:url(http://static.blog.csdn.net/images/ico_comm.png);box-shadow:none;" title="评论次数"> <a href="http://blog.csdn.net/qqiabc521/article/details/6325203#comments" style="color:rgb(51, 102, 153);text-decoration:none;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">评论</a>(1)</span>
            <span style="margin:0px 5px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"> <a href="#" style="color:rgb(51, 102, 153);text-decoration:none;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" title="收藏">收藏</a></span>
             <span style="margin:0px 5px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"> <a href="http://blog.csdn.net/qqiabc521/article/details/6325203#report" style="color:rgb(51, 102, 153);text-decoration:none;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" title="举报">举报</a></span>

        </div>
    <span style="color:rgb(153, 153, 153);font-style:normal;font-variant:normal;font-weight:normal;font-size:12px;line-height:22px;font-family:Arial;text-align:right;display:block;height:0px;clear:both;visibility:hidden;">.</span></div>
    
    
    
      
        <div style="padding:20px 0px;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:42px;">         
            <p style="color:rgb(102, 102, 102);height:14px;border-left-style:solid;border-left-width:3px;border-left-color:rgb(228, 28, 30);padding-left:10px;line-height:14px;font-size:14px;border:;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:695px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
        </div>

  

  
  
     

<div style="font-family:Arial;margin:20px 0px 0px;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:14px;line-height:26px;font-style:normal;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:9156px;">
<div style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:9156px;">在前面的文章“<a href="http://hi.baidu.com/farmerluo/blog/item/2d15e95027aa86501138c27a.html" style="color:rgb(51, 102, 153);text-decoration:none;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" target="_blank"><span style="color:#4c7d08;border:0px none rgb(76, 125, 8);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">mongodb 查询的语法</span></a>”里，我介绍了Mongodb的常用查询语法，Mongodb的update操作也有点复杂，我结合自己的使用经验，在这里介绍一下，给用mongodb的朋友看看，也方便以后自己用到的时候查阅：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>注：在这篇文章及上篇文章内讲的语法介绍都是在mongodb shell环境内的，和真正运用语言编程（如java,php等）使用时，在使用方法上会有一些差别，但语法(如查询条件，$in,$inc等)是一样的。<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>本文是参考<a href="http://www.mongodb.org/display/DOCS/Updating" style="color:rgb(51, 102, 153);text-decoration:none;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" target="_blank"><span style="color:#4c7d08;border:0px none rgb(76, 125, 8);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">官方文档</span></a>来介绍的，之所以有官方文档还要在这介绍，一方面是就当翻译，毕竟每次要用时去看英文文档比较累，第二是官方文档讲解比较简单，有时光看官方文档不好理解，我在实际操作的情况下可以做些补充。<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>好了，不多说了，下面正式开始：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>mongodb更新有两个命令：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">1).update()命令</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.collection.update( criteria, objNew, upsert, multi )<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>criteria : update的查询条件，类似sql update查询内where后面的<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>objNew   : update的对象和一些更新的操作符（如$,$inc...）等，也可以理解为sql update查询内set后面的<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>upsert   : 这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>multi    : mongodb默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.test0.update( { &quot;count&quot; : { $gt : 1 } } , { $set : { &quot;test2&quot; : &quot;OK&quot;} } ); 只更新了第一条记录<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.test0.update( { &quot;count&quot; : { $gt : 3 } } , { $set : { &quot;test2&quot; : &quot;OK&quot;} },false,true ); 全更新了<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.test0.update( { &quot;count&quot; : { $gt : 4 } } , { $set : { &quot;test5&quot; : &quot;OK&quot;} },true,false ); 只加进去了第一条<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.test0.update( { &quot;count&quot; : { $gt : 5 } } , { $set : { &quot;test5&quot; : &quot;OK&quot;} },true,true ); 全加进去了<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.test0.update( { &quot;count&quot; : { $gt : 15 } } , { $inc : { &quot;count&quot; : 1} },false,true );全更新了<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.test0.update( { &quot;count&quot; : { $gt : 10 } } , { $inc : { &quot;count&quot; : 1} },false,false );只更新了第一条<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">2).save()命令</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.collection.save( x )<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>x就是要更新的对象，只能是单条记录。<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>如果在collection内已经存在一个和x对象相同的&quot;_id&quot;的记录。mongodb就会把x对象替换collection内已经存在的记录，否则将会插入x对象，如果x内没有_id,系统会自动生成一个再插入。相当于上面update语句的upsert=true,multi=false的情况。<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.test0.save({count:40,test1:&quot;OK&quot;}); #_id系统会生成<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>db.test0.save({_id:40,count:40,test1:&quot;OK&quot;}); #如果test0内有_id等于40的，会替换，否则插入。<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>mongodb的更新操作符：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">1) $inc</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>用法：{ $inc : { field : value } }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>意思对一个数字字段field增加value，例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 16, &quot;test1&quot; : &quot;TESTTEST&quot;, &quot;test2&quot; : &quot;OK&quot;, &quot;test3&quot; : &quot;TESTTEST&quot;, &quot;test4&quot; : &quot;OK&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $inc : { &quot;count&quot; : 1 } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 17, &quot;test1&quot; : &quot;TESTTEST&quot;, &quot;test2&quot; : &quot;OK&quot;, &quot;test3&quot; : &quot;TESTTEST&quot;, &quot;test4&quot; : &quot;OK&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $inc : { &quot;count&quot; : 2 } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 19, &quot;test1&quot; : &quot;TESTTEST&quot;, &quot;test2&quot; : &quot;OK&quot;, &quot;test3&quot; : &quot;TESTTEST&quot;, &quot;test4&quot; : &quot;OK&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $inc : { &quot;count&quot; : -1 } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : &quot;TESTTEST&quot;, &quot;test2&quot; : &quot;OK&quot;, &quot;test3&quot; : &quot;TESTTEST&quot;, &quot;test4&quot; : &quot;OK&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">2) $set</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>用法：{ $set : { field : value } }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>就是相当于sql的set field = value，全部数据类型都支持$set。例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $set : { &quot;test1&quot; : &quot;testv1&quot;,&quot;test2&quot; : &quot;testv2&quot;,&quot;test3&quot; : &quot;testv3&quot;,&quot;test4&quot; : &quot;testv4&quot; } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : &quot;testv1&quot;, &quot;test2&quot; : &quot;testv2&quot;, &quot;test3&quot; : &quot;testv3&quot;, &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">3) $unset</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>用法：{ $unset : { field : 1} }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>顾名思义，就是删除字段了。例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $unset : { &quot;test1&quot;:1 } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test2&quot; : &quot;testv2&quot;, &quot;test3&quot; : &quot;testv3&quot;, &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $unset : { &quot;test2&quot;: 0 } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test3&quot; : &quot;testv3&quot;, &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $unset : { &quot;test3&quot;:asdfasf } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>Fri May 14 16:17:38 JS Error: ReferenceError: asdfasf is not defined (shell):0<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $unset : { &quot;test3&quot;:&quot;test&quot; } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>没看出field : 1里面的1是干什么用的，反正只要有东西就行。<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">4) $push</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>
<pre style="white-space:pre-wrap;word-wrap:break-word;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:598px;">用法：{ $push : { field : value } }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>把value追加到field里面去，field一定要是数组类型才行，如果field不存在，会新增一个数组类型加进去。例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $set : { &quot;test1&quot; : [&quot;aaa&quot;,&quot;bbb&quot;] } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;aaa&quot;, &quot;bbb&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $push : { &quot;test1&quot;: &quot;ccc&quot; } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $push : { &quot;test2&quot;: &quot;ccc&quot; } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot; ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $push : { &quot;test1&quot;: [&quot;ddd&quot;,&quot;eee&quot;] } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;, [ &quot;ddd&quot;, &quot;eee&quot; ] ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }</pre>
<strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">5) $pushAll</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>用法：{ $pushAll : { field : value_array } }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>同$push,只是一次可以追加多个值到一个数组字段内。例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;, [ &quot;ddd&quot;, &quot;eee&quot; ] ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $pushAll : { &quot;test1&quot;: [&quot;fff&quot;,&quot;ggg&quot;] } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;, [ &quot;ddd&quot;, &quot;eee&quot; ], &quot;fff&quot;, &quot;ggg&quot; ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">6)  $addToSet</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>
<pre style="white-space:pre-wrap;word-wrap:break-word;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:2470px;">用法：{ $addToSet : { field : value } }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>增加一个值到数组内，而且只有当这个值不在数组内才增加。例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $addToSet : { &quot;test1&quot;: {$each : [&quot;444&quot;,&quot;555&quot;] } } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;aaa&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;bbb&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ccc&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;ddd&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;eee&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;fff&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ggg&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;111&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;222&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;444&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;555&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $addToSet : { &quot;test1&quot;: {$each : [&quot;444&quot;,&quot;555&quot;] } } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;aaa&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;bbb&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ccc&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;ddd&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;eee&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;fff&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ggg&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;111&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;222&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;444&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;555&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $addToSet : { &quot;test1&quot;: [&quot;444&quot;,&quot;555&quot;]  } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;aaa&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;bbb&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ccc&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;ddd&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;eee&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;fff&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ggg&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;111&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;222&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;444&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;555&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;444&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;555&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ]<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $addToSet : { &quot;test1&quot;: [&quot;444&quot;,&quot;555&quot;]  } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;aaa&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;bbb&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ccc&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;ddd&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;eee&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;fff&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ggg&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;111&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;222&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;444&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;555&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;444&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;555&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ]<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">7) $pop</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>删除数组内的一个值<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>用法：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>删除最后一个值：{ $pop : { field : 1  } }</pre>
<pre style="white-space:pre-wrap;word-wrap:break-word;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:2730px;">删除第一个值：{ $pop : { field : -1  } }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>注意，只能删除一个值，也就是说只能用1或-1，而不能用2或-2来删除两条。mongodb 1.1及以后的版本才可以用，例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;bbb&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ccc&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;ddd&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;eee&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;fff&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ggg&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;111&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;222&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;444&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $pop : { &quot;test1&quot;: -1 } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ccc&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;ddd&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;eee&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;fff&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;ggg&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        [<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;111&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>                &quot;222&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        ],<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>        &quot;444&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $pop : { &quot;test1&quot;: 1 } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;ccc&quot;, [ &quot;ddd&quot;, &quot;eee&quot; ], &quot;fff&quot;, &quot;ggg&quot;, [ &quot;111&quot;, &quot;222&quot; ] ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">8) $pull</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>用法：$pull : { field : value } }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>从数组field内删除一个等于value值。例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;ccc&quot;, [ &quot;ddd&quot;, &quot;eee&quot; ], &quot;fff&quot;, &quot;ggg&quot;, [ &quot;111&quot;, &quot;222&quot; ] ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;,<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $pull : { &quot;test1&quot;: &quot;ggg&quot; } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;ccc&quot;, [ &quot;ddd&quot;, &quot;eee&quot; ], &quot;fff&quot;, [ &quot;111&quot;, &quot;222&quot; ] ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/> : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">9) $pullAll</strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>用法：{ $pullAll : { field : value_array } }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>同$pull,可以一次删除数组内的多个值。例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ &quot;ccc&quot;, [ &quot;ddd&quot;, &quot;eee&quot; ], &quot;fff&quot;, [ &quot;111&quot;, &quot;222&quot; ] ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot;<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/> : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.update( { &quot;_id&quot; : 15 } , { $pullAll : { &quot;test1&quot;: [ &quot;ccc&quot; , &quot;fff&quot; ] } } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; db.test0.find( { &quot;_id&quot; : 15 } );<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ &quot;_id&quot; : { &quot;floatApprox&quot; : 15 }, &quot;count&quot; : 18, &quot;test1&quot; : [ [ &quot;ddd&quot;, &quot;eee&quot; ], [ &quot;111&quot;, &quot;222&quot; ] ], &quot;test2&quot; : [ &quot;ccc&quot; ], &quot;test4&quot; : &quot;testv4&quot;, &quot;test5&quot; : &quot;OK&quot; }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><strong style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">10) $ 操作符<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/></strong><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>$是他自己的意思，代表按条件找出的数组里面某项他自己。呵呵，比较坳口。看一下官方的例子：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.find()<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;_id&quot;</span> : ObjectId(<span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;4b97e62bf1d8c7152c9ccb74&quot;</span>), <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;title&quot;</span> : <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;ABC&quot;</span>,  <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;comments&quot;</span> : [ { <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;by&quot;</span> : <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;joe&quot;</span>, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;votes&quot;</span> : 3 }, { <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;by&quot;</span> : <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;jane&quot;</span>, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;votes&quot;</span> : 7 } ] }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.update( {'comments.by':'joe'}, {$inc:{'comments.$.votes':1}}, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">false</span>, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">true</span> )<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.find()<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;_id&quot;</span> : ObjectId(<span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;4b97e62bf1d8c7152c9ccb74&quot;</span>), <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;title&quot;</span> : <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;ABC&quot;</span>,  <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;comments&quot;</span> : [ { <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;by&quot;</span> : <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;joe&quot;</span>, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;votes&quot;</span> : 4 }, { <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;by&quot;</span> : <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;jane&quot;</span>, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;votes&quot;</span> : 7 } ] }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>需要注意的是，$只会应用找到的第一条数组项，后面的就不管了。还是看例子：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.find();<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;_id&quot;</span> : ObjectId(<span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;4b9e4a1fc583fa1c76198319&quot;</span>), <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;x&quot;</span> : [ 1, 2, 3, 2 ] }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.update({x: 2}, {$inc: {<span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;x.$&quot;</span>: 1}}, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">false</span>, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">true</span>);<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.find();<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>还有注意的是$配合$unset使用的时候，会留下一个null的数组项，不过可以用{$pull:{x:null}}删除全部是null的数组项。例：<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.insert({x: [1,2,3,4,3,2,3,4]})<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.find()<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;_id&quot;</span> : ObjectId(<span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;4bde2ad3755d00000000710e&quot;</span>), <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;x&quot;</span> : [ 1, 2, 3, 4, 3, 2, 3, 4 ] }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.update({x:3}, {$unset:{<span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;x.$&quot;</span>:1}})<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>&gt; t.find()<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;_id&quot;</span> : ObjectId(<span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;4bde2ad3755d00000000710e&quot;</span>), <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;x&quot;</span> : [ 1, 2, <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">null</span>, 4, 3, 2, 3, 4 ] }<br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/><br style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"/>{ <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;_id&quot;</span> : ObjectId(<span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;4b9e4a1fc583fa1c76198319&quot;</span>), <span style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">&quot;x&quot;</span> : [ 1, 3, 3, 2 ] }</pre>
</div>   
</div>









<div style="zoom:1;float:right;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:138px;height:28px;">
<a href="http://blog.csdn.net/qqiabc521/article/details/6325203#" style="height:16px;color:rgb(51, 51, 51);background-image:url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=d754dcc0.png);background-position:0 0 !important;float:left;font-size:12px;padding-left:17px;line-height:16px;text-decoration:none;cursor:pointer;margin:6px 6px 6px 0px;background-repeat:no-repeat;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);box-shadow:none;width:0px;"></a>
<a href="http://blog.csdn.net/qqiabc521/article/details/6325203#" style="cursor:pointer;color:rgb(51, 102, 153);background-position:0 -52px !important;float:left;font-size:12px;padding-left:17px;line-height:16px;height:16px;text-decoration:none;margin:6px 6px 6px 0px;background-image:url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=ba7acbd3.png);background-repeat:no-repeat;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);box-shadow:none;width:0px;" title="分享到QQ空间"></a>
<a href="http://blog.csdn.net/qqiabc521/article/details/6325203#" style="cursor:pointer;color:rgb(51, 102, 153);background-position:0 -104px !important;float:left;font-size:12px;padding-left:17px;line-height:16px;height:16px;text-decoration:none;margin:6px 6px 6px 0px;background-image:url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=ba7acbd3.png);background-repeat:no-repeat;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);box-shadow:none;width:0px;" title="分享到新浪微博"></a>
<a href="http://blog.csdn.net/qqiabc521/article/details/6325203#" style="cursor:pointer;color:rgb(51, 102, 153);background-position:0 -260px !important;float:left;font-size:12px;padding-left:17px;line-height:16px;height:16px;text-decoration:none;margin:6px 6px 6px 0px;background-image:url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=ba7acbd3.png);background-repeat:no-repeat;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);box-shadow:none;width:0px;" title="分享到腾讯微博"></a>
<a href="http://blog.csdn.net/qqiabc521/article/details/6325203#" style="cursor:pointer;color:rgb(51, 102, 153);background-position:0 -208px !important;float:left;font-size:12px;padding-left:17px;line-height:16px;height:16px;text-decoration:none;margin:6px 6px 6px 0px;background-image:url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=ba7acbd3.png);background-repeat:no-repeat;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);box-shadow:none;width:0px;" title="分享到人人网"></a>
<a href="http://blog.csdn.net/qqiabc521/article/details/6325203#" style="cursor:pointer;color:rgb(51, 102, 153);background-position:0 -1612px !important;float:left;font-size:12px;padding-left:17px;line-height:16px;height:16px;text-decoration:none;margin:6px 6px 6px 0px;background-image:url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=ba7acbd3.png);background-repeat:no-repeat;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);box-shadow:none;width:0px;" title="分享到微信"></a>
<span style="visibility:hidden;display:block;height:0px;clear:both;">.</span></div>



   

    








 

        <div style="text-align:center;display:block;width:182px;margin:0px auto;padding:30px 0px 15px;clear:both;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;height:72px;">
            <dl style="text-align:center;display:inline-block;width:72px;height:72px;overflow:hidden;margin:0px 2px;float:left;background:rgb(153, 153, 153);color:rgb(255, 255, 255);border:0px none rgb(255, 255, 255);background-color:rgb(153, 153, 153);background-image:none;box-shadow:none;">
               
                 <dt style="line-height:30px;margin:0px;color:rgb(255, 255, 255);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:27px;padding:12px 0px 3px;font-family:'Microsoft YaHei';border:0px none rgb(255, 255, 255);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:72px;height:30px;">顶</dt>
                <dd style="line-height:22px;margin:0px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;color:rgb(255, 255, 255);font-family:Arial;border:0px none rgb(255, 255, 255);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:72px;height:22px;">2</dd>
            </dl>
           
              
            <dl style="text-align:center;display:inline-block;width:72px;height:72px;overflow:hidden;margin:0px 2px;float:left;background:rgb(153, 153, 153);color:rgb(255, 255, 255);border:0px none rgb(255, 255, 255);background-color:rgb(153, 153, 153);background-image:none;box-shadow:none;">
              
                  <dt style="line-height:30px;margin:0px;color:rgb(255, 255, 255);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:27px;padding:12px 0px 3px;font-family:'Microsoft YaHei';border:0px none rgb(255, 255, 255);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:72px;height:30px;">踩</dt>
                <dd style="line-height:22px;margin:0px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;color:rgb(255, 255, 255);font-family:Arial;border:0px none rgb(255, 255, 255);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:72px;height:22px;">0</dd>               
            </dl>
            
        <span style="text-align:center;display:block;height:0px;clear:both;visibility:hidden;">.</span></div>
     <div style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:14px;"><a href="#" style="color:rgb(51, 102, 153);text-decoration:none;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"> </a>   </div>
    <div style="border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;height:14px;"> <a href="#" style="color:rgb(51, 102, 153);text-decoration:none;border:0px none rgb(51, 102, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"> </a></div>
    

   <ul style="float:left;display:block;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:14px;line-height:24px;font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif;clear:both;color:rgb(102, 102, 102);margin:0px 0px 5px;padding:10px 0px 0px;margin-top:30px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:254px;height:58px;">
                <li style="list-style-type:none;clear:both;padding:0px 0px 3px;overflow:hidden;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:254px;height:26px;"><span style="margin-right:7px;display:block;width:52px;padding:0px 0px 0px 27px;height:26px;color:rgb(255, 255, 255);font-size:14px;float:left;background-color:rgb(153, 153, 153);background-image:url(http://static.blog.csdn.net/skin/default/images/blog-page-arr.png);background-position:9px 8px;background-repeat:no-repeat;border:0px none rgb(255, 255, 255);box-shadow:none;">上一篇</span><a href="http://blog.csdn.net/qqiabc521/article/details/6323806" style="border:0px none rgb(51, 51, 51);color:rgb(51, 51, 51);display:block;float:left;font-size:14px;text-decoration:none;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:152.516px;height:24px;">MongoDB中索引的用法</a></li>
                <li style="list-style-type:none;clear:both;padding:0px 0px 3px;overflow:hidden;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:254px;height:26px;"><span style="margin-right:7px;display:block;width:52px;padding:0px 0px 0px 27px;height:26px;color:rgb(255, 255, 255);font-size:14px;float:left;background-color:rgb(153, 153, 153);background-image:url(http://static.blog.csdn.net/skin/default/images/blog-page-arr.png);background-position:9px -22px;background-repeat:no-repeat;border:0px none rgb(255, 255, 255);box-shadow:none;">下一篇</span><a href="http://blog.csdn.net/qqiabc521/article/details/6329934" style="border:0px none rgb(51, 51, 51);color:rgb(51, 51, 51);display:block;float:left;font-size:14px;text-decoration:none;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:168px;height:24px;">为什么要用非关系数据库？</a></li>
    <span style="color:rgb(102, 102, 102);font-style:normal;font-variant:normal;font-weight:normal;font-size:14px;line-height:24px;font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif;display:block;height:0px;clear:both;visibility:hidden;">.</span></ul>

    <div style="clear:both;height:10px;border:0px none rgb(51, 51, 51);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:708px;"></div>


      
</div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 