<html>
<head>
  <title>关于poi3.17版本的一些格式设置操作问 - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4201"/>
<h1>关于poi3.17版本的一些格式设置操作问 - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/9/18 15:32</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://blog.csdn.net/Weirdo_zhu/article/details/79912606"><i>https://blog.csdn.net/Weirdo_zhu/article/details/79912606</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="outline:0px;box-sizing:border-box;"><div style="box-sizing:inherit;outline:0px;font-family:&quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, sans-serif;font-size:14px;line-height:1.57143;background-color:rgb(245, 246, 247);color:rgb(51, 51, 51);-webkit-font-smoothing:antialiased;"><div style="outline:0px;box-sizing:border-box;"><span style="box-sizing:inherit;outline:0px;"><div style="box-sizing:inherit;outline:0px;background:rgb(255, 255, 255);box-shadow:rgba(0, 0, 0, 0.05) 0px 2px 4px 0px;">
	<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;border-bottom:1px solid rgb(224, 224, 224);padding-top:16px;z-index:9;background-color:rgb(255, 255, 255);">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;">
			<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-bottom:8px;">
				<span style="border-radius:50%;display:inline-block;width:26px;height:26px;line-height:26px;text-align:center;font-size:12px;outline:0px;box-sizing:inherit;border:1px solid rgb(244, 206, 208);color:rgb(202, 12, 22);margin-right:8px;margin-top:4px;float:left;">原</span>				<h1 style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:24px;word-break:break-all;">关于poi3.17版本的一些格式设置操作问</h1>
			</div>
			<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;padding-bottom:14px;position:relative;">
				<div style="color:rgb(133, 133, 133);width:88%;height:24px;box-sizing:inherit;outline:0px;padding:0px;margin:0px;overflow:hidden;">
																				<span style="box-sizing:inherit;outline:0px;margin-right:14px;">2018年04月12日 14:08:05</span>
					<a href="https://me.csdn.net/Weirdo_zhu" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;color:rgb(120, 165, 241);margin-right:14px;" target="_blank">Weirdo_zhu</a>
						<span style="box-sizing:inherit;outline:0px;margin-right:14px;">阅读数：3285</span>
												
														<span style="box-sizing:inherit;outline:0px;margin-right:14px;margin-bottom:8px;font-size:12px;">
								<span style="box-sizing:inherit;outline:0px;margin-right:14px;color:rgb(77, 77, 77);">标签：</span>
																<a href="http://so.csdn.net/so/search/s.do?q=poi%203.17&amp;t=blog" style="text-align:center;cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;border:1px solid rgb(204, 204, 204);color:rgb(77, 77, 77);padding:0px 8px;margin-bottom:4px;border-radius:100px;word-break:break-all;line-height:21px;min-width:24px;height:21px;margin-right:8px;" target="_blank">poi 3.17																</a><a href="http://so.csdn.net/so/search/s.do?q=java&amp;t=blog" style="text-align:center;cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;border:1px solid rgb(204, 204, 204);color:rgb(77, 77, 77);padding:0px 8px;margin-bottom:4px;border-radius:100px;word-break:break-all;line-height:21px;min-width:24px;height:21px;margin-right:8px;" target="_blank">java																</a>
							<span style="background-color:rgb(255, 255, 255);outline:0px;box-sizing:inherit;letter-spacing:0px;line-height:20px;cursor:pointer;font-size:12px;top:0px;right:101px;width:45px;display:inline-block;color:rgb(51, 153, 234);margin-right:0px;">更多</span></span>
																					<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:12px;margin-top:6px;margin-bottom:0px;">
								<span style="box-sizing:inherit;outline:0px;margin-right:14px;color:rgb(77, 77, 77);">个人分类：</span>
																<a href="https://blog.csdn.net/Weirdo_zhu/article/category/7116061" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(121, 165, 229);word-break:break-all;" target="_blank">每日随笔																</a>
							</div>
																								</div>
				<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;position:absolute;top:0px;right:0px;">
														</div>
			</div>
		</div>
	</div>
	<div style="box-sizing:inherit;outline:0px;display:block;position:relative;padding-top:16px;">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;word-break:break-all;">
								            
						<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun;word-break:break-all;">
                <p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">最近在使用poi操作excel的时候遇到了一些问题，分享一下其中一些坑的点。</p><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">网上很多版本对于poi中样式中样式设置都是poi之前的操作，在poi3.17版本中并不能直接使用，自己给自己挖了一个大坑；</p><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">举个例子，在poi导出设置单元格样式的居中问题时候，网上大部分的操作代码如下：</p><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">    </p><ol start="1" style="border-right:1px solid rgb(231,229,220);word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;list-style:none;border-top:none;box-sizing:border-box;border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;text-align:left;"><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;background-color:inherit;">XSSFCellStyle cellStyle = wb.createCellStyle();   </span></span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setAlignment(XSSFCellStyle.ALIGN_CENTER); <span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,130,0);background-color:inherit;">// 居中</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;background-color:inherit;">  </span></span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setVerticalAlignment(XSSFCellStyle.VERTICAL_CENTER);<span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,130,0);background-color:inherit;">//垂直</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;background-color:inherit;"> </span></span></li></ol><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">但是使用 poi3.17版本的时候，系统会报没有 ALIGN_CENTER,VERTICAL_CENTER 这个参数，一开始以为是poi 3.17导的不完全，然后我就把所有的包都重新打了一遍，然后完全没有解决，网上百度解决方法，几乎找不动其他的方式，poi3.17的操作手册也并没有找到，最后终于在一位博主的分享中（感谢阿炳的博客园https://www.cnblogs.com/acm-bingzi/p/poi1.html。原文链接），找到了解决方案，实际实现代码如下：</p><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">  </p><ol start="1" style="border-right:1px solid rgb(231,229,220);word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;list-style:none;border-top:none;box-sizing:border-box;border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;text-align:left;"><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">XSSFCellStyle cellStyle = wb.createCellStyle();   </span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStylestyle.setAlignment(HorizontalAlignment.CENTER);<span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,130,0);background-color:inherit;">// 居中</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;background-color:inherit;">  </span></span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);;<span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,130,0);background-color:inherit;">//垂直</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;background-color:inherit;"> </span></span></li></ol><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">同时在设置边框时候，也有相应的同样问题，HSSFCellStyle 中同样报错没有其中的值</p><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p><ol start="1" style="border-right:1px solid rgb(231,229,220);word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;list-style:none;border-top:none;box-sizing:border-box;border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;text-align:left;"><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setBorderBottom(HSSFCellStyle.BORDER_THIN); //下边框    </span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setBorderLeft(HSSFCellStyle.BORDER_THIN);//左边框    </span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setBorderTop(HSSFCellStyle.BORDER_THIN);//上边框    </span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setBorderRight(HSSFCellStyle.BORDER_THIN);//右边框    </span></li></ol><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">最后修改方案如下，接用BordyStyle中的值来修改；</p><p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"></p><ol start="1" style="border-right:1px solid rgb(231,229,220);word-break:break-all;outline:0px;padding:0px;margin:0px 0px 24px;list-style:none;border-top:none;box-sizing:border-box;border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;text-align:left;"><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;background-color:rgb(248,248,248);">cellStyle</span>.setBorderBottom(BorderStyle.THIN); //下边框    </span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setBorderLeft(BorderStyle.THIN);//左边框    </span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setBorderTop(BorderStyle.THIN);//上边框    </span></li><li style="margin-top:8px;word-break:break-all;outline:0px;padding:0px;margin:0px;list-style-type:decimal;margin-left:40px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;list-style-position:outside;"><span style="outline:0px;box-sizing:border-box;word-break:break-all;border:none;color:rgb(0,0,0);background-color:inherit;">cellStyle.setBorderRight(BorderStyle.THIN);//右边框    </span></li></ol>供大家参考分享。            </div>
                <span style="display:block;height:0px;visibility:hidden;clear:both;"> </span></div>
				
        	</div>
	
</div></span></div></div></div></div><br/></div></span>
</div></body></html> 