<html>
<head>
  <title>怎么使用mongoose的geoNear - 莫纪祥的日志 - 网易博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="9578"/>
<h1>怎么使用mongoose的geoNear - 莫纪祥的日志 - 网易博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2016/7/13 18:33</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://blog.163.com/moji_xiang/blog/static/223422103201410263520531/"><i>http://blog.163.com/moji_xiang/blog/static/223422103201410263520531/</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px"><div style="overflow-x:auto;overflow-y:scroll;text-align:center;"><div style="font-size:12px;font-family:'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;color:rgb(102, 102, 102);zoom:1;background:url(http://img.bimg.126.net/photo/JxoTlY75bpZ-mFjbsIprdA==/5773614722290757688.jpg) 0% 0% repeat rgb(255, 255, 255);"><div style="zoom:1;overflow:hidden;"><div style="zoom:1;"><div style="zoom:1;overflow:hidden;background:none 50% 0% repeat transparent;"><div style="zoom:1;"><div style="zoom:1;overflow:hidden;"><div style="zoom:1;overflow:hidden;"><div style="zoom:1;overflow:hidden;background:none 50% 0% repeat rgb(255, 255, 255);"><div style="zoom:1;"><div style="overflow:hidden;"><div><div><div style="text-align:left;border:;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:2284.67px;">
        <div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:109px;">
	      <div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:68px;">
	      	<div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:68px;">
		      <h3 style="margin:0px;overflow:hidden;white-space:normal;word-wrap:break-word;word-break:break-all;font-size:16px;line-height:24px;text-align:left;padding:0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;"><span style="font-size:26px;font-weight:bold;font-family:'Hiragino Sans GB W3', 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, Arial, Helvetica, simsun, 宋体;line-height:38px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">怎么使用mongoose的geoNear</span>  <span style="font-size:12px;font-weight:normal;color:rgb(153, 153, 153);background-color:rgb(238, 238, 238);border:0px none rgb(153, 153, 153);background-image:none;box-shadow:none;"></span></h3>
		      <p style="border:0px none rgb(153, 153, 153);zoom:1;padding:0px;text-align:left;color:rgb(153, 153, 153);line-height:20px;margin:0px 0px 10px;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:20px;">
		        <span style="float:left;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:339px;height:20px;">
		          
		          <span style="margin:0px 2px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">2014-11-26 15:05:20</span><span style="margin:0px 2px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">|  分类：</span>
		          <a href="http://blog.163.com/moji_xiang/blog/#m=0&amp;t=1&amp;c=fks_084075093081085067085095083095086084082071086084087067087" style="cursor:pointer;text-decoration:none;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" title="mongodb">mongodb</a>
		          <span style="margin:0px 2px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">|  标签：</span><span style="color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"><a href="http://blog.163.com/moji_xiang/blog/#m=0&amp;t=3&amp;c=mongoose" style="cursor:pointer;text-decoration:none;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">mongoose</a>  </span>
		        </span>
		        <span style="float:right;color:rgb(153, 153, 153);border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:31px;height:20px;"><span style="margin:0px 2px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">|</span><span style="cursor:pointer;text-decoration:none;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">举报</span></span>
		        <span style="float:right;color:rgb(153, 153, 153);border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:31px;height:20px;"><span style="margin:0px 2px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">|</span><span style="color:rgb(75, 159, 208);position:relative;cursor:default;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">字号</span></span><span style="cursor:pointer;float:right;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:44px;height:20px;"><span style="line-height:20px;background-position:-360px -380px;zoom:1;width:20px;height:20px;display:inline-block;background-image:url(http://b2.bst.126.net/newpage/images/icon.png?v=20120531);background-repeat:no-repeat;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);box-shadow:none;"> </span><a style="cursor:pointer;text-decoration:none;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">订阅</a></span>
		      <span style="text-align:left;color:rgb(153, 153, 153);clear:both;display:block;visibility:hidden;height:0px;">.</span></p>
		    </div>
	      </div>
	      
	      <div style="height:24px;line-height:24px;margin-top:-8px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;">
              <div style="float:left;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:180px;height:24px;">
                <span style="cursor:pointer;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;float:left;background-position:0px -144px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到LOFTER"> </span>
                <span style="cursor:pointer;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;float:left;background-position:0px -192px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到新浪微博"> </span>
                <span style="cursor:pointer;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;float:left;background-position:0px -240px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到QQ空间"> </span>
                <span style="cursor:pointer;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;float:left;background-position:0px -288px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到腾讯微博"> </span>
                <div style="background-position:0px -336px;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;cursor:pointer;float:left;position:relative;zoom:1;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到微信">
<div style="text-align:left;color:rgb(153, 153, 153);position:absolute;left:-22px;bottom:28px;width:242px;height:113px;visibility:hidden;cursor:default;background:url(http://blog.163.com/newpage/images/redesign2014/code2dbg24.png) 0px 0px no-repeat;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/code2dbg24.png);box-shadow:none;">
    <img src="怎么使用mongoose的geoNear - 莫纪祥的日志 - 网易博客_files/Image.png" type="image/png" data-filename="Image.png" height="84" style="float:left;width:84px;height:84px;margin:11px -108px 0px 11px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" width="84"/>
    <div style="margin:30px 0px 0px 108px;color:rgb(119, 119, 119);font-size:12px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:48px;">
        <p style="margin:0px 0px 10px;padding:0px;line-height:24px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:24px;">用微信  “扫一扫”</p>
        <p style="margin:0px 0px 10px;padding:0px;line-height:24px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:24px;">将文章分享到朋友圈。</p>
    </div>
    <a style="color:rgb(102, 102, 102);border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"> </a>
</div>
                </div>
                <div style="background-position:0px -384px;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;cursor:pointer;float:left;position:relative;zoom:1;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到易信">
<div style="text-align:left;color:rgb(153, 153, 153);position:absolute;left:-22px;bottom:28px;width:242px;height:113px;visibility:hidden;cursor:default;background:url(http://blog.163.com/newpage/images/redesign2014/code2dbg24.png) 0px 0px no-repeat;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/code2dbg24.png);box-shadow:none;">
    <img src="怎么使用mongoose的geoNear - 莫纪祥的日志 - 网易博客_files/Image [1].png" type="image/png" data-filename="Image.png" height="84" style="float:left;width:84px;height:84px;margin:11px -108px 0px 11px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" width="84"/>
    <div style="margin:30px 0px 0px 108px;color:rgb(119, 119, 119);font-size:12px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:48px;">
        <p style="margin:0px 0px 10px;padding:0px;line-height:24px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:24px;">用易信  “扫一扫”</p>
        <p style="margin:0px 0px 10px;padding:0px;line-height:24px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:24px;">将文章分享到朋友圈。</p>
    </div>
    <a style="color:rgb(102, 102, 102);border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"> </a>
</div>
                </div>
              </div>
              <a href="http://www.lofter.com/app?act=qbbkrzydb_20150408_01" style="text-decoration:none;float:right;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:77px;height:24px;" target="_blank">  下载LOFTER</a>
              <a href="http://yxp.163.com/" style="text-decoration:none;float:right;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:69px;height:24px;" target="_blank">我的照片书  |</a>
          </div>
          
        </div>

        <div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:0px;">
        
        </div>

        <div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:0px;"></div>
        <div style="color:rgb(102, 102, 102);margin:15px 0px;overflow:hidden;line-height:175%;font-size:16px;text-align:left;word-wrap:break-word;padding:5px 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:2028.67px;"><div style="line-height:175%;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:2003.72px;"><h4 style="border:0px none rgb(102, 102, 102);line-height:175%;padding:0px;font-weight:bold;font-size:1.2em;margin:1.3em 0px 1em;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;">起因</h4>
<p style="margin:1.2em 0px !important;padding:0px;line-height:175%;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:168px;">在开发的时候碰到一个情况，数据源有100个景点，需要对给出的一个点，求距离它最近的景点，并且在前端下拉翻页的过程中，依距离顺序依次显示出来。大众点评做出了这个效果，但是以我现阶段的经验，想不出比较完美的解决方案。尤其是处理下拉翻页还能保证排序的效果，这一点是需要先对所有的点求距离，然后将所有点进行排序然后输出吗？这样效率不低吗？后来想到，mongodb有一个查询操作是geoNear，于是思考通过这种方案来解决排序效率的问题。</p>
<h4 style="border:0px none rgb(102, 102, 102);line-height:175%;padding:0px;font-weight:bold;font-size:1.2em;margin:1.3em 0px 1em;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;">过程</h4>
<p style="margin:1.2em 0px !important;padding:0px;line-height:175%;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:28px;">在网上查了一下，大概需要三步：</p>
<ol style="line-height:175%;margin:1.2em 0px;padding:0px;padding-left:2em;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:226.781px;">
<li style="line-height:175%;margin:0.5em 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:28px;">确保有<code style="border:1px solid rgb(234, 234, 234);line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0px 0.3em;white-space:pre-wrap;font-size:0.85em;border-radius:3px;display:inline;background-color:rgb(248, 248, 248);background-image:none;box-shadow:none;">loc:[longitude, latitude]</code>属性</li>
<li style="line-height:175%;margin:0.5em 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:28px;">给<code style="border:1px solid rgb(234, 234, 234);line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0px 0.3em;white-space:pre-wrap;font-size:0.85em;border-radius:3px;display:inline;background-color:rgb(248, 248, 248);background-image:none;box-shadow:none;">loc</code>增加索引<code style="border:1px solid rgb(234, 234, 234);line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0px 0.3em;white-space:pre-wrap;font-size:0.85em;border-radius:3px;display:inline;background-color:rgb(248, 248, 248);background-image:none;box-shadow:none;">AttractionSchema.index({loc: '2d'});</code></li>
<li style="line-height:175%;margin:0.5em 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:154.781px;"><p style="margin:0.5em 0px !important;padding:0px;line-height:175%;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:28px;">使用<code style="border:1px solid rgb(234, 234, 234);line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0px 0.3em;white-space:pre-wrap;font-size:0.85em;border-radius:3px;display:inline;background-color:rgb(248, 248, 248);background-image:none;box-shadow:none;">geoNear</code></p>
<pre style="border:0px none rgb(102, 102, 102);line-height:1.2em;font-size:1em;font-family:Consolas, Inconsolata, Courier, monospace;margin:1.2em 0px;white-space:pre-wrap;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:107.594px;"><code style="border-radius:3px;line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0.5em 0.7em;white-space:pre;border:1px solid rgb(204, 204, 204);font-size:0.85em;display:block !important;background-color:rgb(248, 248, 248);overflow:auto;background-image:none;box-shadow:none;width:521.906px;height:92px;">Model.geoNear([1,3], { maxDistance : 5, spherical : true }, function(err,results, stats) {
     console.log(results);
});
</code></pre></li>
</ol>
<p style="margin:1.2em 0px !important;padding:0px;line-height:175%;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:28px;">或者确保有</p>
<ol style="line-height:175%;margin:1.2em 0px;padding:0px;padding-left:2em;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:364.75px;">
<li style="line-height:175%;margin:0.5em 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:108.781px;"><p style="margin:0.5em 0px !important;padding:0px;line-height:175%;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:28px;">确保有GeoJSON数据结构</p>
<pre style="border:0px none rgb(102, 102, 102);line-height:1.2em;font-size:1em;font-family:Consolas, Inconsolata, Courier, monospace;margin:1.2em 0px;white-space:pre-wrap;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:61.5938px;"><code style="border-radius:3px;line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0.5em 0.7em;white-space:pre;border:1px solid rgb(204, 204, 204);font-size:0.85em;display:block !important;background-color:rgb(248, 248, 248);overflow:auto;background-image:none;box-shadow:none;width:521.906px;height:46px;">{ &lt;location field&gt;: { type: &quot;&lt;GeoJSON type&gt;&quot; , coordinates: &lt;coordinates&gt; } }
</code></pre></li>
<li style="line-height:175%;margin:0.5em 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:28px;">增加索引<code style="border:1px solid rgb(234, 234, 234);line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0px 0.3em;white-space:pre-wrap;font-size:0.85em;border-radius:3px;display:inline;background-color:rgb(248, 248, 248);background-image:none;box-shadow:none;">AttractionSchema.index({location: '2dsphere'});</code></li>
<li style="line-height:175%;margin:0.5em 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:200.781px;"><p style="margin:0.5em 0px !important;padding:0px;line-height:175%;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:28px;">查找</p>
<pre style="border:0px none rgb(102, 102, 102);line-height:1.2em;font-size:1em;font-family:Consolas, Inconsolata, Courier, monospace;margin:1.2em 0px;white-space:pre-wrap;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:153.594px;"><code style="border-radius:3px;line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0.5em 0.7em;white-space:pre;border:1px solid rgb(204, 204, 204);font-size:0.85em;display:block !important;background-color:rgb(248, 248, 248);overflow:auto;background-image:none;box-shadow:none;width:521.906px;height:138px;"> // geoJson
 var point = { type : &quot;Point&quot;, coordinates : [9,9] };
 Model.geoNear(point, { maxDistance : 5, spherical : true }, function(err,     results, stats) {
    console.log(results);
 });
</code></pre></li>
</ol>
<h4 style="border:0px none rgb(102, 102, 102);line-height:175%;padding:0px;font-weight:bold;font-size:1.2em;margin:1.3em 0px 1em;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;">扩展</h4>
<p style="margin:1.2em 0px !important;padding:0px;line-height:175%;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:28px;">利用aggregate</p>
<pre style="border:0px none rgb(102, 102, 102);line-height:1.2em;font-size:1em;font-family:Consolas, Inconsolata, Courier, monospace;margin:1.2em 0px;white-space:pre-wrap;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:774.594px;"><code style="border-radius:3px;line-height:175%;font-family:Consolas, Inconsolata, Courier, monospace;margin:0px 0.15em;padding:0.5em 0.7em;white-space:pre;border:1px solid rgb(204, 204, 204);font-size:0.85em;display:block !important;background-color:rgb(248, 248, 248);overflow:auto;background-image:none;box-shadow:none;width:553.906px;height:759px;">models.Attraction.aggregate(
    [{
        &quot;$geoNear&quot;: {
            // &quot;near&quot;: {
            //         &quot;type&quot;: &quot;Point&quot;,
            //         &quot;coordinates&quot;: [-74.00824900000001, 40.708635]
            //     },
            &quot;near&quot;: [-74.00824900000001, 40.708635],
            &quot;maxDistance&quot;: 10000,
            &quot;distanceMultiplier&quot;: 6371,
            &quot;spherical&quot;: true,
            &quot;query&quot;:{cityid: '516cc44ce3c6a60f69000011'},
            &quot;distanceField&quot;: &quot;dist.calculated&quot;,
            &quot;includelocs&quot;:&quot;dist.location&quot;
        }
    },{

        &quot;$skip&quot;: 10
    },{
        &quot;$limit&quot;: 10
    }],
    function(err, docs) {
        if (err) {
            console.log(err);
        } else {
            docs.forEach(function(element, index){
                console.log(element.cityname + ' '+element.attractions + ' '+ element.dist.calculated);
            });
        }
        // These are not mongoose documents, but you can always cast them
    }
);
</code></pre><ul style="line-height:175%;margin:1.2em 0px;padding:0px;padding-left:2em;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:64px;">
<li style="line-height:175%;margin:0.5em 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:28px;"><a href="http://stackoverflow.com/questions/24297556/mongoose-aggregation-with-geonear" rel="nofollow" style="text-decoration:none;line-height:175%;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">how to use geoNear</a></li>
<li style="line-height:175%;margin:0.5em 0px;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:547px;height:28px;"><a href="http://stackoverflow.com/questions/25584279/combine-geonear-query-with-another-query-for-a-value" rel="nofollow" style="text-decoration:none;line-height:175%;color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">use aggregate with geoNear</a></li>
</ul>
<div style="font-size:0em;line-height:175%;width:0px;max-height:0;max-width:0;overflow:hidden;height:0px;padding:0;margin:0;border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" title="MDH:PGRpdj48c3BhbiBzdHlsZT0ibGluZS1oZWlnaHQ6IDI4cHg7Ij4jIyMjICZuYnNwO+i1t+WboDwvc3Bhbj48L2Rpdj48ZGl2PuWcqOW8gOWPkeeahOaXtuWAmeeisOWIsOS4gOS4quaDheWGte+8jOaVsOaNrua6kOaciTEwMOS4quaZr+eCue+8jOmcgOimgeWvuee7meWHuueahOS4gOS4queCue+8jOaxgui3neemu+Wug+acgOi/keeahOaZr+eCue+8jOW5tuS4lOWcqOWJjeerr+S4i+aLiee/u+mhteeahOi/h+eoi+S4re+8jOS+nei3neemu+mhuuW6j+S+neasoeaYvuekuuWHuuadpeOAguWkp+S8l+eCueivhOWBmuWHuuS6hui/meS4quaViOaenO+8jOS9huaYr+S7peaIkeeOsOmYtuauteeahOe7j+mqjO+8jOaDs+S4jeWHuuavlOi+g+WujOe+jueahOino+WGs+aWueahiOOAguWwpOWFtuaYr+WkhOeQhuS4i+aLiee/u+mhtei/mOiDveS/neivgeaOkuW6j+eahOaViOaenO+8jOi/meS4gOeCueaYr+mcgOimgeWFiOWvueaJgOacieeahOeCueaxgui3neemu++8jOeEtuWQjuWwhuaJgOacieeCuei/m+ihjOaOkuW6j+eEtuWQjui+k+WHuuWQl++8n+i/meagt+aViOeOh+S4jeS9juWQl++8n+WQjuadpeaDs+WIsO+8jG1vbmdvZGLmnInkuIDkuKrmn6Xor6Lmk43kvZzmmK9nZW9OZWFy77yM5LqO5piv5oCd6ICD6YCa6L+H6L+Z56eN5pa55qGI5p2l6Kej5Yaz5o6S5bqP5pWI546H55qE6Zeu6aKY44CCPC9kaXY+PGRpdj4jIyMjIOi/h+eoizwvZGl2PjxkaXY+5Zyo572R5LiK5p+l5LqG5LiA5LiL77yM5aSn5qaC6ZyA6KaB5LiJ5q2l77yaPC9kaXY+PGRpdj48YnI+PC9kaXY+PGRpdj4xLjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CTwvc3Bhbj7noa7kv53mnIlgbG9jOltsb25naXR1ZGUsIGxhdGl0dWRlXWDlsZ7mgKc8L2Rpdj48ZGl2PjIuPHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPue7mWBsb2Ng5aKe5Yqg57Si5byVYEF0dHJhY3Rpb25TY2hlbWEuaW5kZXgoe2xvYzogJzJkJ30pO2A8L2Rpdj48ZGl2PjMuPHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPuS9v+eUqGBnZW9OZWFyYDwvZGl2PjxkaXY+PGJyPjwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPmBgYDwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPk1vZGVsLmdlb05lYXIoWzEsM10sIHsgbWF4RGlzdGFuY2UgOiA1LCBzcGhlcmljYWwgOiB0cnVlIH0sIGZ1bmN0aW9uKGVycixyZXN1bHRzLCBzdGF0cykgezwvZGl2PjxkaXY+Jm5ic3A7ICZuYnNwOzxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQk8L3NwYW4+Y29uc29sZS5sb2cocmVzdWx0cyk7PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+fSk7PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+YGBgPC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+PC9kaXY+PGRpdj7miJbogIXnoa7kv53mnIk8L2Rpdj48ZGl2Pjxicj48L2Rpdj48ZGl2PjEuPHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPuehruS/neaciUdlb0pTT07mlbDmja7nu5PmnoQ8L2Rpdj48ZGl2Pjxicj48L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CTwvc3Bhbj5gYGA8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CTwvc3Bhbj57ICZsdDtsb2NhdGlvbiBmaWVsZCZndDs6IHsgdHlwZTogIiZsdDtHZW9KU09OIHR5cGUmZ3Q7IiAsIGNvb3JkaW5hdGVzOiAmbHQ7Y29vcmRpbmF0ZXMmZ3Q7IH0gfTwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPmBgYDwvZGl2PjxkaXY+Mi4g5aKe5Yqg57Si5byVYEF0dHJhY3Rpb25TY2hlbWEuaW5kZXgoe2xvY2F0aW9uOiAnMmRzcGhlcmUnfSk7YDwvZGl2PjxkaXY+My4g5p+l5om+PC9kaXY+PGRpdj48YnI+PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+YGBgPC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+Ly8gZ2VvSnNvbjwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPnZhciBwb2ludCA9IHsgdHlwZSA6ICJQb2ludCIsIGNvb3JkaW5hdGVzIDogWzksOV0gfTs8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CTwvc3Bhbj5Nb2RlbC5nZW9OZWFyKHBvaW50LCB7IG1heERpc3RhbmNlIDogNSwgc3BoZXJpY2FsIDogdHJ1ZSB9LCBmdW5jdGlvbihlcnIsIDxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CTwvc3Bhbj5yZXN1bHRzLCBzdGF0cykgezwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPiAmbmJzcDsgY29uc29sZS5sb2cocmVzdWx0cyk7PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+fSk7PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+YGBgPC9kaXY+PGRpdj48YnI+PC9kaXY+PGRpdj4jIyMjIOaJqeWxlTwvZGl2PjxkaXY+5Yip55SoYWdncmVnYXRlPC9kaXY+PGRpdj48YnI+PC9kaXY+PGRpdj5gYGA8L2Rpdj48ZGl2Pm1vZGVscy5BdHRyYWN0aW9uLmFnZ3JlZ2F0ZSg8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CTwvc3Bhbj5bezwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCTwvc3Bhbj4iJGdlb05lYXIiOiB7PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgkJCTwvc3Bhbj4vLyAibmVhciI6IHs8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQkJPC9zcGFuPi8vIDxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQk8L3NwYW4+InR5cGUiOiAiUG9pbnQiLDwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCQk8L3NwYW4+Ly8gPHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCTwvc3Bhbj4iY29vcmRpbmF0ZXMiOiBbLTc0LjAwODI0OTAwMDAwMDAxLCA0MC43MDg2MzVdPC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgkJCTwvc3Bhbj4vLyA8c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+fSw8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQkJPC9zcGFuPiJuZWFyIjogWy03NC4wMDgyNDkwMDAwMDAwMSwgNDAuNzA4NjM1XSw8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQkJPC9zcGFuPiJtYXhEaXN0YW5jZSI6IDEwMDAwLDwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCQk8L3NwYW4+ImRpc3RhbmNlTXVsdGlwbGllciI6IDYzNzEsPC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgkJCTwvc3Bhbj4ic3BoZXJpY2FsIjogdHJ1ZSw8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQkJPC9zcGFuPiJxdWVyeSI6e2NpdHlpZDogJzUxNmNjNDRjZTNjNmE2MGY2OTAwMDAxMSd9LDwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCQk8L3NwYW4+ImRpc3RhbmNlRmllbGQiOiAiZGlzdC5jYWxjdWxhdGVkIiw8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQkJPC9zcGFuPiJpbmNsdWRlbG9jcyI6ImRpc3QubG9jYXRpb24iPC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgkJPC9zcGFuPn08L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CTwvc3Bhbj59LHs8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQk8L3NwYW4+PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgkJPC9zcGFuPiIkc2tpcCI6IDEwPC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+fSx7PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgkJPC9zcGFuPiIkbGltaXQiOiAxMDwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPn1dLDwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JPC9zcGFuPmZ1bmN0aW9uKGVyciwgZG9jcykgezwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCTwvc3Bhbj5pZiAoZXJyKSB7PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgkJCTwvc3Bhbj5jb25zb2xlLmxvZyhlcnIpOzwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCTwvc3Bhbj59IGVsc2UgezwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCQk8L3NwYW4+ZG9jcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQsIGluZGV4KXs8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQkJCTwvc3Bhbj5jb25zb2xlLmxvZyhlbGVtZW50LmNpdHluYW1lICsgJyAnK2VsZW1lbnQuYXR0cmFjdGlvbnMgKyAnICcrIGVsZW1lbnQuZGlzdC5jYWxjdWxhdGVkKTs8L2Rpdj48ZGl2PjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CQkJPC9zcGFuPn0pOzwvZGl2PjxkaXY+PHNwYW4gY2xhc3M9IkFwcGxlLXRhYi1zcGFuIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIj4JCTwvc3Bhbj59PC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgkJPC9zcGFuPi8vIFRoZXNlIGFyZSBub3QgbW9uZ29vc2UgZG9jdW1lbnRzLCBidXQgeW91IGNhbiBhbHdheXMgY2FzdCB0aGVtPC9kaXY+PGRpdj48c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+fTwvZGl2PjxkaXY+KTs8L2Rpdj48ZGl2PmBgYDwvZGl2PjxkaXY+PGJyPjwvZGl2PjxkaXY+PGJyPjwvZGl2PjxkaXY+PGJyPjwvZGl2PjxkaXY+PGJyPjwvZGl2PjxkaXY+KjxzcGFuIGNsYXNzPSJBcHBsZS10YWItc3BhbiIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSI+CTwvc3Bhbj5baG93IHRvIHVzZSBnZW9OZWFyXShodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI0Mjk3NTU2L21vbmdvb3NlLWFnZ3JlZ2F0aW9uLXdpdGgtZ2VvbmVhcik8L2Rpdj48ZGl2Pio8c3BhbiBjbGFzcz0iQXBwbGUtdGFiLXNwYW4iIHN0eWxlPSJ3aGl0ZS1zcGFjZTpwcmUiPgk8L3NwYW4+W3VzZSBhZ2dyZWdhdGUgd2l0aCBnZW9OZWFyXSg8L2Rpdj48ZGl2Pmh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjU1ODQyNzkvY29tYmluZS1nZW9uZWFyLXF1ZXJ5LXdpdGgtYW5vdGhlci1xdWVyeS1mb3ItYS12YWx1ZSk8L2Rpdj48d2JyPg==">?</div></div></div>
        <div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:0px;"></div>

        <div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:0px;">
		</div>

        <div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:0px;">
		</div>

		<div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:0px;">
      	  <div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:0px;">
		  	<div style="border:0px none rgb(102, 102, 102);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:0px;"></div>
		  </div>
		</div>

        
		
        
        
        

        

        <div style="border:0px none rgb(75, 159, 208);zoom:1;padding:0px;text-align:left;color:rgb(75, 159, 208);line-height:20px;margin:0px;background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;height:82px;">
          
          
          <div style="margin-bottom:10px;height:32px;line-height:32px;text-align:left;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;">
            <span style="color:rgb(153, 153, 153);border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">阅读(<span style="border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">300</span>)</span><span style="margin:0px 5px;color:rgb(153, 153, 153);border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">|</span>
            <span style="color:rgb(153, 153, 153);border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">评论(<span style="border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;">0</span>)</span>
          </div>
          
          
          <div style="height:40px;line-height:40px;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:579px;">
            <div style="float:left;line-height:24px;height:24px;padding:8px 0px;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:180px;">
              
              <div style="float:left;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:180px;height:24px;">
                <span style="cursor:pointer;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;float:left;background-position:0px -144px;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到LOFTER"> </span>
                <span style="cursor:pointer;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;float:left;background-position:0px -192px;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到新浪微博"> </span>
                <span style="cursor:pointer;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;float:left;background-position:0px -240px;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到QQ空间"> </span>
                <span style="cursor:pointer;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;float:left;background-position:0px -288px;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到腾讯微博"> </span>
                <div style="background-position:0px -336px;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;cursor:pointer;float:left;position:relative;zoom:1;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到微信">
<div style="text-align:left;color:rgb(153, 153, 153);position:absolute;left:-22px;bottom:28px;width:242px;height:113px;visibility:hidden;cursor:default;background:url(http://blog.163.com/newpage/images/redesign2014/code2dbg24.png) 0px 0px no-repeat;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/code2dbg24.png);box-shadow:none;">
    <img src="怎么使用mongoose的geoNear - 莫纪祥的日志 - 网易博客_files/Image [2].png" type="image/png" data-filename="Image.png" height="84" style="float:left;width:84px;height:84px;margin:11px -108px 0px 11px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" width="84"/>
    <div style="margin:30px 0px 0px 108px;color:rgb(119, 119, 119);font-size:12px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:48px;">
        <p style="margin:0px 0px 10px;padding:0px;line-height:24px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:24px;">用微信  “扫一扫”</p>
        <p style="margin:0px 0px 10px;padding:0px;line-height:24px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:24px;">将文章分享到朋友圈。</p>
    </div>
    <a style="color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"> </a>
</div>
                </div>
                <div style="background-position:0px -384px;background:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png) -9999px -9999px no-repeat;width:24px;height:24px;padding:0px 0px 0px 6px;cursor:pointer;float:left;position:relative;zoom:1;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;" title="分享到易信">
<div style="text-align:left;color:rgb(153, 153, 153);position:absolute;left:-22px;bottom:28px;width:242px;height:113px;visibility:hidden;cursor:default;background:url(http://blog.163.com/newpage/images/redesign2014/code2dbg24.png) 0px 0px no-repeat;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/code2dbg24.png);box-shadow:none;">
    <img src="怎么使用mongoose的geoNear - 莫纪祥的日志 - 网易博客_files/Image [3].png" type="image/png" data-filename="Image.png" height="84" style="float:left;width:84px;height:84px;margin:11px -108px 0px 11px;border:0px none rgb(153, 153, 153);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;" width="84"/>
    <div style="margin:30px 0px 0px 108px;color:rgb(119, 119, 119);font-size:12px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:48px;">
        <p style="margin:0px 0px 10px;padding:0px;line-height:24px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:24px;">用易信  “扫一扫”</p>
        <p style="margin:0px 0px 10px;padding:0px;line-height:24px;border:0px none rgb(119, 119, 119);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:134px;height:24px;">将文章分享到朋友圈。</p>
    </div>
    <a style="color:rgb(75, 159, 208);border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;"> </a>
</div>
                </div>
              </div>
              
              
              
            </div>
            <div style="float:right;height:25px;line-height:25px;margin-left:0px;padding-top:6px;border:0px none rgb(75, 159, 208);background-color:rgba(0, 0, 0, 0);background-image:none;box-shadow:none;width:207px;">
              <span style="font-size:12px;cursor:pointer;background:url(http://b2.bst.126.net/newpage/images/liketolofter/likeicons24.png) -9999px -9999px no-repeat;width:34px;height:25px;line-height:25px;padding-left:29px;margin:0px 0px 0px 5px;float:right;color:rgb(255, 255, 255);text-align:left;margin-left:6px;border:0px none rgb(255, 255, 255);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;">喜欢</span>
	            <span style="font-size:12px;cursor:pointer;background:url(http://b2.bst.126.net/newpage/images/liketolofter/likeicons24.png) -9999px -9999px no-repeat;width:34px;height:25px;line-height:25px;padding-left:29px;margin:0px 0px 0px 5px;float:right;color:rgb(255, 255, 255);text-align:left;margin-left:6px;border:0px none rgb(255, 255, 255);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;">推荐</span>
	          
                <span style="font-size:12px;cursor:pointer;background:url(http://b2.bst.126.net/newpage/images/liketolofter/likeicons24.png) -9999px -9999px no-repeat;width:34px;height:25px;line-height:25px;padding-left:29px;margin:0px 0px 0px 5px;float:right;color:rgb(255, 255, 255);text-align:left;margin-left:6px;border:0px none rgb(255, 255, 255);background-color:rgba(0, 0, 0, 0);background-image:url(http://blog.163.com/newpage/images/redesign2014/bkicons24.png);box-shadow:none;">转载</span>
            </div>
          </div>
        <span style="text-align:left;color:rgb(75, 159, 208);line-height:20px;clear:both;display:block;visibility:hidden;height:0px;">.</span></div>
      </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 