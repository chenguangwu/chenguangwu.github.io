<html>
<head>
  <title>wireshark基本用法及过虑规则 - 长风大侠 - 博客频道 - CSDN.NET</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="9378"/>
<h1>wireshark基本用法及过虑规则 - 长风大侠 - 博客频道 - CSDN.NET</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2016/1/1 17:40</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://blog.csdn.net/hzhsan/article/details/43453251"><i>http://blog.csdn.net/hzhsan/article/details/43453251</i></a></td></tr>
</table>
</div>
<br/>

<div><span><br/><div style="font-size: 16px"><div><div style="font-size:12px;font-family:Arial, Console, Verdana, 'Courier New';background:url(http://static.blog.csdn.net/skin/dark1/images/body_bg.jpg) 50% 0% repeat;padding-bottom:initial;"><div><div style="text-align:left;"><div style="overflow:hidden;"><div style="background:rgb(255, 255, 255);"><div><div style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:14px;line-height:26px;font-family:Arial;">

<div style="font-family:微软雅黑;font-size:14px;line-height:1.6428571428571428;"><span style="font-family:Tahoma,Arial,sans-serif;color:#333333;">Wireshark 基本语法，基本使用方法，及包过虑规则：</span></div>
<h1 style="margin:0px;padding:0px;"><a name="t0" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><strong><span style="background-color:inherit;">1.</span><span style="background-color:inherit;">过滤IP，如来源IP或者目标IP等于某个IP</span></strong></span></span></h1>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;">
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(255,0,0);font-size:22px;line-height:1.5;font-family:Tahoma,Arial,sans-serif;"></span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">例子:</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">ip.src eq 192.168.1.107 or ip.dst eq 192.168.1.107</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">或者</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">ip.addr eq 192.168.1.107 // 都能显示来源IP和目标IP</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;"><br/>
</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
linux上运行的wireshark图形窗口截图示例，其他过虑规则操作类似，不再截图。</p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;">ip.src eq 10.175.168.182</span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"><span style="line-height:1.6428571428571428;">截图示例：</span><br style="background-color:inherit;"/>
</span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"><img alt="" height="0" src="" style="border:none;max-width:800px;background-color:inherit;display:inline-block;margin-top:8px;" width="0"></img><img src="wireshark基本用法及过虑规则 - 长风大侠 - 博客频道 - CSDN.NET_files/Center.png" type="image/png" data-filename="Center.png" alt="" height="275" style="border:none;max-width:100%;" width="775"/></span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:#ff0000;">提示： 在Filter编辑框中，收入过虑规则时，如果语法有误，框会显红色，如正确，会是绿色。</span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<br style="background-color:inherit;"/>
</p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:33px;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<h1 style="margin:0px;padding:0px;"><a name="t1" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">2.</span><span style="background-color:inherit;"><span style="background-color:inherit;">过滤端口</span></span></span></span></h1>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;"></span></span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">例子:</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.port eq 80 // 不管端口是来源的还是目标的都显示</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.port == 80</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.port eq 2722</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.port eq 80 or udp.port eq 80</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.dstport == 80 // 只显tcp协议的目标端口80</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.srcport == 80 // 只显tcp协议的来源端口80</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;">udp.port eq 15000</span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">过滤端口范围</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">tcp.port &gt;= 1 and tcp.port &lt;= 80</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><br style="background-color:inherit;"/>
</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<h1 style="margin:0px;padding:0px;"><a name="t2" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">3.</span><span style="background-color:inherit;"><span style="background-color:inherit;">过滤协议</span></span></span></span></h1>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;"></span></span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">例子:</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">udp</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">arp</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">icmp</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">http</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">smtp</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">ftp</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">dns</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">msnms</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">ip</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">ssl</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">oicq</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">bootp</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">等等</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;">排除arp包，如!arp   或者   not arp</span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"><br style="background-color:inherit;"/>
</span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<h1 style="margin:0px;padding:0px;"><a name="t3" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">4.</span><span style="background-color:inherit;"><span style="background-color:inherit;">过滤MAC</span></span></span></span></h1>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;"></span></span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">太以网头过滤</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">eth.dst == A0:00:00:04:C5:84 // 过滤目标mac</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">eth.src eq A0:00:00:04:C5:84 // 过滤来源mac</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">eth.dst==A0:00:00:04:C5:84</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">eth.dst==A0-00-00-04-C5-84</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">eth.addr eq A0:00:00:04:C5:84 // 过滤来源MAC和目标MAC都等于A0:00:00:04:C5:84的</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">less than 小于 &lt; lt </span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">小于等于 le</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">等于 eq</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">大于 gt</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">大于等于 ge</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">不等 ne</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><br style="background-color:inherit;"/>
</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<h1 style="margin:0px;padding:0px;"><a name="t4" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">5.</span><span style="background-color:inherit;"><span style="background-color:inherit;">包长度过滤</span></span></span></span></h1>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;"></span></span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">例子:</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">udp.length == 26 这个长度是指udp本身固定长度8加上udp下面那块数据包之和</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.len &gt;= 7   指的是ip数据包(tcp下面那块数据),不包括tcp本身</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">ip.len == 94 除了以太网头固定长度14,其它都算是ip.len,即从ip本身到最后</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">frame.len == 119 整个数据包长度,从eth开始到最后</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;">eth —&gt; ip or arp —&gt; tcp or udp —&gt; data</span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"><br style="background-color:inherit;"/>
</span></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<h1 style="margin:0px;padding:0px;"><a name="t5" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">6.</span><span style="background-color:inherit;">http模式过滤</span></span></span></h1>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;">
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(255,0,0);line-height:1.5;font-family:Tahoma,Arial,sans-serif;"></span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">例子:</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">http.request.method == “GET”</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">http.request.method == “POST”</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">http.request.uri == “/img/logo-edu.gif”</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">http contains “GET”</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">http contains “HTTP/1.”</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">// GET包</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">http.request.method == “GET” &amp;&amp; http contains “Host: “</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">http.request.method == “GET” &amp;&amp; http contains “User-Agent: “</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">// POST包</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">http.request.method == “POST” &amp;&amp; http contains “Host: “</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">http.request.method == “POST” &amp;&amp; http contains “User-Agent: “</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">// 响应包</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">http contains “HTTP/1.1 200 OK” &amp;&amp; http contains “Content-Type: “</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">http contains “HTTP/1.0 200 OK” &amp;&amp; http contains “Content-Type: “</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">一定包含如下</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">Content-Type:</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><br style="background-color:inherit;"/>
</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<h1 style="margin:0px;padding:0px;"><a name="t6" style="color:rgb(202, 0, 0);text-decoration:none;"></a>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">7.</span><span style="background-color:inherit;">TCP参数过滤</span></span></span></h1>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;">
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(255,0,0);line-height:1.5;font-family:Tahoma,Arial,sans-serif;"></span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.flags 显示包含TCP标志的封包。</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.flags.syn == 0x02     显示包含TCP SYN标志的封包。</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp.window_size == 0 &amp;&amp; tcp.flags.reset != 1</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;"><br style="background-color:inherit;"/>
</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<h1 style="margin:0px;padding:0px;"><a name="t7" style="color:rgb(202, 0, 0);text-decoration:none;"></a>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">8.</span><span style="background-color:inherit;">包内容过滤</span></span></span></h1>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;">
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(255,0,0);line-height:1.5;font-family:Tahoma,Arial,sans-serif;"></span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;">-----------------------------------------------</span></span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">tcp[20]表示从20开始，取1个字符</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp[20:]表示从20开始，取1个字符以上</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"></span>
<div style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;">注： 些两虚线中的内容在我的wireshark（linux）上测试未通过。</span></div>
<div style="line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;">--------------------------------------------------</span></span></div>
    </div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp[20:8]表示从20开始，取8个字符</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">tcp[offset,n]</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">udp[8:3]==81:60:03 // 偏移8个bytes,再取3个数，是否与==后面的数据相等？</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">udp[8:1]==32   如果我猜的没有错的话，应该是udp[offset:截取个数]=nValue</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">eth.addr[0:3]==00:06:5B</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">例子:</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">判断upd下面那块数据包前三个是否等于0x20 0x21 0x22</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">我们都知道udp固定长度为8</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">udp[8:3]==20:21:22</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">判断tcp那块数据包前三个是否等于0x20 0x21 0x22</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">tcp一般情况下，长度为20,但也有不是20的时候</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">tcp[8:3]==20:21:22</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">如果想得到最准确的，应该先知道tcp长度</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="font-family:Tahoma,Arial,sans-serif;line-height:1.5;"><span style="color:#ff0000;background-color:inherit;"><span style="background-color:inherit;">matches(匹配)和contains(包含某字符串)语法</span></span></span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#333333;background-color:inherit;">ip.src==192.168.1.107 and udp[8:5] </span><span style="color:#ff0000;background-color:inherit;">matches </span><span style="color:#333333;background-color:inherit;">“\\x02\\x12\\x21\\x00\\x22″
        </span><span style="color:#ff0000;background-color:inherit;">------???--------</span></span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#333333;background-color:inherit;">ip.src==192.168.1.107 and udp </span><span style="color:#ff0000;background-color:inherit;">contains </span><span style="color:#333333;background-color:inherit;">02:12:21:00:22</span></span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">ip.src==192.168.1.107 and tcp contains “GET”</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;">udp contains 7c:7c:7d:7d 匹配payload中含有0x7c7c7d7d的UDP数据包，不一定是从第一字节匹配。</span></span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"><br style="background-color:inherit;"/>
</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">--------------------------------------不理解Begin------------------------------------------------------------------------------------</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">例子:</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">得到本地qq登陆数据包(判断条件是第一个包==0x02,第四和第五个包等于0x00x22,最后一个包等于0x03)</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;">0x02 xx xx 0x00 0x22 … 0x03</span></span></div>
<div style="background-color:inherit;"><span style="color:#ff0000;background-color:inherit;">如何拼写过虑条件？？？</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">    </span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">udp[11:2]==00:00 表示命令编号为00:00</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">udp[11:2]==00:80 表示命令编号为00:80</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">当命令编号为00:80时，QQ号码为00:00:00:00</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">得到msn登陆成功账号(判断条件是”USR 7 OK “,即前三个等于USR，再通过两个0x20，就到OK,OK后面是一个字符0x20,后面就是mail了)</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">USR xx OK mail@hotmail.com</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">正确</span></div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;">msnms and tcp and ip.addr==192.168.1.107 and tcp[20:] matches “^USR\\x20[\\x30-\\x39]+\\x20OK\\x20[\\x00-\\xff]+”</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span>
<div style="color:rgb(0,0,0);font-family:微软雅黑;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">-------------------------------------<span style="line-height:1.5;">不理解End--</span>-------------------------------------------------------------------------------------</span></div>
<br style="background-color:inherit;"/>
<br style="background-color:inherit;"/>
</div>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<h1 style="margin:0px;padding:0px;"><a name="t8" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">9.</span><span style="background-color:inherit;">dns模式过滤</span></span></span></h1>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;">
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(255,0,0);line-height:1.5;font-family:Tahoma,Arial,sans-serif;"></span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="line-height:1.5;"><span style="color:#ff0000;background-color:inherit;"><br style="background-color:inherit;"/>
</span></span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<h1 style="margin:0px;padding:0px;"><a name="t9" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">10.</span><span style="background-color:inherit;">DHCP</span></span></span></h1>
<div style="font-family:微软雅黑;font-size:14px;line-height:21px;">
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(255,0,0);line-height:1.5;font-family:Tahoma,Arial,sans-serif;"></span></div>
<span style="font-family:Tahoma,Arial,sans-serif;"></span>
<div style="background-color:inherit;"><span style="color:#ff0000;background-color:inherit;">注意：DHCP协议的检索规则不是dhcp/DHCP， 而是<span style="background-color:inherit;">bootp</span></span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">以寻找伪造DHCP服务器为例，介绍Wireshark的用法。在显示过滤器中加入过滤规则，</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">显示所有非来自DHCP服务器并且bootp.type==0x02（Offer/Ack/NAK）的信息：</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;">bootp.type==0x02 and not ip.src==192.168.1.1</span></div>
<div style="background-color:inherit;color:rgb(51,51,51);line-height:1.6428571428571428;">
<span style="line-height:1.5;"><br style="background-color:inherit;"/>
</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;background-color:inherit;"></p>
<div style="background-color:inherit;line-height:1.6428571428571428;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;"></span></div>
</div>
<h1 style="margin:0px;padding:0px;"><a name="t10" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#ff0000;font-size:22px;"><span style="background-color:inherit;">11.</span><span style="background-color:inherit;">msn</span></span></span></h1>
<div style="font-family:微软雅黑;line-height:21px;">
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(255,0,0);line-height:1.5;font-family:Tahoma,Arial,sans-serif;"></span></div>
<span style="font-family:Tahoma,Arial,sans-serif;font-size:14px;"></span>
<div style="font-size:14px;color:rgb(51,51,51);line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">msnms &amp;&amp; tcp[23:1] == 20 // 第四个是0x20的msn数据包</span></div>
<div style="font-size:14px;color:rgb(51,51,51);line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">msnms &amp;&amp; tcp[20:1] &gt;= 41 &amp;&amp; tcp[20:1] &lt;= 5A &amp;&amp; tcp[21:1] &gt;= 41 &amp;&amp; tcp[21:1] &lt;= 5A &amp;&amp; tcp[22:1] &gt;= 41 &amp;&amp; tcp[22:1] &lt;= 5A</span></div>
<div style="font-size:14px;color:rgb(51,51,51);line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">msnms &amp;&amp; tcp[20:3]==”USR” // 找到命令编码是USR的数据包</span></div>
<div style="font-size:14px;color:rgb(51,51,51);line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">msnms &amp;&amp; tcp[20:3]==”MSG” // 找到命令编码是MSG的数据包</span></div>
<div style="font-size:14px;color:rgb(51,51,51);line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp.port == 1863 || tcp.port == 80</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">如何判断数据包是含有命令编码的MSN数据包?</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">1)端口为1863或者80,如:tcp.port == 1863 || tcp.port == 80</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">2)数据这段前三个是大写字母,如:</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp[20:1] &gt;= 41 &amp;&amp; tcp[20:1] &lt;= 5A &amp;&amp; tcp[21:1] &gt;= 41 &amp;&amp; tcp[21:1] &lt;= 5A &amp;&amp; tcp[22:1] &gt;= 41 &amp;&amp; tcp[22:1] &lt;= 5A</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">3)第四个为0x20,如:tcp[23:1] == 20</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">4)msn是属于TCP协议的,如tcp</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">MSN Messenger 协议分析</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">http://blog.csdn.net/Hopping/archive/2008/11/13/3292257.aspx</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">MSN 协议分析</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;"><a href="http://blog.csdn.net/lzyzuixin/archive/2009/03/13/3986597.aspx" style="color:rgb(202, 0, 0);text-decoration:none;background-color:inherit;" target="_blank">http://blog.csdn.net/lzyzuixin/archive/2009/03/13/3986597.aspx</a></span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<br style="background-color:inherit;"/>
</div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:33px;background-color:inherit;"><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">更详细的说明</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">&lt;&lt;wireshark过滤表达式实例介绍&gt;&gt;</span></div>
<span style="background-color:inherit;font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">http://www.csna.cn/viewthread.php?tid=14614</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">Wireshark 主界面的操作菜单中英对比</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">http://www.csna.cn/viewthread.php?tid=9645&amp;extra=page=1</span></div>
<p style="margin:0px;padding:0px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);"></span></p>
<h1 style="margin:0px;padding:0px;font-family:微软雅黑;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;"><a name="t11" style="color:rgb(202, 0, 0);text-decoration:none;"></a>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);"><span style="font-size:24px;"><span style="line-height:23px;"></span></span></span>
</h1><h1 style="margin:0px;padding:0px;"><a name="t12" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-family:微软雅黑;font-size:14px;line-height:21px;"><span style="font-family:Tahoma,Arial,sans-serif;color:rgb(255,0,0);font-size:22px;"><span style="background-color:inherit;">12. wireshark字符串过虑语法字符</span></span></span></h1>
<h1 style="margin:0px;padding:0px;"><a name="t13" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">如下内容转自：</span><a href="http://www.csna.cn/viewthread.php?tid=14614" style="color:rgb(202, 0, 0);text-decoration:none;font-size:14px;font-family:微软雅黑;line-height:1.5;background-color:inherit;" target="_blank">http://www.csna.cn/viewthread.php?tid=14614</a></h1>

<p style="margin:0px;padding:0px;"></p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
类似正则表达式的规则。</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"> </span><span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.6428571428571428;">1、wireshark基本的语法字符</span></p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">\d          0-9的数字</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">\D          \d的补集（以所以字符为全集，下同），即所有非数字的字符</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">\w          单词字符，指大小写字母、0-9的数字、下划线</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">\W          \w的补集</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">\s          空白字符，包括换行符\n、回车符\r、制表符\t、垂直制表符\v、换页符\f</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">\S          \s的补集</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">.          除换行符\n外的任意字符。 在Perl中，“.”可以匹配新行符的模式被称作“单行模式”</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">.*       匹配任意文本，不包括回车(\n)? 。 而，[0x00-0xff]*        匹配任意文本,包括\n</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">[…]          匹配[]内所列出的所有字符</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">[^…]          匹配非[]内所列出的字符</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">—————————————————————————————-</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">2、定位字符  所代表的是一个虚的字符，它代表一个位置，你也可以直观地认为“定位字符”所代表的是某个字符与字符间的那个微小间隙。</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">^          表示其后的字符必须位于字符串的开始处</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">$          表示其前面的字符必须位于字符串的结束处</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">\b          匹配一个单词的边界</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">\B          匹配一个非单词的边界</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">—————————————————————————————-</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">3、重复描述字符</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">{n}          匹配前面的字符n次</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">{n,}          匹配前面的字符n次或多于n次</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">{n,m}          匹配前面的字符n到m次</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">?          匹配前面的字符0或1次</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">+          匹配前面的字符1次或多于1次</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">*          匹配前面的字符0次或式于0次</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">—————————————————————————————-</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">4、and or 匹配</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">and 符号 并</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">or  符号 或</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">例如：</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp and tcp.port==80</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp or udp</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">—————————————————————————————-</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">5、wireshark过滤匹配表达式实例</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">5.1、搜索按条件过滤udp的数据段payload（数字8是表示udp头部有8个字节，数据部分从第9个字节开始udp[8:]）</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">udp[8]==14        (14是十六进制0x14)匹配payload第一个字节0x14的UDP数据包</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">udp[8:2]==14:05 可以udp[8:2]==1405，且只支持2个字节连续，三个以上须使用冒号：分隔表示十六进制。 (相当于 udp[8]==14 and udp[9]==05,1405是0x1405)</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">udp[8:3]==22:00:f7 但是不可以udp[8:3]==2200f7</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">udp[8:4]==00:04:00:2a，匹配payload的前4个字节0x0004002a</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">而udp contains 7c:7c:7d:7d 匹配payload中含有0x7c7c7d7d的UDP数据包，不一定是从第一字节匹配。</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">udp[8:4] matches “\\x14\\x05\\x07\\x18″</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">udp[8:] matches “^\\x14\\x05\\x07\\x18\\x14″</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">5.2、搜索按条件过滤tcp的数据段payload（数字20是表示tcp头部有20个字节，数据部分从第21个字节开始tcp[20:]）</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp[20:] matches “^GET [ -~]*HTTP/1.1\\x0d\\x0a”</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">等同http matches “^GET [ -~]*HTTP/1.1\\x0d\\x0a”</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">tcp[20:] matches “^GET (.*?)HTTP/1.1\\x0d\\x0a”</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp[20:] matches “^GET (.*?)HTTP/1.1\\x0d\\x0a[\\x00-\\xff]*Host: (.*?)pplive(.*?)\\x0d\\x0a”</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp[20:] matches “^GET (.*?)HTTP/1.1\\x0d\\x0a[\\x00-\\xff]*Host: “</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp[20:] matches “^POST / HTTP/1.1\\x0d\\x0a[\\x00-\\xff]*\\x0d\\x0aConnection: Keep-Alive\\x0d\\x0a\\x0d\\x0a”</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">检测SMB头的smb标记，指明smb标记从tcp头部第24byte的位置开始匹配。</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp[24:4] == ff:53:4d:42</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">检测SMB头的smb标记，tcp的数据包含十六进制ff:53:4d:42，从tcp头部开始搜索此数据。</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp contains ff:53:4d:42</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp matches “\\xff\\x53\\x4d\\x42″</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">检测tcp含有十六进制01:bd,从tcp头部开始搜索此数据。</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp matches “\\x01\\xbd”</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="color:rgb(51,51,51);font-family:Tahoma,Arial,sans-serif;line-height:1.5;">检测MS08067的RPC请求路径</span></div>
<span style="font-family:Tahoma,Arial,sans-serif;color:rgb(51,51,51);font-size:14px;"></span>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">tcp[179:13] == 00:5c:00:2e:00:2e:00:5c:00:2e:00:2e:00</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">                  \      .     .     \     .     .</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">5.3、其他</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">http.request.uri matches “.gif$” 匹配过滤HTTP的请求URI中含有”.gif”字符串，并且以.gif结尾（4个字节）的http请求数据包（$是正则表达式中的结尾表示符）</span></div>
<div style="font-size:14px;line-height:1.6428571428571428;background-color:inherit;">
<span style="line-height:1.5;">注意区别：http.request.uri contains “.gif$” 与此不同，contains是包含字符串”.gif$”（5个字节）。匹配过滤HTTP的请求URI中含有”.gif$”字符串的http请求数据包（这里$是字符，不是结尾符）</span></div>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;background-color:inherit;">
</p>
<p style="margin:0px;padding:0px;font-size:14px;margin-top:5px;margin-bottom:5px;line-height:1.6428571428571428;background-color:inherit;">
<span style="font-family:Tahoma,Arial,sans-serif;color:#333333;">eth.addr[0:3]==00:1e:4f 搜索过滤MAC地址前3个字节是0x001e4f的数据包。</span></p>
<div style="font-size:14px;"><span style="font-family:Tahoma,Arial,sans-serif;color:#333333;"><br/>
</span></div>
</div>
   
</div></div></div></div></div></div></div></div></div><br/></span>
</div></body></html> 