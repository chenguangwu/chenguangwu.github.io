<html>
<head>
  <title>nginx超时设置 - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5200"/>
<h1>nginx超时设置 - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/5/29 10:58</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://blog.csdn.net/liujiyong7/article/details/18228915"><i>https://blog.csdn.net/liujiyong7/article/details/18228915</i></a></td></tr>
</table>
</div>
<br/>

<div><span>
  <div>
<div style="font-size: 16px; display: inline-block; min-width: 100%;position: relative;"><div style="outline:0px;box-sizing:border-box;"><div style="box-sizing:inherit;outline:0px;font-family:&quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, sans-serif;font-size:14px;line-height:1.57143;background-color:rgb(245, 246, 247);color:rgb(51, 51, 51);"><div style="outline:0px;box-sizing:content-box;"><span style="box-sizing:inherit;outline:0px;"><div style="box-sizing:inherit;outline:0px;background:rgb(255, 255, 255);box-shadow:rgba(0, 0, 0, 0.0470588) 0px 2px 4px 0px;">
	<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-bottom:16px;">
			<span style="border-radius:50%;display:inline-block;width:26px;height:26px;line-height:26px;text-align:center;font-size:12px;outline:0px;box-sizing:inherit;border:1px solid rgb(244, 206, 208);color:rgb(202, 12, 22);margin-right:8px;margin-top:4px;float:left;">原</span>		<h6 style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:24px;word-break:break-all;">nginx超时设置</h6>
	</div>
	<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;padding-bottom:14px;border-bottom:1px solid rgb(227, 227, 227);">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;color:rgb(133, 133, 133);display:flex;">
												<span style="box-sizing:inherit;outline:0px;margin-right:14px;">2014年01月13日 19:07:56</span>
			<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-left:auto;float:right;">
				<span style="box-sizing:inherit;outline:0px;margin-right:14px;">阅读数：119727</span>
											</div>
		</div>
	</div>
	<div style="box-sizing:inherit;outline:0px;display:block;position:relative;padding-top:16px;">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;word-break:break-all;">
                    
            <div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-family:&quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;word-break:break-all;">
                
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">nginx常用的超时配置说明</strong></p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;"><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/></strong></p>
<p style="outline:0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">client_header_timeout</strong></p>
语法 client_header_timeout time<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 60s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 http server<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 指定等待client发送一个请求头的超时时间（例如：GET / HTTP/1.1）.仅当在一次read中，没有收到请求头，才会算成超时。如果在超时时间内，client没发送任何东西，nginx返回HTTP状态码408(“Request timed out”)<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">client_body_timeout </strong><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
语法 client_body_timeout time<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 60s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 http server location<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 该指令设置请求体（request body）的读超时时间。仅当在一次readstep中，没有得到请求体，就会设为超时。超时后，nginx返回HTTP状态码408(“Request timed out”)<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">keepalive_timeout </strong><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
语法 keepalive_timeout timeout [ header_timeout ]<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 75s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 http server location<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 第一个参数指定了与client的keep-alive连接超时时间。服务器将会在这个时间后关闭连接。可选的第二个参数指定了在响应头Keep-Alive: timeout=time中的time值。这个头能够让一些浏览器主动关闭连接，这样服务器就不必要去关闭连接了。没有这个参数，nginx不会发送Keep-Alive响应头（尽管并不是由这个头来决定连接是否“keep-alive”）<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
两个参数的值可并不相同<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><ul style="outline:0px;list-style:none;box-sizing:border-box;padding:0px;margin:0px 0px 24px;word-break:break-all;"><li style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 0px 32px;list-style-type:disc;word-break:break-all;">注意不同浏览器怎么处理“keep-alive”头</li></ul><ul style="outline:0px;list-style:none;box-sizing:border-box;padding:0px;margin:0px 0px 24px;word-break:break-all;"><li style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 0px 32px;list-style-type:disc;word-break:break-all;">MSIE和Opera忽略掉&quot;Keep-Alive: timeout=&lt;N&gt;&quot; header. </li></ul><ul style="outline:0px;list-style:none;box-sizing:border-box;padding:0px;margin:0px 0px 24px;word-break:break-all;"><li style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 0px 32px;list-style-type:disc;word-break:break-all;">MSIE保持连接大约60-65秒，然后发送TCP RST</li></ul><ul style="outline:0px;list-style:none;box-sizing:border-box;padding:0px;margin:0px 0px 24px;word-break:break-all;"><li style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 0px 32px;list-style-type:disc;word-break:break-all;">Opera永久保持长连接</li></ul><ul style="outline:0px;list-style:none;box-sizing:border-box;padding:0px;margin:0px 0px 24px;word-break:break-all;"><li style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 0px 32px;list-style-type:disc;word-break:break-all;">Mozilla keeps the connection alive for N plus about 1-10 seconds. </li></ul><ul style="outline:0px;list-style:none;box-sizing:border-box;padding:0px;margin:0px 0px 24px;word-break:break-all;"><li style="outline:0px;padding:0px;box-sizing:border-box;margin:8px 0px 0px 32px;list-style-type:disc;word-break:break-all;">Konqueror保持长连接N秒</li></ul><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">lingering_timeout</strong><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
语法 lingering_timeout time<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 5s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 http server location<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 lingering_close生效后，在关闭连接前，会检测是否有用户发送的数据到达服务器，如果超过lingering_timeout时间后还没有数据可读，就直接关闭连接；否则，必须在读取完连接缓冲区上的数据并丢弃掉后才会关闭连接。<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">resolver_timeout</strong><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
语法 resolver_timeout time <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 30s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 http server location<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 该指令设置DNS解析超时时间<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">proxy_connect_timeout</strong><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
语法 proxy_connect_timeout time <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 60s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 http server location<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 该指令设置与upstream server的连接超时时间，有必要记住，这个超时不能超过75秒。<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
这个不是等待后端返回页面的时间，那是由proxy_read_timeout声明的。如果你的upstream服务器起来了，但是hanging住了（例如，没有足够的线程处理请求，所以把你的请求放到请求池里稍后处理），那么这个声明是没有用的，由于与upstream服务器的连接已经建立了。<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">proxy_read_timeout</strong><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
语法 proxy_read_timeout time <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 60s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 http server location<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 该指令设置与代理服务器的读超时时间。它决定了nginx会等待多长时间来获得请求的响应。这个时间不是获得整个response的时间，而是两次reading操作的时间。<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">proxy_send_timeout</strong><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
语法 proxy_send_timeout time <br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 60s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 http server location<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 这个指定设置了发送请求给upstream服务器的超时时间。超时设置不是为了整个发送期间，而是在两次write操作期间。如果超时后，upstream没有收到新的数据，nginx会关闭连接<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/><strong style="outline:0px;box-sizing:border-box;font-weight:700;word-break:break-all;">proxy_upstream_fail_timeout（fail_timeout）</strong><br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
语法 server address [fail_timeout=30s]<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
默认值 10s<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
上下文 upstream<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>
说明 Upstream模块下 server指令的参数，设置了某一个upstream后端失败了指定次数（max_fails）后，该后端不可操作的时间，默认为10秒<br style="outline:0px;box-sizing:border-box;word-break:break-all;"/>            </div>
                <span style="display:block;clear:both;"></span></div>
				
        	</div>
	
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;padding-bottom:16px;margin-top:36px;border-bottom:1px solid rgb(227, 227, 227);">
						<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-bottom:8px;font-size:12px;">
			<span style="box-sizing:inherit;outline:0px;color:rgb(77, 77, 77);">文章标签：</span>
						<a href="http://so.csdn.net/so/search/s.do?q=linux&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">linux						</a><a href="http://so.csdn.net/so/search/s.do?q=nginx&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">nginx						</a><a href="http://so.csdn.net/so/search/s.do?q=%E6%9C%8D%E5%8A%A1%E5%99%A8&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">服务器						</a><a href="http://so.csdn.net/so/search/s.do?q=%E8%BF%90%E7%BB%B4&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">运维						</a><a href="http://so.csdn.net/so/search/s.do?q=%E9%85%8D%E7%BD%AE&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">配置						</a>
		</div>
						<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:12px;margin-bottom:0px;">
			<span style="box-sizing:inherit;outline:0px;color:rgb(77, 77, 77);">个人分类：</span>
						<a href="https://blog.csdn.net/liujiyong7/article/category/1643429" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(121, 165, 229);word-break:break-all;" target="_blank">开源软件						</a><a href="https://blog.csdn.net/liujiyong7/article/category/1819729" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(121, 165, 229);word-break:break-all;" target="_blank">nginx						</a>
		</div>
					</div>
	
	
		</div></span></div></div></div></div>
</div>
</span>
</div></body></html> 