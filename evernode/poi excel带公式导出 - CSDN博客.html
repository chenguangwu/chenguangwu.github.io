<html>
<head>
  <title>poi excel带公式导出 - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="6115"/>
<h1>poi excel带公式导出 - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2017/10/26 13:56</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://blog.csdn.net/p451933505/article/details/8432133"><i>http://blog.csdn.net/p451933505/article/details/8432133</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="box-sizing:border-box;font-family:sans-serif;text-size-adjust:100%;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);"><div style="box-sizing:border-box;font-family:&quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;font-size:16px;line-height:24px;color:rgb(51, 51, 51);background-color:rgb(244, 244, 244);font-weight:normal;"><div style="box-sizing:border-box;font-weight:normal;"><span style="box-sizing:border-box;"><div style="box-sizing:border-box;background-color:rgb(255, 255, 255);box-shadow:rgba(0, 0, 0, 0.0470588) 0px 2px 4px 0px;">
            <h1 style="margin:0px;box-sizing:border-box;font-family:&quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;font-size:24px;font-weight:bold;line-height:38px;color:rgb(44, 48, 51);padding:0px 29px;">poi excel带公式导出</h1>
            <div style="box-sizing:border-box;margin:0px;font-weight:normal;display:block;padding:0px 29px 8px;color:rgb(136, 136, 136);border-bottom:1px solid rgb(229, 229, 229);font-size:14px;line-height:38px;margin-top:5px;"><span style="font-weight:normal;color:rgb(136, 136, 136);font-size:14px;line-height:38px;display:table;"> </span>
                <div style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;float:left;">
                    <span style="box-sizing:border-box;margin:0px;font-weight:normal;padding:2px 6px;border:1px solid rgb(228, 235, 244);font-size:14px;color:rgb(120, 144, 156);margin-right:20px;">原创</span>
                    <span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;display:inline-block;color:rgb(187, 187, 187);font-size:14px;">2012年12月25日 10:16:29</span>
                </div>
				<ul style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;list-style:none;display:block;float:left;margin-left:26px;background-color:rgb(255, 255, 255);font-size:14px;"><span style="font-weight:normal;list-style:none;font-size:14px;display:table;"> </span>
					<li style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;list-style:none;float:left;color:rgb(187, 187, 187);">标签：</li>
					
					<li style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;list-style:none;float:left;"><a href="http://so.csdn.net/so/search/s.do?q=excel&amp;t=blog" style="background:transparent;box-sizing:border-box;text-decoration:none;margin:0px;padding:0px;font-weight:normal;outline:none;color:rgb(64, 147, 198);display:inline-block;" target="_blank">excel</a> <span style="box-sizing:border-box;padding:0px;font-weight:normal;margin:0px 10px 0px 5px;color:rgb(229, 229, 229);display:inline-block;">/</span></li>
					
					<li style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;list-style:none;float:left;"><a href="http://so.csdn.net/so/search/s.do?q=java&amp;t=blog" style="background:transparent;box-sizing:border-box;text-decoration:none;margin:0px;padding:0px;font-weight:normal;outline:none;color:rgb(64, 147, 198);display:inline-block;" target="_blank">java</a> </li>
					
				<span style="font-weight:normal;list-style:none;font-size:14px;display:block;clear:both;height:0px;visibility:hidden;">.</span></ul>
                <ul style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;list-style:none;float:right;margin-top:5px;">
                    <li style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;list-style:none;float:left;margin-left:30px;line-height:28px;"></li>
                    

                    
                    
                </ul>
            <span style="font-weight:normal;color:rgb(136, 136, 136);font-size:14px;line-height:38px;display:block;clear:both;height:0px;visibility:hidden;">.</span></div>
            <div style="box-sizing:border-box;margin:0px;font-weight:normal;padding:20px 30px 0px;margin-bottom:30px;color:rgb(69, 69, 69);">
                
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;">poi excel导出带公式</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;">第一，非模版读取，带公式导出，我们可以将完整的公式直接如下形式写：</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;background-color:rgb(102,204,204);">excel里面公式=ROUND(AE6-AF6-AH6-AG6,2)，在java代码里面可以写成</span></span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;background-color:rgb(102,204,204);"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;">String sixBuf = &quot;ROUND(AE</span>6<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;">-AF</span>6<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;">-AH</span>6<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"> -AG</span>6<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;">
 &quot;,2)&quot;;<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>oneRow.getCell(6).setCellFormula(sixBuf.toString());</span></span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;background-color:rgb(102,204,204);"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>合计公式例：</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;background-color:rgb(102,204,204);"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;">oneRow.getCell(28).setCellFormula(&quot;SUM(AC6:AC&quot;+oneRowNum+&quot;)&quot;); //合计 =SUM(AC6:AC10)</span></span></span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;background-color:rgb(192,192,192);">其实可以直接将公式写进来，不管多复杂都是一样的，里面的6可以写死，也可以写活点，关键是自己要怎么的结果，如果该行是不断变动的，最好用活点，要不写死也没关系。</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;">复杂点的如：</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;background-color:rgb(102,204,204);">String t29 = &quot;IF(ISNA(VLOOKUP(E&quot;<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>+ (oneRowNum + 1)<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>+ &quot;,离入职!A:E,4,FALSE))=TRUE,\&quot;\&quot;,CONCATENATE(MONTH(VLOOKUP(E&quot;<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>+ (oneRowNum + 1)<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>+ &quot;,离入职!A:E,4,FALSE)),\&quot;月\&quot;,DAY(VLOOKUP(E&quot;<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>+ (oneRowNum + 1)<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>+ &quot;,离入职!A:E,4,FALSE)),\&quot;日\&quot;,VLOOKUP(E&quot;<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>+ (oneRowNum + 1) + &quot;,离入职!A:E,5,FALSE)))&quot;;<br style="box-sizing:border-box;"/>
<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;white-space:pre;"></span>oneRow.getCell(29).setCellFormula(t29);<br style="box-sizing:border-box;"/>
</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;"><br style="box-sizing:border-box;"/>
</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;">第二种，如果我们是读取固定的一模版导出的话，可以如下</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;">oneRow.getCell(29).setCellFormula(oneRow.getCell(29).getCellFormula())；<br style="box-sizing:border-box;"/>
</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;">这样就可以了，它会先获取公式再进行计算，但是最后还有一点千万千万不能漏掉的，就是你公式都写进来了，目前这里已经完成了一般的工作量了，<span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;background-color:rgb(255,102,102);font-size:18px;">sheetOne.setForceFormulaRecalculation(true); </span>此红色自此乃重中之重，绝不可少的，如果这行没有了，整个上面的都不会有自动计算的效果的。</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;"><br style="box-sizing:border-box;"/>
</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;"><br style="box-sizing:border-box;"/>
</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;background-color:rgb(255,255,204);">如有不足之处，还请各位大侠多多指点，谢谢，best regards！</span></p>
<p style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;"><span style="box-sizing:border-box;margin:0px;padding:0px;font-weight:normal;font-size:18px;"><br style="box-sizing:border-box;"/>
</span></p>

            </div>
        </div></span></div></div></div></div><br/></div></span>
</div></body></html> 