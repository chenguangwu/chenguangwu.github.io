<html>
<head>
  <title>Ajax工作原理 - Eric Sun - 博客园</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="7503"/>
<h1>Ajax工作原理 - Eric Sun - 博客园</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2015/10/14 23:52</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2016/3/1 17:06</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://www.cnblogs.com/mingmingruyuedlut/archive/2011/10/18/2216553.html"><i>http://www.cnblogs.com/mingmingruyuedlut/archive/2011/10/18/2216553.html</i></a></td></tr>
</table>
</div>
<br/>

<div>
<span><br/><div style="font-size: 16px"><div style="font-family:Verdana, Arial, Helvetica, sans-serif;background-image:url(http://www.cnblogs.com/skins/iMetro_HD/images/background.jpg);background-attachment:fixed;background-repeat:no-repeat;"><div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:rgb(0, 0, 0);word-wrap:break-word;box-shadow:black 0px 0px 25px;background-color:rgb(255, 255, 255);"><div style="overflow:auto;"><div><h1 style="margin:0px;padding:0px;font-size:100%;font-weight:normal;margin-bottom:10px;padding-left:15px;padding-right:15px;background-image:url(http://www.cnblogs.com/skins/iMetro_HD/images/logo.png);background-position:-10px 0px;background-repeat:repeat-y;"><a href="http://www.cnblogs.com/mingmingruyuedlut/archive/2011/10/18/2216553.html" style="margin:0px;padding:0px;font-size:200%;color:rgb(0, 0, 0);text-decoration:none;">Ajax工作原理</a></h1><div style="margin:0px;padding:0px;font-size:116%;padding-left:15px;padding-right:15px;margin-bottom:5px;"><div style="margin:0px;padding:0px;margin-bottom:30px;word-break:break-word;overflow:auto;"><p style="padding:0px;margin:10px auto;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">　　在写这篇文章之前，曾经写过一篇关于</span><span lang="EN-US" style="margin:0px;padding:0px;">AJAX</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的随笔，不过涉及到的方面很窄，对</span><span lang="EN-US" style="margin:0px;padding:0px;">AJAX</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的背景、原理、优缺点等各个方面都很少涉及</span><span lang="EN-US" style="margin:0px;padding:0px;">null</span><span style="margin:0px;padding:0px;font-family:宋体;">。这次写这篇文章的背景是因为公司需要对内部程序员做一个培训。项目经理找到了我，并且征询我培训的主题，考虑到之前</span><span lang="EN-US" style="margin:0px;padding:0px;">Javascript</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">CSS</span><span style="margin:0px;padding:0px;font-family:宋体;">等</span><span lang="EN-US" style="margin:0px;padding:0px;">WEB</span><span style="margin:0px;padding:0px;font-family:宋体;">开发技术都已经讲解过了，所以决定针对</span><span lang="EN-US" style="margin:0px;padding:0px;">AJAX</span><span style="margin:0px;padding:0px;font-family:宋体;">这一块做一个比较系统的培训，所以这篇文章实际上是一个培训的材料。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">     </span> <span style="margin:0px;padding:0px;font-family:宋体;">在这篇文章中，我将从</span><span lang="EN-US" style="margin:0px;padding:0px;">10</span><span style="margin:0px;padding:0px;font-family:宋体;">个方面来对</span><span lang="EN-US" style="margin:0px;padding:0px;">AJAX</span><span style="margin:0px;padding:0px;font-family:宋体;">技术进行系统的讲解。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">1</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的背景</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">     </span> <span style="margin:0px;padding:0px;font-family:宋体;">不可否认，</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的流行得益于</span><span lang="EN-US" style="margin:0px;padding:0px;">google</span><span style="margin:0px;padding:0px;font-family:宋体;">的大力推广，正是由于</span><span lang="EN-US" style="margin:0px;padding:0px;">google earth</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">google suggest</span><span style="margin:0px;padding:0px;font-family:宋体;">以及</span><span lang="EN-US" style="margin:0px;padding:0px;">gmail</span><span style="margin:0px;padding:0px;font-family:宋体;">等对</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的广泛应用，催生了</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的流行。而这也让微软感到无比的尴尬，因为早在</span><span lang="EN-US" style="margin:0px;padding:0px;">97</span><span style="margin:0px;padding:0px;font-family:宋体;">年，微软便已经发明了</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">中的关键技术，并且在</span><span lang="EN-US" style="margin:0px;padding:0px;">99</span><span style="margin:0px;padding:0px;font-family:宋体;">年</span><span lang="EN-US" style="margin:0px;padding:0px;">IE5</span><span style="margin:0px;padding:0px;font-family:宋体;">推出之时，它便开始支持</span><span lang="EN-US" style="margin:0px;padding:0px;">XmlHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象，并且微软之前已经开始在它的一些产品中应用</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">，比如说</span><span lang="EN-US" style="margin:0px;padding:0px;">MSDN</span><span style="margin:0px;padding:0px;font-family:宋体;">网站菜单中的一些应用。遗憾的是，不知道出于什么想法，当时微软发明了</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的核心技术之后，并没有看到它的潜力而加以发展和推广，而是将它搁置起来。对于这一点来说，我个人是觉得非常奇怪的，因为以微软的资源和它的战略眼光来说，应该不会看不到</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的前景，唯一的解释也许就是因为当时它的主要竞争对手</span><span lang="EN-US" style="margin:0px;padding:0px;">Netscape</span><span style="margin:0px;padding:0px;font-family:宋体;">的消失反而使它变得麻痹和迟钝，毕竟巨人也有打盹的时候，比如</span><span lang="EN-US" style="margin:0px;padding:0px;">IBM</span><span style="margin:0px;padding:0px;font-family:宋体;">曾经在对微软战略上的失误。正是这一次的失误，成就了它现在的竞争对手</span><span lang="EN-US" style="margin:0px;padding:0px;">google</span><span style="margin:0px;padding:0px;font-family:宋体;">在</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">方面的领先地位，而事实上</span><span lang="EN-US" style="margin:0px;padding:0px;">google</span><span style="margin:0px;padding:0px;font-family:宋体;">目前在</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术方面的领先是微软所无法达到的，这一点在后面我讲述</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">缺陷的时候也会提到。现在微软也意识到了这个问题，因此它也开始在</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">领域奋起直追，比如说推出它自己的</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">框架</span><span lang="EN-US" style="margin:0px;padding:0px;">atlas</span><span style="margin:0px;padding:0px;font-family:宋体;">，并且在</span><span lang="EN-US" style="margin:0px;padding:0px;">.NET2.0</span><span style="margin:0px;padding:0px;font-family:宋体;">也提供了一个用来实现异步回调的接口，即</span><span lang="EN-US" style="margin:0px;padding:0px;">ICallBack</span><span style="margin:0px;padding:0px;font-family:宋体;">接口。那么微软为什么对自己在</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">方面的落后如此紧张呢？现在就让我们来分析一下</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术后面隐藏的深刻意义。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">2</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的意义</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">    </span> <span style="margin:0px;padding:0px;font-family:宋体;">我们在平时的开发中都多多少少的接触或者应用到了</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">，谈到</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的意义，我们关注得最多的毫无疑问是提升用户的体验。但是，如果我们结合将来电脑和互联网的发展趋势，我们会发现</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技 术在某些方面正好代表了这种趋势。为什么这样说呢？我们知道，自从电脑出现以来，一直是桌面软件占据着绝对主导的地位，但是互联网的出现和成功使这一切开 始发生着微妙的变化。相当一部分的人都相信，迟早有一天，数据和电脑软件将会从桌面转移到互联网。也就是说，将来的电脑有可能抛弃笨重的硬盘，而直接从互 联网来获取数据和服务，我记得我念大学的时候，有位教授给我们上课的时候，曾经设想过这样一种情景，也许在将来的电脑桌面上，没有任何多余的软件和程序， 而仅仅只有一个</span><span lang="EN-US" style="margin:0px;padding:0px;">IE</span><span style="margin:0px;padding:0px;font-family:宋体;">，虽然现在看起来我们距离这一天还很遥远，并且这其中还有很多的问题需要解决，但是我觉得这个并非梦想，而是迟早将实现的现实。那么，这其中的主要问题就是互联网的连接不稳定，谁也不愿意看着自己的电脑从服务器一点一滴的下载数据，那么，</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">是不是解决了这个问题呢，说实话，与其说</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">解决了这个问题，倒不如它只是掩盖了这个问题，它只是在服务器和客户端之间充当了一个缓冲器，让用户误以为服务没有中断。精确的说，</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">并不能提高从服务器端下载数据的速度，而只是使这个等待不那么令人沮丧。但是正是这一点就足以产生巨大的影响和震动，它实际上也对桌面软件产生了巨大的冲击。这一点我用一个例子来说明，我们可以比较一下</span><span lang="EN-US" style="margin:0px;padding:0px;">Outlook Express</span><span style="margin:0px;padding:0px;font-family:宋体;">和</span><span lang="EN-US" style="margin:0px;padding:0px;">Gmail</span><span style="margin:0px;padding:0px;font-family:宋体;">，前者是典型的桌面软件，后者是</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">所实现的</span><span lang="EN-US" style="margin:0px;padding:0px;">B/S</span><span style="margin:0px;padding:0px;font-family:宋体;">模式，实际上后者目前已经在慢慢取代前者了，</span><span lang="EN-US" style="margin:0px;padding:0px;">Gmail</span><span style="margin:0px;padding:0px;font-family:宋体;">在收发邮件的时候已经和</span><span lang="EN-US" style="margin:0px;padding:0px;">Outlook Express</span><span style="margin:0px;padding:0px;font-family:宋体;">的功能几乎没有差别了，而且它不需要安装客户端程序。这就是为什么微软对</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">所带来的冲击有着如此的恐惧心理，并且在它前不久所进行的调查之中，将</span><span lang="EN-US" style="margin:0px;padding:0px;">google</span><span style="margin:0px;padding:0px;font-family:宋体;">看做他们未来十年内的主要竞争对手的主要原因之一。当然，这种变化也并不会将桌面软件全部淘汰，现有的浏览器还没有一个能像</span><span lang="EN-US" style="margin:0px;padding:0px;">PhotoShop</span><span style="margin:0px;padding:0px;font-family:宋体;">等桌面程序那样处理复杂的图像。但是我们也不能忽视它带来的影响和冲击。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">3</span><span style="margin:0px;padding:0px;font-family:宋体;">、关于</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的名字</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;"><br style="margin:0px;padding:0px;"/></span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">    ajax</span> <span style="margin:0px;padding:0px;font-family:宋体;">的全称是</span><span lang="EN-US" style="margin:0px;padding:0px;">Asynchronous JavaScript and XML</span><span style="margin:0px;padding:0px;font-family:宋体;">，其中，</span><span lang="EN-US" style="margin:0px;padding:0px;">Asynchronous</span> <span style="margin:0px;padding:0px;font-family:宋体;">是异步的意思，它有别于传统</span><span lang="EN-US" style="margin:0px;padding:0px;">web</span><span style="margin:0px;padding:0px;font-family:宋体;">开发中采用的同步的方式。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;"><br style="margin:0px;padding:0px;"/></span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">4</span><span style="margin:0px;padding:0px;font-family:宋体;">、关于同步和异步</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:21.75pt;"><span style="margin:0px;padding:0px;font-family:宋体;font-size:14px;">异步传输是面向字符的传输，它的单位是字符；而同步传输是面向比特的传输，它的单位是桢，它传输的时候要求接受方和发送方的时钟是保持一致的。</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:21.75pt;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">具体来说，异步传输是将比特分成小组来进行传送。一般每个小组是一个</span><span lang="EN-US" style="margin:0px;padding:0px;">8</span><span style="margin:0px;padding:0px;font-family:宋体;">位字符，在每个小组的头部和尾部都有一个开始位和一个停止位，它在传送过程中接收方和发送方的时钟不要求一致，也就是说，发送方可以在任何时刻发送这些小组，而接收方并不知道它什么时候到达。一个最明显的例子就是计算机键盘和主机的通信，按下一个键的同时向主机发送一个</span><span lang="EN-US" style="margin:0px;padding:0px;">8</span><span style="margin:0px;padding:0px;font-family:宋体;">比特位的</span><span lang="EN-US" style="margin:0px;padding:0px;">ASCII</span><span style="margin:0px;padding:0px;font-family:宋体;">代 码，键盘可以在任何时刻发送代码，这取决于用户的输入速度，内部的硬件必须能够在任何时刻接收一个键入的字符。这是一个典型的异步传输过程。异步传输存在 一个潜在的问题，即接收方并不知道数据会在什么时候到达。在它检测到数据并做出响应之前，第一个比特已经过去了。这就像有人出乎意料地从后面走上来跟你说 话，而你没来得及反应过来，漏掉了最前面的几个词。因此，每次异步传输的信息都以一个起始位开头，它通知接收方数据已经到达了，这就给了接收方响应、接收 和缓存数据比特的时间；在传输结束时，一个停止位表示该次传输信息的终止。按照惯例，空闲（没有传送数据）的线路实际携带着一个代表二进制</span><span lang="EN-US" style="margin:0px;padding:0px;">1</span><span style="margin:0px;padding:0px;font-family:宋体;">的信号。步传输的开始位使信号变成</span><span lang="EN-US" style="margin:0px;padding:0px;">0</span><span style="margin:0px;padding:0px;font-family:宋体;">，其他的比特位使信号随传输的数据信息而变化。最后，停止位使信号重新变回</span><span lang="EN-US" style="margin:0px;padding:0px;">1</span><span style="margin:0px;padding:0px;font-family:宋体;">，该信号一直保持到下一个开始位到达。例如在键盘上数字“</span><span lang="EN-US" style="margin:0px;padding:0px;">1</span><span style="margin:0px;padding:0px;font-family:宋体;">”</span><span style="margin:0px;padding:0px;font-family:宋体;">，按照</span><span lang="EN-US" style="margin:0px;padding:0px;">8</span><span style="margin:0px;padding:0px;font-family:宋体;">比特位的扩展</span><span lang="EN-US" style="margin:0px;padding:0px;">ASCII</span><span style="margin:0px;padding:0px;font-family:宋体;">编码，将发送“</span><span lang="EN-US" style="margin:0px;padding:0px;">00110001</span><span style="margin:0px;padding:0px;font-family:宋体;">”</span><span style="margin:0px;padding:0px;font-family:宋体;">，同时需要在</span><span lang="EN-US" style="margin:0px;padding:0px;">8</span><span style="margin:0px;padding:0px;font-family:宋体;">比特位的前面加一个起始位，后面一个停止位。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:21pt;"><span style="margin:0px;padding:0px;font-family:宋体;font-size:14px;">同步传输的比特分组要大得多。它不是独立地发送每个字符，每个字符都有自己的开始位和停止位，而是把它们组合起来一起发送。我们将这些组合称为数据帧，或简称为帧。</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-family:宋体;font-size:14px;">　　数据帧的第一部分包含一组同步字符，它是一个独特的比特组合，类似于前面提到的起始位，用于通知接收方一个帧已经到达，但它同时还能确保接收方的采样速度和比特的到达速度保持一致，使收发双方进入同步。</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-family:宋体;font-size:14px;">　　帧的最后一部分是一个帧结束标记。与同步字符一样，它也是一个独特的比特串，类似于前面提到的停止位，用于表示在下一帧开始之前没有别的即将到达的数据了。</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">　　同步传输通常要比异步传输快速得多。接收方不必对每个字符进行开始和停止的操作。一旦检测到帧同步字符，它就在接下来的数据到达时接收它们。另外，同步传输的开销也比较少。例如，一个典型的帧可能有</span><span lang="EN-US" style="margin:0px;padding:0px;">500</span><span style="margin:0px;padding:0px;font-family:宋体;">字节（即</span><span lang="EN-US" style="margin:0px;padding:0px;">4000</span><span style="margin:0px;padding:0px;font-family:宋体;">比特）的数据，其中可能只包含</span><span lang="EN-US" style="margin:0px;padding:0px;">100</span><span style="margin:0px;padding:0px;font-family:宋体;">比特的开销。这时，增加的比特位使传输的比特总数增加</span><span lang="EN-US" style="margin:0px;padding:0px;">2.5%</span><span style="margin:0px;padding:0px;font-family:宋体;">，这与异步传输中</span><span lang="EN-US" style="margin:0px;padding:0px;">25 %</span><span style="margin:0px;padding:0px;font-family:宋体;">的增值要小得多。随着数据帧中实际数据比特位的增加，开销比特所占的百分比将相应地减少。但是，数据比特位越长，缓存数据所需要的缓冲区也越大，这就限制了一个帧的大小。另外，帧越大，它占据传输媒体的连续时间也越长。在极端的情况下，这将导致其他用户等得太久。<br style="margin:0px;padding:0px;"/></span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">     了解了同步和异步的概念之后，大家应该对ajax为什么可以提升用户体验应该比较清晰了，它是利用异步请求方式的。打个比方，如果现在你家里所在的小区因 某种情况而面临停水，现在有关部门公布了两种方案，一是完全停水8个小时，在这8个小时内完全停水，8个小时后恢复正常。二是不完全停水10 </span>个小时，在这10个小时内水没有完全断，只是流量比原来小了很多，在10个小时后恢复正常流量，那么，如果是你你会选择哪种方式呢？显然是后者。</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><br style="margin:0px;padding:0px;"/></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">5</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">所包含的技术</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;"><br style="margin:0px;padding:0px;"/></span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">   </span> <span style="margin:0px;padding:0px;font-family:宋体;">大家都知道</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">并非一种新的技术，而是几种原有技术的结合体。它由下列技术组合而成。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">   1.</span><span style="margin:0px;padding:0px;font-family:宋体;">使用</span><span lang="EN-US" style="margin:0px;padding:0px;">CSS</span><span style="margin:0px;padding:0px;font-family:宋体;">和</span><span lang="EN-US" style="margin:0px;padding:0px;">XHTML</span><span style="margin:0px;padding:0px;font-family:宋体;">来表示。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">   2.</span> <span style="margin:0px;padding:0px;font-family:宋体;">使用</span><span lang="EN-US" style="margin:0px;padding:0px;">DOM</span><span style="margin:0px;padding:0px;font-family:宋体;">模型来交互和动态显示。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">   3.</span><span style="margin:0px;padding:0px;font-family:宋体;">使用</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">来和服务器进行异步通信。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">   4.</span><span style="margin:0px;padding:0px;font-family:宋体;">使用</span><span lang="EN-US" style="margin:0px;padding:0px;">javascript</span><span style="margin:0px;padding:0px;font-family:宋体;">来绑定和调用。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">在上面几中技术中，除了</span><span lang="EN-US" style="margin:0px;padding:0px;">XmlHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象以外，其它所有的技术都是基于</span><span lang="EN-US" style="margin:0px;padding:0px;">web</span><span style="margin:0px;padding:0px;font-family:宋体;">标准并且已经得到了广泛使用的，</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">虽然目前还没有被</span><span lang="EN-US" style="margin:0px;padding:0px;">W3C</span><span style="margin:0px;padding:0px;font-family:宋体;">所采纳，但是它已经是一个事实的标准，因为目前几乎所有的主流浏览器都支持它。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">6</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">原理和</span><span lang="EN-US" style="margin:0px;padding:0px;">XmlHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　Ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的原理简单来说通过</span><span lang="EN-US" style="margin:0px;padding:0px;">XmlHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象来向服务器发异步请求，从服务器获得数据，然后用</span><span lang="EN-US" style="margin:0px;padding:0px;">javascript</span><span style="margin:0px;padding:0px;font-family:宋体;">来操作</span><span lang="EN-US" style="margin:0px;padding:0px;">DOM</span><span style="margin:0px;padding:0px;font-family:宋体;">而更新页面。这其中最关键的一步就是从服务器获得请求数据。要清楚这个过程和原理，我们必须对</span> <span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">有所了解。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:10.5pt;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">是</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的核心机制，它是在</span><span lang="EN-US" style="margin:0px;padding:0px;">IE5</span><span style="margin:0px;padding:0px;font-family:宋体;">中首先引入的，是一种支持异步请求的技术。简单的说，也就是</span><span lang="EN-US" style="margin:0px;padding:0px;">javascript</span><span style="margin:0px;padding:0px;font-family:宋体;">可以及时向服务器提出请求和处理响应，而不阻塞用户。达到无刷新的效果。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;"> </span> <span style="margin:0px;padding:0px;font-family:宋体;">　所以我们先从</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">讲起，来看看它的工作原理。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;"> </span> <span style="margin:0px;padding:0px;font-family:宋体;">　首先，我们先来看看</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">这个对象的属性。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">  　　</span><span style="margin:0px;padding:0px;font-family:宋体;">它的属性有：</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">  　　onreadystatechange </span> <span style="margin:0px;padding:0px;font-family:宋体;">每次状态改变所触发事件的事件处理程序。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">  　　responseText    </span> <span style="margin:0px;padding:0px;font-family:宋体;">从服务器进程返回数据的字符串形式。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">  　　responseXML    </span><span style="margin:0px;padding:0px;font-family:宋体;">从服务器进程返回的</span><span lang="EN-US" style="margin:0px;padding:0px;">DOM</span><span style="margin:0px;padding:0px;font-family:宋体;">兼容的文档数据对象。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">  　　status          </span> <span style="margin:0px;padding:0px;font-family:宋体;">从服务器返回的数字代码，比如常见的</span><span lang="EN-US" style="margin:0px;padding:0px;">404</span><span style="margin:0px;padding:0px;font-family:宋体;">（未找到）和</span><span lang="EN-US" style="margin:0px;padding:0px;">200</span><span style="margin:0px;padding:0px;font-family:宋体;">（已就绪）</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">  　　status Text      </span> <span style="margin:0px;padding:0px;font-family:宋体;">伴随状态码的字符串信息</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">  　　readyState      </span> <span style="margin:0px;padding:0px;font-family:宋体;">对象状态值</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　　　0 (</span><span style="margin:0px;padding:0px;font-family:宋体;">未初始化</span><span lang="EN-US" style="margin:0px;padding:0px;">)</span> <span style="margin:0px;padding:0px;font-family:宋体;">对象已建立，但是尚未初始化（尚未调用</span><span lang="EN-US" style="margin:0px;padding:0px;">open</span><span style="margin:0px;padding:0px;font-family:宋体;">方法）</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　　　1 (</span><span style="margin:0px;padding:0px;font-family:宋体;">初始化</span><span lang="EN-US" style="margin:0px;padding:0px;">)</span> <span style="margin:0px;padding:0px;font-family:宋体;">对象已建立，尚未调用</span><span lang="EN-US" style="margin:0px;padding:0px;">send</span><span style="margin:0px;padding:0px;font-family:宋体;">方法</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　　　2 (</span><span style="margin:0px;padding:0px;font-family:宋体;">发送数据</span><span lang="EN-US" style="margin:0px;padding:0px;">) send</span><span style="margin:0px;padding:0px;font-family:宋体;">方法已调用，但是当前的状态及</span><span lang="EN-US" style="margin:0px;padding:0px;">http</span><span style="margin:0px;padding:0px;font-family:宋体;">头未知</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　　　3 (</span><span style="margin:0px;padding:0px;font-family:宋体;">数据传送中</span><span lang="EN-US" style="margin:0px;padding:0px;">)</span> <span style="margin:0px;padding:0px;font-family:宋体;">已接收部分数据，因为响应及</span><span lang="EN-US" style="margin:0px;padding:0px;">http</span><span style="margin:0px;padding:0px;font-family:宋体;">头不全，这时通过</span><span lang="EN-US" style="margin:0px;padding:0px;">responseBody</span><span style="margin:0px;padding:0px;font-family:宋体;">和</span><span lang="EN-US" style="margin:0px;padding:0px;">responseText</span><span style="margin:0px;padding:0px;font-family:宋体;">获取部分数据会出现错误，</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　　　4 (</span><span style="margin:0px;padding:0px;font-family:宋体;">完成</span><span lang="EN-US" style="margin:0px;padding:0px;">)</span> <span style="margin:0px;padding:0px;font-family:宋体;">数据接收完毕</span><span lang="EN-US" style="margin:0px;padding:0px;">,</span><span style="margin:0px;padding:0px;font-family:宋体;">此时可以通过通过</span><span lang="EN-US" style="margin:0px;padding:0px;">responseXml</span><span style="margin:0px;padding:0px;font-family:宋体;">和</span><span lang="EN-US" style="margin:0px;padding:0px;">responseText</span><span style="margin:0px;padding:0px;font-family:宋体;">获取完整的回应数据</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　</span><span style="margin:0px;padding:0px;font-family:宋体;">但是，由于各浏览器之间存在差异，所以创建一个</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象可能需要不同的方法。这个差异主要体现在</span><span lang="EN-US" style="margin:0px;padding:0px;">IE</span><span style="margin:0px;padding:0px;font-family:宋体;">和其它浏览器之间。下面是一个比较标准的创建</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象的方法。</span></span></p><p align="left" style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;text-align:left;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">  </span> </span></p><div style="margin:5px 0px;padding:5px;border:1px solid rgb(204, 204, 204);overflow:auto;color:rgb(0, 0, 0);background-color:rgb(245, 245, 245);font-family:'Courier New';font-size:12px;"><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:'Courier New';font-size:12px;"><a style="margin:0px;padding:1px 3px;color:green;text-decoration:none;border:none;background-color:rgb(245, 245, 245);" title="复制代码"><img src="Ajax工作原理 - Eric Sun - 博客园_files/copycode.gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin: 0px; padding: 0px; border: none; background-color: rgb(245, 245, 245); height: auto;" width="20"/></a></span></div><pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;white-space:pre-wrap;word-wrap:break-word;font-family:'Courier New';font-size:12px;"><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">function</span> CreateXmlHttp() {<br style="margin:0px;padding:0px;"/><br style="margin:0px;padding:0px;"/>    <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#008000;">非IE浏览器创建XmlHttpRequest对象</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#008000;"><br style="margin:0px;padding:0px;"/></span>    <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">if</span> (window.XmlHttpRequest) {<br style="margin:0px;padding:0px;"/>        xmlhttp = <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">new</span> XmlHttpRequest();<br style="margin:0px;padding:0px;"/>    }<br style="margin:0px;padding:0px;"/><br style="margin:0px;padding:0px;"/>    <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#008000;">IE浏览器创建XmlHttpRequest对象</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#008000;"><br style="margin:0px;padding:0px;"/></span>    <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">if</span> (window.ActiveXObject) {<br style="margin:0px;padding:0px;"/>        <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">try</span> {<br style="margin:0px;padding:0px;"/>            xmlhttp = <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">new</span> ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);<br style="margin:0px;padding:0px;"/>        }<br style="margin:0px;padding:0px;"/>        <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">catch</span> (e) {<br style="margin:0px;padding:0px;"/>            <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">try</span> {<br style="margin:0px;padding:0px;"/>                xmlhttp = <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">new</span> ActiveXObject(&quot;msxml2.XMLHTTP&quot;);<br style="margin:0px;padding:0px;"/>            }<br style="margin:0px;padding:0px;"/>            <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">catch</span> (ex) { }<br style="margin:0px;padding:0px;"/>        }<br style="margin:0px;padding:0px;"/>    }<br style="margin:0px;padding:0px;"/>}<br style="margin:0px;padding:0px;"/><br style="margin:0px;padding:0px;"/><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">function</span> Ustbwuyi() {<br style="margin:0px;padding:0px;"/><br style="margin:0px;padding:0px;"/>    <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">var</span> data = document.getElementById(&quot;username&quot;).value;<br style="margin:0px;padding:0px;"/>    CreateXmlHttp();<br style="margin:0px;padding:0px;"/>    <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">if</span> (!xmlhttp) {<br style="margin:0px;padding:0px;"/>        alert(&quot;创建xmlhttp对象异常！&quot;);<br style="margin:0px;padding:0px;"/>        <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">return</span> <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">false</span>;<br style="margin:0px;padding:0px;"/>    }<br style="margin:0px;padding:0px;"/><br style="margin:0px;padding:0px;"/>    xmlhttp.open(&quot;POST&quot;, url, <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">false</span>);<br style="margin:0px;padding:0px;"/><br style="margin:0px;padding:0px;"/>    xmlhttp.onreadystatechange = <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">function</span> () {<br style="margin:0px;padding:0px;"/>        <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">if</span> (xmlhttp.readyState == 4) {<br style="margin:0px;padding:0px;"/>            document.getElementById(&quot;user1&quot;).innerHTML = &quot;数据正在加载...&quot;;<br style="margin:0px;padding:0px;"/>            <span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;color:#0000ff;">if</span> (xmlhttp.status == 200) {<br style="margin:0px;padding:0px;"/>                document.write(xmlhttp.responseText);<br style="margin:0px;padding:0px;"/>            }<br style="margin:0px;padding:0px;"/>        }<br style="margin:0px;padding:0px;"/>    }<br style="margin:0px;padding:0px;"/>    xmlhttp.send();<br style="margin:0px;padding:0px;"/>}
</pre><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:'Courier New';font-size:12px;"><a style="margin:0px;padding:1px 3px;color:green;text-decoration:none;border:none;background-color:rgb(245, 245, 245);" title="复制代码"><img src="Ajax工作原理 - Eric Sun - 博客园_files/copycode [1].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin: 0px; padding: 0px; border: none; background-color: rgb(245, 245, 245); height: auto;" width="20"/></a></span></div></div><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;font-family:新宋体;"><span style="margin:0px;padding:0px;color:blue;"><br style="margin:0px;padding:0px;"/></span></span><span style="margin:0px;padding:0px;font-family:宋体;">　　如上所示，函数首先检查</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">的整体状态并且保证它已经完成（</span><span lang="EN-US" style="margin:0px;padding:0px;">readyStatus=4</span><span style="margin:0px;padding:0px;font-family:宋体;">），即数据已经发送完毕。然后根据服务器的设定询问请求状态，如果一切已经就绪（</span><span lang="EN-US" style="margin:0px;padding:0px;">status=200</span><span style="margin:0px;padding:0px;font-family:宋体;">），那么就执行下面需要的操作。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:21.75pt;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">对于</span><span lang="EN-US" style="margin:0px;padding:0px;">XmlHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">的两个方法，</span><span lang="EN-US" style="margin:0px;padding:0px;">open</span><span style="margin:0px;padding:0px;font-family:宋体;">和</span><span lang="EN-US" style="margin:0px;padding:0px;">send</span><span style="margin:0px;padding:0px;font-family:宋体;">，其中</span><span lang="EN-US" style="margin:0px;padding:0px;">open</span><span style="margin:0px;padding:0px;font-family:宋体;">方法指定了：</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:21.75pt;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">a</span><span style="margin:0px;padding:0px;font-family:宋体;">、向服务器提交数据的类型，即</span><span lang="EN-US" style="margin:0px;padding:0px;">post</span><span style="margin:0px;padding:0px;font-family:宋体;">还是</span><span lang="EN-US" style="margin:0px;padding:0px;">get</span><span style="margin:0px;padding:0px;font-family:宋体;">。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:21.75pt;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">b</span><span style="margin:0px;padding:0px;font-family:宋体;">、请求的</span><span lang="EN-US" style="margin:0px;padding:0px;">url</span><span style="margin:0px;padding:0px;font-family:宋体;">地址和传递的参数。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">      c</span><span style="margin:0px;padding:0px;font-family:宋体;">、传输方式，</span><span lang="EN-US" style="margin:0px;padding:0px;">false</span><span style="margin:0px;padding:0px;font-family:宋体;">为同步，</span><span lang="EN-US" style="margin:0px;padding:0px;">true</span><span style="margin:0px;padding:0px;font-family:宋体;">为异步。默认为</span><span lang="EN-US" style="margin:0px;padding:0px;">true</span><span style="margin:0px;padding:0px;font-family:宋体;">。如果是异步通信方式</span><span lang="EN-US" style="margin:0px;padding:0px;">(true)</span><span style="margin:0px;padding:0px;font-family:宋体;">，客户机就不等待服务器的响应；如果是同步方式</span><span lang="EN-US" style="margin:0px;padding:0px;">(false)</span><span style="margin:0px;padding:0px;font-family:宋体;">，客户机就要等到服务器返回消息后才去执行其他操作。我们需要根据实际需要来指定同步方式，在某些页面中，可能会发出多个请求，甚至是有组织有计划有队形大规模的高强度的</span><span lang="EN-US" style="margin:0px;padding:0px;">request</span><span style="margin:0px;padding:0px;font-family:宋体;">，而后一个是会覆盖前一个的，这个时候当然要指定同步方式。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">    Send</span><span style="margin:0px;padding:0px;font-family:宋体;">方法用来发送请求。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　</span><span style="margin:0px;padding:0px;font-family:宋体;">知道了</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">的工作流程，我们可以看出，</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">是完全用来向服务器发出一个请求的，它的作用也局限于此，但它的作用是整个</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">实现的关键，因为</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">无非是两个过程，发出请求和响应请求。并且它完全是一种客户端的技术。而</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">正是处理了服务器端和客户端通信的问题所以才会如此的重要。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　</span><span style="margin:0px;padding:0px;font-family:宋体;">现在，我们对</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的原理大概可以有一个了解了。我们可以把服务器端看成一个数据接口，它返回的是一个纯文本流，当然，这个文本流可以是</span><span lang="EN-US" style="margin:0px;padding:0px;">XML</span><span style="margin:0px;padding:0px;font-family:宋体;">格式，可以是</span><span lang="EN-US" style="margin:0px;padding:0px;">Html</span><span style="margin:0px;padding:0px;font-family:宋体;">，可以是</span><span lang="EN-US" style="margin:0px;padding:0px;">Javascript</span><span style="margin:0px;padding:0px;font-family:宋体;">代码，也可以只是一个字符串。这时候，</span><span lang="EN-US" style="margin:0px;padding:0px;">XMLHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">向服务器端请求这个页面，服务器端将文本的结果写入页面，这和普通的</span><span lang="EN-US" style="margin:0px;padding:0px;">web</span><span style="margin:0px;padding:0px;font-family:宋体;">开发流程是一样的，不同的是，客户端在异步获取这个结果后，不是直接显示在页面，而是先由</span><span lang="EN-US" style="margin:0px;padding:0px;">javascript</span><span style="margin:0px;padding:0px;font-family:宋体;">来处理，然后再显示在页面。至于现在流行的很多</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">控件，比如</span><span lang="EN-US" style="margin:0px;padding:0px;">magicajax</span><span style="margin:0px;padding:0px;font-family:宋体;">等，可以返回</span><span lang="EN-US" style="margin:0px;padding:0px;">DataSet</span><span style="margin:0px;padding:0px;font-family:宋体;">等其它数据类型，只是将这个过程封装了的结果，本质上他们并没有什么太大的区别。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">7</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的优点</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;"><br style="margin:0px;padding:0px;"/></span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">   Ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的给我们带来的好处大家基本上都深有体会，在这里我只简单的讲几点：</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">    1</span><span style="margin:0px;padding:0px;font-family:宋体;">、最大的一点是页面无刷新，在页面内与服务器通信，给用户的体验非常好。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">　</span> <span lang="EN-US" style="margin:0px;padding:0px;">2</span><span style="margin:0px;padding:0px;font-family:宋体;">、使用异步方式与服务器通信，不需要打断用户的操作，具有更加迅速的响应能力。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">　</span> <span lang="EN-US" style="margin:0px;padding:0px;">3</span><span style="margin:0px;padding:0px;font-family:宋体;">、可以把以前一些服务器负担的工作转嫁到客户端，利用客户端闲置的能力来处理，减轻服务器和带宽的负担，节约空间和宽带租用成本。并且减轻服务器的负担，</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的原则是</span><span lang="EN-US" style="margin:0px;padding:0px;">“</span><span style="margin:0px;padding:0px;font-family:宋体;">按需取数据</span><span lang="EN-US" style="margin:0px;padding:0px;">”</span><span style="margin:0px;padding:0px;font-family:宋体;">，可以最大程度的减少冗余请求，和响应对服务器造成的负担。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">    4</span><span style="margin:0px;padding:0px;font-family:宋体;">、基于标准化的并被广泛支持的技术，不需要下载插件或者小程序。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;"><br style="margin:0px;padding:0px;"/></span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">8</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的缺点</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;"><br style="margin:0px;padding:0px;"/></span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">　　下面我着重讲一讲</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的缺陷，因为平时我们大多注意的都是</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">给我们所带来的好处诸如用户体验的提升。而对</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">所带来的缺陷有所忽视。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">　　下面所阐述的</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的缺陷都是它先天所产生的。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">   　1</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">干掉了</span><span lang="EN-US" style="margin:0px;padding:0px;">back</span><span style="margin:0px;padding:0px;font-family:宋体;">按钮，即对浏览器后退机制的破坏。后退按钮是一个标准的</span><span lang="EN-US" style="margin:0px;padding:0px;">web</span><span style="margin:0px;padding:0px;font-family:宋体;">站点的重要功能，但是它没法和</span><span lang="EN-US" style="margin:0px;padding:0px;">js</span><span style="margin:0px;padding:0px;font-family:宋体;">进行很好的合作。这是</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">所带来的一个比较严重的问题，因为用户往往是希望能够通过后退来取消前一次操作的。那么对于这个问题有没有办法？答案是肯定的，用过</span><span lang="EN-US" style="margin:0px;padding:0px;">Gmail</span><span style="margin:0px;padding:0px;font-family:宋体;">的知道，</span><span lang="EN-US" style="margin:0px;padding:0px;">Gmail</span><span style="margin:0px;padding:0px;font-family:宋体;">下面采用的</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术解决了这个问题，在</span><span lang="EN-US" style="margin:0px;padding:0px;">Gmail</span><span style="margin:0px;padding:0px;font-family:宋体;">下面是可以后退的，但是，它也并不能改变</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的机制，它只是采用的一个比较笨但是有效的办法，即用户单击后退按钮访问历史记录时，通过创建或使用一个隐藏的</span><span lang="EN-US" style="margin:0px;padding:0px;">IFRAME</span><span style="margin:0px;padding:0px;font-family:宋体;">来重现页面上的变更。（例如，当用户在</span><span lang="EN-US" style="margin:0px;padding:0px;">Google Maps</span><span style="margin:0px;padding:0px;font-family:宋体;">中单击后退时，它在一个隐藏的</span><span lang="EN-US" style="margin:0px;padding:0px;">IFRAME</span><span style="margin:0px;padding:0px;font-family:宋体;">中进行搜索，然后将搜索结果反映到</span><span lang="EN-US" style="margin:0px;padding:0px;">Ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">元素上，以便将应用程序状态恢复到当时的状态。）</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">但是，虽然说这个问题是可以解决的，但是它所带来的开发成本是非常高的，和</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">框架所要求的快速开发是相背离的。这是</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">所带来的一个非常严重的问题。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">     2</span><span style="margin:0px;padding:0px;font-family:宋体;">、安全问题</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:21pt;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">技术同时也对</span><span lang="EN-US" style="margin:0px;padding:0px;">IT</span><span style="margin:0px;padding:0px;font-family:宋体;">企业带来了新的安全威胁，</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术就如同对企业数据建立了一个直接通道。这使得开发者在不经意间会暴露比以前更多的数据和服务器逻辑。</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的逻辑可以对客户端的安全扫描技术隐藏起来，允许黑客从远端服务器上建立新的攻击。还有</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">也难以避免一些已知的安全弱点，诸如跨站点脚步攻击、</span><span lang="EN-US" style="margin:0px;padding:0px;">SQL</span><span style="margin:0px;padding:0px;font-family:宋体;">注入攻击和基于</span><span lang="EN-US" style="margin:0px;padding:0px;">credentials</span><span style="margin:0px;padding:0px;font-family:宋体;">的安全漏洞等。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">     3</span><span style="margin:0px;padding:0px;font-family:宋体;">、对搜索引擎的支持比较弱。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">     4</span><span style="margin:0px;padding:0px;font-family:宋体;">、破坏了程序的异常机制。至少从目前看来，像</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax.dll</span><span style="margin:0px;padding:0px;font-family:宋体;">，</span><span lang="EN-US" style="margin:0px;padding:0px;">ajaxpro.dll</span><span style="margin:0px;padding:0px;font-family:宋体;">这些</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">框架是会破坏程序的异常机制的。关于这个问题，我曾经在开发过程中遇到过，但是查了一下网上几乎没有相关的介绍。后来我自己做了一次试验，分别采用</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">和传统的</span><span lang="EN-US" style="margin:0px;padding:0px;">form</span><span style="margin:0px;padding:0px;font-family:宋体;">提交的模式来删除一条数据</span><span lang="EN-US" style="margin:0px;padding:0px;">……</span><span style="margin:0px;padding:0px;font-family:宋体;">给我们的调试带来了很大的困难。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">     5</span><span style="margin:0px;padding:0px;font-family:宋体;">、另外，像其他方面的一些问题，比如说违背了</span><span lang="EN-US" style="margin:0px;padding:0px;">url</span><span style="margin:0px;padding:0px;font-family:宋体;">和资源定位的初衷。例如，我给你一个</span><span lang="EN-US" style="margin:0px;padding:0px;">url</span><span style="margin:0px;padding:0px;font-family:宋体;">地址，如果采用了</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术，也许你在该</span><span lang="EN-US" style="margin:0px;padding:0px;">url</span><span style="margin:0px;padding:0px;font-family:宋体;">地址下面看到的和我在这个</span><span lang="EN-US" style="margin:0px;padding:0px;">url</span><span style="margin:0px;padding:0px;font-family:宋体;">地址下看到的内容是不同的。这个和资源定位的初衷是相背离的。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">     6</span><span style="margin:0px;padding:0px;font-family:宋体;">、一些手持设备（如手机、</span><span lang="EN-US" style="margin:0px;padding:0px;">PDA</span><span style="margin:0px;padding:0px;font-family:宋体;">等）现在还不能很好的支持</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">，比如说我们在手机的浏览器上打开采用</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">技术的网站时，它目前是不支持的，当然，这个问题和我们没太多关系。</span> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-family:宋体;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">9</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的几种框架</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　</span><span style="margin:0px;padding:0px;font-family:宋体;">目前我们采用的比较多的</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">框架主要有</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax.dll,ajaxpro.dll,magicajax.dll</span> <span style="margin:0px;padding:0px;font-family:宋体;">以及微软的</span><span lang="EN-US" style="margin:0px;padding:0px;">atlas</span><span style="margin:0px;padding:0px;font-family:宋体;">框架。</span><span lang="EN-US" style="margin:0px;padding:0px;">Ajax.dll</span><span style="margin:0px;padding:0px;font-family:宋体;">和</span><span lang="EN-US" style="margin:0px;padding:0px;">Ajaxpro.dll</span><span style="margin:0px;padding:0px;font-family:宋体;">这两个框架差别不大，而</span><span lang="EN-US" style="margin:0px;padding:0px;">magicajax.dll</span><span style="margin:0px;padding:0px;font-family:宋体;">只是封装得更厉害一些，比如说它可以直接返回</span><span lang="EN-US" style="margin:0px;padding:0px;">DataSet</span><span style="margin:0px;padding:0px;font-family:宋体;">数据集，前面我们已经说过，</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">返回的都是字符串，</span><span lang="EN-US" style="margin:0px;padding:0px;">magicajax</span><span style="margin:0px;padding:0px;font-family:宋体;">只是对它进行了封装而已。但是它的这个特点可以给我们带来很大的方便，比如说我们的页面有一个列表，而列表的数据是不断变化的，那么我们可以采用</span><span lang="EN-US" style="margin:0px;padding:0px;">magicajax</span><span style="margin:0px;padding:0px;font-family:宋体;">来处理，操作很简单，添加</span><span lang="EN-US" style="margin:0px;padding:0px;">magicajax</span><span style="margin:0px;padding:0px;font-family:宋体;">之后，将要更新的列表控件放在</span><span lang="EN-US" style="margin:0px;padding:0px;">magicajax</span><span style="margin:0px;padding:0px;font-family:宋体;">的控件之内，然后在</span><span lang="EN-US" style="margin:0px;padding:0px;">pageload</span><span style="margin:0px;padding:0px;font-family:宋体;">里面定义更新间隔的时间就</span><span lang="EN-US" style="margin:0px;padding:0px;">ok</span><span style="margin:0px;padding:0px;font-family:宋体;">了，</span><span lang="EN-US" style="margin:0px;padding:0px;">atlas</span><span style="margin:0px;padding:0px;font-family:宋体;">的原理和</span><span lang="EN-US" style="margin:0px;padding:0px;">magicajax</span><span style="margin:0px;padding:0px;font-family:宋体;">差不多。但是，需要注意的一个问题是，这几种框架都只支持</span><span lang="EN-US" style="margin:0px;padding:0px;">IE</span><span style="margin:0px;padding:0px;font-family:宋体;">，没有进行浏览器兼容方面的处理，用反编译工具察看他们的代码就可以知道。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;"> </span><span style="margin:0px;padding:0px;font-family:宋体;">除了这几种框架之外，我们平时用到的比较多的方式是自己创建</span><span lang="EN-US" style="margin:0px;padding:0px;">xmlHttpRequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象，这种方式和前面的几种框架相比更具有灵活性。另外，在这里还提一下</span><span lang="EN-US" style="margin:0px;padding:0px;">aspnet2.0</span><span style="margin:0px;padding:0px;font-family:宋体;">自带的异步回调接口，它和</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">一样也可以实现局部的无刷新，但它的实现实际上也是基于</span><span lang="EN-US" style="margin:0px;padding:0px;">xmlhttprequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象的，另外也是只支持</span><span lang="EN-US" style="margin:0px;padding:0px;">IE</span><span style="margin:0px;padding:0px;font-family:宋体;">，当然这是微软的一个竞争策略。</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">10</span><span style="margin:0px;padding:0px;font-family:宋体;">、</span><span lang="EN-US" style="margin:0px;padding:0px;">ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">示例</span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;"><br style="margin:0px;padding:0px;"/></span></span></strong></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-family:宋体;font-size:14px;">验证用户名是否注册。</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-family:宋体;font-size:14px;">采用两种方式</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;">　　1 ajax.dll</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　2</span> <span style="margin:0px;padding:0px;font-family:宋体;">自己写</span><span lang="EN-US" style="margin:0px;padding:0px;">xmlhttprequest</span><span style="margin:0px;padding:0px;font-family:宋体;">对象</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">10.ajax</span><span style="margin:0px;padding:0px;font-family:宋体;">中常见到的一些错误</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;"> 　　1</span> <span style="margin:0px;padding:0px;font-family:宋体;">配置的问题</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">　　在</span><span lang="EN-US" style="margin:0px;padding:0px;">pageload</span><span style="margin:0px;padding:0px;font-family:宋体;">里面配置该页面的时候</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;"> </span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span lang="EN-US" style="margin:0px;padding:0px;font-size:14px;">11</span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span style="margin:0px;padding:0px;font-family:宋体;">　　在后台调用的方法里调用了前台的部分</span><span lang="EN-US" style="margin:0px;padding:0px;">…</span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;"><br style="margin:0px;padding:0px;"/></span></span></p><p style="margin:0cm 0cm 0pt;padding:0px;font-size:13px;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:14px;"><span lang="EN-US" style="margin:0px;padding:0px;">　　此文要感谢：http://www.cnblogs.com/ustbwuyi/archive/2007/02/08/645061.html#2215165<br style="margin:0px;padding:0px;"/></span></span></p></div><div style="margin:0px;padding:0px;margin-top:20px;"><div style="margin:0px;padding:0px;margin-bottom:5px;">分类: <a href="http://www.cnblogs.com/mingmingruyuedlut/category/328679.html" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;">Ajax</a></div><div style="margin:0px;padding:0px;"><div style="margin:0px;padding:10px 0px;margin-bottom:10px;margin-top:10px;border:1px dashed silver;font-size:12px;width:350px;text-align:center;"><a style="margin-right:10px;margin:0px;border-radius:10px;background-color:rgb(45, 174, 191);display:inline-block;font-weight:bold;cursor:pointer;padding:3px 8px;text-decoration:none;-webkit-box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D) repeat-x;border:none;color:rgb(255, 255, 255);">好文要顶</a> <a style="margin-right:10px;margin:0px;border-radius:10px;background-color:rgb(227, 49, 0);display:inline-block;font-weight:bold;cursor:pointer;padding:3px 8px;text-decoration:none;-webkit-box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D) repeat-x;border:none;color:rgb(255, 255, 255);">关注我</a> <a style="margin-right:10px;margin:0px;border-radius:10px;background-color:rgb(255, 181, 21);display:inline-block;font-weight:bold;cursor:pointer;padding:3px 8px;text-decoration:none;-webkit-box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D) repeat-x;border:none;color:rgb(255, 255, 255);">收藏该文</a> <a style="margin-right:10px;margin:0px;border-radius:10px;color:rgb(255, 255, 255);display:inline-block;font-weight:bold;cursor:pointer;padding:3px 2px;text-decoration:none;-webkit-box-shadow:none;text-shadow:none;vertical-align:middle;background:none;border:none;" title="分享至新浪微博"><img src="Ajax工作原理 - Eric Sun - 博客园_files/icon_weibo_24.png" type="image/png" data-filename="icon_weibo_24.png" height="24" style="margin: 0px 0px 0px 5px; padding: 0px; border: none; vertical-align: middle; box-shadow: none; height: auto;" width="24"/></a> <a style="margin-right:10px;margin:0px;border-radius:10px;color:rgb(255, 255, 255);display:inline-block;font-weight:bold;cursor:pointer;padding:3px 2px;text-decoration:none;-webkit-box-shadow:none;text-shadow:none;vertical-align:middle;background:none;border:none;" title="分享至微信"><img src="Ajax工作原理 - Eric Sun - 博客园_files/wechat.png" type="image/png" data-filename="wechat.png" height="24" style="margin: 0px 0px 0px 5px; padding: 0px; border: medium none; width: 24px; box-shadow: none; vertical-align: middle; height: auto;" width="24"/></a></div><div style="margin:0px;padding:0px;float:left;width:280px;margin-top:0px;margin-bottom:10px;color:rgb(0, 0, 0);margin-left:0px;font-size:12px;"><div style="margin:0px;padding:0px;float:left;"><a href="http://home.cnblogs.com/u/mingmingruyuedlut/" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;" target="_blank"><img src="Ajax工作原理 - Eric Sun - 博客园_files/u161932.jpg" type="image/jpeg" data-filename="u161932.jpg" height="48" style="margin: 0px 5px 0px 0px; padding: 5px 0px 0px 2px; border: 0px; vertical-align: top; float: left; height: auto;" width="48"/></a><div style="margin:0px;padding:0px;float:left;"><a href="http://home.cnblogs.com/u/mingmingruyuedlut/" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;">Eric Sun</a><br style="margin:0px;padding:0px;"/><a href="http://home.cnblogs.com/u/mingmingruyuedlut/followees" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;">关注 - 10</a><br style="margin:0px;padding:0px;"/><a href="http://home.cnblogs.com/u/mingmingruyuedlut/followers" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;">粉丝 - 181</a></div></div><div style="margin:0px;padding:0px;"><a style="margin:0px;padding:1px 3px;color:green;text-decoration:none;">+加关注</a></div></div><div style="margin:0px;padding:0px;float:right;margin-bottom:10px;margin-right:30px;font-size:12px;width:125px;text-align:center;margin-top:10px;"><div style="margin:0px;padding:0px;float:left;width:46px;height:52px;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;background:url(http://static.cnblogs.com/images/upup.gif) no-repeat;"><span style="margin:0px;padding:0px;font-size:14px;color:rgb(7, 93, 179);font-family:Verdana;">29</span></div><div style="height:52px;margin:0px;padding:0px;margin-left:20px;width:46px;float:right;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;background:url(http://static.cnblogs.com/images/downdown.gif) no-repeat;"><span style="margin:0px;padding:0px;font-size:14px;color:rgb(7, 93, 179);font-family:Verdana;">0</span></div><div style="margin:0px;padding:0px;margin-top:5px;margin-left:0px;font-size:12px;color:gray;">(请您对文章做出评价)</div></div></div><div style="margin:0px;padding:0px;font-size:12px;"><a href="http://www.cnblogs.com/mingmingruyuedlut/archive/2011/10/17/2215621.html" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;">«</a> 上一篇：<a href="http://www.cnblogs.com/mingmingruyuedlut/archive/2011/10/17/2215621.html" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;" title="发布于2011-10-17 17:05">DataReader和DataSet区别</a><br style="margin:0px;padding:0px;"/><a href="http://www.cnblogs.com/mingmingruyuedlut/archive/2011/11/04/2235630.html" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;">»</a> 下一篇：<a href="http://www.cnblogs.com/mingmingruyuedlut/archive/2011/11/04/2235630.html" style="margin:0px;padding:1px 3px;color:green;text-decoration:none;" title="发布于2011-11-04 17:04">配置WebSite的IIS时遇到的问题与解决方法</a><br style="margin:0px;padding:0px;"/></div></div></div><div style="margin:0px;padding:0px;color:gray;text-align:right;padding-left:15px;padding-right:15px;margin-bottom:5px;">posted @ <span style="margin:0px;padding:0px;">2011-10-18 15:38</span> <a href="http://www.cnblogs.com/mingmingruyuedlut/" style="margin:0px;padding:0px;color:gray;text-decoration:none;">Eric Sun</a> 阅读(<span style="margin:0px;padding:0px;">68225</span>) 评论(<span style="margin:0px;padding:0px;">9</span>) <a href="http://i.cnblogs.com/EditPosts.aspx?postid=2216553" rel="nofollow" style="margin:0px;padding:0px;color:gray;text-decoration:none;">编辑</a> <a href="http://www.cnblogs.com/mingmingruyuedlut/archive/2011/10/18/2216553.html#" style="margin:0px;padding:0px;color:gray;text-decoration:none;">收藏</a></div></div></div></div></div></div><br/></span>
</div></body></html> 