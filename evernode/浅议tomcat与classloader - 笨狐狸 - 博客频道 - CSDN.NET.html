<html>
<head>
  <title>浅议tomcat与classloader - 笨狐狸 - 博客频道 - CSDN.NET</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5629"/>
<h1>浅议tomcat与classloader - 笨狐狸 - 博客频道 - CSDN.NET</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2017/5/3 18:01</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://blog.csdn.net/liweisnake/article/details/8470285"><i>http://blog.csdn.net/liweisnake/article/details/8470285</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div><div style="background:url(&quot;http://static.blog.csdn.net/skin/dark1/css/../images/body_bg.jpg&quot;) center top repeat;font-size:12px;font-family:Arial, Console, Verdana, &quot;Courier New&quot;;"><div><div style="text-align:left;"><div style="overflow:hidden;"><div style="min-width:700px;background:rgb(255, 255, 255);"><div>
    <div style="display:block;margin:5px 0px;color:rgb(0, 0, 0);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:20px;line-height:30px;font-family:&quot;Microsoft YaHei&quot;;">   
         <span style="display:inline-block;width:19px;height:19px;margin:0px 2px 0px 0px;background:url(&quot;http://static.blog.csdn.net/skin/dark1/css/../../../images/ico_Original.gif&quot;) 0px 0px no-repeat;vertical-align:middle;"></span>


    <h1 style="font-size:20px;padding:0px;margin:0px;font-weight:normal;font-stretch:normal;font-style:normal;line-height:30px;font-family:&quot;Microsoft YaHei&quot;;vertical-align:middle;font-variant:normal;display:inline;">
        <span><a href="http://blog.csdn.net/liweisnake/article/details/8470285" style="text-decoration:none;color:rgb(0, 0, 0);">
        浅议tomcat与classloader            
        </a></span>
    </h1>
<span style="color:rgb(0, 0, 0);font-style:normal;font-variant:normal;font-weight:normal;font-size:20px;line-height:30px;font-family:&quot;Microsoft YaHei&quot;;display:block;height:0px;clear:both;visibility:hidden;">.</span></div>

   

        <div style="line-height:22px;padding:0px 20px 5px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;color:rgb(153, 153, 153);font-family:Arial;text-align:right;display:block;border-bottom:1px solid rgb(237, 237, 237);margin:0px -20px;overflow:hidden;">
        <div style="width:100%;float:left;">
            <span style="margin:0px 5px;float:left;">
            标签：
              <a href="http://www.csdn.net/tag/classloader" style="color:rgb(202, 0, 0);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">classloader</a><a href="http://www.csdn.net/tag/java" style="color:rgb(202, 0, 0);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">java</a><a href="http://www.csdn.net/tag/tomcat" style="color:rgb(202, 0, 0);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">tomcat</a><a href="http://www.csdn.net/tag/%e7%83%ad%e9%83%a8%e7%bd%b2" style="color:rgb(202, 0, 0);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">热部署</a>
            </span>
        </div>
        <div>
            <span style="margin:0px 5px 0px 0px;">2013-01-06 15:49</span>
            <span style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;http://static.blog.csdn.net/css/../../../images/ico_view.png&quot;) left center no-repeat;" title="阅读次数">6057人阅读</span>
            <span style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;http://static.blog.csdn.net/css/../../../images/ico_comm.png&quot;) left center no-repeat;" title="评论次数"> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#comments" style="color:rgb(202, 0, 0);text-decoration:none;">评论</a>(6)</span>
            <span style="margin:0px 5px;"> <a href="#" style="color:rgb(202, 0, 0);text-decoration:none;" title="收藏">收藏</a></span>
             <span style="margin:0px 5px;"> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#report" style="color:rgb(202, 0, 0);text-decoration:none;" title="举报">举报</a></span>

        </div>
    <span style="color:rgb(153, 153, 153);font-style:normal;font-variant:normal;font-weight:normal;font-size:12px;line-height:22px;font-family:Arial;text-align:right;display:block;height:0px;clear:both;visibility:hidden;">.</span></div>
    
    
    
      <div style="display:block;margin:0px -20px;border-bottom:1px solid rgb(237, 237, 237);padding:5px 20px;">
        <div style="display:inline-block;font-size:14px;color:rgb(51, 51, 51);width:70px;float:left;line-height:28px;">
           <img src="浅议tomcat与classloader - 笨狐狸 - 博客频道 - CSDN.NET_files/category_icon.jpg" type="image/jpeg" data-filename="category_icon.jpg" height="13" style="border:none;vertical-align:middle;" width="15"/>
            <span style="display:inline-block;vertical-align:middle;">分类：</span>
        </div>
        <div style="display:inline-block;font-size:14px;color:rgb(223, 52, 52);float:left;width:90%;">
                    <span style="display:inline-block;margin-left:15px;cursor:pointer;line-height:28px;position:relative;">
                        <span>tomcat<em style="font-style:normal;">（5）</em></span>
                      <img src="浅议tomcat与classloader - 笨狐狸 - 博客频道 - CSDN.NET_files/arrow_triangle _down.jpg" type="image/jpeg" data-filename="arrow_triangle _down.jpg" height="5" style="border:none;display:inline;" width="10"/>
                      
                        
                    </span>                    
        </div>
    <span style="display:block;height:0px;clear:both;visibility:hidden;">.</span></div>
      
        <div style="padding:20px 0px;">         
            <p style="margin:0px;padding:0px;height:14px;line-height:14px;border-left:3px solid rgb(228, 28, 30);padding-left:10px;color:rgb(102, 102, 102);font-size:14px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
        </div>

  

  
  
     

<div style="margin:20px 0px 0px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:14px;line-height:26px;font-family:Arial;">

<p style="margin:0px;padding:0px;">    关于tomcat和classloader的文章，网上多如牛毛，且互相转载，所以大多数搜到的基本上是讲到了tomcat中classloader的几个层次，对于初接触classloader，看了之后还是只知其然不知其所以然。</p>
<p style="margin:0px;padding:0px;">    我以为，学习tomcat classloader，先得追溯到为什么tomcat要自己造一堆自己的classloader出来，了解了这个之后才知道classloader用在什么地方，什么时候该新写，什么时候使用jvm的默认classloader；之后，得明白每个原因背后的道理，所谓明白，就是能将整个过程理清楚。</p>
<p style="margin:0px;padding:0px;">    开始之前，不得不费点篇幅申明，关于classloader，jvm的classloader等内容，请自行查阅资料（网上搜索或jvm相关资料），做到心中有个概念，相信读完此文，应该会加深这个印象。</p>
<p style="margin:0px;padding:0px;">    一直比较好奇，为什么tomcat需要实现自己的classloader，jvm提供的classloader有什么不符合需要？</p>
<p style="margin:0px;padding:0px;">   事实上，tomcat之所以造了一堆自己的classloader，大致是出于下面三类目的：</p>
<p style="margin:0px;padding:0px;">   1. 对于各个webapp中的class和<strong>lib，需要相互隔离</strong>，不能出现一个应用中加载的类库会影响另一个应用的情况；而对于许多应用，需要有<strong>共享的lib</strong>以便不浪费资源，举个例子，如果webapp1和webapp2都用到了log4j，可以将log4j提到tomcat/lib中，表示所有应用共享此类库，试想如果log4j很大，并且20个应用都分别加载，那实在是没有必要的。</p>
<p style="margin:0px;padding:0px;">   2. 第二个原因则是与jvm一样的<strong>安全性问题</strong>。使用单独的classloader去装载tomcat自身的类库，以免其他恶意或无意的破坏；</p>
<p style="margin:0px;padding:0px;">   3. 第三个原因是<strong>热部署</strong>的问题。相信大家一定为tomcat修改文件不用重启就自动重新装载类库而惊叹吧。</p>
<p style="margin:0px;padding:0px;">   由于篇幅所限，本文集中探讨第一个和第三个原因，即tomcat中如何利用classloader做到部分隔离，部分共享的，以及tomcat如何做到热部署的。</p>
<p style="margin:0px;padding:0px;">   首先，我们讨论tomcat中如何做到lib的部分隔离，部分共享的。在Bootstrap中，可以找到如下代码：</p>
<p style="margin:0px;padding:0px;"></p>
<div style="padding-top:1px;font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;background-color:rgb(231, 229, 220);width:99%;overflow:auto;font-size:12px;text-align:left;overflow-y:hidden;position:relative;overflow-x:auto;margin:18px 0px;"><div style="padding-left:45px;"><div style="font-size:9px;padding:3px 8px 10px 10px;font-variant:normal;font-weight:normal;font-stretch:normal;font-style:normal;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:rgb(248, 248, 248);border-left:3px solid rgb(153, 153, 153);"><b>[java]</b> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="view plain">view plain</a><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="copy">copy</a><div style="position:absolute;left:485px;top:899px;width:27px;height:15px;z-index:99;"><div align="middle" style="background-color:rgb(255, 255, 255);"></div></div></span><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="print">print</a></span><a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="?">?</a></div></div><ol start="1" style="padding:0px;border:none;list-style:decimal;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);margin:0px 0px 1px 45px;"><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">private</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> initClassLoaders() {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">try</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            commonLoader = createClassLoader(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;common&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">, </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">( commonLoader == </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> ) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// no config file, default to this loader - we might be in a 'single' env.</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                commonLoader=<span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">this</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">.getClass().getClassLoader();  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            catalinaLoader = createClassLoader(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;server&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">, commonLoader);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            sharedLoader = createClassLoader(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;shared&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">, commonLoader);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">catch</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (Throwable t) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            log.error(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;Class loader creation threw exception&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">, t);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            System.exit(<span style="margin:0px;padding:0px;border:none;background-color:inherit;color:rgb(192, 0, 0);">1</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">    }  </span></li></ol></div>
<p style="margin:0px;padding:0px;">   应该可以看出来，这里创建了3个classloader，分别是common，server和shared，并且common是server和shared之父。如果感兴趣，可以看下createClassLoader，它会调用进ClassLoaderFactory.createClassLoader，这个工厂方法最后会创建一个StandardClassLoader，StandardClassLoader仅仅继承了URLClassLoader而没有其他更多改动，也就是说上面3个classloader都是StandardClassLoader，除了层次关系之外，他们与jvm定义的classloader并没有区别，这就意味着他们同样遵循双亲委派模型，只要我们能够用它装载指定的类，则它就自然的嵌入到了jvm的classloader体系中去了。Tomcat的classloader体系如图：</p>
<p style="margin:0px;padding:0px;"><img src="浅议tomcat与classloader - 笨狐狸 - 博客频道 - CSDN.NET_files/1365990181_2529.png" type="image/png" data-filename="1365990181_2529.png" alt="" height="617" style="border:none;max-width:100%;" width="668"/><br/>
</p>
<p style="margin:0px;padding:0px;"></p>
<p style="margin:0px;padding:0px;">   问题来了，tomcat是如何将自己和webapp的所有类用自己的classloader加载的呢？是否需要有个专门的地方遍历所有的类并将其加载，可是代码里并不能找到这样的地方。而且相对来说，将不用的类显式的加载进来也是一种浪费，那么，tomcat（或者说jvm）是如何做到这点呢？</p>
<p style="margin:0px;padding:0px;">   这里有个隐式加载的问题，所谓的隐式加载，就是指在当前类中所有new的对象，如果没有被加载，则使用当前类的类加载器加载，即this.getClass(),getClassLoader()会默认加载该类中所有被new出来的对象的类（前提是他们没在别处先被加载过）。从这里思考，我们一个一个的应用，本质上是什么样子，事实上，正如所有程序都有一个main函数一样，所有的应用都有一个或多个startup的类（即入口），这个类是被最先加载的，并且随后的所有类都像树枝一样以此类为根被加载，只要控制了加载该入口的classloader，等于就控制了所有其他相关类的classloader。</p>
<p style="margin:0px;padding:0px;">   以此为线索来看tomcat的Bootstrap中的init代码</p>
<p style="margin:0px;padding:0px;"></p>
<div style="padding-top:1px;font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;background-color:rgb(231, 229, 220);width:99%;overflow:auto;font-size:12px;text-align:left;overflow-y:hidden;position:relative;overflow-x:auto;margin:18px 0px;"><div style="padding-left:45px;"><div style="font-size:9px;padding:3px 8px 10px 10px;font-variant:normal;font-weight:normal;font-stretch:normal;font-style:normal;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:rgb(248, 248, 248);border-left:3px solid rgb(153, 153, 153);"><b>[java]</b> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="view plain">view plain</a><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="copy">copy</a><div style="position:absolute;left:485px;top:2146px;width:27px;height:15px;z-index:99;"><div align="middle" style="background-color:rgb(255, 255, 255);"></div></div></span><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="print">print</a></span><a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="?">?</a></div></div><ol start="1" style="padding:0px;border:none;list-style:decimal;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);margin:0px 0px 1px 45px;"><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">public</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> init()  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">throws</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> Exception  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">    {  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Set Catalina path</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        setCatalinaHome();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        setCatalinaBase();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        initClassLoaders();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        Thread.currentThread().setContextClassLoader(catalinaLoader);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        SecurityClassLoad.securityClassLoad(catalinaLoader);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Load our startup class and call its process() method</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (log.isDebugEnabled())  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            log.debug(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;Loading startup class&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        Class startupClass =  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            catalinaLoader.loadClass  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            (<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;org.apache.catalina.startup.Catalina&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        Object startupInstance = startupClass.newInstance();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Set the shared extensions class loader</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (log.isDebugEnabled())  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            log.debug(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;Setting startup class properties&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        String methodName = <span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;setParentClassLoader&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">;  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        Class paramTypes[] = <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">new</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> Class[</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;color:rgb(192, 0, 0);">1</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">];  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        paramTypes[<span style="margin:0px;padding:0px;border:none;background-color:inherit;color:rgb(192, 0, 0);">0</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">] = Class.forName(</span><span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;java.lang.ClassLoader&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        Object paramValues[] = <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">new</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> Object[</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;color:rgb(192, 0, 0);">1</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">];  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        paramValues[<span style="margin:0px;padding:0px;border:none;background-color:inherit;color:rgb(192, 0, 0);">0</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">] = sharedLoader;  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        Method method =  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            startupInstance.getClass().getMethod(methodName, paramTypes);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        method.invoke(startupInstance, paramValues);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        catalinaDaemon = startupInstance;  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">    }  </span></li></ol></div>
<p style="margin:0px;padding:0px;">    在catalinaLoader.loadClass之后，Catalina事实上就由server这个classloader加载进来了，而下一句newInstance时，所有以Catalina为根的对象的类也会全部被隐式加载进来，但是为什么这里需要在其后费尽笔墨反射去setParentClassLoader呢，直接用((Catalina)startupInstance).setParentClassLoader岂不是更加方便？要注意，如果这样写，这个强制转换的Catalina便会由加载BootStrap的classloader(URLClassLoader)加载进来，而startupInstance是由StandardClassLoader加载进来的，并不是一个class，由此会抛一个ClassCastException。这也是类库可能发生冲突的一个原因。</p>
<p style="margin:0px;padding:0px;">    有同学问到为什么在eclipse中调试tomcat源码时把反射换成((Catalina)startupInstance).setParentClassLoader是完全合法的，没有报任何异常。这里需要注意tomcat的启动默认会把bin下的bootstrap.jar加入classpath：set &quot;CLASSPATH=%CLASSPATH%%CATALINA_BASE%\bin\tomcat-juli.jar;%CATALINA_HOME%\bin\bootstrap.jar&quot;，而eclipse中调试tomcat是所有相关类都在classpath的，区别在于，第一种情况，双亲委派模型在上层找不到Catalina.class，则StandardClassLoader去lib下加载catalina.jar；而第二种情况，AppClassLoader直接能够找到Catalina.class，所以就由他加载了，StandardClassLoader就形同虚设了。所以我们不能单从现象去判断原因，这也是我们为什么要学习classloader加载原理的原因。</p>
<p style="margin:0px;padding:0px;"></p>
<p style="margin:0px;padding:0px;">    搞明白这点，其实就可以理解tomcat是如何使用自己的classloader加载类进来并且如何隔离server和shared类的加载了。</p>
<p style="margin:0px;padding:0px;">    但是另一个问题，tomcat又是如何隔离不同的webapp的加载呢？</p>
<p style="margin:0px;padding:0px;">    对于每个webapp应用，都会对应唯一的StandContext，在StandContext中会引用WebappLoader，该类又会引用WebappClassLoader，WebappClassLoader就是真正加载webapp的classloader。</p>
<p style="margin:0px;padding:0px;">    StandContext隶属于Lifecycle管理，在start方法中会做一系列准备工作（有兴趣可以参考，实际上该方法比较重要，但是篇幅太长），比如新建WebappClassLoader，另外loadOnStartup便会加载所有配置好的servlet（每个StandardWrapper负责管理一个servlet），这里同样的一个问题是，在我们自己写的web应用程序中，入口是什么？答案就是Servlet, Listener, Filter这些组件，如果我们控制好入口的classloader，便等于控制了其后所加载的全部类，那么，tomcat是如何控制的呢？且看StandardWrapper中一个重要的方法loadServlet（篇幅所限，隐去了大部分不想关内容），getLoader()事实上调用到了StandContext中保存的WebappLoader，于是，用该loader加载Servlet，从而控制住了Servlet中所有待加载的类。</p>
<p style="margin:0px;padding:0px;"></p>
<div style="padding-top:1px;font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;background-color:rgb(231, 229, 220);width:99%;overflow:auto;font-size:12px;text-align:left;overflow-y:hidden;position:relative;overflow-x:auto;margin:18px 0px;"><div style="padding-left:45px;"><div style="font-size:9px;padding:3px 8px 10px 10px;font-variant:normal;font-weight:normal;font-stretch:normal;font-style:normal;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:rgb(248, 248, 248);border-left:3px solid rgb(153, 153, 153);"><b>[java]</b> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="view plain">view plain</a><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="copy">copy</a><div style="position:absolute;left:485px;top:3372px;width:27px;height:15px;z-index:99;"><div align="middle" style="background-color:rgb(255, 255, 255);"></div></div></span><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="print">print</a></span><a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="?">?</a></div></div><ol start="1" style="padding:0px;border:none;list-style:decimal;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);margin:0px 0px 1px 45px;"><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">public</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">synchronized</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> Servlet loadServlet() </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">throws</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> ServletException {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        ...  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        Servlet servlet;  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">try</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            ...  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Acquire an instance of the class loader to be used</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            Loader loader = getLoader();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (loader == </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                unavailable(<span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">throw</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">new</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> ServletException  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    (sm.getString(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;standardWrapper.missingLoader&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">, getName()));  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            ClassLoader classLoader = loader.getClassLoader();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Special case class loader for a container provided servlet</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">//  </span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (isContainerProvidedServlet(actualClass) &amp;&amp;   </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    ! ((Context)getParent()).getPrivileged() ) {  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// If it is a priviledged context - using its own</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// class loader will work, since it's a child of the container</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// loader</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                classLoader = <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">this</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">.getClass().getClassLoader();  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Load the specified servlet class from the appropriate class loader</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            Class classClass = <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">;  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">try</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (SecurityUtil.isPackageProtectionEnabled()){  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    ...  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">else</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (classLoader != </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                        classClass = classLoader.loadClass(actualClass);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">else</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                        classClass = Class.forName(actualClass);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">catch</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (ClassNotFoundException e) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                unavailable(<span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                getServletContext().log( <span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;Error loading &quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> + classLoader + </span><span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot; &quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> + actualClass, e );  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">throw</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">new</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> ServletException  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    (sm.getString(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;standardWrapper.missingClass&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">, actualClass),  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                     e);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (classClass == </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                unavailable(<span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">throw</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">new</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> ServletException  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    (sm.getString(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;standardWrapper.missingClass&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">, actualClass));  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Instantiate and initialize an instance of the servlet class itself</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">try</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                servlet = (Servlet) classClass.newInstance();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Annotation processing</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (!((Context) getParent()).getIgnoreAnnotations()) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (getParent() </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">instanceof</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> StandardContext) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                       ((StandardContext)getParent()).getAnnotationProcessor().processAnnotations(servlet);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                       ((StandardContext)getParent()).getAnnotationProcessor().postConstruct(servlet);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">catch</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (ClassCastException e) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                ...  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">catch</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (Throwable e) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                ...  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            ...  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">return</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> servlet;  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">    }  </span></li></ol></div>
<p style="margin:0px;padding:0px;">     这里的加载过程与之前的一致，至于如何做到不同webapp之间的隔离，我想大家已经明白，不同的StandardContext有不同的WebappClassLoader，那么不同的webapp的类装载器就是不一致的。装载器的不一致带来了名称空间不一致，所以webapp之间是相互隔离的。</p>
<p style="margin:0px;padding:0px;"><br/>
</p>
<p style="margin:0px;padding:0px;">    关于tomcat是如何做到<strong>热部署</strong>的，相信不用说也能猜到个十之八九。简单讲就是定期检查是否需要热部署，如果需要，则将类装载器也重新装载，并且去重新装载其他相关类。关于tomcat是如何做的，可以具体看以下分析。</p>
<p style="margin:0px;padding:0px;">    首先来看一个后台的定期检查，该定期检查是StandardContext的一个后台线程，会做reload的check，过期session清理等等，这里的modified实际上调用了WebappClassLoader中的方法以判断这个class是不是已经修改。注意到他调用了StandardContext的reload方法。</p>
<p style="margin:0px;padding:0px;"></p>
<div style="padding-top:1px;font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;background-color:rgb(231, 229, 220);width:99%;overflow:auto;font-size:12px;text-align:left;overflow-y:hidden;position:relative;overflow-x:auto;margin:18px 0px;"><div style="padding-left:45px;"><div style="font-size:9px;padding:3px 8px 10px 10px;font-variant:normal;font-weight:normal;font-stretch:normal;font-style:normal;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:rgb(248, 248, 248);border-left:3px solid rgb(153, 153, 153);"><b>[java]</b> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="view plain">view plain</a><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="copy">copy</a><div style="position:absolute;left:485px;top:4952px;width:27px;height:15px;z-index:99;"><div align="middle" style="background-color:rgb(255, 255, 255);"></div></div></span><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="print">print</a></span><a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="?">?</a></div></div><ol start="1" style="padding:0px;border:none;list-style:decimal;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);margin:0px 0px 1px 45px;"><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">public</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> backgroundProcess() {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (reloadable &amp;&amp; modified()) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">try</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                Thread.currentThread().setContextClassLoader  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    (WebappLoader.<span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">class</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">.getClassLoader());  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (container </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">instanceof</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> StandardContext) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    ((StandardContext) container).reload();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">finally</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (container.getLoader() != </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">null</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    Thread.currentThread().setContextClassLoader  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                        (container.getLoader().getClassLoader());  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">else</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            closeJARs(<span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">false</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">    }  </span></li></ol></div>
<p style="margin:0px;padding:0px;"></p>
<p style="margin:0px;padding:0px;">    那么reload方法具体做了什么？非常简单，就是tomcat lifecycle中标准的启停方法stop和start，别忘了，start方法会重新造一个WebappClassLoader并且重复loadOnStartup的过程，从而重新加载了webapp中的类，注意到一般应用很大时，热部署通常会报outofmemory: permgen space not enough之类的，这是由于之前加载进来的class还没有清除而方法区内存又不够的原因</p>
<p style="margin:0px;padding:0px;"></p>
<div style="padding-top:1px;font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;background-color:rgb(231, 229, 220);width:99%;overflow:auto;font-size:12px;text-align:left;overflow-y:hidden;position:relative;overflow-x:auto;margin:18px 0px;"><div style="padding-left:45px;"><div style="font-size:9px;padding:3px 8px 10px 10px;font-variant:normal;font-weight:normal;font-stretch:normal;font-style:normal;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;background-color:rgb(248, 248, 248);border-left:3px solid rgb(153, 153, 153);"><b>[java]</b> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="view plain">view plain</a><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="copy">copy</a><div style="position:absolute;left:485px;top:5420px;width:27px;height:15px;z-index:99;"><div align="middle" style="background-color:rgb(255, 255, 255);"></div></div></span><span> <a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="print">print</a></span><a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="background:none;border:none;padding:0px;margin:0px;color:rgb(160, 160, 160);text-decoration:none;font-size:9px;background-color:inherit;margin-right:10px;" title="?">?</a></div></div><ol start="1" style="padding:0px;border:none;list-style:decimal;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);margin:0px 0px 1px 45px;"><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">public</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">synchronized</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> reload() {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Validate our current component state</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (!started)  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">throw</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> </span><span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">new</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> IllegalStateException  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                (sm.getString(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;containerBase.notStarted&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">, logName()));  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Make sure reloading is enabled</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">//      if (!reloadable)</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">//          throw new IllegalStateException</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">//              (sm.getString(&quot;standardContext.notReloadable&quot;));</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">(log.isInfoEnabled())  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            log.info(sm.getString(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;standardContext.reloadingStarted&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">,  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    getName()));  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:rgb(0, 130, 0);background-color:inherit;">// Stop accepting requests temporarily</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        setPaused(<span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">true</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">try</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            stop();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">catch</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (LifecycleException e) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            log.error(sm.getString(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;standardContext.stoppingContext&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">,  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    getName()), e);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">try</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            start();  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        } <span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">catch</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"> (LifecycleException e) {  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">            log.error(sm.getString(<span style="margin:0px;padding:0px;border:none;color:red;background-color:inherit;">&quot;standardContext.startingContext&quot;</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">,  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">                    getName()), e);  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        }  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">        setPaused(<span style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;font-weight:bold;">false</span><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">);  </span></span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);background-color:rgb(248, 248, 248);color:rgb(85, 85, 85);line-height:150%;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">  </span></li><li style="border:none;list-style-type:decimal-leading-zero;list-style-image:initial;border-left:3px solid rgb(153, 153, 153);line-height:150%;background-color:rgb(255, 255, 255);color:inherit;margin:0px;padding:0px 3px 0px 10px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">    }  </span></li></ol></div><br/>
<br/>
<p style="margin:0px;padding:0px;"></p>
<p style="margin:0px;padding:0px;"></p>
<p style="margin:0px;padding:0px;">     参考资料：http://blog.csdn<a href="http://lib.csdn.net/base/dotnet" style="color:#df3434;text-decoration:none;font-weight:bold;" target="_blank" title=".NET知识库">.NET</a>/aesop_wubo/article/details/7582266</p>
<p style="margin:0px;padding:0px;">     http://my.oschina<a href="http://lib.csdn.net/base/dotnet" style="color:#df3434;text-decoration:none;font-weight:bold;" target="_blank" title=".NET知识库">.Net</a>/321tiantian/blog/69399</p>
<p style="margin:0px;padding:0px;">     http://developer.51cto.com/art/201003/185704.htm</p>
<p style="margin:0px;padding:0px;">     <a href="http://blog.csdn.net/yangwen0406/article/details/8545893" style="color:rgb(202, 0, 0);text-decoration:none;" target="_blank">http://blog.csdn.net/yangwen0406/article/details/8545893</a></p>
<p style="margin:0px;padding:0px;">     <a href="http://blog.csdn.net/chief1985/article/details/4440398" style="color:rgb(202, 0, 0);text-decoration:none;" target="_blank">http://blog.csdn.net/chief1985/article/details/4440398</a></p>
<p style="margin:0px;padding:0px;">     <a href="http://blog.chenlb.com/2009/06/java-classloader-architecture.html" style="color:rgb(202, 0, 0);text-decoration:none;" target="_blank">http://blog.chenlb.com/2009/06/java-classloader-architecture.html</a></p>
<p style="margin:0px;padding:0px;"><br/>
</p>
   
</div>









<div style="zoom:1;float:right;">
<a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="padding-left:17px;color:rgb(51, 51, 51);background-image:url('http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=d754dcc0.png') !important;background-position:0 0 !important;float:left;font-size:12px;text-decoration:none;line-height:16px;height:16px;background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;"></a>
<a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="line-height:16px;color:rgb(202, 0, 0);background-position:0 -52px !important;text-decoration:none;font-size:12px;padding-left:17px;float:left;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;" title="分享到QQ空间"></a>
<a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="line-height:16px;color:rgb(202, 0, 0);background-position:0 -104px !important;text-decoration:none;font-size:12px;padding-left:17px;float:left;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;" title="分享到新浪微博"></a>
<a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="line-height:16px;color:rgb(202, 0, 0);background-position:0 -260px !important;text-decoration:none;font-size:12px;padding-left:17px;float:left;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;" title="分享到腾讯微博"></a>
<a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="line-height:16px;color:rgb(202, 0, 0);background-position:0 -208px !important;text-decoration:none;font-size:12px;padding-left:17px;float:left;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;" title="分享到人人网"></a>
<a href="http://blog.csdn.net/liweisnake/article/details/8470285#" style="line-height:16px;color:rgb(202, 0, 0);background-position:0 -1612px !important;text-decoration:none;font-size:12px;padding-left:17px;float:left;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;" title="分享到微信"></a>
<span style="visibility:hidden;display:block;height:0px;clear:both;">.</span></div>



   

    










 


        <div style="display:block;clear:both;width:182px;margin:0px auto;padding:30px 0px 15px;text-align:center;">
            <dl style="display:inline-block;float:left;width:72px;height:72px;overflow:hidden;margin:0px 2px;background:rgb(153, 153, 153);text-align:center;color:rgb(255, 255, 255);cursor:pointer;">
               
                 <dt style="margin:0px;padding:12px 0px 3px;color:rgb(255, 255, 255);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:27px;line-height:30px;font-family:&quot;Microsoft YaHei&quot;;">顶</dt>
                <dd style="margin:0px;color:rgb(255, 255, 255);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:22px;font-family:Arial;">1</dd>
            </dl>
           
              
            <dl style="display:inline-block;float:left;width:72px;height:72px;overflow:hidden;margin:0px 2px;background:rgb(153, 153, 153);text-align:center;color:rgb(255, 255, 255);cursor:pointer;">
              
                  <dt style="margin:0px;padding:12px 0px 3px;color:rgb(255, 255, 255);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:27px;line-height:30px;font-family:&quot;Microsoft YaHei&quot;;">踩</dt>
                <dd style="margin:0px;color:rgb(255, 255, 255);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:22px;font-family:Arial;">0</dd>               
            </dl>
            
        <span style="text-align:center;display:block;height:0px;clear:both;visibility:hidden;">.</span></div>
     <div><a href="#" style="color:rgb(202, 0, 0);text-decoration:none;"> </a>   </div>
    <div> <a href="#" style="color:rgb(202, 0, 0);text-decoration:none;"> </a></div>
    

   <ul style="line-height:24px;display:block;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:14px;color:rgb(102, 102, 102);font-family:&quot;Microsoft YaHei&quot;, Arial, Helvetica, sans-serif;clear:both;float:left;margin:0px 0px 5px;padding:10px 0px 0px;margin-top:30px;">
                <li style="list-style-type:none;clear:both;padding:0px 0px 3px;overflow:hidden;"><span style="color:rgb(255, 255, 255);display:block;width:52px;padding:0px 0px 0px 27px;height:26px;background-color:rgb(153, 153, 153);float:left;font-size:14px;margin-right:7px;background-image:url(&quot;http://static.blog.csdn.net/skin/dark1/css/../images/blog-page-arr.png&quot;);background-repeat:no-repeat;background-position:9px 8px;">上一篇</span><a href="http://blog.csdn.net/liweisnake/article/details/8458870" style="text-decoration:none;display:block;float:left;font-size:14px;color:rgb(51, 51, 51);">java超时控制</a></li>
                <li style="list-style-type:none;clear:both;padding:0px 0px 3px;overflow:hidden;"><span style="color:rgb(255, 255, 255);display:block;width:52px;padding:0px 0px 0px 27px;height:26px;background-color:rgb(153, 153, 153);float:left;font-size:14px;margin-right:7px;background-image:url(&quot;http://static.blog.csdn.net/skin/dark1/css/../images/blog-page-arr.png&quot;);background-repeat:no-repeat;background-position:9px -22px;">下一篇</span><a href="http://blog.csdn.net/liweisnake/article/details/8513295" style="text-decoration:none;display:block;float:left;font-size:14px;color:rgb(51, 51, 51);">tomcat6中的请求流程</a></li>
    <span style="color:rgb(102, 102, 102);font-style:normal;font-variant:normal;font-weight:normal;font-size:14px;line-height:24px;font-family:&quot;Microsoft YaHei&quot;, Arial, Helvetica, sans-serif;display:block;height:0px;clear:both;visibility:hidden;">.</span></ul>

    <div style="clear:both;height:10px;"></div>


        <div style="overflow:hidden;">
                <h4 style="margin:0px;padding:0px;font-size:16px;color:rgb(51, 51, 51);">我的同类文章</h4>
                <div style="border:1px solid rgb(187, 187, 187);margin:20px 0px 0px 0px;">
                    <div style="line-height:45px;border-bottom:1px solid rgb(220, 220, 220);">
                                <span style="display:inline-block;margin-left:25px;font-size:16px;color:rgb(102, 102, 102);font-weight:bold;">
                                    <span style="cursor:pointer;">tomcat<em style="font-style:normal;">（5）</em></span>
                                </span>
                    </div>
                   
                    <div style="background:rgb(252, 252, 252);max-height:195px;overflow-y:auto;padding:10px 20px;">
                        
                        <ul style="float:left;width:49%;list-style:none;margin:0px;padding:0px;"><li style="list-style:none;line-height:30px;"><em style="font-style:normal;display:inline-block;vertical-align:middle;margin-right:10px;">•</em><a href="http://blog.csdn.net/liweisnake/article/details/8827243" style="text-decoration:none;color:rgb(51, 51, 51);display:inline-block;width:50%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;vertical-align:middle;" target="_blank" title="搞清tomcat中的编解码">搞清tomcat中的编解码</a><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;">2013-04-20</span><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;"><i style="font-weight:normal;font-style:normal;">阅读</i><b style="font-weight:normal;font-style:normal;margin-left:5px;">3413</b></span></li> <li style="list-style:none;line-height:30px;"><em style="font-style:normal;display:inline-block;vertical-align:middle;margin-right:10px;">•</em><a href="http://blog.csdn.net/liweisnake/article/details/8556663" style="text-decoration:none;color:rgb(51, 51, 51);display:inline-block;width:50%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;vertical-align:middle;" target="_blank" title="tomcat架构以及生命周期">tomcat架构以及生命周期</a><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;">2013-06-12</span><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;"><i style="font-weight:normal;font-style:normal;">阅读</i><b style="font-weight:normal;font-style:normal;margin-left:5px;">1020</b></span></li> <li style="list-style:none;line-height:30px;"><em style="font-style:normal;display:inline-block;vertical-align:middle;margin-right:10px;">•</em><a href="http://blog.csdn.net/liweisnake/article/details/8513295" style="text-decoration:none;color:rgb(51, 51, 51);display:inline-block;width:50%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;vertical-align:middle;" target="_blank" title="tomcat6中的请求流程">tomcat6中的请求流程</a><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;">2013-01-17</span><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;"><i style="font-weight:normal;font-style:normal;">阅读</i><b style="font-weight:normal;font-style:normal;margin-left:5px;">826</b></span></li> </ul>

                        <ul style="float:right;width:49%;list-style:none;margin:0px;padding:0px;"><li style="list-style:none;line-height:30px;"><em style="font-style:normal;display:inline-block;vertical-align:middle;margin-right:10px;">•</em><a href="http://blog.csdn.net/liweisnake/article/details/8824766" style="text-decoration:none;color:rgb(51, 51, 51);display:inline-block;width:50%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;vertical-align:middle;" target="_blank" title="tomcat中的Lifecycle架构">tomcat中的Lifecycle架构</a><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;">2013-04-19</span><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;"><i style="font-weight:normal;font-style:normal;">阅读</i><b style="font-weight:normal;font-style:normal;margin-left:5px;">832</b></span></li> <li style="list-style:none;line-height:30px;"><em style="font-style:normal;display:inline-block;vertical-align:middle;margin-right:10px;">•</em><a href="http://blog.csdn.net/liweisnake/article/details/8524179" style="text-decoration:none;color:rgb(51, 51, 51);display:inline-block;width:50%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;vertical-align:middle;" target="_blank" title="tomcat中对客户端的缓存机制">tomcat中对客户端的缓存机制</a><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;">2013-01-23</span><span style="font-size:12px;color:rgb(187, 187, 187);display:inline-block;margin-left:9px;"><i style="font-weight:normal;font-style:normal;">阅读</i><b style="font-weight:normal;font-style:normal;margin-left:5px;">2012</b></span></li> </ul>
                    </div>
                </div>
            </div>    
    
      
</div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 