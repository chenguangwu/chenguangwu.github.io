<html>
<head>
  <title>Spring MVC防止数据重复提交 - - ITeye博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="12870"/>
<h1>Spring MVC防止数据重复提交 - - ITeye博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2019/8/28 15:17</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://www.iteye.com/blog/ljz0721cx-2181581"><i>https://www.iteye.com/blog/ljz0721cx-2181581</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="box-sizing:border-box;"><div style="text-align:center;font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:12px;line-height:1.5;color:black;background:white;box-sizing:border-box;"><div style="background:white;text-align:center;background-color:rgb(239, 250, 255);box-sizing:border-box;"><div style="text-align:left;box-sizing:border-box;"><div style="overflow:hidden;background-color:white;box-sizing:border-box;"><div style="background-color:white;box-sizing:border-box;"><div style="font-size:14px;line-height:1.8em;box-sizing:border-box;">
    
    来讲一下如何在Spring MVC里面解决此问题（其它框架也一样，逻辑一样，思想一样，和具体框架没什么关系）。要解决重复提交，有很多办法，比如说在提交完成后redirect一下，也可以用本文提到的使用token的方法（我不使用redirect是因为那样解决不了ajax提交数据或者移动应用提交数据，另一个原因是现在比较通行的方法是使用token，像python里的django框架也是使用token来解决）。
<br style="box-sizing:border-box;"/>使用token的逻辑是，给所有的url加一个拦截器，在拦截器里面用java的UUID生成一个随机的UUID并把这个UUID放到session里面，然后在浏览器做数据提交的时候将此UUID提交到服务器。服务器在接收到此UUID后，检查一下该UUID是否已经被提交，如果已经被提交，则不让逻辑继续执行下去…
<br style="box-sizing:border-box;"/>注解Token代码：
<br style="box-sizing:border-box;"/><div style="font-family:Monaco, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;background-color:transparent;width:97%;overflow:auto;margin-left:9px;padding:1px;word-break:break-all;overflow-wrap:break-word;margin:0px;box-sizing:border-box;"><div style="margin:0px;padding:0px;box-sizing:border-box;"><div style="padding:3px;text-align:left;margin:0px;color:black;font-weight:bold;box-sizing:border-box;">Java代码 <div style="box-sizing:border-box;"></div> <a href="#" style="color:rgb(16, 138, 198);text-decoration:underline;box-sizing:border-box;" title="收藏这段代码"><img src="Spring MVC防止数据重复提交 - - ITeye博客_files/Image.png" type="image/png" data-filename="Image.png" alt="收藏代码" height="14" style="border:0px;box-sizing:border-box;" width="15"/></a></div></div><ol start="1" style="font-size:1em;line-height:1.4em;margin:0px 0px 1px;padding:2px 0px;border:1px solid rgb(209, 215, 220);list-style:decimal;background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);box-sizing:border-box;"><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;"><span style="color:rgb(100, 100, 100);box-sizing:border-box;">@Target</span><span style="color:black;box-sizing:border-box;">(ElementType.METHOD)  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;"><span style="color:rgb(100, 100, 100);box-sizing:border-box;">@Retention</span><span style="color:black;box-sizing:border-box;">(RetentionPolicy.RUNTIME)  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;"><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">public</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">@interface</span><span style="color:black;box-sizing:border-box;"> Token {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">   </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">    <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">boolean</span><span style="color:black;box-sizing:border-box;"> save() </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">default</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">false</span><span style="color:black;box-sizing:border-box;">;  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">   </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">    <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">boolean</span><span style="color:black;box-sizing:border-box;"> remove() </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">default</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">false</span><span style="color:black;box-sizing:border-box;">;  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">}  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">拦截器TokenInterceptor代码：  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;"><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">public</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">class</span><span style="color:black;box-sizing:border-box;"> TokenInterceptor </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">extends</span><span style="color:black;box-sizing:border-box;"> HandlerInterceptorAdapter {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">   </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">    <span style="color:rgb(100, 100, 100);box-sizing:border-box;">@Override</span><span style="color:black;box-sizing:border-box;">  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">    <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">public</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">boolean</span><span style="color:black;box-sizing:border-box;"> preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">throws</span><span style="color:black;box-sizing:border-box;"> Exception {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">if</span><span style="color:black;box-sizing:border-box;"> (handler </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">instanceof</span><span style="color:black;box-sizing:border-box;"> HandlerMethod) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            HandlerMethod handlerMethod = (HandlerMethod) handler;  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            Method method = handlerMethod.getMethod();  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            Token annotation = method.getAnnotation(Token.<span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">class</span><span style="color:black;box-sizing:border-box;">);  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">if</span><span style="color:black;box-sizing:border-box;"> (annotation != </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">null</span><span style="color:black;box-sizing:border-box;">) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">boolean</span><span style="color:black;box-sizing:border-box;"> needSaveSession = annotation.save();  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">if</span><span style="color:black;box-sizing:border-box;"> (needSaveSession) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                    request.getSession(<span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">false</span><span style="color:black;box-sizing:border-box;">).setAttribute(</span><span style="color:blue;box-sizing:border-box;">&quot;token&quot;</span><span style="color:black;box-sizing:border-box;">, UUID.randomUUID().toString());  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">boolean</span><span style="color:black;box-sizing:border-box;"> needRemoveSession = annotation.remove();  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">if</span><span style="color:black;box-sizing:border-box;"> (needRemoveSession) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                    <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">if</span><span style="color:black;box-sizing:border-box;"> (isRepeatSubmit(request)) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                        <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">return</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">false</span><span style="color:black;box-sizing:border-box;">;  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                    }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                    request.getSession(<span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">false</span><span style="color:black;box-sizing:border-box;">).removeAttribute(</span><span style="color:blue;box-sizing:border-box;">&quot;token&quot;</span><span style="color:black;box-sizing:border-box;">);  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">                }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">return</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">true</span><span style="color:black;box-sizing:border-box;">;  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        } <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">else</span><span style="color:black;box-sizing:border-box;"> {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">return</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">super</span><span style="color:black;box-sizing:border-box;">.preHandle(request, response, handler);  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">    }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">   </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">    <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">private</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">boolean</span><span style="color:black;box-sizing:border-box;"> isRepeatSubmit(HttpServletRequest request) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        String serverToken = (String) request.getSession(<span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">false</span><span style="color:black;box-sizing:border-box;">).getAttribute(</span><span style="color:blue;box-sizing:border-box;">&quot;token&quot;</span><span style="color:black;box-sizing:border-box;">);  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">if</span><span style="color:black;box-sizing:border-box;"> (serverToken == </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">null</span><span style="color:black;box-sizing:border-box;">) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">return</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">true</span><span style="color:black;box-sizing:border-box;">;  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        String clinetToken = request.getParameter(<span style="color:blue;box-sizing:border-box;">&quot;token&quot;</span><span style="color:black;box-sizing:border-box;">);  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">if</span><span style="color:black;box-sizing:border-box;"> (clinetToken == </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">null</span><span style="color:black;box-sizing:border-box;">) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">return</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">true</span><span style="color:black;box-sizing:border-box;">;  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">if</span><span style="color:black;box-sizing:border-box;"> (!serverToken.equals(clinetToken)) {  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">            <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">return</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">true</span><span style="color:black;box-sizing:border-box;">;  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">        <span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">return</span><span style="color:black;box-sizing:border-box;"> </span><span style="color:rgb(127, 0, 85);font-weight:bold;box-sizing:border-box;">false</span><span style="color:black;box-sizing:border-box;">;  </span></span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">    }  </span></li><li style="font-size:1em;margin:0px 0px 0px 38px;padding:0px;border-left:1px solid rgb(209, 215, 220);background-color:rgb(250, 250, 250);padding-left:10px;line-height:18px;box-sizing:border-box;"><span style="color:black;box-sizing:border-box;">}  </span></li></ol></div>
<br style="box-sizing:border-box;"/>相应的sping容器的额配置文件自己加上
<br style="box-sizing:border-box;"/>相关代码已经注释，相信你能看懂。
<br style="box-sizing:border-box;"/>关于这个方法的用法是：在需要生成token的controller上增加@Token(save=true)，而在需要检查重复提交的controller上添加@Token(remove=true)就可以了。
<br style="box-sizing:border-box;"/>另外，你需要在view里在form里增加下面代码：
<br style="box-sizing:border-box;"/>&lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;${token}&quot; /&gt;
<br style="box-sizing:border-box;"/>已经完成了，去试试看你的数据还能重复提交了吧。

  


  <div style="display:block;margin:0px;padding:0px;box-sizing:border-box;">
    
    <div style="display:inline-block;float:right;width:160px;height:32px;margin:0px;padding:27px 5px 0px 0px;background:none;color:rgb(51, 51, 51);text-align:right;cursor:auto;font:12px/32px Arial, Helvetica, sans-serif;box-sizing:border-box;">分享到：
      <a href="#" style="color:rgb(16, 138, 198);text-decoration:underline;background:transparent;box-sizing:border-box;" title="分享到新浪微博"><img src="Spring MVC防止数据重复提交 - - ITeye博客_files/Image.jpg" type="image/jpeg" data-filename="Image.jpg" height="16" style="border:0px;margin:0px 5px;box-sizing:border-box;" width="16"/></a>
      <a href="#" style="color:rgb(16, 138, 198);text-decoration:underline;background:transparent;box-sizing:border-box;" title="分享到腾讯微博"><img src="Spring MVC防止数据重复提交 - - ITeye博客_files/Image [1].jpg" type="image/jpeg" data-filename="Image.jpg" height="16" style="border:0px;margin:0px 5px;box-sizing:border-box;" width="16"/></a>
    </div>
  <span style="display:block;height:0px;clear:both;visibility:hidden;"> </span></div>

  <div style="right:20px;margin-bottom:15px;margin:0px;padding:0px;box-sizing:border-box;">
    <div style="float:right;text-align:right;padding-top:5px;margin:0px;padding:0px;box-sizing:border-box;">
      <a href="https://www.iteye.com/blog/2183434" style="color:rgb(16, 138, 198);text-decoration:underline;padding:0px 15px;background-repeat:no-repeat;background-image:url(&quot;/images/gray_west_arrow.gif&quot;);background-position:left center;box-sizing:border-box;" title="Spring Data JPA入门">Spring Data JPA入门</a>
      |
      <a href="https://www.iteye.com/blog/2181575" style="color:rgb(16, 138, 198);text-decoration:underline;padding:0px 15px;background-repeat:no-repeat;background-image:url(&quot;/images/gray_east_arrow.gif&quot;);background-position:right center;box-sizing:border-box;" title="shrio 权限管理filterChainDefinitions过滤器配置">shrio 权限管理filterChainDefinitions过滤 ...</a>
    </div>
  </div>
  <div style="padding:15px 0px 5px;margin:0px;box-sizing:border-box;">
    <ul style="margin:0px;padding:0px;box-sizing:border-box;">
      <li style="margin:0px 10px 0px 0px;padding:0px;list-style:none;display:inline;float:left;padding-right:10px;border-right:1px solid;border-right-color:rgb(16, 138, 198);color:rgb(16, 138, 198);box-sizing:border-box;">2015-01-30 09:35</li>
      <li style="margin:0px 10px 0px 0px;padding:0px;list-style:none;display:inline;float:left;padding-right:10px;border-right:1px solid;border-right-color:rgb(16, 138, 198);color:rgb(16, 138, 198);box-sizing:border-box;">浏览 1613</li>
      <li style="margin:0px 10px 0px 0px;padding:0px;list-style:none;display:inline;float:left;padding-right:10px;border-right:1px solid;border-right-color:rgb(16, 138, 198);color:rgb(16, 138, 198);box-sizing:border-box;"><a href="https://www.iteye.com/blog/ljz0721cx-2181581#comments" style="color:rgb(16, 138, 198);text-decoration:underline;box-sizing:border-box;">评论(0)</a></li>
      
      
      <li style="margin:0px 10px 0px 0px;padding:0px;list-style:none;display:inline;float:left;padding-right:10px;border-right:1px solid;border-right-color:rgb(16, 138, 198);color:rgb(16, 138, 198);box-sizing:border-box;">分类:<a href="https://www.iteye.com/blogs/category/language" style="color:rgb(16, 138, 198);text-decoration:underline;box-sizing:border-box;">编程语言</a></li>      
      <li style="margin:0px 10px 0px 0px;padding:0px;list-style:none;display:inline;float:left;padding-right:10px;border-right:none;border-right-color:rgb(16, 138, 198);color:rgb(16, 138, 198);box-sizing:border-box;"><a href="https://www.iteye.com/wiki/blog/2181581" style="color:rgb(16, 138, 198);text-decoration:underline;padding-right:50px;background-repeat:no-repeat;background-image:url(&quot;/images/icon_more.gif&quot;);background-position:right center;box-sizing:border-box;" target="_blank">查看更多</a></li>
    </ul>    
  </div>
    
  <div style="margin-top:15px;padding:15px;border-top:1px solid gray;width:685px;border-top-color:rgb(16, 138, 198);margin:0px;box-sizing:border-box;">
    <h5 style="font-size:1.1em;line-height:1.3em;margin:0px;padding:0px;color:black;box-sizing:border-box;font-weight:400;">评论</h5>
    <a name="comments" style="color:rgb(16, 138, 198);text-decoration:underline;box-sizing:border-box;"></a>
    
    
    
  </div>

  <div style="margin-top:15px;padding:15px;border-top:1px solid gray;width:685px;border-top-color:rgb(16, 138, 198);margin:0px;box-sizing:border-box;">
    <h5 style="font-size:1.1em;line-height:1.3em;margin:0px;padding:0px;color:black;box-sizing:border-box;font-weight:400;">发表评论</h5>
            <p style="margin:0px;padding:0px;box-sizing:border-box;text-align:center;margin-top:30px;margin-bottom:0px;"><a href="https://www.iteye.com/login" style="color:rgb(16, 138, 198);text-decoration:underline;box-sizing:border-box;background-color:white;"> <img src="Spring MVC防止数据重复提交 - - ITeye博客_files/Image [1].png" type="image/png" data-filename="Image.png" height="32" style="border:0px;box-sizing:border-box;vertical-align:middle;margin-right:10px;" width="26"/></a><a href="https://www.iteye.com/login" style="color:rgb(16, 138, 198);text-decoration:underline;box-sizing:border-box;">  您还没有登录,请您登录后再发表评论 </a></p>
      </div>
  </div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 