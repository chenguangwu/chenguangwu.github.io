<html>
<head>
  <title>阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2023"/>
<h1>阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2019/5/7 15:58</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://www.cnblogs.com/jiangwz/p/10564749.html"><i>https://www.cnblogs.com/jiangwz/p/10564749.html</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div><div style="font-family:&quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;color:rgb(0, 0, 0);background-color:rgb(230, 230, 230);font-size:14px;text-size-adjust:none;"><div style="min-width:0px;background-color:rgb(255, 255, 255);box-shadow:rgba(100, 100, 100, 0.3) 0px 2px 6px;"><div style="text-align:left;"><div style="text-overflow:ellipsis;overflow:hidden;"><div><div><div style="text-overflow:ellipsis;overflow:hidden;"><div>
		<h1 style="margin:0px;padding:0px;font-size:130%;font-weight:bold;border-left:3px solid rgb(33, 117, 155);margin-bottom:10px;float:left;width:auto;clear:both;border:0px;line-height:1.5;padding-left:5px;">
			<a href="https://www.cnblogs.com/jiangwz/p/10564749.html" style="margin:0px;padding:0px;outline:none;color:rgb(33, 117, 155);text-decoration:none;transition:all 0.4s linear 0s;">阿里 EasyExcel 使用及避坑</a>
		</h1>
		<div style="clear:both;margin:0px;padding:0px;"></div>
		<div style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.7;font-size:14px;">
			<div style="margin-bottom:20px;word-break:break-word;margin:0px;padding:0px;"><p style="margin:10px auto;text-indent:0px;padding:0px;">github地址：<a href="https://github.com/alibaba/easyexcel" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" target="_blank">https://github.com/alibaba/easyexcel</a></p>
<p style="margin:10px auto;text-indent:0px;padding:0px;">原本在项目中使用EasyPoi读取excel，后来为了统一技术方案，改用阿里的EasyExcel。EasyExcel和EasyPoi有一定的相似之处。</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;">EasyExcel和EasyPoi效率对比：</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/1176316-20190320141249925-678493912.png" type="image/png" data-filename="1176316-20190320141249925-678493912.png" alt="" height="415" style="border:0px;max-width:300px;height:auto;margin:0px;padding:0px;" width="554"/></p>
<p style="margin:10px auto;text-indent:0px;padding:0px;"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/1176316-20190320141256016-249819580.png" type="image/png" data-filename="1176316-20190320141256016-249819580.png" alt="" height="415" style="border:0px;max-width:300px;height:auto;margin:0px;padding:0px;" width="554"/></p>
<p style="margin:10px auto;text-indent:0px;padding:0px;">因为数据量少，从效率上看几乎没有差别，EasyExcel略胜一筹。</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;"> </p>
<p style="margin:10px auto;text-indent:0px;padding:0px;">使用maven的方式引用EasyExcel</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;"><a href="https://mvnrepository.com/artifact/com.alibaba/easyexcel" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" target="_blank">https://mvnrepository.com/artifact/com.alibaba/easyexcel</a></p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-size:12px;">
<pre style="overflow-wrap:break-word;white-space:pre-wrap;font-family:&quot;Courier New&quot;;font-size:12px;margin-top:0px;margin-bottom:0px;margin:0px;padding:0px;">        <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">&lt;!--</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">easyexcel</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">--&gt;</span>
        <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&lt;</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#800000;">dependency</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&gt;</span>
            <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&lt;</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#800000;">groupId</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&gt;</span>com.alibaba<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&lt;/</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#800000;">groupId</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&gt;</span>
            <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&lt;</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#800000;">artifactId</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&gt;</span>easyexcel<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&lt;/</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#800000;">artifactId</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&gt;</span>
            <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&lt;</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#800000;">version</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&gt;</span>1.1.2-beat1<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&lt;/</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#800000;">version</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&gt;</span>
        <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&lt;/</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#800000;">dependency</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">&gt;</span></pre>
</div>
<p style="margin:10px auto;text-indent:0px;padding:0px;">使用Java模型的方式使用easyexcel</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;">Java模型</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-size:12px;"><div style="background-color:rgb(245, 245, 245);margin-top:5px;margin:0px;padding:0px;"><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;padding-right:5px;margin:0px;padding:0px;"><a href="#" style="background-color:rgb(245, 245, 245);border:none;margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="复制代码"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/copycode.gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="border:none;background-color:rgb(245, 245, 245);max-width:300px;height:auto;margin:0px;padding:0px;" width="20"/></a></span></div>
<pre style="overflow-wrap:break-word;white-space:pre-wrap;font-family:&quot;Courier New&quot;;font-size:12px;margin-top:0px;margin-bottom:0px;margin:0px;padding:0px;"><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">@Data
</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">public</span> <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">class</span> TotalAmount <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">extends</span> BaseRowModel <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">implements</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> Serializable {
    
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">private</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> Integer id;

    @ExcelProperty(value </span>=&quot;类型&quot;,index = 0<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">)
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">private</span> String type;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">//</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">开支类型 信用卡等</span>
<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">
    @ExcelProperty(value </span>= &quot;金额&quot;,index =1<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">)
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">private</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> String sum;

    @ExcelProperty(value </span>= &quot;来源&quot;,index =2<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">)
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">private</span> String name;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">//</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">开支来源  如：**银行信用卡</span>
<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">
    @ExcelProperty(value </span>= &quot;日期&quot;,index =3<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">)
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">private</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> String date;

    @ExcelProperty(value </span>= &quot;状态&quot;,index =4<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">)
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">private</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> Integer status;

    @ExcelProperty(value </span>= &quot;备注&quot;,index =5<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">)
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">private</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> String descr;


}</span></pre>
<div style="background-color:rgb(245, 245, 245);margin-top:5px;margin:0px;padding:0px;"><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;padding-right:5px;margin:0px;padding:0px;"><a href="#" style="background-color:rgb(245, 245, 245);border:none;margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="复制代码"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/copycode [1].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="border:none;background-color:rgb(245, 245, 245);max-width:300px;height:auto;margin:0px;padding:0px;" width="20"/></a></span></div></div>
<p style="margin:10px auto;text-indent:0px;padding:0px;">使用Java模型的方式需要继承 BaseRowModel ，字段上使用 @ExcelProperty 注解，注解中 value 属性指定字段名，index属性指定字段排序。</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#ff0000;"><strong style="margin:0px;padding:0px;">注意：这里和EasyExcel不同的是，目前可以使用只指定index和同时指定index和value的方式来匹配excel文件，但是如果只指定value，则无法读取。</strong></span></p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-size:12px;"><div style="background-color:rgb(245, 245, 245);margin-top:5px;margin:0px;padding:0px;"><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;padding-right:5px;margin:0px;padding:0px;"><a href="#" style="background-color:rgb(245, 245, 245);border:none;margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="复制代码"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/copycode [2].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="border:none;background-color:rgb(245, 245, 245);max-width:300px;height:auto;margin:0px;padding:0px;" width="20"/></a></span></div>
<pre style="overflow-wrap:break-word;white-space:pre-wrap;font-family:&quot;Courier New&quot;;font-size:12px;margin-top:0px;margin-bottom:0px;margin:0px;padding:0px;">    @RequestMapping(&quot;/importExce&quot;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">)
    @ResponseBody
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">public</span> JsonResponse importExcel(@RequestParam(&quot;excelFile&quot;) MultipartFile excelFile, String type) <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">throws</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> IOException {
        JsonResponse jsonResponse </span>= <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">new</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> JsonResponse();
        String sm</span>=&quot;2019-02&quot;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">;
        List</span>&lt;Object&gt; dataList = <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">null</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">;
        dataList </span>= EasyExcelFactory.read(excelFile.getInputStream(), <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">new</span> Sheet(3, 1, TotalAmount.<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">class</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">));
        </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">int</span> scuess = 0<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">;
        </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">int</span> error = 0<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">;
        </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">for</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> (Object o : dataList) {
            </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">if</span> (o <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">instanceof</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> TotalAmount) {
                TotalAmount importEntity </span>=<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> (TotalAmount) o;

                </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">try</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> {

                } </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">catch</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> (Exception e) {
                    error</span>++<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">;
                    e.printStackTrace();
                    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">continue</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">;
                }
            }
        }
    }

</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">/*</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">    @RequestMapping(&quot;/importExce&quot;)
    @ResponseBody
    public JsonResponse importExce(){
        JsonResponse jsonResponse = new JsonResponse();
        File excelFile = new File
                (&quot;E:\\工作文档\\部门架构201902(bug).xlsx&quot;);
        String sm=&quot;2019-02&quot;;
        InputStream inputStream = new FileInputStream(excelFile);
        List&lt;Object&gt; dataList = null;
        dataList = EasyExcelFactory.read(inputStream, new Sheet(3, 1, TotalAmount.class));
        int scuess = 0;
        int error = 0;
        for (Object o : dataList) {
            if (o instanceof TotalAmount) {
                TotalAmount importEntity = (TotalAmount) o;

                try {

                } catch (Exception e) {
                    error++;
                    e.printStackTrace();
                    continue;
                }
            }
        }
    }</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">*/</span></pre>
<div style="background-color:rgb(245, 245, 245);margin-top:5px;margin:0px;padding:0px;"><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;padding-right:5px;margin:0px;padding:0px;"><a href="#" style="background-color:rgb(245, 245, 245);border:none;margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="复制代码"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/copycode [3].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="border:none;background-color:rgb(245, 245, 245);max-width:300px;height:auto;margin:0px;padding:0px;" width="20"/></a></span></div></div>
<p style="margin:10px auto;text-indent:0px;padding:0px;">注意：在使用EasyExcel时容易出的几个错误：</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#ff0000;">For input &quot;&quot; 类型错误，应该是double等类型的字段有非double类型的数据</span></strong></p>
<p style="margin:10px auto;text-indent:0px;padding:0px;"><strong style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#ff0000;">java.lang.NumberFormatException: multiple points 多线程使用非线程安全类报错，实际是在日期格式里有并非指定日期格式的数据，比如空格，比如指定 yyyy/mm/dd 但数据是 yyyy-mm-dd</span></strong></p>
<p style="margin:10px auto;text-indent:0px;padding:0px;">使用easyexcel写出excel：</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;">使用Java模型方式，返回模型列表，带入方法即可</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-size:12px;"><div style="background-color:rgb(245, 245, 245);margin-top:5px;margin:0px;padding:0px;"><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;padding-right:5px;margin:0px;padding:0px;"><a href="#" style="background-color:rgb(245, 245, 245);border:none;margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="复制代码"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/copycode [4].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="border:none;background-color:rgb(245, 245, 245);max-width:300px;height:auto;margin:0px;padding:0px;" width="20"/></a></span></div>
<pre style="overflow-wrap:break-word;white-space:pre-wrap;font-family:&quot;Courier New&quot;;font-size:12px;margin-top:0px;margin-bottom:0px;margin:0px;padding:0px;">    <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">/**</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">
     * 导出Excel
     *
     * </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#808080;">@param</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;"> request
     * </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#808080;">@param</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;"> response
     * </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#808080;">@param</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;"> map
     * </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#808080;">@throws</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;"> IOException
     </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#008000;">*/</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">
    @RequestMapping(</span>&quot;export.do&quot;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">)
    </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">public</span> <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">void</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> export(HttpServletRequest request, String type, HttpServletResponse response,
                       @RequestParam Map</span>&lt;String, Object&gt; map) <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">throws</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> IOException {
        ServletOutputStream out </span>= <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">null</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">;
        </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">try</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> {
            out </span>=<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> response.getOutputStream();
        } </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">catch</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> (IOException e) {
            e.printStackTrace();
        }
        ExcelWriter writer </span>= <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">new</span> ExcelWriter(out, ExcelTypeEnum.XLSX, <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">true</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">);
        String filename;
        String fileName </span>= <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">null</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">;
        </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">try</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> {
            filename </span>= <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">new</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> Date().toLocaleString();
            fileName </span>= <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">new</span> String((filename).getBytes(), &quot;UTF-8&quot;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">);
            Sheet sheet2 </span>= <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">new</span> Sheet(2, 3, ImportEntityEasyExcel.<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">class</span>, &quot;sheet&quot;, <span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">null</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">);
            List</span>&lt;ImportEntityEasyExcel&gt; list =<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> service.getData(map);
            response.setCharacterEncoding(</span>&quot;utf-8&quot;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">);
            response.setContentType(</span>&quot;application/vnd.ms-excel&quot;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">);
            response.setHeader(</span>&quot;content-Disposition&quot;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">,
                    </span>&quot;attachment;filename=&quot; + URLEncoder.encode(fileName + &quot;.xlsx&quot;, &quot;utf-8&quot;<span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;">));
            out.flush();
        } </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">catch</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> (Exception e) {
            e.printStackTrace();
        } </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">finally</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> {
            writer.finish();
            </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">try</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> {
                out.close();
            } </span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#0000ff;">catch</span><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;margin:0px;padding:0px;color:#000000;"> (IOException e) {
                e.printStackTrace();
            }
        }
    }</span></pre>
<div style="background-color:rgb(245, 245, 245);margin-top:5px;margin:0px;padding:0px;"><span style="font-family:&quot;Courier New&quot;;font-size:12px;line-height:1.5;padding-right:5px;margin:0px;padding:0px;"><a href="#" style="background-color:rgb(245, 245, 245);border:none;margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="复制代码"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/copycode [5].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="border:none;background-color:rgb(245, 245, 245);max-width:300px;height:auto;margin:0px;padding:0px;" width="20"/></a></span></div></div>
<p style="margin:10px auto;text-indent:0px;padding:0px;">总结：</p>
<p style="margin:10px auto;text-indent:0px;padding:0px;">easyexcel还有一些并不完善，但是大数据量操作效率高于easypoi</p></div>
<div style="clear:both;margin:0px;padding:0px;"></div>
<div style="margin-top:20px;margin:0px;padding:0px;">
<div style="margin-bottom:10px;margin:0px;padding:0px;color:rgb(102, 102, 102);"></div>
<div style="margin-top:0px;margin:0px;padding:0px;color:rgb(102, 102, 102);"></div>
<div style="margin:0px;padding:0px;"><div style="padding:10px 0px;margin-bottom:10px;margin-top:10px;border:1px dashed silver;font-size:12px;width:320px;text-align:center;margin:0px;">
        <a href="#" style="background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x;display:inline-block;padding:3px 8px;color:rgb(255, 255, 255);text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;box-shadow:rgba(0, 0, 0, 0.5) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.25) 0px -1px 1px;vertical-align:middle;background-color:rgb(45, 174, 191);border:none;margin:0px;outline:none;">好文要顶</a>
            <a href="#" style="background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x;display:inline-block;padding:3px 8px;color:rgb(255, 255, 255);text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;box-shadow:rgba(0, 0, 0, 0.5) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.25) 0px -1px 1px;vertical-align:middle;background-color:rgb(227, 49, 0);border:none;margin:0px;outline:none;">关注我</a>
    <a href="#" style="background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x;display:inline-block;padding:3px 8px;color:rgb(255, 255, 255);text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;box-shadow:rgba(0, 0, 0, 0.5) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.25) 0px -1px 1px;vertical-align:middle;background-color:rgb(255, 181, 21);border:none;margin:0px;outline:none;">收藏该文</a>
    <a href="#" style="background:none;display:inline-block;padding:3px 2px;color:rgb(255, 255, 255);text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;box-shadow:none;text-shadow:none;vertical-align:middle;border:none;margin:0px;outline:none;" title="分享至新浪微博"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/icon_weibo_24.png" type="image/png" data-filename="icon_weibo_24.png" alt="" height="24" style="border:none;vertical-align:middle;margin-left:5px;box-shadow:none;margin:0px;padding:0px;height:auto;max-width:300px;" width="24"/></a>
    <a href="#" style="background:none;display:inline-block;padding:3px 2px;color:rgb(255, 255, 255);text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;box-shadow:none;text-shadow:none;vertical-align:middle;border:none;margin:0px;outline:none;" title="分享至微信"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/wechat.png" type="image/png" data-filename="wechat.png" alt="" height="24" style="border:medium none;width:24px;height:24px;box-shadow:none;margin-left:5px;vertical-align:middle;margin:0px;padding:0px;max-width:300px;" width="24"/></a>
</div>
<div style="float:left;width:280px;margin-top:0px;margin-bottom:10px;color:rgb(0, 0, 0);margin-left:0px;font-size:12px;margin:0px;padding:0px;">
    <div style="float:left;line-height:18px;margin:0px;padding:0px;">
            <a href="http://home.cnblogs.com/u/jiangwz/" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" target="_blank"><img src="阿里 EasyExcel 使用及避坑 - 谁将新樽辞旧月，今月曾经照古人 - 博客园_files/20170619174802.png.jpg" type="image/jpeg" data-filename="20170619174802.png.jpg" alt="" height="48" style="border:0px;vertical-align:top;float:left;margin-right:5px;padding-top:5px;padding-left:2px;margin:0px;padding:0px;height:auto;max-width:300px;" width="48"/></a>
        <div style="float:left;line-height:18px;margin:0px;padding:0px;">
            <a href="http://home.cnblogs.com/u/jiangwz/" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;">谁将新樽辞旧月，今月曾经照古人</a><br style="margin:0px;padding:0px;"/>
            <a href="http://home.cnblogs.com/u/jiangwz/followees" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;">关注 - 7</a><br style="margin:0px;padding:0px;"/>
            <a href="http://home.cnblogs.com/u/jiangwz/followers" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;">粉丝 - 39</a>
        </div>
    </div>
    <div style="clear:both;margin:0px;padding:0px;"></div>
    <div style="margin:0px;padding:0px;"></div>
    <div style="margin:0px;padding:0px;">
                <a href="#" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;">+加关注</a>
    </div>
</div>
<div style="float:right;margin-bottom:10px;margin-right:30px;font-size:12px;width:125px;text-align:center;margin-top:10px;margin:0px;padding:0px;">
    <div style="float:left;width:46px;height:52px;background:url(&quot;//static.cnblogs.com/images/upup.gif&quot;) no-repeat;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;margin:0px;padding:0px;">
        <span style="font-size:14px;color:rgb(7, 93, 179);font-family:Verdana;line-height:1.5em;margin:0px;padding:0px;">0</span>
    </div>
    <div style="float:right;margin-left:20px;width:46px;height:52px;background:url(&quot;//static.cnblogs.com/images/downdown.gif&quot;) no-repeat;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;margin:0px;padding:0px;">
        <span style="font-size:14px;color:rgb(7, 93, 179);font-family:Verdana;line-height:1.5em;margin:0px;padding:0px;">0</span>
    </div>
    <div style="clear:both;margin:0px;padding:0px;"></div>
    <div style="margin-top:5px;margin-left:0px;font-size:12px;color:gray;margin:0px;padding:0px;">
    </div>
</div>
</div>
<div style="clear:both;margin:0px;padding:0px;"></div>
<div style="line-height:1.8;font-size:12px;margin:0px;padding:0px;"><a href="https://www.cnblogs.com/jiangwz/p/10456372.html" style="text-decoration:none;margin:0px;padding:0px;outline:none;color:black;">« </a> 上一篇：<a href="https://www.cnblogs.com/jiangwz/p/10456372.html" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="发布于2019-03-01 14:51">捕获异常抛出事务不回滚</a><br style="margin:0px;padding:0px;"/></div>
</div>


		</div>
		<div style="margin:0px;padding:0px;font-size:13px;background:none;color:rgb(102, 102, 102);float:left;width:100%;clear:both;text-align:left;padding-left:0px;padding-right:5px;margin-top:5px;line-height:1.5;">posted @ <span style="margin:0px;padding:0px;">2019-03-20 14:31</span> <a href="https://www.cnblogs.com/jiangwz/" style="margin:0px;padding:0px;outline:none;color:rgb(102, 102, 102);text-decoration:none;">谁将新樽辞旧月，今月曾经照古人</a> 阅读(<span style="margin:0px;padding:0px;">1388</span>) 评论(<span style="margin:0px;padding:0px;">0</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=10564749" rel="nofollow" style="margin:0px;padding:0px;outline:none;color:rgb(102, 102, 102);text-decoration:none;">编辑</a> <a href="https://www.cnblogs.com/jiangwz/p/10564749.html#" style="margin:0px;padding:0px;outline:none;color:rgb(102, 102, 102);text-decoration:none;">收藏</a></div>
	</div></div></div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 