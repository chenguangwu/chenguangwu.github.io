<html>
<head>
  <title>Node读写Excel文件探究实践-爱编程</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="6013"/>
<h1>Node读写Excel文件探究实践-爱编程</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2017/3/31 17:39</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://www.w2bc.com/article/118589"><i>http://www.w2bc.com/article/118589</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="box-sizing:border-box;font-family:sans-serif;text-size-adjust:100%;font-size:10px;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);"><div style="box-sizing:border-box;font-family:&quot;Microsoft YaHei&quot;, 微软雅黑, 宋体, Arial, Tahoma, Helvetica, sans-serif;font-size:14px;line-height:1.42857;color:rgb(51, 51, 51);background:url(&quot;http://www.w2bc.com/Content/css/../Images/body_bg.gif&quot;) repeat;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;background-color:rgb(255, 255, 255);"><div style="box-sizing:border-box;">
<div style="box-sizing:border-box;background-color:rgb(250, 250, 250);padding:15px 15px 0px;border-bottom:1px solid rgb(232, 232, 232);border-top-left-radius:4px;border-top:1px solid rgb(255, 255, 255);text-align:center;">
<h3 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin:0px;border:0px;font-size:25px;padding:15px 0px;">
Node读写Excel文件探究实践
</h3>
<div style="box-sizing:border-box;color:rgb(156, 156, 156);font-size:12px;text-align:right;padding:10px 0px;line-height:26px;">
<div style="box-sizing:border-box;color:rgb(156, 156, 156);font-size:12px;text-align:right;line-height:26px;padding:0px;float:right;margin-left:10px;">
<span style="box-sizing:border-box;padding-right:15px;">
来源：Aotu.io
</span>
<span style="box-sizing:border-box;padding-right:15px;">阅读：196</span>
<span style="box-sizing:border-box;padding-right:15px;">时间：2016-04-08 01:48</span>
</div>
<span style="box-sizing:border-box;padding-right:15px;">分享：</span>
<div style="box-sizing:border-box;zoom:1;color:rgb(156, 156, 156);font-size:12px;text-align:right;line-height:26px;padding:0px;width:135px;float:right;">
<a style="padding-left:17px;background-color:transparent;color:rgb(51, 51, 51);text-decoration:none;box-sizing:border-box;float:left;font-size:12px;line-height:16px;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;background-position:0px -104px;" title="分享到新浪微博"></a>
<a style="padding-left:17px;background-color:transparent;color:rgb(51, 51, 51);text-decoration:none;box-sizing:border-box;float:left;font-size:12px;line-height:16px;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;background-position:0px -52px;" title="分享到QQ空间"></a>
<a style="padding-left:17px;background-color:transparent;color:rgb(51, 51, 51);text-decoration:none;box-sizing:border-box;float:left;font-size:12px;line-height:16px;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;background-position:0px -1612px;" title="分享到微信">
</a>
<a style="padding-left:17px;background-color:transparent;color:rgb(51, 51, 51);text-decoration:none;box-sizing:border-box;float:left;font-size:12px;line-height:16px;height:16px;background-image:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/icons_0_16.png?v=91362611.png&quot;);background-repeat:no-repeat;cursor:pointer;margin:6px 6px 6px 0px;background-position:0px -728px;" title="分享到百度贴吧"></a>
<a style="cursor:pointer;box-sizing:border-box;margin:6px 0px 0px;text-decoration:none;background-color:transparent;font-size:12px;line-height:16px;float:left;height:16px;color:rgb(51, 51, 51);background:url(&quot;http://bdimg.share.baidu.com/static/api/css/../img/share/sc.png?v=a970ff04.png&quot;) 0px -30px no-repeat;width:42px;padding:0px;text-align:center;" title="累计分享0次">0</a>
<span style="color:rgb(156, 156, 156);font-size:12px;text-align:right;line-height:26px;visibility:hidden;display:block;height:0px;clear:both;">.</span></div>

</div>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;clear:both;display:block;overflow:hidden;visibility:hidden;height:10px;"></p>
</div>
<div style="box-sizing:border-box;font-size:16px;line-height:30px;padding:30px;">
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">本文介绍用 Node.js 中的依赖库来处理 Excel 文件，深入分析对比常见npm库处理Excel 文件存在的优缺点，主要阐述用js-xlsx、excel-export 库来处理 Excel 文件。</p>
<ul style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">有哪些外部模块支持读写Excel</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">引入依赖模块</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">编写业务逻辑函数</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">实践应用</li>
</ul>
<h2 style="box-sizing:border-box;font-family:inherit;font-weight:500;color:inherit;margin:0px;padding:0px;border:0px;line-height:40px;font-size:20px;">支持读写Excel的node.js模块 </h2>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">通过npm搜索，支持读写excel文件的模块有很多，但是都各有忧缺点，有些仅支持xls/xlsx的一种格式，有些仅支持读取数据，有些仅支持导出文件，有些需要依赖python解析。常见的npm依赖模块如下：</p>
<ul style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://github.com/SheetJS/js-xlsx" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">js-xlsx</a>
: 目前 Github 上 star 数量最多的处理 Excel 的库，支持解析多种格式表格XLSX / XLSM / XLSB / XLS / CSV，解析采用纯js实现，写入需要依赖nodejs或者 <a href="https://github.com/eligrey/FileSaver.js/" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">FileSaver</a>
.js实现生成写入Excel，可以生成子表Excel，功能强大，但上手难度稍大。不提供基础设置Excel表格api例单元格宽度，文档有些乱，不适合快速上手； </li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://github.com/mgcrea/node-xlsx" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">node-xlsx</a>
: 基于Node.js解析excel文件数据及生成excel文件，仅支持xlsx格式文件； </li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://github.com/leftshifters/excel-parser" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">excel-parser</a>
: 基于Node.js解析excel文件数据，支持xls及xlsx格式文件，需要依赖python，太重不太实用； </li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://github.com/functionscope/Node-Excel-Export" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">excel-export</a>
: 基于Node.js将数据生成导出excel文件，生成文件格式为xlsx，可以设置单元格宽度，API容易上手，无法生成worksheet字表，比较单一，基本功能可以基本满足； </li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://segmentfault.com/a/1190000004062768" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">node-xlrd</a>
: 基于node.js从excel文件中提取数据，仅支持xls格式文件,不支持xlsx,有点过时，常用的都是XLSX 格式。 </li>
</ul>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
通过以上分析对比，本人比较推崇 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">js-xlsx</code>
、 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">excel-export</code>
来读写Excel文件，可以结合使用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">js-xlsx</code>
解析Excel、 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">excel-export</code>
生成，效果更加，接下来分别实践 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">js-xlsx</code>
、 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">excel-export</code>
。 </p>
<h2 style="box-sizing:border-box;font-family:inherit;font-weight:500;color:inherit;margin:0px;padding:0px;border:0px;line-height:40px;font-size:20px;">第一讲：利用 js-xlsx 处理 Excel 文件 </h2>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">node中使用通过npm： </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;">$ npm <span style="box-sizing:border-box;">install</span> xlsx</span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">浏览器使用： </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">&lt;<span style="box-sizing:border-box;">script</span> <span style="box-sizing:border-box;">lang</span>=<span style="box-sizing:border-box;">&quot;javascript&quot;</span> <span style="box-sizing:border-box;">src</span>=<span style="box-sizing:border-box;">&quot;dist/xlsx.core.min.js&quot;</span>&gt;</span><span style="box-sizing:border-box;"></span><span style="box-sizing:border-box;">&lt;/<span style="box-sizing:border-box;">script</span>&gt;</span></span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">通过bower安装： </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">bower </span><span style="box-sizing:border-box;">install </span><span style="box-sizing:border-box;">js-xlsx</span></span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">注意</code>
，在客户端使用时，建议使用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">dist/xlsx.full.min.js</code>
，包含了js-xlsx所有模块。 </p>
<h3 style="box-sizing:border-box;font-family:inherit;font-weight:500;color:inherit;margin:0px;padding:0px;border:0px;line-height:35px;font-size:18px;">一些概念 </h3>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">在使用这个库之前，先介绍库中的一些概念。</p>
<ul style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">workbook 对象，指的是整份 Excel 文档。我们在使用 js-xlsx 读取 Excel 文档之后就会获得 workbook 对象。</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">worksheet 对象，指的是 Excel 文档中的表。我们知道一份 Excel 文档中可以包含很多张表，而每张表对应的就是 worksheet 对象。</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">cell 对象，指的就是 worksheet 中的单元格，一个单元格就是一个 cell 对象。</li>
</ul>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">它们的关系如下： </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">// workbook</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    <span style="box-sizing:border-box;">SheetNames</span>: [<span style="box-sizing:border-box;">'sheet1'</span>, <span style="box-sizing:border-box;">'sheet2'</span>],</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    <span style="box-sizing:border-box;">Sheets</span>: {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        <span style="box-sizing:border-box;">// worksheet</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        <span style="box-sizing:border-box;">'sheet1'</span>: {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">// cell</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">'A1'</span>: { ... },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">// cell</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">'A2'</span>: { ... },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            ...</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        <span style="box-sizing:border-box;">// worksheet</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        <span style="box-sizing:border-box;">'sheet2'</span>: {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">// cell</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">'A1'</span>: { ... },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">// cell</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">'A2'</span>: { ... },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            ...</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">}</span><br style="box-sizing:border-box;"/></pre>
<h4 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;font-size:18px;margin:0px;padding:0px;border:0px;">基本用法</h4>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
1.用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">XLSX.read</code>
读取获取到的 Excel 数据，返回 workbook </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
2.用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">XLSX.readFile</code>
打开 Excel 文件，返回 workbook </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
3.用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">workbook.SheetNames</code>
获取表名 </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
4.用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">workbook.Sheets[xxx]</code>
通过表名获取表格 </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
5.用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">worksheet[address]</code>
操作单元格 </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
6.用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">XLSX.utils.sheet_to_json</code>
针对单个表获取表格数据转换为json格式 </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
7.用 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">XLSX.writeFile(wb, 'output.xlsx')</code>
生成新的 Excel 文件 </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
具体用法 </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">读取 Excel 文件</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">workbook</span> ＝ <span style="box-sizing:border-box;">XLSX</span><span style="box-sizing:border-box;">.read</span>(excelData, {<span style="box-sizing:border-box;">type</span>: <span style="box-sizing:border-box;">'base64'</span>});</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">workbook</span> ＝ <span style="box-sizing:border-box;">XLSX</span><span style="box-sizing:border-box;">.writeFile</span>(<span style="box-sizing:border-box;">'someExcel.xlsx'</span>, opts);</span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">获取 Excel 文件中的表 </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">// 获取 Excel 中所有表名</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">var</span> sheetNames</span> = workbook.SheetNames; <span style="box-sizing:border-box;">// 返回 ['sheet1', 'sheet2',……]</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">// 根据表名获取对应某张表</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">var</span> worksheet</span> = workbook.Sheets[sheetNames[<span style="box-sizing:border-box;">0</span>]];</span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
通过 <code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;font-size:90%;padding:2px 4px;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);border-radius:4px;">worksheet[address]</code>
来操作表格，以 ! 开头的 key 是特殊的字段。 </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;">// 获取 A1 单元格对象</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">let</span> a1 = worksheet[<span style="box-sizing:border-box;">'A1'</span>]; // 返回 { v: <span style="box-sizing:border-box;">'hello'</span>, t: <span style="box-sizing:border-box;">'s'</span>, ... }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">// 获取 A1 中的值</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">a1.v // 返回 <span style="box-sizing:border-box;">'hello'</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">// 获取表的有效范围</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">worksheet[<span style="box-sizing:border-box;">'!ref'</span>] // 返回 <span style="box-sizing:border-box;">'A1:B20'</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">worksheet[<span style="box-sizing:border-box;">'!range'</span>] // 返回 range 对象，{ s: { r: <span style="box-sizing:border-box;">0</span>, c: <span style="box-sizing:border-box;">0</span>}, e: { r: <span style="box-sizing:border-box;">100</span>, c: <span style="box-sizing:border-box;">2</span> } }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">// 获取合并过的单元格</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">worksheet[<span style="box-sizing:border-box;">'!merges'</span>] // 返回一个包含 range 对象的列表，[ {s: { r: <span style="box-sizing:border-box;">0</span>, c: <span style="box-sizing:border-box;">0</span> }, c: { r: <span style="box-sizing:border-box;">2</span>, c: <span style="box-sizing:border-box;">1</span> } } ]</span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">获取 Excel 文件中的表转换为json数据 </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;">XLSX<span style="box-sizing:border-box;">.utils</span><span style="box-sizing:border-box;">.sheet_to_json</span>(worksheet)  <span style="box-sizing:border-box;">//针对单个表，返回序列化json数据</span></span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">生成新的 Excel 文件 </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">//服务端通过XLSX.writeFile</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">XLSX = <span style="box-sizing:border-box;">require</span>(<span style="box-sizing:border-box;">&quot;xlsx&quot;</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">XLSX.writeFile(wb, <span style="box-sizing:border-box;">'output.xlsx'</span>)   </span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">//客服端，只能通过XLSX.write(wb, write_opts) 写入 表格数据，借助FileSaver生成，且只支持在高版本浏览器。</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">var</span> wopts = { <span style="box-sizing:border-box;">bookType</span>:<span style="box-sizing:border-box;">'xlsx'</span>, <span style="box-sizing:border-box;">bookSST</span>:<span style="box-sizing:border-box;">false, type</span>:<span style="box-sizing:border-box;">'binary'</span> };</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">var</span> wbout = XLSX.write(wb,wopts);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">function</span> <span style="box-sizing:border-box;">s2ab</span>(<span style="box-sizing:border-box;">s</span>) </span>{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">  <span style="box-sizing:border-box;">var</span> buf = <span style="box-sizing:border-box;">new</span> <span style="box-sizing:border-box;">ArrayBuffer</span>(s.length);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">  <span style="box-sizing:border-box;">var</span> view = <span style="box-sizing:border-box;">new</span> <span style="box-sizing:border-box;">Uint8Array</span>(buf);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">  <span style="box-sizing:border-box;">for</span> (<span style="box-sizing:border-box;">var</span> i=<span style="box-sizing:border-box;">0</span>; i!=s.length; ++i) view[i] = s.charCodeAt(i) &amp; <span style="box-sizing:border-box;">0xFF</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">  <span style="box-sizing:border-box;">return</span> buf;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">}</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">/* the saveAs call downloads a file on the local machine */</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">saveAs(<span style="box-sizing:border-box;">new</span> Blob([s2ab(wbout)],{<span style="box-sizing:border-box;">type</span>:<span style="box-sizing:border-box;">&quot;&quot;</span>}), <span style="box-sizing:border-box;">&quot;test.xlsx&quot;</span>)</span><br style="box-sizing:border-box;"/></pre>
<h2 style="box-sizing:border-box;font-family:inherit;font-weight:500;color:inherit;margin:0px;padding:0px;border:0px;line-height:40px;font-size:20px;">js-xlsx实战 </h2>
<h4 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;font-size:18px;margin:0px;padding:0px;border:0px;">解析 Excel 生成 JSON</h4>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;">function to_json(workbook) {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">	<span style="box-sizing:border-box;">var</span> <span style="box-sizing:border-box;">result</span> = {};</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">	// 获取 <span style="box-sizing:border-box;">Excel</span> 中所有表名</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">	<span style="box-sizing:border-box;">var</span> sheetNames = workbook.<span style="box-sizing:border-box;">SheetNames</span>; // 返回 ['sheet1', 'sheet2']</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">	workbook.<span style="box-sizing:border-box;">SheetNames</span>.forEach(function(sheetName) {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">		<span style="box-sizing:border-box;">var</span> worksheet = workbook.<span style="box-sizing:border-box;">Sheets</span>[sheetName];</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">		<span style="box-sizing:border-box;">result</span>[sheetName] = <span style="box-sizing:border-box;">XLSX</span>.utils.sheet_to_json(worksheet);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">	});	</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">	console.log(<span style="box-sizing:border-box;">&quot;打印表信息&quot;</span>,<span style="box-sizing:border-box;">JSON</span>.stringify(<span style="box-sizing:border-box;">result</span>, <span style="box-sizing:border-box;">2</span>, <span style="box-sizing:border-box;">2</span>));  //显示格式{<span style="box-sizing:border-box;">&quot;表1&quot;</span>:[],<span style="box-sizing:border-box;">&quot;表2&quot;</span>:[]}</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">	<span style="box-sizing:border-box;">return</span> <span style="box-sizing:border-box;">result</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">}</span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
导出表格 </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">1.构建特定的数据结构，通过new Blob如下。</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">// workbook</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    <span style="box-sizing:border-box;">SheetNames</span>: [<span style="box-sizing:border-box;">'mySheet'</span>],</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    <span style="box-sizing:border-box;">Sheets</span>: {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        <span style="box-sizing:border-box;">'mySheet'</span>: {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">'!ref'</span>: <span style="box-sizing:border-box;">'A1:E4'</span>, <span style="box-sizing:border-box;">// 必须要有这个范围才能输出，否则导出的 excel 会是一个空表</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">A1</span>: { <span style="box-sizing:border-box;">v</span>: <span style="box-sizing:border-box;">'id'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            ...</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">}</span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">2.调用 XLSX.write， 借助FileSaver中new Blob生成即可。 </p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;">var _headers = [<span style="box-sizing:border-box;">'id'</span>, <span style="box-sizing:border-box;">'name'</span>, <span style="box-sizing:border-box;">'age'</span>, <span style="box-sizing:border-box;">'country'</span>, <span style="box-sizing:border-box;">'remark'</span>]</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var _data = [ { id: <span style="box-sizing:border-box;">'1'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                name: <span style="box-sizing:border-box;">'test1'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                age: <span style="box-sizing:border-box;">'30'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                country: <span style="box-sizing:border-box;">'China'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                remark: <span style="box-sizing:border-box;">'hello'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              { id: <span style="box-sizing:border-box;">'2'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                name: <span style="box-sizing:border-box;">'test2'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                age: <span style="box-sizing:border-box;">'20'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                country: <span style="box-sizing:border-box;">'America'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                remark: <span style="box-sizing:border-box;">'world'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              { id: <span style="box-sizing:border-box;">'3'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                name: <span style="box-sizing:border-box;">'test3'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                age: <span style="box-sizing:border-box;">'18'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                country: <span style="box-sizing:border-box;">'Unkonw'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                remark: <span style="box-sizing:border-box;">'???'</span> } ];</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var headers = _headers</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                // 为 _headers 添加对应的单元格位置</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                // [ { v: <span style="box-sizing:border-box;">'id'</span>, position: <span style="box-sizing:border-box;">'A1'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                //   { v: <span style="box-sizing:border-box;">'name'</span>, position: <span style="box-sizing:border-box;">'B1'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                //   { v: <span style="box-sizing:border-box;">'age'</span>, position: <span style="box-sizing:border-box;">'C1'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                //   { v: <span style="box-sizing:border-box;">'country'</span>, position: <span style="box-sizing:border-box;">'D1'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                //   { v: <span style="box-sizing:border-box;">'remark'</span>, position: <span style="box-sizing:border-box;">'E1'</span> } ]</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                .<span style="box-sizing:border-box;">map</span>((v, i) =&gt; Object.assign({}, {v: v, position: String.fromCharCode(<span style="box-sizing:border-box;">65</span>+i) + <span style="box-sizing:border-box;">1</span> }))</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                // 转换成 worksheet 需要的结构</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                // { A1: { v: <span style="box-sizing:border-box;">'id'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                //   B1: { v: <span style="box-sizing:border-box;">'name'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                //   C1: { v: <span style="box-sizing:border-box;">'age'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                //   D1: { v: <span style="box-sizing:border-box;">'country'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                //   E1: { v: <span style="box-sizing:border-box;">'remark'</span> } }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                .reduce((prev, <span style="box-sizing:border-box;">next</span>) =&gt; Object.assign({}, prev, {[next.position]: {v: next.v}}), {});</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var data = _data</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              // 匹配 headers 的位置，生成对应的单元格数据</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              // [ [ { v: <span style="box-sizing:border-box;">'1'</span>, position: <span style="box-sizing:border-box;">'A2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'test1'</span>, position: <span style="box-sizing:border-box;">'B2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'30'</span>, position: <span style="box-sizing:border-box;">'C2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'China'</span>, position: <span style="box-sizing:border-box;">'D2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'hello'</span>, position: <span style="box-sizing:border-box;">'E2'</span> } ],</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   [ { v: <span style="box-sizing:border-box;">'2'</span>, position: <span style="box-sizing:border-box;">'A3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'test2'</span>, position: <span style="box-sizing:border-box;">'B3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'20'</span>, position: <span style="box-sizing:border-box;">'C3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'America'</span>, position: <span style="box-sizing:border-box;">'D3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'world'</span>, position: <span style="box-sizing:border-box;">'E3'</span> } ],</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   [ { v: <span style="box-sizing:border-box;">'3'</span>, position: <span style="box-sizing:border-box;">'A4'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'test3'</span>, position: <span style="box-sizing:border-box;">'B4'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'18'</span>, position: <span style="box-sizing:border-box;">'C4'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'Unkonw'</span>, position: <span style="box-sizing:border-box;">'D4'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     { v: <span style="box-sizing:border-box;">'???'</span>, position: <span style="box-sizing:border-box;">'E4'</span> } ] ]</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              .<span style="box-sizing:border-box;">map</span>((v, i) =&gt; _headers.<span style="box-sizing:border-box;">map</span>((k, j) =&gt; Object.assign({}, { v: v[k], position: String.fromCharCode(<span style="box-sizing:border-box;">65</span>+j) + (i+<span style="box-sizing:border-box;">2</span>) })))</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              // 对刚才的结果进行降维处理（二维数组变成一维数组）</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              // [ { v: <span style="box-sizing:border-box;">'1'</span>, position: <span style="box-sizing:border-box;">'A2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'test1'</span>, position: <span style="box-sizing:border-box;">'B2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'30'</span>, position: <span style="box-sizing:border-box;">'C2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'China'</span>, position: <span style="box-sizing:border-box;">'D2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'hello'</span>, position: <span style="box-sizing:border-box;">'E2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'2'</span>, position: <span style="box-sizing:border-box;">'A3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'test2'</span>, position: <span style="box-sizing:border-box;">'B3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'20'</span>, position: <span style="box-sizing:border-box;">'C3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'America'</span>, position: <span style="box-sizing:border-box;">'D3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'world'</span>, position: <span style="box-sizing:border-box;">'E3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'3'</span>, position: <span style="box-sizing:border-box;">'A4'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'test3'</span>, position: <span style="box-sizing:border-box;">'B4'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'18'</span>, position: <span style="box-sizing:border-box;">'C4'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'Unkonw'</span>, position: <span style="box-sizing:border-box;">'D4'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { v: <span style="box-sizing:border-box;">'???'</span>, position: <span style="box-sizing:border-box;">'E4'</span> } ]</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              .reduce((prev, <span style="box-sizing:border-box;">next</span>) =&gt; prev.concat(<span style="box-sizing:border-box;">next</span>))</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              // 转换成 worksheet 需要的结构</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //   { A2: { v: <span style="box-sizing:border-box;">'1'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     B2: { v: <span style="box-sizing:border-box;">'test1'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     C2: { v: <span style="box-sizing:border-box;">'30'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     D2: { v: <span style="box-sizing:border-box;">'China'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     E2: { v: <span style="box-sizing:border-box;">'hello'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     A3: { v: <span style="box-sizing:border-box;">'2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     B3: { v: <span style="box-sizing:border-box;">'test2'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     C3: { v: <span style="box-sizing:border-box;">'20'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     D3: { v: <span style="box-sizing:border-box;">'America'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     E3: { v: <span style="box-sizing:border-box;">'world'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     A4: { v: <span style="box-sizing:border-box;">'3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     B4: { v: <span style="box-sizing:border-box;">'test3'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     C4: { v: <span style="box-sizing:border-box;">'18'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     D4: { v: <span style="box-sizing:border-box;">'Unkonw'</span> },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              //     E4: { v: <span style="box-sizing:border-box;">'???'</span> } }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">              .reduce((prev, <span style="box-sizing:border-box;">next</span>) =&gt; Object.assign({}, prev, {[next.position]: {v: next.v}}), {});</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">// 合并 headers 和 data</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var output = Object.assign({}, headers, data);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">// 获取所有单元格的位置</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var outputPos = Object.keys(output);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">// 计算出范围</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var ref = outputPos[<span style="box-sizing:border-box;">0</span>] + <span style="box-sizing:border-box;">':'</span> + outputPos[outputPos.length - <span style="box-sizing:border-box;">1</span>];</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">// 构建 workbook 对象</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var wb = {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    SheetNames: [<span style="box-sizing:border-box;">'mySheet'</span>],</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    Sheets: {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        <span style="box-sizing:border-box;">'mySheet'</span>: Object.assign({}, output, { <span style="box-sizing:border-box;">'!ref'</span>: ref })</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">};</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">// 导出 Excel</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">//XLSX.writeFile(wb, <span style="box-sizing:border-box;">'output.xlsx'</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var wopts = { bookType:<span style="box-sizing:border-box;">'xlsx'</span>, bookSST:false, type:<span style="box-sizing:border-box;">'binary'</span> };</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">var wbout = XLSX.write(wb,wopts);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">function</span> s2ab(s) {</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">  var buf = new ArrayBuffer(s.length);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">  var view = new Uint8Array(buf);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">  for (var i=<span style="box-sizing:border-box;">0</span>; i!=s.length; ++i) view[i] = s.charCodeAt(i) &amp; <span style="box-sizing:border-box;">0xFF</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">  return buf;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">}</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">/* the saveAs call downloads a file on the local machine */</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">saveAs(new Blob([s2ab(wbout)],{type:<span style="box-sizing:border-box;">&quot;&quot;</span>}), <span style="box-sizing:border-box;">&quot;test.xlsx&quot;</span>)</span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
实践Demo： <a href="http://doc.pfan123.com/excel.html" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">RD快速生成excel表</a>
</p>
<h2 style="box-sizing:border-box;font-family:inherit;font-weight:500;color:inherit;margin:0px;padding:0px;border:0px;line-height:40px;font-size:20px;">第二讲：利用 excel-export 生成 Excel 文件 </h2>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">excel-export模块，上手起来就比较容易了，其中原理是通过修改，修改header 信息、拼接字符串、修改字符集、输出字符串的形式实现的，在部分firefox低版本下载中文名会出现乱码情况。我们只需要按照API设置好数据参数，通过nodeExcel.execute调用执行，系统调用模版”styles.xml”就可以生成Excel文件，比较好的就是，它可以设置单元格的宽度，类型。</p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">我们先看看，官方提供的例子：</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">var</span> express = <span style="box-sizing:border-box;">require</span>(<span style="box-sizing:border-box;">'express'</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">var</span> nodeExcel = <span style="box-sizing:border-box;">require</span>(<span style="box-sizing:border-box;">'excel-export'</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">var</span> app = express();</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">app.get(<span style="box-sizing:border-box;">'/Excel'</span>, <span style="box-sizing:border-box;"><span style="box-sizing:border-box;">function</span>(<span style="box-sizing:border-box;">req, res</span>)</span>{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    <span style="box-sizing:border-box;">var</span> conf ={};</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    conf.stylesXmlFile = <span style="box-sizing:border-box;">&quot;styles.xml&quot;</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    conf.name = <span style="box-sizing:border-box;">&quot;mysheet&quot;</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    conf.cols = [{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        caption:<span style="box-sizing:border-box;">'string'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        type:<span style="box-sizing:border-box;">'string'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        beforeCellWrite:<span style="box-sizing:border-box;"><span style="box-sizing:border-box;">function</span>(<span style="box-sizing:border-box;">row, cellData</span>)</span>{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">             <span style="box-sizing:border-box;">return</span> cellData.toUpperCase();</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        },</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        width:<span style="box-sizing:border-box;">28.7109375</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    },{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        caption:<span style="box-sizing:border-box;">'date'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        type:<span style="box-sizing:border-box;">'date'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        beforeCellWrite:<span style="box-sizing:border-box;"><span style="box-sizing:border-box;">function</span>(<span style="box-sizing:border-box;"></span>)</span>{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">var</span> originDate = <span style="box-sizing:border-box;">new</span> <span style="box-sizing:border-box;">Date</span>(<span style="box-sizing:border-box;">Date</span>.UTC(<span style="box-sizing:border-box;">1899</span>,<span style="box-sizing:border-box;">11</span>,<span style="box-sizing:border-box;">30</span>));</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            <span style="box-sizing:border-box;">return</span> <span style="box-sizing:border-box;"><span style="box-sizing:border-box;">function</span>(<span style="box-sizing:border-box;">row, cellData, eOpt</span>)</span>{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                <span style="box-sizing:border-box;">if</span> (eOpt.rowNum%<span style="box-sizing:border-box;">2</span>){</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                    eOpt.styleIndex = <span style="box-sizing:border-box;">1</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                }  </span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                <span style="box-sizing:border-box;">else</span>{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                    eOpt.styleIndex = <span style="box-sizing:border-box;">2</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                }</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                <span style="box-sizing:border-box;">if</span> (cellData === <span style="box-sizing:border-box;">null</span>){</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                  eOpt.cellType = <span style="box-sizing:border-box;">'string'</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                  <span style="box-sizing:border-box;">return</span> <span style="box-sizing:border-box;">'N/A'</span>;</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                } <span style="box-sizing:border-box;">else</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">                  <span style="box-sizing:border-box;">return</span> (cellData - originDate) / (<span style="box-sizing:border-box;">24</span> * <span style="box-sizing:border-box;">60</span> * <span style="box-sizing:border-box;">60</span> * <span style="box-sizing:border-box;">1000</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">            } </span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        }()</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    },{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        caption:<span style="box-sizing:border-box;">'bool'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        type:<span style="box-sizing:border-box;">'bool'</span></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    },{</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        caption:<span style="box-sizing:border-box;">'number'</span>,</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">         type:<span style="box-sizing:border-box;">'number'</span>              </span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    }];</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    conf.rows = [</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        [<span style="box-sizing:border-box;">'pi'</span>, <span style="box-sizing:border-box;">new</span> <span style="box-sizing:border-box;">Date</span>(<span style="box-sizing:border-box;">Date</span>.UTC(<span style="box-sizing:border-box;">2013</span>, <span style="box-sizing:border-box;">4</span>, <span style="box-sizing:border-box;">1</span>)), <span style="box-sizing:border-box;">true</span>, <span style="box-sizing:border-box;">3.14</span>],</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        [<span style="box-sizing:border-box;">&quot;e&quot;</span>, <span style="box-sizing:border-box;">new</span> <span style="box-sizing:border-box;">Date</span>(<span style="box-sizing:border-box;">2012</span>, <span style="box-sizing:border-box;">4</span>, <span style="box-sizing:border-box;">1</span>), <span style="box-sizing:border-box;">false</span>, <span style="box-sizing:border-box;">2.7182</span>],</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        [<span style="box-sizing:border-box;">&quot;M&amp;M&lt;&gt;'&quot;</span>, <span style="box-sizing:border-box;">new</span> <span style="box-sizing:border-box;">Date</span>(<span style="box-sizing:border-box;">Date</span>.UTC(<span style="box-sizing:border-box;">2013</span>, <span style="box-sizing:border-box;">6</span>, <span style="box-sizing:border-box;">9</span>)), <span style="box-sizing:border-box;">false</span>, <span style="box-sizing:border-box;">1.61803</span>],</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">        [<span style="box-sizing:border-box;">&quot;null date&quot;</span>, <span style="box-sizing:border-box;">null</span>, <span style="box-sizing:border-box;">true</span>, <span style="box-sizing:border-box;">1.414</span>]  </span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    ];</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    <span style="box-sizing:border-box;">var</span> result = nodeExcel.execute(conf);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    res.setHeader(<span style="box-sizing:border-box;">'Content-Type'</span>, <span style="box-sizing:border-box;">'application/vnd.openxmlformats'</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    res.setHeader(<span style="box-sizing:border-box;">&quot;Content-Disposition&quot;</span>, <span style="box-sizing:border-box;">&quot;attachment; filename=&quot;</span> + <span style="box-sizing:border-box;">&quot;Report.xlsx&quot;</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">    res.end(result, <span style="box-sizing:border-box;">'binary'</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">});</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"></span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;">app.listen(<span style="box-sizing:border-box;">3000</span>);</span><br style="box-sizing:border-box;"/><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">console</span>.log(<span style="box-sizing:border-box;">'Listening on port 3000'</span>);</span><br style="box-sizing:border-box;"/></pre>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">
分析生成excel流程： </p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">1.配置excel文件名conf.name</p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">2.设置表caption，每列单元格数据类型，宽度</p>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">3.填充表中每行数据conf.rows，nodeExcel.execute生成数据结构，设置头部，拼接生成表</p>
<h4 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;font-size:18px;margin:0px;padding:0px;border:0px;">写在最后，以上仅为个人观点，如有纰漏之处，欢迎各位大侠拍砖！</h4>
<p style="box-sizing:border-box;margin:0px;padding:0px;border:0px;padding-top:4px;padding-bottom:13px;">参考资料：</p>
<ul style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://github.com/functionscope/Node-Excel-Export" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">Node-Excel-Export excel导出</a>
</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://segmentfault.com/a/1190000004062768" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">node.js读写excel文件</a>
</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="http://www.uedsc.com/js-xlsx.html" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">JS-XLSX读取和解析Excel表格文件(xls/xlsx)的JavaScript插件</a>
</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="http://scarletsky.github.io/2016/01/30/nodejs-process-excel/" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">在 Node.js 中利用 js-xlsx 处理 Excel 文件</a>
</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://segmentfault.com/a/1190000004062768" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">node-xlrd</a>
</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://github.com/leftshifters/excel-parser" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">excel-parser</a>
</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="https://github.com/eligrey/FileSaver.js/" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">FileSaver浏览器保存excel</a>
</li>
<li style="box-sizing:border-box;margin:0px;padding:0px;border:0px;list-style-type:none;">
<a href="http://stackoverflow.com/questions/30859901/parse-xlsx-with-node-and-create-json" rel="nofollow,noindex" style="box-sizing:border-box;text-decoration:none;color:rgb(51, 102, 204);background:url(&quot;http://www.w2bc.com/Content/Images/linkIcon.png&quot;) right 4px no-repeat;padding-right:15px;margin-right:5px;" target="_blank">stackoverflow xlsx相关问题</a>
</li>
</ul>
<div style="box-sizing:border-box;clear:both;display:block;overflow:hidden;visibility:hidden;height:5px;">
</div>

<div style="box-sizing:border-box;padding:0px;overflow:hidden;text-align:center;">
<div style="box-sizing:border-box;clear:both;display:block;overflow:hidden;visibility:hidden;height:30px;">
</div>
<ins style="box-sizing:border-box;display:inline-block;width:728px;height:90px;"></ins>

</div>
<div style="box-sizing:border-box;padding:0px;overflow:hidden;text-align:center;">
<div style="box-sizing:border-box;clear:both;display:block;overflow:hidden;visibility:hidden;height:30px;">
</div>
<div style="box-sizing:border-box;width:640px;margin:auto;overflow:hidden;">


</div>
</div>
<div style="box-sizing:border-box;padding:0px;overflow:hidden;text-align:center;">
<div style="box-sizing:border-box;clear:both;display:block;overflow:hidden;visibility:hidden;height:10px;">
</div>
<div style="box-sizing:border-box;">

<ins style="box-sizing:border-box;display:inline-block;width:300px;height:250px;"></ins>

</div>
</div>
</div>
<div style="box-sizing:border-box;font-size:14px;line-height:27px;padding:0px 30px;">
<div style="box-sizing:border-box;">
<div style="box-sizing:border-box;"><div style="box-sizing:border-box;margin:0;border:none;padding:0;clear:both;overflow:hidden;*zoom:1;*position:relative;">
    
    
    
        <div style="box-sizing:border-box;padding:0;margin:0;border:none;clear:both;display:block;">
        <div style="padding:0px;box-sizing:border-box;border-top:none;border-right:none;border-bottom:3px solid rgb(228, 228, 228);border-left:none;border-image:initial;margin:0px 0px 10px;text-indent:0px;text-align:left;font-weight:normal;font-size:16px;line-height:40px;height:40px;"><span style="box-sizing:border-box;border-bottom:solid 3px #48A2BD;padding-left:5px;height:40px;display:inline-block;">相关阅读：</span></div>
                <ul style="box-sizing:border-box;margin:0 0 0 1px;padding:0;border:0px;list-style-type:none;"><li style="background:none 0px 0px repeat scroll transparent;box-sizing:border-box;padding:0px;overflow:hidden;height:30px;list-style:disc inside none;display:list-item;line-height:30px;margin:0px 20px 0px 0px;text-indent:0px;text-align:left;font-size:14px;width:325px;float:left;list-style-type:none;border:0px;color:rgb(72, 162, 189);">
    <a href="http://www.w2bc.com/article/227080" style="box-sizing:border-box;background-color:transparent;color:#333333;text-decoration:none;border-bottom:none;outline:none;"><span style="box-sizing:border-box;">java使用POI操作excel文件</span></a>
</li><li style="background:none 0px 0px repeat scroll transparent;box-sizing:border-box;padding:0px;overflow:hidden;height:30px;list-style:disc inside none;display:list-item;line-height:30px;margin:0px 20px 0px 0px;text-indent:0px;text-align:left;font-size:14px;width:325px;float:left;list-style-type:none;border:0px;color:rgb(72, 162, 189);">
    <a href="http://www.w2bc.com/article/225953" style="box-sizing:border-box;background-color:transparent;color:#333333;text-decoration:none;border-bottom:none;outline:none;"><span style="box-sizing:border-box;">PowerDesigner辅助导入导出excel文件</span></a>
</li><li style="background:none 0px 0px repeat scroll transparent;box-sizing:border-box;padding:0px;overflow:hidden;height:30px;list-style:disc inside none;display:list-item;line-height:30px;margin:0px 20px 0px 0px;text-indent:0px;text-align:left;font-size:14px;width:325px;float:left;list-style-type:none;border:0px;color:rgb(72, 162, 189);">
    <a href="http://www.w2bc.com/article/189044" style="box-sizing:border-box;background-color:transparent;color:#333333;text-decoration:none;border-bottom:none;outline:none;"><span style="box-sizing:border-box;">在Node.js中使用ejsexcel输出EXCEL文件</span></a>
</li><li style="background:none 0px 0px repeat scroll transparent;box-sizing:border-box;padding:0px;overflow:hidden;height:30px;list-style:disc inside none;display:list-item;line-height:30px;margin:0px 20px 0px 0px;text-indent:0px;text-align:left;font-size:14px;width:325px;float:left;list-style-type:none;border:0px;color:rgb(72, 162, 189);">
    <a href="http://www.w2bc.com/Article/49550" style="box-sizing:border-box;background-color:transparent;color:#333333;text-decoration:none;border-bottom:none;outline:none;"><span style="box-sizing:border-box;">node-wechat 微信实践</span></a>
</li><li style="background:none 0px 0px repeat scroll transparent;box-sizing:border-box;padding:0px;overflow:hidden;height:30px;list-style:disc inside none;display:list-item;line-height:30px;margin:0px 20px 0px 0px;text-indent:0px;text-align:left;font-size:14px;width:325px;float:left;list-style-type:none;border:0px;color:rgb(72, 162, 189);">
    <a href="http://www.w2bc.com/article/61394" style="box-sizing:border-box;background-color:transparent;color:rgb(51, 51, 51);text-decoration:none;border-bottom:none;outline:none;"><span style="box-sizing:border-box;">PHPExcel读取excel文件</span></a>
</li><li style="background:none 0px 0px repeat scroll transparent;box-sizing:border-box;padding:0px;overflow:hidden;height:30px;list-style:disc inside none;display:list-item;line-height:30px;margin:0px 20px 0px 0px;text-indent:0px;text-align:left;font-size:14px;width:325px;float:left;list-style-type:none;border:0px;color:rgb(72, 162, 189);">
    <a href="http://www.w2bc.com/article/4588" style="box-sizing:border-box;background-color:transparent;color:#333333;text-decoration:none;border-bottom:none;outline:none;"><span style="box-sizing:border-box;">Node.js文件操作详解</span></a>
</li></ul>
    </div>
</div></div>
</div>


<div style="box-sizing:border-box;display:block;float:none;clear:both;zoom:1;overflow:hidden;height:0px;">
</div>

</div>
<div style="box-sizing:border-box;clear:both;display:block;overflow:hidden;visibility:hidden;height:30px;"></div>
<div style="box-sizing:border-box;line-height:25px;padding:0px 30px;">
<h2 style="font-size:16px;box-sizing:border-box;font-family:inherit;margin:0px;padding:0px;border:0px;font-weight:normal;line-height:40px;color:rgb(0, 0, 0);border-bottom:3px solid rgb(228, 228, 228);">
<span style="box-sizing:border-box;border-bottom:3px solid rgb(72, 162, 189);padding-left:5px;padding-right:6px;height:40px;display:inline-block;">文章评论</span>
</h2>
<div style="box-sizing:border-box;clear:both;display:block;overflow:hidden;visibility:hidden;height:25px;"></div>

<div style="box-sizing:border-box;text-align:right;">


</div>
<div style="box-sizing:border-box;">
<div style="box-sizing:border-box;display:block;float:none;clear:both;zoom:1;overflow:hidden;height:0px;"></div>
</div>
</div>
</div></div></div></div></div></div><br/></div></span>
</div></body></html> 