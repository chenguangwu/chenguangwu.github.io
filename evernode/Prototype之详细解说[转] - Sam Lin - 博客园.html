<html>
<head>
  <title>Prototype之详细解说[转] - Sam Lin - 博客园</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="7806"/>
<h1>Prototype之详细解说[转] - Sam Lin - 博客园</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2015/11/11 17:37</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://www.cnblogs.com/samlin/archive/2008/07/06/1236962.html"><i>http://www.cnblogs.com/samlin/archive/2008/07/06/1236962.html</i></a></td></tr>
</table>
</div>
<br/>

<div><span><br/><div style="font-size: 16px"><div><div style="font-family:Verdana, Arial, Helvetica, sans-serif;color:rgb(0, 0, 0);background-color:rgb(255, 255, 255);font-size:13px;line-height:1.5;"><div><div><div><div><div><div><div>
		<h1 style="padding:0px;color:rgb(0, 0, 0);margin:20px 0px 10px;font-weight:bold;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221, 221, 221);font-size:14px;">
			<a href="http://www.cnblogs.com/samlin/archive/2008/07/06/1236962.html" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);">Prototype之详细解说[转]</a>
		</h1>
		<div style="margin:0px;padding:0px;clear:both;"></div>
		<div style="margin:0px;padding:0px;color:rgb(17, 17, 17);font-size:13px;line-height:1.8;">
			<div style="margin:0px;padding:0px;margin-bottom:20px;word-break:break-word;"><p style="padding:0px;margin:10px auto;text-indent:0px;"> </p>
<div style="margin:5px 0px;padding:5px;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);overflow:auto;color:rgb(0, 0, 0);font-family:'Courier New';font-size:12px;width:918px;height:41299px;"><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:'Courier New';font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);background-color:rgb(245, 245, 245);border:none;" title="复制代码"><img src="Prototype之详细解说[转] - Sam Lin - 博客园_files/copycode.gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;border:none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">  Prototype JavaScript framework, version 1.4.0<br style="margin:0px;padding:0px;"/>
 *  (c) 2005 Sam Stephenson &lt;sam@conio.net&gt;<br style="margin:0px;padding:0px;"/>
 *<br style="margin:0px;padding:0px;"/>
 *  Prototype is freely distributable under the terms of an MIT-style license.<br style="margin:0px;padding:0px;"/>
 *  For details, see the Prototype web site: http://prototype.conio.net/<br style="margin:0px;padding:0px;"/>
 <br style="margin:0px;padding:0px;"/>
 *  这是一个JavaScript的框架,致力于简化动态的Web开发，完全按照面对对象的思想<br style="margin:0px;padding:0px;"/>
 *  进行Javascript开发，添加了迭代器的概念增强Javascript的设计能力。<br style="margin:0px;padding:0px;"/>
 *  Prototype框架构思独特充满了技巧性的代码，方便易用的工具类！<br style="margin:0px;padding:0px;"/>
 *<br style="margin:0px;padding:0px;"/>
/*--------------------------------------------------------------------------</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
 <br style="margin:0px;padding:0px;"/>
  <br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"> 【Prototype】定义一个全局对象,提供一个全局的基本信息和工具 </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> Prototype </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> {<br style="margin:0px;padding:0px;"/>
  Version: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1.4.0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">可以作为版本检测用</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">用于脚本检测的正则表达式，经常使用所以放在这里起到全局常量的作用</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  ScriptFragment: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(?:&lt;script.*?&gt;)(( | |.)*?)(?:&lt;/script&gt;)</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">,<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  emptyFunction: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {},</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">空函数</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  K: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(x) {</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> x}</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">K方法返回参数本身，在后面经常用到</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
 *【Class】对象的作用只有一个就是提供了一个定义类的模式<br style="margin:0px;padding:0px;"/>
 * 仅含有create 一个方法，返回一个构造函数。 <br style="margin:0px;padding:0px;"/>
 * 一般使用如下  <br style="margin:0px;padding:0px;"/>
 *     var X = Class.create();  返回一个类型  <br style="margin:0px;padding:0px;"/>
 * 要使用 X 类型，需继续用 new X()来获取一个实例 这与C# JAVA类似<br style="margin:0px;padding:0px;"/>
 * 返回的构造函数会执行名为 initialize 的方法， initialize 是 Ruby 对象的构造器方法名字。 <br style="margin:0px;padding:0px;"/>
 * 此时initialize方法还没有定义，其后的代码中创建新类型时会建立相应的同名方法,可以看作是一个抽象方法。 <br style="margin:0px;padding:0px;"/>
 * 从C#角度讲可以理解为用Class.create()创建一个继承Object基类的类。 <br style="margin:0px;padding:0px;"/>
 * <br style="margin:0px;padding:0px;"/>
 </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> <br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> Class </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> {<br style="margin:0px;padding:0px;"/>
  create: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">下面使用Apply方法传递参数是一个常用的技巧</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.initialize.apply(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, arguments);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">Abstract是一个空对象，它的作用仅仅是作为一个抽象的命名空间，所有在该对象下定义的类都是抽象类</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">从而从形式上与实体类分开</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> Abstract </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">new</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> Object();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
 *Object是所有对象的基类，这个基类有两个静态方法<br style="margin:0px;padding:0px;"/>
 </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> <br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">把Source的所有属性和方法传递给Destination，实现了继承的效果</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">Object.extend </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(destination, source) {<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">for</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (property </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">in</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> source) {<br style="margin:0px;padding:0px;"/>
    destination[property] </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> source[property];<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> destination;<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">观察Object的组成，需要参数中的object实现自己的inspect方法</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">Object.inspect </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(object) {<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">try</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (object </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">==</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> undefined) </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">undefined</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (object </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">==</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">null</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">) </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">null</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> object.inspect </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">?</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> object.inspect() : object.toString();<br style="margin:0px;padding:0px;"/>
  } </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">catch</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (e) {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (e </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">instanceof</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> RangeError) </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">''</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">throw</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> e;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">【Function】是所有函数对象的基类，可以通过对它的扩展实现对所有函数对象添加功能</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"> 这里在绑定的时候旧可以传递参数而不是调用的时候才指定参数，bind方法接收多个参数<br style="margin:0px;padding:0px;"/>
  将函数绑定到第一个参数指定的对象上，并返回该方法的调用句柄<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
Function.prototype.bind </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"> $A()方法的作用是把参数专为数组 </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">数组的shift方法作用是删除数组的第一个元素</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> __method </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, args </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> $A(arguments), object </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> args.shift();<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> __method.apply(object, args.concat($A(arguments)));<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">这里的$A(arguments)是条用返回函数句柄时传递的参数，不是bind方法的参数</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">* <br style="margin:0px;padding:0px;"/>
 * 和bind一样，不过这个方法一般用做html控件对象的事件处理。所以要传递event对象 <br style="margin:0px;padding:0px;"/>
 * 好像是重载了_method方法<br style="margin:0px;padding:0px;"/>
 </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> <br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Function.prototype.bindAsEventListener </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(object) {<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> __method </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(event) {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> __method.call(object, event </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">||</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> window.event);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">【Function】是所有数值类型的基类</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
Object.extend(Number.prototype, {<br style="margin:0px;padding:0px;"/>
  toColorPart: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {           </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">RGB-》16进制颜色</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> digits </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.toString(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">16</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&lt;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">16</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">) </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">+</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> digits;<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> digits;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  succ: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() { </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">数值加一 var a=1; var b=a.succ; 那么b=2</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">+</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  times: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(iterator) { <br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">这里的参数iterator是一个迭代器作用就是循环调用指定次数的iterator函数</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">$R(start,end,exclusive)是创建ObjectRnge对象的快捷方式</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">    $R(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">true</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">).each(iterator);<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">提供了一个方法these，要求参数是函数的句柄，可以有多个。作用就是返回第一个成功执行的函数的返回值</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> Try </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> {<br style="margin:0px;padding:0px;"/>
  these: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> returnValue;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">for</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> i </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">; i </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&lt;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> arguments.length; i</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">++</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">) {<br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> lambda </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> arguments[i];<br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">try</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> {<br style="margin:0px;padding:0px;"/>
        returnValue </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> lambda();<br style="margin:0px;padding:0px;"/>
        </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">break</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
      } </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">catch</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (e) {}<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> returnValue;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">定时器类用来实现Window.setInterval的效果，在给定时间间隔执行某一个函数，增加了对重复执行的控制S</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> PeriodicalExecuter </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> Class.create();<br style="margin:0px;padding:0px;"/>
PeriodicalExecuter.prototype </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> {<br style="margin:0px;padding:0px;"/>
  initialize: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(callback, frequency) {<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">构造函数指定回调函数和执行频率，单位是秒</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.callback </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> callback;<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.frequency </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> frequency;<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.currentlyExecuting </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">false</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.registerCallback();<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
  <br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"> 开始调用定时器，无需显示调用，在构造函数中就实现了自动调用，这一下面的<br style="margin:0px;padding:0px;"/>
this.onTimerEvent.bind(this)如果写成this.onTimerEvent则this指针就会指向widows对象即setInterval的默认对象<br style="margin:0px;padding:0px;"/>
从而不能正确的引用到下面两个函数上，也就失去了对正在执行函数的控制<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  registerCallback: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    setInterval(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.onTimerEvent.bind(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">), </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.frequency </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1000</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">下面的函数相当于是回调函数的一个代理， setInterval是到了指定的时间就会强制执行而这里</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">加入了一个判断如果callback函数执行的时间超过了一个时间片，则阻止其被重复执行</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  onTimerEvent: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">!</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.currentlyExecuting) {<br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">try</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> {<br style="margin:0px;padding:0px;"/>
        </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.currentlyExecuting </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">true</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
        </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.callback();<br style="margin:0px;padding:0px;"/>
      } </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">finally</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> {<br style="margin:0px;padding:0px;"/>
        </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.currentlyExecuting </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">false</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">使用举例：<br style="margin:0px;padding:0px;"/>
function GetOnlineCount()<br style="margin:0px;padding:0px;"/>
{//获得在线人数<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
new PeriodicalExecuter(GetOnlineCount,10)每10秒获取一次<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"> 框架核心内容--------【基础工具类】<br style="margin:0px;padding:0px;"/>
/*========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
 </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">document.getElementById(id)获取一个指定ID的结点,是这个方法的快捷方式和扩展<br style="margin:0px;padding:0px;"/>
 可以指定多个参数返回一个对象数组。参数也不一定是ID也可以是对象本身的引用，例如<br style="margin:0px;padding:0px;"/>
 $('id')等价于$($('id'))<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> $() {<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> elements </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">new</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> Array();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">for</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> i </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">; i </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&lt;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> arguments.length; i</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">++</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">) {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> element </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> arguments[i];<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">typeof</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> element </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">==</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">string</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">)<br style="margin:0px;padding:0px;"/>
      element </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> document.getElementById(element);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (arguments.length </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">==</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">)<br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> element;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    elements.push(element);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> elements;<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">/*</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">========================================================================================</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">*/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">【String】类的扩展</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">删除字符串中的HTML标记</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">Object.extend(String.prototype, {<br style="margin:0px;padding:0px;"/>
  stripTags: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.replace(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&lt;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">?</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">^&gt;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">]</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">+&gt;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">gi, '');</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">删除字符串中的脚本块</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  stripScripts: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.replace(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">new</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> RegExp(Prototype.ScriptFragment, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">img</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">), </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">''</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">提取字符串中的所有脚本块，作为数组返回，每一个脚本作为一个数组元素</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  extractScripts: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> matchAll </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">new</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> RegExp(Prototype.ScriptFragment, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">img</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> matchOne </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">new</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> RegExp(Prototype.ScriptFragment, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">im</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.match(matchAll) </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">||</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> []).map(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(scriptTag) {<br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (scriptTag.match(matchOne) </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">||</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> [</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">''</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">''</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">])[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">];<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">提取字符串中的脚本并执行</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  evalScripts: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.extractScripts().map(eval);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">将字符串进行html编码例如&quot;&lt;&quot; --》&quot;&amp;lt&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  escapeHTML: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> div </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> document.createElement(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">div</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> text </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> document.createTextNode(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    div.appendChild(text);<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> div.innerHTML;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">对字符串进行html解码例如&quot;&amp;lt&quot;--》&quot;&lt;&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  unescapeHTML: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> div </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> document.createElement(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">div</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    div.innerHTML </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.stripTags();<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> div.childNodes[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">] </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">?</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> div.childNodes[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">].nodeValue : </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">''</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">将查询字符串格式的字符串转换为键值对数组</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">例如var s=&quot;a=1&amp;b=2&amp;c=3&quot;; var s2=s.toQueryParams(); s2为{a:1,b:2,c:3}</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  toQueryParams: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> pairs </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.match(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">^??(.*)$</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">/</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">)[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">].split(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&amp;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> pairs.inject({}, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(params, pairString) {<br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> pair </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> pairString.split(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
      params[pair[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">]] </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> pair[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">];<br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> params;<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">字符串转换为字符数组 &quot;abc&quot;--&gt;['a','b','c']</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  toArray: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.split(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">''</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">连字符--》骆驼样式 'good-man'--&gt;'goodMan'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  camelize: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> oStringList </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.split(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">-</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (oStringList.length </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">==</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">) </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> oStringList[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">];<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> camelizedString </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.indexOf(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">-</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">) </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">==</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">?</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> oStringList[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">].charAt(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">).toUpperCase() </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">+</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> oStringList[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">].substring(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">)<br style="margin:0px;padding:0px;"/>
      : oStringList[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">];<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">for</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> (</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> i </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, len </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> oStringList.length; i </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&lt;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> len; i</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">++</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">) {<br style="margin:0px;padding:0px;"/>
      </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">var</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> s </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> oStringList[i];<br style="margin:0px;padding:0px;"/>
      camelizedString </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">+=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> s.charAt(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">0</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">).toUpperCase() </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">+</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> s.substring(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> camelizedString;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;">得到字符串的组成结构</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#008000;"><br style="margin:0px;padding:0px;"/>
</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">  inspect: </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">function</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">() {<br style="margin:0px;padding:0px;"/>
    </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">return</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">+</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#0000ff;">this</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">.replace(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">\</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">\\</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">).replace(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">, </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">\</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">''</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">) + &quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">'&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
//定义了一个等价的函数<br style="margin:0px;padding:0px;"/>
String.prototype.parseQuery = String.prototype.toQueryParams;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//【Enumerable】可枚举接口 是整个1.4.0框架的核心工具，所有实现此接口的类必须要实现_each(iterator)方法<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
var $break    = new Object(); //首先定义了两个异常对象，用于进行迭代计算的控制<br style="margin:0px;padding:0px;"/>
var $continue = new Object();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
var Enumerable = {<br style="margin:0px;padding:0px;"/>
//用于对对象的每一个元素遍历执行iterator迭代器函数<br style="margin:0px;padding:0px;"/>
  each: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var index = 0;                //可选参数表示元素在枚举对象的次序<br style="margin:0px;padding:0px;"/>
    try {<br style="margin:0px;padding:0px;"/>
      this._each(function(value) {//value是枚举元素的值<br style="margin:0px;padding:0px;"/>
        try {<br style="margin:0px;padding:0px;"/>
          iterator(value, index++);<br style="margin:0px;padding:0px;"/>
        } catch (e) {<br style="margin:0px;padding:0px;"/>
          if (e != $continue) throw e;<br style="margin:0px;padding:0px;"/>
        }<br style="margin:0px;padding:0px;"/>
      });<br style="margin:0px;padding:0px;"/>
    } catch (e) {<br style="margin:0px;padding:0px;"/>
      if (e != $break) throw e;<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//判断是否所有的枚举元素都能使iterator返回true<br style="margin:0px;padding:0px;"/>
  all: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var result = true;<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      result = result &amp;&amp; !!(iterator || Prototype.K)(value, index);<br style="margin:0px;padding:0px;"/>
      if (!result) throw $break;<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return result;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//判断是否有枚举元素能使iterator返回true，有一个就是True<br style="margin:0px;padding:0px;"/>
  any: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var result = true;<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      if (result = !!(iterator || Prototype.K)(value, index))<br style="margin:0px;padding:0px;"/>
        throw $break;<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return result;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//对所有的枚举元素执行iterator迭代器函数 结果作为一个数组返回<br style="margin:0px;padding:0px;"/>
  collect: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var results = [];<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      results.push(iterator(value, index));<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return results;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//第一个素能使iterator返回true的枚举元素的值，没有返回undefined<br style="margin:0px;padding:0px;"/>
  detect: function (iterator) {<br style="margin:0px;padding:0px;"/>
    var result;<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      if (iterator(value, index)) {<br style="margin:0px;padding:0px;"/>
        result = value;<br style="margin:0px;padding:0px;"/>
        throw $break;<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return result;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//找到所有的能使iterator迭代器函数返回true的枚举元素 作为一个数组返回<br style="margin:0px;padding:0px;"/>
  findAll: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var results = [];<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      if (iterator(value, index))<br style="margin:0px;padding:0px;"/>
        results.push(value);<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return results;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//找到素有匹配pattern的枚举元素，结果作为数组返回，iterator可选，如果不指定旧返回素有匹配pattern的枚举元素<br style="margin:0px;padding:0px;"/>
  grep: function(pattern, iterator) {//正则模式 迭代器<br style="margin:0px;padding:0px;"/>
    var results = [];<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      var stringValue = value.toString();<br style="margin:0px;padding:0px;"/>
      if (stringValue.match(pattern))<br style="margin:0px;padding:0px;"/>
        results.push((iterator || Prototype.K)(value, index));<br style="margin:0px;padding:0px;"/>
    })<br style="margin:0px;padding:0px;"/>
    return results;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//判断枚举对象中是否含有参数Object指定的值<br style="margin:0px;padding:0px;"/>
  include: function(object) {<br style="margin:0px;padding:0px;"/>
    var found = false;<br style="margin:0px;padding:0px;"/>
    this.each(function(value) {<br style="margin:0px;padding:0px;"/>
      if (value == object) {<br style="margin:0px;padding:0px;"/>
        found = true;<br style="margin:0px;padding:0px;"/>
        throw $break;<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return found;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//将memo作为iterator的第一个参数，枚举元素作为iterator的第二个参数，枚举元素的次序作为第三个<br style="margin:0px;padding:0px;"/>
//参数每次迭代器的返回值将作为下一个iterator的memo参数，从而所有的迭代执行都通过memo联系起来了<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  inject: function(memo, iterator) {<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      memo = iterator(memo, value, index);<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return memo;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//对所有的枚举元素执行method方法 后面是要传递的参数<br style="margin:0px;padding:0px;"/>
  invoke: function(method) {<br style="margin:0px;padding:0px;"/>
    var args = $A(arguments).slice(1);<br style="margin:0px;padding:0px;"/>
    return this.collect(function(value) {<br style="margin:0px;padding:0px;"/>
      return value[method].apply(value, args);<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//返回的最大的迭代器执行结果<br style="margin:0px;padding:0px;"/>
  max: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var result;<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      value = (iterator || Prototype.K)(value, index);<br style="margin:0px;padding:0px;"/>
      if (value &gt;= (result || value))<br style="margin:0px;padding:0px;"/>
        result = value;<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return result;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//反之<br style="margin:0px;padding:0px;"/>
  min: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var result;<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      value = (iterator || Prototype.K)(value, index);<br style="margin:0px;padding:0px;"/>
      if (value &lt;= (result || value))<br style="margin:0px;padding:0px;"/>
        result = value;<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return result;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//返回两个数组一组能使iterator返回true 另一组返回false<br style="margin:0px;padding:0px;"/>
  partition: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var trues = [], falses = [];<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      ((iterator || Prototype.K)(value, index) ?<br style="margin:0px;padding:0px;"/>
        trues : falses).push(value);<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return [trues, falses];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//获取所有枚举元素的property属性值作为数组的返回<br style="margin:0px;padding:0px;"/>
  pluck: function(property) {<br style="margin:0px;padding:0px;"/>
    var results = [];<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      results.push(value[property]);<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return results;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//与findall相反 <br style="margin:0px;padding:0px;"/>
  reject: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var results = [];<br style="margin:0px;padding:0px;"/>
    this.each(function(value, index) {<br style="margin:0px;padding:0px;"/>
      if (!iterator(value, index))<br style="margin:0px;padding:0px;"/>
        results.push(value);<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
    return results;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//根据iterator的结果排序 最小的在前面 作为数组返回<br style="margin:0px;padding:0px;"/>
  sortBy: function(iterator) {<br style="margin:0px;padding:0px;"/>
    return this.collect(function(value, index) {<br style="margin:0px;padding:0px;"/>
      return {value: value, criteria: iterator(value, index)};<br style="margin:0px;padding:0px;"/>
    }).sort(function(left, right) {<br style="margin:0px;padding:0px;"/>
      var a = left.criteria, b = right.criteria;<br style="margin:0px;padding:0px;"/>
      return a &lt; b ? -1 : a &gt; b ? 1 : 0;<br style="margin:0px;padding:0px;"/>
    }).pluck('value');<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//枚举对象--》数组<br style="margin:0px;padding:0px;"/>
  toArray: function() {<br style="margin:0px;padding:0px;"/>
    return this.collect(Prototype.K);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//接收多个枚举对象参数，最后一个可以是迭代器用于阵列转换<br style="margin:0px;padding:0px;"/>
  zip: function() {<br style="margin:0px;padding:0px;"/>
    var iterator = Prototype.K, args = $A(arguments);<br style="margin:0px;padding:0px;"/>
    if (typeof args.last() == 'function')<br style="margin:0px;padding:0px;"/>
      iterator = args.pop();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    var collections = [this].concat(args).map($A);<br style="margin:0px;padding:0px;"/>
    return this.map(function(value, index) {<br style="margin:0px;padding:0px;"/>
      iterator(value = collections.pluck(index));<br style="margin:0px;padding:0px;"/>
      return value;<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//返回枚举对象的字符串描述<br style="margin:0px;padding:0px;"/>
  inspect: function() {<br style="margin:0px;padding:0px;"/>
    return '#&lt;Enumerable:' + this.toArray().inspect() + '&gt;';<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
//等价函数定义<br style="margin:0px;padding:0px;"/>
Object.extend(Enumerable, {<br style="margin:0px;padding:0px;"/>
  map:     Enumerable.collect,<br style="margin:0px;padding:0px;"/>
  find:    Enumerable.detect,<br style="margin:0px;padding:0px;"/>
  select:  Enumerable.findAll,<br style="margin:0px;padding:0px;"/>
  member:  Enumerable.include,<br style="margin:0px;padding:0px;"/>
  entries: Enumerable.toArray<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//【Array】数组对象<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//参数转换为数组，如果参数定义了toarray则直接调用，否则枚举获得数组<br style="margin:0px;padding:0px;"/>
var $A = Array.from = function(iterable) {<br style="margin:0px;padding:0px;"/>
  if (!iterable) return [];<br style="margin:0px;padding:0px;"/>
  if (iterable.toArray) {<br style="margin:0px;padding:0px;"/>
    return iterable.toArray();<br style="margin:0px;padding:0px;"/>
  } else {<br style="margin:0px;padding:0px;"/>
    var results = [];<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; iterable.length; i++)<br style="margin:0px;padding:0px;"/>
      results.push(iterable[i]);<br style="margin:0px;padding:0px;"/>
    return results;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
//数组对象继承了Enumerable接口<br style="margin:0px;padding:0px;"/>
Object.extend(Array.prototype, Enumerable);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Array.prototype._reverse = Array.prototype.reverse;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Object.extend(Array.prototype, {<br style="margin:0px;padding:0px;"/>
//实现了枚举接口方法，用于对数组内的元素执行迭代器<br style="margin:0px;padding:0px;"/>
  _each: function(iterator) {<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; this.length; i++)<br style="margin:0px;padding:0px;"/>
      iterator(this[i]);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//清空数组<br style="margin:0px;padding:0px;"/>
  clear: function() {<br style="margin:0px;padding:0px;"/>
    this.length = 0;<br style="margin:0px;padding:0px;"/>
    return this;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//取得第一个元素<br style="margin:0px;padding:0px;"/>
  first: function() {<br style="margin:0px;padding:0px;"/>
    return this[0];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//取得最后一个元素<br style="margin:0px;padding:0px;"/>
  last: function() {<br style="margin:0px;padding:0px;"/>
    return this[this.length - 1];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//删除数组元素中所有的null undefined值 作为新数组返回，原数组不受影响<br style="margin:0px;padding:0px;"/>
  compact: function() {<br style="margin:0px;padding:0px;"/>
    return this.select(function(value) {<br style="margin:0px;padding:0px;"/>
      return value != undefined || value != null;<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//展开所有数组元素不再嵌套<br style="margin:0px;padding:0px;"/>
  flatten: function() {<br style="margin:0px;padding:0px;"/>
    return this.inject([], function(array, value) {<br style="margin:0px;padding:0px;"/>
      return array.concat(value.constructor == Array ?<br style="margin:0px;padding:0px;"/>
        value.flatten() : [value]);<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//数组中删除指定的元素，返回删除后的结果，原数组不受影响<br style="margin:0px;padding:0px;"/>
  without: function() {<br style="margin:0px;padding:0px;"/>
    var values = $A(arguments);<br style="margin:0px;padding:0px;"/>
    return this.select(function(value) {<br style="margin:0px;padding:0px;"/>
      return !values.include(value);<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//Value元素在数组中的索引值<br style="margin:0px;padding:0px;"/>
  indexOf: function(object) {<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; this.length; i++)<br style="margin:0px;padding:0px;"/>
      if (this[i] == object) return i;<br style="margin:0px;padding:0px;"/>
    return -1;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//反转数组<br style="margin:0px;padding:0px;"/>
  reverse: function(inline) {<br style="margin:0px;padding:0px;"/>
    return (inline !== false ? this : this.toArray())._reverse();<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//删除数组中第一个元素并返回这个元素的值<br style="margin:0px;padding:0px;"/>
  shift: function() {<br style="margin:0px;padding:0px;"/>
    var result = this[0];<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; this.length - 1; i++)<br style="margin:0px;padding:0px;"/>
      this[i] = this[i + 1];<br style="margin:0px;padding:0px;"/>
    this.length--;<br style="margin:0px;padding:0px;"/>
    return result;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//得到数组的字符串描述例如arr=[1,2,3]-----&gt; </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">[</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">1</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">,</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">2</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">,</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">3</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">]</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
  inspect: function() {<br style="margin:0px;padding:0px;"/>
    return '[' + this.map(Object.inspect).join(', ') + ']';<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//【Hash】哈希对象<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
var Hash = {<br style="margin:0px;padding:0px;"/>
//实现枚举接口方法从而使Hash对象也是枚举对象<br style="margin:0px;padding:0px;"/>
  _each: function(iterator) {<br style="margin:0px;padding:0px;"/>
    for (key in this) {<br style="margin:0px;padding:0px;"/>
      var value = this[key];<br style="margin:0px;padding:0px;"/>
      if (typeof value == 'function') continue;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      var pair = [key, value];<br style="margin:0px;padding:0px;"/>
      pair.key = key;<br style="margin:0px;padding:0px;"/>
      pair.value = value;<br style="margin:0px;padding:0px;"/>
      iterator(pair);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//所有键数组<br style="margin:0px;padding:0px;"/>
  keys: function() {<br style="margin:0px;padding:0px;"/>
    return this.pluck('key');<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//所有值数组<br style="margin:0px;padding:0px;"/>
  values: function() {<br style="margin:0px;padding:0px;"/>
    return this.pluck('value');<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//合并哈希表，键相同就覆盖调用者<br style="margin:0px;padding:0px;"/>
  merge: function(hash) {<br style="margin:0px;padding:0px;"/>
    return $H(hash).inject($H(this), function(mergedHash, pair) {<br style="margin:0px;padding:0px;"/>
      mergedHash[pair.key] = pair.value;<br style="margin:0px;padding:0px;"/>
      return mergedHash;<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//键值对组成查询字符串的形式<br style="margin:0px;padding:0px;"/>
  toQueryString: function() {<br style="margin:0px;padding:0px;"/>
    return this.map(function(pair) {<br style="margin:0px;padding:0px;"/>
      return pair.map(encodeURIComponent).join('=');<br style="margin:0px;padding:0px;"/>
    }).join('&amp;');<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//获取Hash对象的字符串描述<br style="margin:0px;padding:0px;"/>
  inspect: function() {<br style="margin:0px;padding:0px;"/>
    return '#&lt;Hash:{' + this.map(function(pair) {<br style="margin:0px;padding:0px;"/>
      return pair.map(Object.inspect).join(': ');<br style="margin:0px;padding:0px;"/>
    }).join(', ') + '}&gt;';<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
/*哈希表不是类而是对象所以不能用new的方法创建，而是用$H()函数<br style="margin:0px;padding:0px;"/>
  这个方法吧一个对象转换为哈希对象，对象的属性名为key 值为value<br style="margin:0px;padding:0px;"/>
  可枚举！！<br style="margin:0px;padding:0px;"/>
*/<br style="margin:0px;padding:0px;"/>
function $H(object) {<br style="margin:0px;padding:0px;"/>
  var hash = Object.extend({}, object || {});<br style="margin:0px;padding:0px;"/>
  Object.extend(hash, Enumerable);<br style="margin:0px;padding:0px;"/>
  Object.extend(hash, Hash);<br style="margin:0px;padding:0px;"/>
  return hash;<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//【ObjectRange】用于进行指定次数的循环运算，同样继承于枚举接口并实现_each方法<br style="margin:0px;padding:0px;"/>
//有了这个方法基本上Javascript里面就不用for循环了<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
ObjectRange = Class.create();<br style="margin:0px;padding:0px;"/>
Object.extend(ObjectRange.prototype, Enumerable);<br style="margin:0px;padding:0px;"/>
Object.extend(ObjectRange.prototype, {<br style="margin:0px;padding:0px;"/>
//构造函数同事指定了3个参数的值<br style="margin:0px;padding:0px;"/>
  initialize: function(start, end, exclusive) {<br style="margin:0px;padding:0px;"/>
    this.start = start; //其实索引<br style="margin:0px;padding:0px;"/>
    this.end = end;//结束索引<br style="margin:0px;padding:0px;"/>
    this.exclusive = exclusive;//表示是否包含结束索引<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  _each: function(iterator) {<br style="margin:0px;padding:0px;"/>
    var value = this.start;<br style="margin:0px;padding:0px;"/>
    do {<br style="margin:0px;padding:0px;"/>
      iterator(value);<br style="margin:0px;padding:0px;"/>
      value = value.succ();<br style="margin:0px;padding:0px;"/>
    } while (this.include(value));<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//重写枚举接口的include方法，判断改循环的索引是否包含参数value的指定的值<br style="margin:0px;padding:0px;"/>
  include: function(value) {<br style="margin:0px;padding:0px;"/>
    if (value &lt; this.start)<br style="margin:0px;padding:0px;"/>
      return false;<br style="margin:0px;padding:0px;"/>
    if (this.exclusive)<br style="margin:0px;padding:0px;"/>
      return value &lt; this.end;<br style="margin:0px;padding:0px;"/>
    return value &lt;= this.end;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
//使用$R()方法快速创建objectRange对象<br style="margin:0px;padding:0px;"/>
var $R = function(start, end, exclusive) {<br style="margin:0px;padding:0px;"/>
  return new ObjectRange(start, end, exclusive);<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
/* 【Ajax模块】<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//【ajax对象】<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
var Ajax = {//创建浏览器兼容的XMLHttpRequest对象<br style="margin:0px;padding:0px;"/>
  getTransport: function() {<br style="margin:0px;padding:0px;"/>
    return Try.these(<br style="margin:0px;padding:0px;"/>
      function() {return new ActiveXObject('Msxml2.XMLHTTP')},<br style="margin:0px;padding:0px;"/>
      function() {return new ActiveXObject('Microsoft.XMLHTTP')},<br style="margin:0px;padding:0px;"/>
      function() {return new XMLHttpRequest()}<br style="margin:0px;padding:0px;"/>
    ) || false;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//当前激活的请求数目<br style="margin:0px;padding:0px;"/>
  activeRequestCount: 0<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
//【Ajax.Responders对象】<br style="margin:0px;padding:0px;"/>
Ajax.Responders = {<br style="margin:0px;padding:0px;"/>
  responders: [],//表示所有响应处理代理<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  _each: function(iterator) {<br style="margin:0px;padding:0px;"/>
    this.responders._each(iterator);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//注册一个响应代理<br style="margin:0px;padding:0px;"/>
  register: function(responderToAdd) {<br style="margin:0px;padding:0px;"/>
    if (!this.include(responderToAdd))<br style="margin:0px;padding:0px;"/>
      this.responders.push(responderToAdd);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//删除一个响应代理<br style="margin:0px;padding:0px;"/>
  unregister: function(responderToRemove) {<br style="margin:0px;padding:0px;"/>
    this.responders = this.responders.without(responderToRemove);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//分发一个回调函数，让所有半酣callback回调函数事件标识符的响应代理都被调用<br style="margin:0px;padding:0px;"/>
//传递三个参数最后一个可选表示Json对象<br style="margin:0px;padding:0px;"/>
  dispatch: function(callback, request, transport, json) {<br style="margin:0px;padding:0px;"/>
    this.each(function(responder) {<br style="margin:0px;padding:0px;"/>
      if (responder[callback] &amp;&amp; typeof responder[callback] == 'function') {<br style="margin:0px;padding:0px;"/>
        try {<br style="margin:0px;padding:0px;"/>
          responder[callback].apply(responder, [request, transport, json]);<br style="margin:0px;padding:0px;"/>
        } catch (e) {}<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
};<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Object.extend(Ajax.Responders, Enumerable);<br style="margin:0px;padding:0px;"/>
//统计当前活动请求的数目<br style="margin:0px;padding:0px;"/>
Ajax.Responders.register({<br style="margin:0px;padding:0px;"/>
//开始创建了一个请求<br style="margin:0px;padding:0px;"/>
  onCreate: function() {<br style="margin:0px;padding:0px;"/>
    Ajax.activeRequestCount++;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//请求结束<br style="margin:0px;padding:0px;"/>
  onComplete: function() {<br style="margin:0px;padding:0px;"/>
    Ajax.activeRequestCount--;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//【Ajax.Base类】进行服务器通信的基类<br style="margin:0px;padding:0px;"/>
Ajax.Base = function() {};<br style="margin:0px;padding:0px;"/>
Ajax.Base.prototype = {<br style="margin:0px;padding:0px;"/>
  setOptions: function(options) {<br style="margin:0px;padding:0px;"/>
    this.options = {<br style="margin:0px;padding:0px;"/>
      method:       'post',<br style="margin:0px;padding:0px;"/>
      asynchronous: true,<br style="margin:0px;padding:0px;"/>
      parameters:   ''<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
    Object.extend(this.options, options || {});<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  responseIsSuccess: function() {<br style="margin:0px;padding:0px;"/>
    return this.transport.status == undefined<br style="margin:0px;padding:0px;"/>
        || this.transport.status == 0<br style="margin:0px;padding:0px;"/>
        || (this.transport.status &gt;= 200 &amp;&amp; this.transport.status &lt; 300);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  responseIsFailure: function() {<br style="margin:0px;padding:0px;"/>
    return !this.responseIsSuccess();<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
//【Ajax.Request类】用于向服务器端发送请求，封装了XmlHttpRequest<br style="margin:0px;padding:0px;"/>
Ajax.Request = Class.create();<br style="margin:0px;padding:0px;"/>
Ajax.Request.Events =<br style="margin:0px;padding:0px;"/>
  ['Uninitialized', 'Loading', 'Loaded', 'Interactive', 'Complete'];<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Ajax.Request.prototype = Object.extend(new Ajax.Base(), {<br style="margin:0px;padding:0px;"/>
  initialize: function(url, options) {<br style="margin:0px;padding:0px;"/>
    this.transport = Ajax.getTransport();<br style="margin:0px;padding:0px;"/>
    this.setOptions(options);//使用基类方法设置<br style="margin:0px;padding:0px;"/>
    this.request(url);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//向指定url发送请求 一般不会显示调用<br style="margin:0px;padding:0px;"/>
  request: function(url) {<br style="margin:0px;padding:0px;"/>
    var parameters = this.options.parameters || '';<br style="margin:0px;padding:0px;"/>
    if (parameters.length &gt; 0) parameters += '&amp;_=';<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    try {<br style="margin:0px;padding:0px;"/>
      this.url = url;<br style="margin:0px;padding:0px;"/>
      if (this.options.method == 'get' &amp;&amp; parameters.length &gt; 0)<br style="margin:0px;padding:0px;"/>
        this.url += (this.url.match(/?/) ? '&amp;' : '?') + parameters;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      Ajax.Responders.dispatch('onCreate', this, this.transport);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      this.transport.open(this.options.method, this.url,<br style="margin:0px;padding:0px;"/>
        this.options.asynchronous);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      if (this.options.asynchronous) {<br style="margin:0px;padding:0px;"/>
        this.transport.onreadystatechange = this.onStateChange.bind(this);<br style="margin:0px;padding:0px;"/>
        setTimeout((function() {this.respondToReadyState(1)}).bind(this), 10);<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      this.setRequestHeaders();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      var body = this.options.postBody ? this.options.postBody : parameters;<br style="margin:0px;padding:0px;"/>
      this.transport.send(this.options.method == 'post' ? body : null);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    } catch (e) {<br style="margin:0px;padding:0px;"/>
      this.dispatchException(e);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//设置请求的Http头 类内部使用 一般无需显示调用<br style="margin:0px;padding:0px;"/>
  setRequestHeaders: function() {<br style="margin:0px;padding:0px;"/>
    var requestHeaders =<br style="margin:0px;padding:0px;"/>
      ['X-Requested-With', 'XMLHttpRequest',<br style="margin:0px;padding:0px;"/>
       'X-Prototype-Version', Prototype.Version];<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (this.options.method == 'post') {<br style="margin:0px;padding:0px;"/>
      requestHeaders.push('Content-type',<br style="margin:0px;padding:0px;"/>
        'application/x-www-form-urlencoded');<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      /* Force </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">Connection: close</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> for Mozilla browsers to work around<br style="margin:0px;padding:0px;"/>
       * a bug where XMLHttpReqeuest sends an incorrect Content-length<br style="margin:0px;padding:0px;"/>
       * header. See Mozilla Bugzilla #246651.<br style="margin:0px;padding:0px;"/>
       */<br style="margin:0px;padding:0px;"/>
      if (this.transport.overrideMimeType)<br style="margin:0px;padding:0px;"/>
        requestHeaders.push('Connection', 'close');<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (this.options.requestHeaders)<br style="margin:0px;padding:0px;"/>
      requestHeaders.push.apply(requestHeaders, this.options.requestHeaders);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; requestHeaders.length; i += 2)<br style="margin:0px;padding:0px;"/>
      this.transport.setRequestHeader(requestHeaders[i], requestHeaders[i+1]);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//检测XMLHttpRquest对象的onstatechange事件类内部使用 一般无需显示调用<br style="margin:0px;padding:0px;"/>
  onStateChange: function() {<br style="margin:0px;padding:0px;"/>
    var readyState = this.transport.readyState;<br style="margin:0px;padding:0px;"/>
    if (readyState != 1)<br style="margin:0px;padding:0px;"/>
      this.respondToReadyState(this.transport.readyState);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//获取指定的Http头的内容<br style="margin:0px;padding:0px;"/>
  header: function(name) {<br style="margin:0px;padding:0px;"/>
    try {<br style="margin:0px;padding:0px;"/>
      return this.transport.getResponseHeader(name);<br style="margin:0px;padding:0px;"/>
    } catch (e) {}<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//如果服务器返回了Http头</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">X</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">-</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">JOSN</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">则将其作为js执行并返回执行结果<br style="margin:0px;padding:0px;"/>
  evalJSON: function() {<br style="margin:0px;padding:0px;"/>
    try {<br style="margin:0px;padding:0px;"/>
      return eval(this.header('X-JSON'));<br style="margin:0px;padding:0px;"/>
    } catch (e) {}<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//将XMLHttpRequest返回的responseText作为JS语句执行并返回执行结果<br style="margin:0px;padding:0px;"/>
  evalResponse: function() {<br style="margin:0px;padding:0px;"/>
    try {<br style="margin:0px;padding:0px;"/>
      return eval(this.transport.responseText);<br style="margin:0px;padding:0px;"/>
    } catch (e) {<br style="margin:0px;padding:0px;"/>
      this.dispatchException(e);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//处理XMLHttpRequest的readystate属性根据成功或失败调用Options对象中相应的回调函数<br style="margin:0px;padding:0px;"/>
//同时通知Ajax.Responders中注册的响应处理句柄<br style="margin:0px;padding:0px;"/>
  respondToReadyState: function(readyState) {<br style="margin:0px;padding:0px;"/>
    var event = Ajax.Request.Events[readyState];<br style="margin:0px;padding:0px;"/>
    var transport = this.transport, json = this.evalJSON();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (event == 'Complete') {<br style="margin:0px;padding:0px;"/>
      try {<br style="margin:0px;padding:0px;"/>
        (this.options['on' + this.transport.status]<br style="margin:0px;padding:0px;"/>
         || this.options['on' + (this.responseIsSuccess() ? 'Success' : 'Failure')]<br style="margin:0px;padding:0px;"/>
         || Prototype.emptyFunction)(transport, json);<br style="margin:0px;padding:0px;"/>
      } catch (e) {<br style="margin:0px;padding:0px;"/>
        this.dispatchException(e);<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      if ((this.header('Content-type') || '').match(/^text/javascript/i))<br style="margin:0px;padding:0px;"/>
        this.evalResponse();<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    try {<br style="margin:0px;padding:0px;"/>
      (this.options['on' + event] || Prototype.emptyFunction)(transport, json);<br style="margin:0px;padding:0px;"/>
      Ajax.Responders.dispatch('on' + event, this, transport, json);<br style="margin:0px;padding:0px;"/>
    } catch (e) {<br style="margin:0px;padding:0px;"/>
      this.dispatchException(e);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    /* Avoid memory leak in MSIE: clean up the oncomplete event handler */<br style="margin:0px;padding:0px;"/>
    if (event == 'Complete')<br style="margin:0px;padding:0px;"/>
      this.transport.onreadystatechange = Prototype.emptyFunction;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  dispatchException: function(exception) {<br style="margin:0px;padding:0px;"/>
    (this.options.onException || Prototype.emptyFunction)(this, exception);<br style="margin:0px;padding:0px;"/>
    Ajax.Responders.dispatch('onException', this, exception);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//【Ajax.Updater类】用于将获取的内容填充到指定的容器中去<br style="margin:0px;padding:0px;"/>
Ajax.Updater = Class.create();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Object.extend(Object.extend(Ajax.Updater.prototype, Ajax.Request.prototype), {<br style="margin:0px;padding:0px;"/>
//重写了构造函数<br style="margin:0px;padding:0px;"/>
  initialize: function(container, url, options) {<br style="margin:0px;padding:0px;"/>
    this.containers = {<br style="margin:0px;padding:0px;"/>
      success: container.success ? $(container.success) : $(container),<br style="margin:0px;padding:0px;"/>
      failure: container.failure ? $(container.failure) :<br style="margin:0px;padding:0px;"/>
        (container.success ? null : $(container))<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    this.transport = Ajax.getTransport();<br style="margin:0px;padding:0px;"/>
    this.setOptions(options);//可以指定evalscripts属性和insertion属性<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    var onComplete = this.options.onComplete || Prototype.emptyFunction;<br style="margin:0px;padding:0px;"/>
    this.options.onComplete = (function(transport, object) {<br style="margin:0px;padding:0px;"/>
      this.updateContent();<br style="margin:0px;padding:0px;"/>
      onComplete(transport, object);<br style="margin:0px;padding:0px;"/>
    }).bind(this);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    this.request(url);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  updateContent: function() {<br style="margin:0px;padding:0px;"/>
    var receiver = this.responseIsSuccess() ?<br style="margin:0px;padding:0px;"/>
      this.containers.success : this.containers.failure;<br style="margin:0px;padding:0px;"/>
    var response = this.transport.responseText;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (!this.options.evalScripts)<br style="margin:0px;padding:0px;"/>
      response = response.stripScripts();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (receiver) {<br style="margin:0px;padding:0px;"/>
      if (this.options.insertion) {<br style="margin:0px;padding:0px;"/>
        new this.options.insertion(receiver, response);<br style="margin:0px;padding:0px;"/>
      } else {<br style="margin:0px;padding:0px;"/>
        Element.update(receiver, response);<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (this.responseIsSuccess()) {<br style="margin:0px;padding:0px;"/>
      if (this.onComplete)<br style="margin:0px;padding:0px;"/>
        setTimeout(this.onComplete.bind(this), 10);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//【Ajax.PeriodicalUpdater类】用于定时执行服务器异步调用，功能与Updater相同只是有了定时功能<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Ajax.PeriodicalUpdater = Class.create();<br style="margin:0px;padding:0px;"/>
Ajax.PeriodicalUpdater.prototype = Object.extend(new Ajax.Base(), {<br style="margin:0px;padding:0px;"/>
  initialize: function(container, url, options) {<br style="margin:0px;padding:0px;"/>
    this.setOptions(options);<br style="margin:0px;padding:0px;"/>
    this.onComplete = this.options.onComplete;<br style="margin:0px;padding:0px;"/>
//区别就在下面两个属性 频率 衰减参数 指数增长！只要有一次不同旧回复原有频率<br style="margin:0px;padding:0px;"/>
    this.frequency = (this.options.frequency || 2);<br style="margin:0px;padding:0px;"/>
    this.decay = (this.options.decay || 1);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    this.updater = {};<br style="margin:0px;padding:0px;"/>
    this.container = container;<br style="margin:0px;padding:0px;"/>
    this.url = url;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    this.start();<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  start: function() {<br style="margin:0px;padding:0px;"/>
    this.options.onComplete = this.updateComplete.bind(this);<br style="margin:0px;padding:0px;"/>
    this.onTimerEvent();<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  stop: function() {<br style="margin:0px;padding:0px;"/>
    this.updater.onComplete = undefined;<br style="margin:0px;padding:0px;"/>
    clearTimeout(this.timer);<br style="margin:0px;padding:0px;"/>
    (this.onComplete || Prototype.emptyFunction).apply(this, arguments);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  updateComplete: function(request) {<br style="margin:0px;padding:0px;"/>
    if (this.options.decay) {<br style="margin:0px;padding:0px;"/>
      this.decay = (request.responseText == this.lastText ?<br style="margin:0px;padding:0px;"/>
        this.decay * this.options.decay : 1);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      this.lastText = request.responseText;<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
    this.timer = setTimeout(this.onTimerEvent.bind(this),<br style="margin:0px;padding:0px;"/>
      this.decay * this.frequency * 1000);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  onTimerEvent: function() {<br style="margin:0px;padding:0px;"/>
    this.updater = new Ajax.Updater(this.container, this.url, this.options);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
/*【文档操作的封装】<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//返回了一个数组包含了所有符合条件的结点的引用<br style="margin:0px;padding:0px;"/>
document.getElementsByClassName = function(className, parentElement) { //parentElement不指定就在全局查找<br style="margin:0px;padding:0px;"/>
  var children = ($(parentElement) || document.body).getElementsByTagName('*');<br style="margin:0px;padding:0px;"/>
  return $A(children).inject([], function(elements, child) {<br style="margin:0px;padding:0px;"/>
    if (child.className.match(new RegExp(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">^|</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">\s)</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"> + className + </span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">(\s</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">|</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">$)</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">)))<br style="margin:0px;padding:0px;"/>
      elements.push(child);<br style="margin:0px;padding:0px;"/>
    return elements;<br style="margin:0px;padding:0px;"/>
  });<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*【Element对象】用于对文档结点做一些统一的操作<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
*/<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
if (!window.Element) {<br style="margin:0px;padding:0px;"/>
  var Element = new Object();<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Object.extend(Element, {<br style="margin:0px;padding:0px;"/>
  visible: function(element) {<br style="margin:0px;padding:0px;"/>
    return $(element).style.display != 'none';<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//指定结点可见性的切换<br style="margin:0px;padding:0px;"/>
  toggle: function() {<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; arguments.length; i++) {<br style="margin:0px;padding:0px;"/>
      var element = $(arguments[i]);<br style="margin:0px;padding:0px;"/>
      Element[Element.visible(element) ? 'hide' : 'show'](element);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  hide: function() {<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; arguments.length; i++) {<br style="margin:0px;padding:0px;"/>
      var element = $(arguments[i]);<br style="margin:0px;padding:0px;"/>
      element.style.display = 'none';<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  show: function() {<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; arguments.length; i++) {<br style="margin:0px;padding:0px;"/>
      var element = $(arguments[i]);<br style="margin:0px;padding:0px;"/>
      element.style.display = '';<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  remove: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    element.parentNode.removeChild(element);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//将html片段填充到element指定的结点中<br style="margin:0px;padding:0px;"/>
  update: function(element, html) {<br style="margin:0px;padding:0px;"/>
    $(element).innerHTML = html.stripScripts();<br style="margin:0px;padding:0px;"/>
    setTimeout(function() {html.evalScripts()}, 10);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//获得element的绝对高度<br style="margin:0px;padding:0px;"/>
  getHeight: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    return element.offsetHeight;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  classNames: function(element) {<br style="margin:0px;padding:0px;"/>
    return new Element.ClassNames(element);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  hasClassName: function(element, className) {<br style="margin:0px;padding:0px;"/>
    if (!(element = $(element))) return;<br style="margin:0px;padding:0px;"/>
    return Element.classNames(element).include(className);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  addClassName: function(element, className) {<br style="margin:0px;padding:0px;"/>
    if (!(element = $(element))) return;<br style="margin:0px;padding:0px;"/>
    return Element.classNames(element).add(className);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  removeClassName: function(element, className) {<br style="margin:0px;padding:0px;"/>
    if (!(element = $(element))) return;<br style="margin:0px;padding:0px;"/>
    return Element.classNames(element).remove(className);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  // removes whitespace-only text node children<br style="margin:0px;padding:0px;"/>
  cleanWhitespace: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; element.childNodes.length; i++) {<br style="margin:0px;padding:0px;"/>
      var node = element.childNodes[i];<br style="margin:0px;padding:0px;"/>
      if (node.nodeType == 3 &amp;&amp; !/S/.test(node.nodeValue))<br style="margin:0px;padding:0px;"/>
        Element.remove(node);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  empty: function(element) {<br style="margin:0px;padding:0px;"/>
    return $(element).innerHTML.match(/^s*$/);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//将浏览器的滚动条滚动到指定的结点的位置<br style="margin:0px;padding:0px;"/>
  scrollTo: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    var x = element.x ? element.x : element.offsetLeft,<br style="margin:0px;padding:0px;"/>
        y = element.y ? element.y : element.offsetTop;<br style="margin:0px;padding:0px;"/>
    window.scrollTo(x, y);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//得到element的结点的绝对样式<br style="margin:0px;padding:0px;"/>
  getStyle: function(element, style) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    var value = element.style[style.camelize()];<br style="margin:0px;padding:0px;"/>
    if (!value) {<br style="margin:0px;padding:0px;"/>
      if (document.defaultView &amp;&amp; document.defaultView.getComputedStyle) {<br style="margin:0px;padding:0px;"/>
        var css = document.defaultView.getComputedStyle(element, null);<br style="margin:0px;padding:0px;"/>
        value = css ? css.getPropertyValue(style) : null;<br style="margin:0px;padding:0px;"/>
      } else if (element.currentStyle) {<br style="margin:0px;padding:0px;"/>
        value = element.currentStyle[style.camelize()];<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (window.opera &amp;&amp; ['left', 'top', 'right', 'bottom'].include(style))<br style="margin:0px;padding:0px;"/>
      if (Element.getStyle(element, 'position') == 'static') value = 'auto';<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    return value == 'auto' ? null : value;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//设置结点样式 var style={background-color:'black',color:'red'} Element.setStyle($('div1'),style)<br style="margin:0px;padding:0px;"/>
  setStyle: function(element, style) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    for (name in style)<br style="margin:0px;padding:0px;"/>
      element.style[name.camelize()] = style[name];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
  <br style="margin:0px;padding:0px;"/>
  //获得结点的宽度高度 该方法无论结点是否可见 都能获得其大小<br style="margin:0px;padding:0px;"/>
  getDimensions: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    if (Element.getStyle(element, 'display') != 'none')<br style="margin:0px;padding:0px;"/>
      return {width: element.offsetWidth, height: element.offsetHeight};<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    // All *Width and *Height properties give 0 on elements with display none,<br style="margin:0px;padding:0px;"/>
    // so enable the element temporarily<br style="margin:0px;padding:0px;"/>
    var els = element.style;<br style="margin:0px;padding:0px;"/>
    var originalVisibility = els.visibility;<br style="margin:0px;padding:0px;"/>
    var originalPosition = els.position;<br style="margin:0px;padding:0px;"/>
    els.visibility = 'hidden';<br style="margin:0px;padding:0px;"/>
    els.position = 'absolute';<br style="margin:0px;padding:0px;"/>
    els.display = '';<br style="margin:0px;padding:0px;"/>
    var originalWidth = element.clientWidth;<br style="margin:0px;padding:0px;"/>
    var originalHeight = element.clientHeight;<br style="margin:0px;padding:0px;"/>
    els.display = 'none';<br style="margin:0px;padding:0px;"/>
    els.position = originalPosition;<br style="margin:0px;padding:0px;"/>
    els.visibility = originalVisibility;<br style="margin:0px;padding:0px;"/>
    return {width: originalWidth, height: originalHeight};<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//相对定位<br style="margin:0px;padding:0px;"/>
  makePositioned: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    var pos = Element.getStyle(element, 'position');<br style="margin:0px;padding:0px;"/>
    if (pos == 'static' || !pos) {<br style="margin:0px;padding:0px;"/>
      element._madePositioned = true;<br style="margin:0px;padding:0px;"/>
      element.style.position = 'relative';<br style="margin:0px;padding:0px;"/>
      // Opera returns the offset relative to the positioning context, when an<br style="margin:0px;padding:0px;"/>
      // element is position relative but top and left have not been defined<br style="margin:0px;padding:0px;"/>
      if (window.opera) {<br style="margin:0px;padding:0px;"/>
        element.style.top = 0;<br style="margin:0px;padding:0px;"/>
        element.style.left = 0;<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//取消相对定位<br style="margin:0px;padding:0px;"/>
  undoPositioned: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    if (element._madePositioned) {<br style="margin:0px;padding:0px;"/>
      element._madePositioned = undefined;<br style="margin:0px;padding:0px;"/>
      element.style.position =<br style="margin:0px;padding:0px;"/>
        element.style.top =<br style="margin:0px;padding:0px;"/>
        element.style.left =<br style="margin:0px;padding:0px;"/>
        element.style.bottom =<br style="margin:0px;padding:0px;"/>
        element.style.right = '';<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//使结点隐藏超出的部分 overflow=relative<br style="margin:0px;padding:0px;"/>
  makeClipping: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    if (element._overflow) return;<br style="margin:0px;padding:0px;"/>
    element._overflow = element.style.overflow;<br style="margin:0px;padding:0px;"/>
    if ((Element.getStyle(element, 'overflow') || 'visible') != 'hidden')<br style="margin:0px;padding:0px;"/>
      element.style.overflow = 'hidden';<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  undoClipping: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    if (element._overflow) return;<br style="margin:0px;padding:0px;"/>
    element.style.overflow = element._overflow;<br style="margin:0px;padding:0px;"/>
    element._overflow = undefined;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//Toggle对象是Element.toggle方法的一个快捷用法<br style="margin:0px;padding:0px;"/>
var Toggle = new Object();<br style="margin:0px;padding:0px;"/>
Toggle.display = Element.toggle;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//【Insertion命名空间】包含了4个类把指定的html片段插入到指定的结点的相应位置上<br style="margin:0px;padding:0px;"/>
Abstract.Insertion = function(adjacency) {<br style="margin:0px;padding:0px;"/>
  this.adjacency = adjacency;<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Abstract.Insertion.prototype = {<br style="margin:0px;padding:0px;"/>
  initialize: function(element, content) {<br style="margin:0px;padding:0px;"/>
    this.element = $(element);<br style="margin:0px;padding:0px;"/>
    this.content = content.stripScripts();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (this.adjacency &amp;&amp; this.element.insertAdjacentHTML) {<br style="margin:0px;padding:0px;"/>
      try {<br style="margin:0px;padding:0px;"/>
        this.element.insertAdjacentHTML(this.adjacency, this.content);<br style="margin:0px;padding:0px;"/>
      } catch (e) {<br style="margin:0px;padding:0px;"/>
        if (this.element.tagName.toLowerCase() == 'tbody') {<br style="margin:0px;padding:0px;"/>
          this.insertContent(this.contentFromAnonymousTable());<br style="margin:0px;padding:0px;"/>
        } else {<br style="margin:0px;padding:0px;"/>
          throw e;<br style="margin:0px;padding:0px;"/>
        }<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    } else {<br style="margin:0px;padding:0px;"/>
      this.range = this.element.ownerDocument.createRange();<br style="margin:0px;padding:0px;"/>
      if (this.initializeRange) this.initializeRange();<br style="margin:0px;padding:0px;"/>
      this.insertContent([this.range.createContextualFragment(this.content)]);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    setTimeout(function() {content.evalScripts()}, 10);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  contentFromAnonymousTable: function() {<br style="margin:0px;padding:0px;"/>
    var div = document.createElement('div');<br style="margin:0px;padding:0px;"/>
    div.innerHTML = '&lt;table&gt;&lt;tbody&gt;' + this.content + '&lt;/tbody&gt;&lt;/table&gt;';<br style="margin:0px;padding:0px;"/>
    return $A(div.childNodes[0].childNodes[0].childNodes);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
var Insertion = new Object();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Insertion.Before = Class.create();<br style="margin:0px;padding:0px;"/>
Insertion.Before.prototype = Object.extend(new Abstract.Insertion('beforeBegin'), {<br style="margin:0px;padding:0px;"/>
  initializeRange: function() {<br style="margin:0px;padding:0px;"/>
    this.range.setStartBefore(this.element);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  insertContent: function(fragments) {<br style="margin:0px;padding:0px;"/>
    fragments.each((function(fragment) {<br style="margin:0px;padding:0px;"/>
      this.element.parentNode.insertBefore(fragment, this.element);<br style="margin:0px;padding:0px;"/>
    }).bind(this));<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Insertion.Top = Class.create();<br style="margin:0px;padding:0px;"/>
Insertion.Top.prototype = Object.extend(new Abstract.Insertion('afterBegin'), {<br style="margin:0px;padding:0px;"/>
  initializeRange: function() {<br style="margin:0px;padding:0px;"/>
    this.range.selectNodeContents(this.element);<br style="margin:0px;padding:0px;"/>
    this.range.collapse(true);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  insertContent: function(fragments) {<br style="margin:0px;padding:0px;"/>
    fragments.reverse(false).each((function(fragment) {<br style="margin:0px;padding:0px;"/>
      this.element.insertBefore(fragment, this.element.firstChild);<br style="margin:0px;padding:0px;"/>
    }).bind(this));<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Insertion.Bottom = Class.create();<br style="margin:0px;padding:0px;"/>
Insertion.Bottom.prototype = Object.extend(new Abstract.Insertion('beforeEnd'), {<br style="margin:0px;padding:0px;"/>
  initializeRange: function() {<br style="margin:0px;padding:0px;"/>
    this.range.selectNodeContents(this.element);<br style="margin:0px;padding:0px;"/>
    this.range.collapse(this.element);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  insertContent: function(fragments) {<br style="margin:0px;padding:0px;"/>
    fragments.each((function(fragment) {<br style="margin:0px;padding:0px;"/>
      this.element.appendChild(fragment);<br style="margin:0px;padding:0px;"/>
    }).bind(this));<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Insertion.After = Class.create();<br style="margin:0px;padding:0px;"/>
Insertion.After.prototype = Object.extend(new Abstract.Insertion('afterEnd'), {<br style="margin:0px;padding:0px;"/>
  initializeRange: function() {<br style="margin:0px;padding:0px;"/>
    this.range.setStartAfter(this.element);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  insertContent: function(fragments) {<br style="margin:0px;padding:0px;"/>
    fragments.each((function(fragment) {<br style="margin:0px;padding:0px;"/>
      this.element.parentNode.insertBefore(fragment,<br style="margin:0px;padding:0px;"/>
        this.element.nextSibling);<br style="margin:0px;padding:0px;"/>
    }).bind(this));<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
//【Element.ClassNames】获得一个结点的所有的class名称组成的对象，实现了枚举接口<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Element.ClassNames = Class.create();<br style="margin:0px;padding:0px;"/>
Element.ClassNames.prototype = {<br style="margin:0px;padding:0px;"/>
  initialize: function(element) {<br style="margin:0px;padding:0px;"/>
    this.element = $(element);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  _each: function(iterator) {<br style="margin:0px;padding:0px;"/>
    this.element.className.split(/s+/).select(function(name) {<br style="margin:0px;padding:0px;"/>
      return name.length &gt; 0;<br style="margin:0px;padding:0px;"/>
    })._each(iterator);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  set: function(className) {<br style="margin:0px;padding:0px;"/>
    this.element.className = className;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  add: function(classNameToAdd) {<br style="margin:0px;padding:0px;"/>
    if (this.include(classNameToAdd)) return;<br style="margin:0px;padding:0px;"/>
    this.set(this.toArray().concat(classNameToAdd).join(' '));<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  remove: function(classNameToRemove) {<br style="margin:0px;padding:0px;"/>
    if (!this.include(classNameToRemove)) return;<br style="margin:0px;padding:0px;"/>
    this.set(this.select(function(className) {<br style="margin:0px;padding:0px;"/>
      return className != classNameToRemove;<br style="margin:0px;padding:0px;"/>
    }).join(' '));<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  toString: function() {//获得所有class的字符串表示空格隔开<br style="margin:0px;padding:0px;"/>
    return this.toArray().join(' ');<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
//表单域对象工具类<br style="margin:0px;padding:0px;"/>
Object.extend(Element.ClassNames.prototype, Enumerable);<br style="margin:0px;padding:0px;"/>
var Field = {<br style="margin:0px;padding:0px;"/>
  clear: function() {<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; arguments.length; i++)<br style="margin:0px;padding:0px;"/>
      $(arguments[i]).value = '';<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  focus: function(element) {<br style="margin:0px;padding:0px;"/>
    $(element).focus();<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  present: function() {<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; arguments.length; i++)<br style="margin:0px;padding:0px;"/>
      if ($(arguments[i]).value == '') return false;<br style="margin:0px;padding:0px;"/>
    return true;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//选中表单域<br style="margin:0px;padding:0px;"/>
  select: function(element) {<br style="margin:0px;padding:0px;"/>
    $(element).select();<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//focus + select<br style="margin:0px;padding:0px;"/>
  activate: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    element.focus();<br style="margin:0px;padding:0px;"/>
    if (element.select)<br style="margin:0px;padding:0px;"/>
      element.select();<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*【Form】表单工具对象*/<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
var Form = {<br style="margin:0px;padding:0px;"/>
//表单数据序列化<br style="margin:0px;padding:0px;"/>
  serialize: function(form) {<br style="margin:0px;padding:0px;"/>
    var elements = Form.getElements($(form));<br style="margin:0px;padding:0px;"/>
    var queryComponents = new Array();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; elements.length; i++) {<br style="margin:0px;padding:0px;"/>
      var queryComponent = Form.Element.serialize(elements[i]);<br style="margin:0px;padding:0px;"/>
      if (queryComponent)<br style="margin:0px;padding:0px;"/>
        queryComponents.push(queryComponent);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    return queryComponents.join('&amp;');<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//获取所有表单域按照标记名排列<br style="margin:0px;padding:0px;"/>
  getElements: function(form) {<br style="margin:0px;padding:0px;"/>
    form = $(form);<br style="margin:0px;padding:0px;"/>
    var elements = new Array();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    for (tagName in Form.Element.Serializers) {<br style="margin:0px;padding:0px;"/>
      var tagElements = form.getElementsByTagName(tagName);<br style="margin:0px;padding:0px;"/>
      for (var j = 0; j &lt; tagElements.length; j++)<br style="margin:0px;padding:0px;"/>
        elements.push(tagElements[j]);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
    return elements;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//有一个满足就返回<br style="margin:0px;padding:0px;"/>
  getInputs: function(form, typeName, name) {<br style="margin:0px;padding:0px;"/>
    form = $(form);<br style="margin:0px;padding:0px;"/>
    var inputs = form.getElementsByTagName('input');<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (!typeName &amp;&amp; !name)<br style="margin:0px;padding:0px;"/>
      return inputs;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    var matchingInputs = new Array();<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; inputs.length; i++) {<br style="margin:0px;padding:0px;"/>
      var input = inputs[i];<br style="margin:0px;padding:0px;"/>
      if ((typeName &amp;&amp; input.type != typeName) ||<br style="margin:0px;padding:0px;"/>
          (name &amp;&amp; input.name != name))<br style="margin:0px;padding:0px;"/>
        continue;<br style="margin:0px;padding:0px;"/>
      matchingInputs.push(input);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    return matchingInputs;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//整个表单域禁用<br style="margin:0px;padding:0px;"/>
  disable: function(form) {<br style="margin:0px;padding:0px;"/>
    var elements = Form.getElements(form);<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; elements.length; i++) {<br style="margin:0px;padding:0px;"/>
      var element = elements[i];<br style="margin:0px;padding:0px;"/>
      element.blur();<br style="margin:0px;padding:0px;"/>
      element.disabled = 'true';<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//启用<br style="margin:0px;padding:0px;"/>
  enable: function(form) {<br style="margin:0px;padding:0px;"/>
    var elements = Form.getElements(form);<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; elements.length; i++) {<br style="margin:0px;padding:0px;"/>
      var element = elements[i];<br style="margin:0px;padding:0px;"/>
      element.disabled = '';<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//获取第一个可用的表单域<br style="margin:0px;padding:0px;"/>
  findFirstElement: function(form) {<br style="margin:0px;padding:0px;"/>
    return Form.getElements(form).find(function(element) {<br style="margin:0px;padding:0px;"/>
      return element.type != 'hidden' &amp;&amp; !element.disabled &amp;&amp;<br style="margin:0px;padding:0px;"/>
        ['input', 'select', 'textarea'].include(element.tagName.toLowerCase());<br style="margin:0px;padding:0px;"/>
    });<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//激活第一个表单域<br style="margin:0px;padding:0px;"/>
  focusFirstElement: function(form) {<br style="margin:0px;padding:0px;"/>
    Field.activate(Form.findFirstElement(form));<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  reset: function(form) {<br style="margin:0px;padding:0px;"/>
    $(form).reset();<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//【Form.Element】 对特定的表单域进行操作<br style="margin:0px;padding:0px;"/>
Form.Element = {<br style="margin:0px;padding:0px;"/>
//序列化形成</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&amp;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">name</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">=</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">value</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;">&quot;</span><span style="margin:0px;padding:0px;font-family:'Courier New';font-size:12px;line-height:1.5;color:#000000;"><br style="margin:0px;padding:0px;"/>
  serialize: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    var method = element.tagName.toLowerCase();<br style="margin:0px;padding:0px;"/>
    var parameter = Form.Element.Serializers[method](element);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (parameter) {<br style="margin:0px;padding:0px;"/>
      var key = encodeURIComponent(parameter[0]);<br style="margin:0px;padding:0px;"/>
      if (key.length == 0) return;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      if (parameter[1].constructor != Array)<br style="margin:0px;padding:0px;"/>
        parameter[1] = [parameter[1]];<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      return parameter[1].map(function(value) {<br style="margin:0px;padding:0px;"/>
        return key + '=' + encodeURIComponent(value);<br style="margin:0px;padding:0px;"/>
      }).join('&amp;');<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//获得指定表单域的值<br style="margin:0px;padding:0px;"/>
  getValue: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    var method = element.tagName.toLowerCase();<br style="margin:0px;padding:0px;"/>
    var parameter = Form.Element.Serializers[method](element);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (parameter)<br style="margin:0px;padding:0px;"/>
      return parameter[1];<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
//【Form.Element.Serializers】针对不同的表单域进行序列化<br style="margin:0px;padding:0px;"/>
Form.Element.Serializers = {<br style="margin:0px;padding:0px;"/>
//一般用所有的&lt;input&gt;标记的序列化都可以<br style="margin:0px;padding:0px;"/>
  input: function(element) {<br style="margin:0px;padding:0px;"/>
    switch (element.type.toLowerCase()) {<br style="margin:0px;padding:0px;"/>
      case 'submit':<br style="margin:0px;padding:0px;"/>
      case 'hidden':<br style="margin:0px;padding:0px;"/>
      case 'password':<br style="margin:0px;padding:0px;"/>
      case 'text':<br style="margin:0px;padding:0px;"/>
        return Form.Element.Serializers.textarea(element);<br style="margin:0px;padding:0px;"/>
      case 'checkbox':<br style="margin:0px;padding:0px;"/>
      case 'radio':<br style="margin:0px;padding:0px;"/>
        return Form.Element.Serializers.inputSelector(element);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
    return false;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  inputSelector: function(element) {<br style="margin:0px;padding:0px;"/>
    if (element.checked)<br style="margin:0px;padding:0px;"/>
      return [element.name, element.value];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  textarea: function(element) {<br style="margin:0px;padding:0px;"/>
    return [element.name, element.value];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  select: function(element) {<br style="margin:0px;padding:0px;"/>
    return Form.Element.Serializers[element.type == 'select-one' ?<br style="margin:0px;padding:0px;"/>
      'selectOne' : 'selectMany'](element);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  selectOne: function(element) {<br style="margin:0px;padding:0px;"/>
    var value = '', opt, index = element.selectedIndex;<br style="margin:0px;padding:0px;"/>
    if (index &gt;= 0) {<br style="margin:0px;padding:0px;"/>
      opt = element.options[index];<br style="margin:0px;padding:0px;"/>
      value = opt.value;<br style="margin:0px;padding:0px;"/>
      if (!value &amp;&amp; !('value' in opt))<br style="margin:0px;padding:0px;"/>
        value = opt.text;<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
    return [element.name, value];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  selectMany: function(element) {<br style="margin:0px;padding:0px;"/>
    var value = new Array();<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; element.length; i++) {<br style="margin:0px;padding:0px;"/>
      var opt = element.options[i];<br style="margin:0px;padding:0px;"/>
      if (opt.selected) {<br style="margin:0px;padding:0px;"/>
        var optValue = opt.value;<br style="margin:0px;padding:0px;"/>
        if (!optValue &amp;&amp; !('value' in opt))<br style="margin:0px;padding:0px;"/>
          optValue = opt.text;<br style="margin:0px;padding:0px;"/>
        value.push(optValue);<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
    return [element.name, value];<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//【获得表单域的值】<br style="margin:0px;padding:0px;"/>
var $F = Form.Element.getValue;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
/*【Observer模式框架】 观察对象仅仅针对表单和表单域*/<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Abstract.TimedObserver = function() {}//定义了基于定时器的观察模式基类后面的类都继承了这个类<br style="margin:0px;padding:0px;"/>
Abstract.TimedObserver.prototype = {<br style="margin:0px;padding:0px;"/>
  initialize: function(element, frequency, callback) {<br style="margin:0px;padding:0px;"/>
    this.frequency = frequency;//观察频率<br style="margin:0px;padding:0px;"/>
    this.element   = $(element);//被观察的对象<br style="margin:0px;padding:0px;"/>
    this.callback  = callback;//回调函数接受参数 被观察对象自身和触发事件时的值<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    this.lastValue = this.getValue();//这是观察的值！！<br style="margin:0px;padding:0px;"/>
    this.registerCallback();<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//注册回调函数<br style="margin:0px;padding:0px;"/>
  registerCallback: function() {<br style="margin:0px;padding:0px;"/>
    setInterval(this.onTimerEvent.bind(this), this.frequency * 1000);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//每一个时间片触发一次该事件<br style="margin:0px;padding:0px;"/>
  onTimerEvent: function() {<br style="margin:0px;padding:0px;"/>
    var value = this.getValue();<br style="margin:0px;padding:0px;"/>
    if (this.lastValue != value) {<br style="margin:0px;padding:0px;"/>
      this.callback(this.element, value);<br style="margin:0px;padding:0px;"/>
      this.lastValue = value;<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//【Form.Element.Observer类】实现了getvalue方法<br style="margin:0px;padding:0px;"/>
Form.Element.Observer = Class.create();<br style="margin:0px;padding:0px;"/>
Form.Element.Observer.prototype = Object.extend(new Abstract.TimedObserver(), {<br style="margin:0px;padding:0px;"/>
  getValue: function() {<br style="margin:0px;padding:0px;"/>
    return Form.Element.getValue(this.element);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//【Form.Observer类】实现了getvalue方法，只要有一个表单域发生变化就会触发回调<br style="margin:0px;padding:0px;"/>
Form.Observer = Class.create();<br style="margin:0px;padding:0px;"/>
Form.Observer.prototype = Object.extend(new Abstract.TimedObserver(), {<br style="margin:0px;padding:0px;"/>
  getValue: function() {<br style="margin:0px;padding:0px;"/>
    return Form.serialize(this.element);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//【Abstract.EventObserver 类】基于事件的Oberver模式的基类 后面的具体类都继承这个类<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Abstract.EventObserver = function() {}<br style="margin:0px;padding:0px;"/>
Abstract.EventObserver.prototype = {<br style="margin:0px;padding:0px;"/>
  initialize: function(element, callback) {<br style="margin:0px;padding:0px;"/>
    this.element  = $(element);<br style="margin:0px;padding:0px;"/>
    this.callback = callback;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    this.lastValue = this.getValue();<br style="margin:0px;padding:0px;"/>
    if (this.element.tagName.toLowerCase() == 'form')<br style="margin:0px;padding:0px;"/>
      this.registerFormCallbacks();<br style="margin:0px;padding:0px;"/>
    else<br style="margin:0px;padding:0px;"/>
      this.registerCallback(this.element);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//每次发生事件时被调用 内部调用 无需显示调用<br style="margin:0px;padding:0px;"/>
  onElementEvent: function() {<br style="margin:0px;padding:0px;"/>
    var value = this.getValue();<br style="margin:0px;padding:0px;"/>
    if (this.lastValue != value) {<br style="margin:0px;padding:0px;"/>
      this.callback(this.element, value);<br style="margin:0px;padding:0px;"/>
      this.lastValue = value;<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//注册表表单域事件<br style="margin:0px;padding:0px;"/>
  registerFormCallbacks: function() {<br style="margin:0px;padding:0px;"/>
    var elements = Form.getElements(this.element);<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; elements.length; i++)<br style="margin:0px;padding:0px;"/>
      this.registerCallback(elements[i]);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  registerCallback: function(element) {<br style="margin:0px;padding:0px;"/>
    if (element.type) {<br style="margin:0px;padding:0px;"/>
      switch (element.type.toLowerCase()) {<br style="margin:0px;padding:0px;"/>
        case 'checkbox':<br style="margin:0px;padding:0px;"/>
        case 'radio':<br style="margin:0px;padding:0px;"/>
          Event.observe(element, 'click', this.onElementEvent.bind(this));<br style="margin:0px;padding:0px;"/>
          break;<br style="margin:0px;padding:0px;"/>
        case 'password':<br style="margin:0px;padding:0px;"/>
        case 'text':<br style="margin:0px;padding:0px;"/>
        case 'textarea':<br style="margin:0px;padding:0px;"/>
        case 'select-one':<br style="margin:0px;padding:0px;"/>
        case 'select-multiple':<br style="margin:0px;padding:0px;"/>
          Event.observe(element, 'change', this.onElementEvent.bind(this));<br style="margin:0px;padding:0px;"/>
          break;<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
//【Form.Element.EventObserver】<br style="margin:0px;padding:0px;"/>
Form.Element.EventObserver = Class.create();<br style="margin:0px;padding:0px;"/>
Form.Element.EventObserver.prototype = Object.extend(new Abstract.EventObserver(), {<br style="margin:0px;padding:0px;"/>
  getValue: function() {<br style="margin:0px;padding:0px;"/>
    return Form.Element.getValue(this.element);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
//【Form.EventObserver】<br style="margin:0px;padding:0px;"/>
Form.EventObserver = Class.create();<br style="margin:0px;padding:0px;"/>
Form.EventObserver.prototype = Object.extend(new Abstract.EventObserver(), {<br style="margin:0px;padding:0px;"/>
  getValue: function() {<br style="margin:0px;padding:0px;"/>
    return Form.serialize(this.element);<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
/*【事件处理:对Event对象的扩展】对javascript事件处理机制进行封装*/<br style="margin:0px;padding:0px;"/>
/*========================================================================================*/<br style="margin:0px;padding:0px;"/>
if (!window.Event) {<br style="margin:0px;padding:0px;"/>
  var Event = new Object();<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
Object.extend(Event, {<br style="margin:0px;padding:0px;"/>
  KEY_BACKSPACE: 8,<br style="margin:0px;padding:0px;"/>
  KEY_TAB:       9,<br style="margin:0px;padding:0px;"/>
  KEY_RETURN:   13,<br style="margin:0px;padding:0px;"/>
  KEY_ESC:      27,<br style="margin:0px;padding:0px;"/>
  KEY_LEFT:     37,<br style="margin:0px;padding:0px;"/>
  KEY_UP:       38,<br style="margin:0px;padding:0px;"/>
  KEY_RIGHT:    39,<br style="margin:0px;padding:0px;"/>
  KEY_DOWN:     40,<br style="margin:0px;padding:0px;"/>
  KEY_DELETE:   46,<br style="margin:0px;padding:0px;"/>
//获取触发事件的对象<br style="margin:0px;padding:0px;"/>
  element: function(event) {<br style="margin:0px;padding:0px;"/>
    return event.target || event.srcElement;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  isLeftClick: function(event) {<br style="margin:0px;padding:0px;"/>
    return (((event.which) &amp;&amp; (event.which == 1)) ||<br style="margin:0px;padding:0px;"/>
            ((event.button) &amp;&amp; (event.button == 1)));<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  pointerX: function(event) {<br style="margin:0px;padding:0px;"/>
    return event.pageX || (event.clientX +<br style="margin:0px;padding:0px;"/>
      (document.documentElement.scrollLeft || document.body.scrollLeft));<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  pointerY: function(event) {<br style="margin:0px;padding:0px;"/>
    return event.pageY || (event.clientY +<br style="margin:0px;padding:0px;"/>
      (document.documentElement.scrollTop || document.body.scrollTop));<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//停止事件的传递<br style="margin:0px;padding:0px;"/>
  stop: function(event) {<br style="margin:0px;padding:0px;"/>
    if (event.preventDefault) {<br style="margin:0px;padding:0px;"/>
      event.preventDefault();<br style="margin:0px;padding:0px;"/>
      event.stopPropagation();<br style="margin:0px;padding:0px;"/>
    } else {<br style="margin:0px;padding:0px;"/>
      event.returnValue = false;<br style="margin:0px;padding:0px;"/>
      event.cancelBubble = true;<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  // find the first node with the given tagName, starting from the<br style="margin:0px;padding:0px;"/>
  // node the event was triggered on; traverses the DOM upwards<br style="margin:0px;padding:0px;"/>
  findElement: function(event, tagName) {<br style="margin:0px;padding:0px;"/>
    var element = Event.element(event);<br style="margin:0px;padding:0px;"/>
    while (element.parentNode &amp;&amp; (!element.tagName ||<br style="margin:0px;padding:0px;"/>
        (element.tagName.toUpperCase() != tagName.toUpperCase())))<br style="margin:0px;padding:0px;"/>
      element = element.parentNode;<br style="margin:0px;padding:0px;"/>
    return element;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  observers: false,<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  _observeAndCache: function(element, name, observer, useCapture) {<br style="margin:0px;padding:0px;"/>
    if (!this.observers) this.observers = [];<br style="margin:0px;padding:0px;"/>
    if (element.addEventListener) {<br style="margin:0px;padding:0px;"/>
      this.observers.push([element, name, observer, useCapture]);<br style="margin:0px;padding:0px;"/>
      element.addEventListener(name, observer, useCapture);<br style="margin:0px;padding:0px;"/>
    } else if (element.attachEvent) {<br style="margin:0px;padding:0px;"/>
      this.observers.push([element, name, observer, useCapture]);<br style="margin:0px;padding:0px;"/>
      element.attachEvent('on' + name, observer);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//删除所有通过Event.observers绑定的事件<br style="margin:0px;padding:0px;"/>
  unloadCache: function() {<br style="margin:0px;padding:0px;"/>
    if (!Event.observers) return;<br style="margin:0px;padding:0px;"/>
    for (var i = 0; i &lt; Event.observers.length; i++) {<br style="margin:0px;padding:0px;"/>
      Event.stopObserving.apply(this, Event.observers[i]);<br style="margin:0px;padding:0px;"/>
      Event.observers[i][0] = null;<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
    Event.observers = false;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//绑定一个事件<br style="margin:0px;padding:0px;"/>
  observe: function(element, name, observer, useCapture) {<br style="margin:0px;padding:0px;"/>
    var element = $(element);<br style="margin:0px;padding:0px;"/>
    useCapture = useCapture || false;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (name == 'keypress' &amp;&amp;<br style="margin:0px;padding:0px;"/>
        (navigator.appVersion.match(/Konqueror|Safari|KHTML/)<br style="margin:0px;padding:0px;"/>
        || element.attachEvent))<br style="margin:0px;padding:0px;"/>
      name = 'keydown';<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    this._observeAndCache(element, name, observer, useCapture);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//取消事件绑定<br style="margin:0px;padding:0px;"/>
  stopObserving: function(element, name, observer, useCapture) {<br style="margin:0px;padding:0px;"/>
    var element = $(element);<br style="margin:0px;padding:0px;"/>
    useCapture = useCapture || false;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (name == 'keypress' &amp;&amp;<br style="margin:0px;padding:0px;"/>
        (navigator.appVersion.match(/Konqueror|Safari|KHTML/)<br style="margin:0px;padding:0px;"/>
        || element.detachEvent))<br style="margin:0px;padding:0px;"/>
      name = 'keydown';<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    if (element.removeEventListener) {<br style="margin:0px;padding:0px;"/>
      element.removeEventListener(name, observer, useCapture);<br style="margin:0px;padding:0px;"/>
    } else if (element.detachEvent) {<br style="margin:0px;padding:0px;"/>
      element.detachEvent('on' + name, observer);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
});<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//【结点的位置处理:Position对象】<br style="margin:0px;padding:0px;"/>
/* prevent memory leaks in IE */<br style="margin:0px;padding:0px;"/>
Event.observe(window, 'unload', Event.unloadCache, false);<br style="margin:0px;padding:0px;"/>
var Position = {<br style="margin:0px;padding:0px;"/>
  // set to true if needed, warning: firefox performance problems<br style="margin:0px;padding:0px;"/>
  // NOT neeeded for page scrolling, only if draggable contained in<br style="margin:0px;padding:0px;"/>
  // scrollable elements<br style="margin:0px;padding:0px;"/>
  includeScrollOffsets: false,<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  // must be called before calling withinIncludingScrolloffset, every time the<br style="margin:0px;padding:0px;"/>
  // page is scrolled用于计算滚动条的位置信息<br style="margin:0px;padding:0px;"/>
  prepare: function() {<br style="margin:0px;padding:0px;"/>
    this.deltaX =  window.pageXOffset<br style="margin:0px;padding:0px;"/>
                || document.documentElement.scrollLeft<br style="margin:0px;padding:0px;"/>
                || document.body.scrollLeft<br style="margin:0px;padding:0px;"/>
                || 0;<br style="margin:0px;padding:0px;"/>
    this.deltaY =  window.pageYOffset<br style="margin:0px;padding:0px;"/>
                || document.documentElement.scrollTop<br style="margin:0px;padding:0px;"/>
                || document.body.scrollTop<br style="margin:0px;padding:0px;"/>
                || 0;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//计算节点的绝对滚动位置返回包含两个元素的数组到文档左侧 顶部的距离<br style="margin:0px;padding:0px;"/>
  realOffset: function(element) {<br style="margin:0px;padding:0px;"/>
    var valueT = 0, valueL = 0;<br style="margin:0px;padding:0px;"/>
    do {<br style="margin:0px;padding:0px;"/>
      valueT += element.scrollTop  || 0;<br style="margin:0px;padding:0px;"/>
      valueL += element.scrollLeft || 0;<br style="margin:0px;padding:0px;"/>
      element = element.parentNode;<br style="margin:0px;padding:0px;"/>
    } while (element);<br style="margin:0px;padding:0px;"/>
    return [valueL, valueT];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//计算结点相对于文档的绝对滚动位置，返回包含两个元素的数组到文档左侧 顶部的距离<br style="margin:0px;padding:0px;"/>
  cumulativeOffset: function(element) {<br style="margin:0px;padding:0px;"/>
    var valueT = 0, valueL = 0;<br style="margin:0px;padding:0px;"/>
    do {<br style="margin:0px;padding:0px;"/>
      valueT += element.offsetTop  || 0;<br style="margin:0px;padding:0px;"/>
      valueL += element.offsetLeft || 0;<br style="margin:0px;padding:0px;"/>
      element = element.offsetParent;<br style="margin:0px;padding:0px;"/>
    } while (element);<br style="margin:0px;padding:0px;"/>
    return [valueL, valueT];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//相对位置<br style="margin:0px;padding:0px;"/>
  positionedOffset: function(element) {<br style="margin:0px;padding:0px;"/>
    var valueT = 0, valueL = 0;<br style="margin:0px;padding:0px;"/>
    do {<br style="margin:0px;padding:0px;"/>
      valueT += element.offsetTop  || 0;<br style="margin:0px;padding:0px;"/>
      valueL += element.offsetLeft || 0;<br style="margin:0px;padding:0px;"/>
      element = element.offsetParent;<br style="margin:0px;padding:0px;"/>
      if (element) {<br style="margin:0px;padding:0px;"/>
        p = Element.getStyle(element, 'position');<br style="margin:0px;padding:0px;"/>
        if (p == 'relative' || p == 'absolute') break;<br style="margin:0px;padding:0px;"/>
      }<br style="margin:0px;padding:0px;"/>
    } while (element);<br style="margin:0px;padding:0px;"/>
    return [valueL, valueT];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  offsetParent: function(element) {<br style="margin:0px;padding:0px;"/>
    if (element.offsetParent) return element.offsetParent;<br style="margin:0px;padding:0px;"/>
    if (element == document.body) return element;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    while ((element = element.parentNode) &amp;&amp; element != document.body)<br style="margin:0px;padding:0px;"/>
      if (Element.getStyle(element, 'position') != 'static')<br style="margin:0px;padding:0px;"/>
        return element;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    return document.body;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  // caches x/y coordinate pair to use with overlap是否在element内<br style="margin:0px;padding:0px;"/>
  within: function(element, x, y) {<br style="margin:0px;padding:0px;"/>
    if (this.includeScrollOffsets)<br style="margin:0px;padding:0px;"/>
      return this.withinIncludingScrolloffsets(element, x, y);<br style="margin:0px;padding:0px;"/>
    this.xcomp = x;<br style="margin:0px;padding:0px;"/>
    this.ycomp = y;<br style="margin:0px;padding:0px;"/>
    this.offset = this.cumulativeOffset(element);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    return (y &gt;= this.offset[1] &amp;&amp;<br style="margin:0px;padding:0px;"/>
            y &lt;  this.offset[1] + element.offsetHeight &amp;&amp;<br style="margin:0px;padding:0px;"/>
            x &gt;= this.offset[0] &amp;&amp;<br style="margin:0px;padding:0px;"/>
            x &lt;  this.offset[0] + element.offsetWidth);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  withinIncludingScrolloffsets: function(element, x, y) {<br style="margin:0px;padding:0px;"/>
    var offsetcache = this.realOffset(element);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    this.xcomp = x + offsetcache[0] - this.deltaX;<br style="margin:0px;padding:0px;"/>
    this.ycomp = y + offsetcache[1] - this.deltaY;<br style="margin:0px;padding:0px;"/>
    this.offset = this.cumulativeOffset(element);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    return (this.ycomp &gt;= this.offset[1] &amp;&amp;<br style="margin:0px;padding:0px;"/>
            this.ycomp &lt;  this.offset[1] + element.offsetHeight &amp;&amp;<br style="margin:0px;padding:0px;"/>
            this.xcomp &gt;= this.offset[0] &amp;&amp;<br style="margin:0px;padding:0px;"/>
            this.xcomp &lt;  this.offset[0] + element.offsetWidth);<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  // within must be called directly before<br style="margin:0px;padding:0px;"/>
  overlap: function(mode, element) {<br style="margin:0px;padding:0px;"/>
    if (!mode) return 0;<br style="margin:0px;padding:0px;"/>
    if (mode == 'vertical')<br style="margin:0px;padding:0px;"/>
      return ((this.offset[1] + element.offsetHeight) - this.ycomp) /<br style="margin:0px;padding:0px;"/>
        element.offsetHeight;<br style="margin:0px;padding:0px;"/>
    if (mode == 'horizontal')<br style="margin:0px;padding:0px;"/>
      return ((this.offset[0] + element.offsetWidth) - this.xcomp) /<br style="margin:0px;padding:0px;"/>
        element.offsetWidth;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//克隆结点 常用于拖放<br style="margin:0px;padding:0px;"/>
  clone: function(source, target) {<br style="margin:0px;padding:0px;"/>
    source = $(source);<br style="margin:0px;padding:0px;"/>
    target = $(target);<br style="margin:0px;padding:0px;"/>
    target.style.position = 'absolute';<br style="margin:0px;padding:0px;"/>
    var offsets = this.cumulativeOffset(source);<br style="margin:0px;padding:0px;"/>
    target.style.top    = offsets[1] + 'px';<br style="margin:0px;padding:0px;"/>
    target.style.left   = offsets[0] + 'px';<br style="margin:0px;padding:0px;"/>
    target.style.width  = source.offsetWidth + 'px';<br style="margin:0px;padding:0px;"/>
    target.style.height = source.offsetHeight + 'px';<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  page: function(forElement) {<br style="margin:0px;padding:0px;"/>
    var valueT = 0, valueL = 0;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    var element = forElement;<br style="margin:0px;padding:0px;"/>
    do {<br style="margin:0px;padding:0px;"/>
      valueT += element.offsetTop  || 0;<br style="margin:0px;padding:0px;"/>
      valueL += element.offsetLeft || 0;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      // Safari fix<br style="margin:0px;padding:0px;"/>
      if (element.offsetParent==document.body)<br style="margin:0px;padding:0px;"/>
        if (Element.getStyle(element,'position')=='absolute') break;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    } while (element = element.offsetParent);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    element = forElement;<br style="margin:0px;padding:0px;"/>
    do {<br style="margin:0px;padding:0px;"/>
      valueT -= element.scrollTop  || 0;<br style="margin:0px;padding:0px;"/>
      valueL -= element.scrollLeft || 0;<br style="margin:0px;padding:0px;"/>
    } while (element = element.parentNode);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    return [valueL, valueT];<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
  clone: function(source, target) {<br style="margin:0px;padding:0px;"/>
    var options = Object.extend({<br style="margin:0px;padding:0px;"/>
      setLeft:    true,<br style="margin:0px;padding:0px;"/>
      setTop:     true,<br style="margin:0px;padding:0px;"/>
      setWidth:   true,<br style="margin:0px;padding:0px;"/>
      setHeight:  true,<br style="margin:0px;padding:0px;"/>
      offsetTop:  0,<br style="margin:0px;padding:0px;"/>
      offsetLeft: 0<br style="margin:0px;padding:0px;"/>
    }, arguments[2] || {})<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    // find page position of source<br style="margin:0px;padding:0px;"/>
    source = $(source);<br style="margin:0px;padding:0px;"/>
    var p = Position.page(source);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    // find coordinate system to use<br style="margin:0px;padding:0px;"/>
    target = $(target);<br style="margin:0px;padding:0px;"/>
    var delta = [0, 0];<br style="margin:0px;padding:0px;"/>
    var parent = null;<br style="margin:0px;padding:0px;"/>
    // delta [0,0] will do fine with position: fixed elements,<br style="margin:0px;padding:0px;"/>
    // position:absolute needs offsetParent deltas<br style="margin:0px;padding:0px;"/>
    if (Element.getStyle(target,'position') == 'absolute') {<br style="margin:0px;padding:0px;"/>
      parent = Position.offsetParent(target);<br style="margin:0px;padding:0px;"/>
      delta = Position.page(parent);<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    // correct by body offsets (fixes Safari)<br style="margin:0px;padding:0px;"/>
    if (parent == document.body) {<br style="margin:0px;padding:0px;"/>
      delta[0] -= document.body.offsetLeft;<br style="margin:0px;padding:0px;"/>
      delta[1] -= document.body.offsetTop;<br style="margin:0px;padding:0px;"/>
    }<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    // set position<br style="margin:0px;padding:0px;"/>
    if(options.setLeft)   target.style.left  = (p[0] - delta[0] + options.offsetLeft) + 'px';<br style="margin:0px;padding:0px;"/>
    if(options.setTop)    target.style.top   = (p[1] - delta[1] + options.offsetTop) + 'px';<br style="margin:0px;padding:0px;"/>
    if(options.setWidth)  target.style.width = source.offsetWidth + 'px';<br style="margin:0px;padding:0px;"/>
    if(options.setHeight) target.style.height = source.offsetHeight + 'px';<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//绝对定位<br style="margin:0px;padding:0px;"/>
  absolutize: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    if (element.style.position == 'absolute') return;<br style="margin:0px;padding:0px;"/>
    Position.prepare();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    var offsets = Position.positionedOffset(element);<br style="margin:0px;padding:0px;"/>
    var top     = offsets[1];<br style="margin:0px;padding:0px;"/>
    var left    = offsets[0];<br style="margin:0px;padding:0px;"/>
    var width   = element.clientWidth;<br style="margin:0px;padding:0px;"/>
    var height  = element.clientHeight;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    element._originalLeft   = left - parseFloat(element.style.left  || 0);<br style="margin:0px;padding:0px;"/>
    element._originalTop    = top  - parseFloat(element.style.top || 0);<br style="margin:0px;padding:0px;"/>
    element._originalWidth  = element.style.width;<br style="margin:0px;padding:0px;"/>
    element._originalHeight = element.style.height;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    element.style.position = 'absolute';<br style="margin:0px;padding:0px;"/>
    element.style.top    = top + 'px';;<br style="margin:0px;padding:0px;"/>
    element.style.left   = left + 'px';;<br style="margin:0px;padding:0px;"/>
    element.style.width  = width + 'px';;<br style="margin:0px;padding:0px;"/>
    element.style.height = height + 'px';;<br style="margin:0px;padding:0px;"/>
  },<br style="margin:0px;padding:0px;"/>
//相对定位<br style="margin:0px;padding:0px;"/>
  relativize: function(element) {<br style="margin:0px;padding:0px;"/>
    element = $(element);<br style="margin:0px;padding:0px;"/>
    if (element.style.position == 'relative') return;<br style="margin:0px;padding:0px;"/>
    Position.prepare();<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    element.style.position = 'relative';<br style="margin:0px;padding:0px;"/>
    var top  = parseFloat(element.style.top  || 0) - (element._originalTop || 0);<br style="margin:0px;padding:0px;"/>
    var left = parseFloat(element.style.left || 0) - (element._originalLeft || 0);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    element.style.top    = top + 'px';<br style="margin:0px;padding:0px;"/>
    element.style.left   = left + 'px';<br style="margin:0px;padding:0px;"/>
    element.style.height = element._originalHeight;<br style="margin:0px;padding:0px;"/>
    element.style.width  = element._originalWidth;<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
// Safari returns margins on body which is incorrect if the child is absolutely<br style="margin:0px;padding:0px;"/>
// positioned.  For performance reasons, redefine Position.cumulativeOffset for<br style="margin:0px;padding:0px;"/>
// KHTML/WebKit only.<br style="margin:0px;padding:0px;"/>
if (/Konqueror|Safari|KHTML/.test(navigator.userAgent)) {<br style="margin:0px;padding:0px;"/>
  Position.cumulativeOffset = function(element) {<br style="margin:0px;padding:0px;"/>
    var valueT = 0, valueL = 0;<br style="margin:0px;padding:0px;"/>
    do {<br style="margin:0px;padding:0px;"/>
      valueT += element.offsetTop  || 0;<br style="margin:0px;padding:0px;"/>
      valueL += element.offsetLeft || 0;<br style="margin:0px;padding:0px;"/>
      if (element.offsetParent == document.body)<br style="margin:0px;padding:0px;"/>
        if (Element.getStyle(element, 'position') == 'absolute') break;<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
      element = element.offsetParent;<br style="margin:0px;padding:0px;"/>
    } while (element);<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
    return [valueL, valueT];<br style="margin:0px;padding:0px;"/>
  }<br style="margin:0px;padding:0px;"/>
}<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
//---------&gt;完成<br style="margin:0px;padding:0px;"/>
</span><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:'Courier New';font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);background-color:rgb(245, 245, 245);border:none;" title="复制代码"><img src="Prototype之详细解说[转] - Sam Lin - 博客园_files/copycode [1].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;border:none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div></div>
</div><div style="margin:0px;padding:0px;display:block;">转载请注明出处［<a href="http://samlin.cnblogs.com/" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);">http://samlin.cnblogs.com/</a>］ <br style="margin:0px;padding:0px;"/>

<div style="margin:0px;padding:0px;">
<span style="margin:0px;padding:0px;">分享到：</span>
<a style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);"></a>
<a style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);"></a>
<a style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);"></a>
<a style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);"></a>
<a style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);"></a>
</div>

<br style="margin:0px;padding:0px;"/>
<div style="margin:0px auto;padding:0px;"><a href="http://union.dangdang.com/transfer/transfer.aspx?from=P-262177&amp;backurl=http://book.dangdang.com/01.54.htm" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);">当当计算书籍 5-8折</a> </div>
<br style="margin:0px;padding:0px;"/>

</div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;margin-top:20px;">
<div style="margin:0px;padding:0px;margin-bottom:10px;">分类: <a href="http://www.cnblogs.com/samlin/category/126563.html" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);">JS Collecion</a></div>
<div style="margin:0px;padding:0px;margin-top:0px;"></div>
<div style="margin:0px;padding:0px;"><div style="margin:0px;padding:10px 0px;margin-bottom:10px;margin-top:10px;border:1px dashed silver;font-size:12px;width:350px;text-align:center;">
<a href="#" style="border-top-left-radius:10px;margin:0px;border-top-right-radius:10px;text-decoration:none;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D);display:inline-block;font-weight:bold;cursor:pointer;margin-right:10px;padding:3px 8px;background-repeat:repeat no-repeat;border-bottom-right-radius:10px;border-bottom-left-radius:10px;-webkit-box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;background-color:rgb(45, 174, 191);color:rgb(255, 255, 255);border:none;">好文要顶</a>
<a href="#" style="border-top-left-radius:10px;margin:0px;border-top-right-radius:10px;text-decoration:none;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D);display:inline-block;font-weight:bold;cursor:pointer;margin-right:10px;padding:3px 8px;background-repeat:repeat no-repeat;border-bottom-right-radius:10px;border-bottom-left-radius:10px;-webkit-box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;background-color:rgb(227, 49, 0);color:rgb(255, 255, 255);border:none;">关注我</a>
<a href="#" style="border-top-left-radius:10px;margin:0px;border-top-right-radius:10px;text-decoration:none;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D);display:inline-block;font-weight:bold;cursor:pointer;margin-right:10px;padding:3px 8px;background-repeat:repeat no-repeat;border-bottom-right-radius:10px;border-bottom-left-radius:10px;-webkit-box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;background-color:rgb(255, 181, 21);color:rgb(255, 255, 255);border:none;">收藏该文</a>
<a href="#" style="border-top-left-radius:10px;margin:0px;border-top-right-radius:10px;text-decoration:none;background-repeat:repeat no-repeat;display:inline-block;font-weight:bold;cursor:pointer;margin-right:10px;vertical-align:middle;border-bottom-left-radius:10px;border-bottom-right-radius:10px;-webkit-box-shadow:none;text-shadow:none;padding:3px 2px;background-image:none;color:rgb(255, 255, 255);border:none;" title="分享至新浪微博"><img src="Prototype之详细解说[转] - Sam Lin - 博客园_files/icon_weibo_24.png" type="image/png" data-filename="icon_weibo_24.png" height="24" style="margin:0px;padding:0px;border:none;vertical-align:middle;margin-left:5px;box-shadow:none;" width="24"/></a>
<a href="#" style="border-top-left-radius:10px;margin:0px;border-top-right-radius:10px;text-decoration:none;background-repeat:repeat no-repeat;display:inline-block;font-weight:bold;cursor:pointer;margin-right:10px;vertical-align:middle;border-bottom-left-radius:10px;border-bottom-right-radius:10px;-webkit-box-shadow:none;text-shadow:none;padding:3px 2px;background-image:none;color:rgb(255, 255, 255);border:none;" title="分享至微信"><img src="Prototype之详细解说[转] - Sam Lin - 博客园_files/wechat.png" type="image/png" data-filename="wechat.png" height="24" style="margin:0px;padding:0px;border:medium none;width:24px;height:24px;box-shadow:none;margin-left:5px;vertical-align:middle;" width="24"/></a>
</div>
<div style="margin:0px;padding:0px;float:left;width:280px;margin-top:0px;margin-bottom:10px;color:rgb(0, 0, 0);margin-left:0px;font-size:12px;">
<div style="margin:0px;padding:0px;float:left;line-height:18px;">
<a href="http://home.cnblogs.com/u/samlin/" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);" target="_blank"><img src="Prototype之详细解说[转] - Sam Lin - 博客园_files/u28051.jpg" type="image/jpeg" data-filename="u28051.jpg" height="48" style="margin:0px;padding:0px;border:0px;vertical-align:top;float:left;margin-right:5px;padding-top:5px;padding-left:2px;" width="48"/></a>
<div style="margin:0px;padding:0px;float:left;line-height:18px;">
<a href="http://home.cnblogs.com/u/samlin/" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);">Sam Lin</a><br style="margin:0px;padding:0px;"/>
<a href="http://home.cnblogs.com/u/samlin/followees" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);">关注 - 0</a><br style="margin:0px;padding:0px;"/>
<a href="http://home.cnblogs.com/u/samlin/followers" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);">粉丝 - 28</a>
</div>
</div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;"></div>
<div style="margin:0px;padding:0px;">
    <a href="#" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);">+加关注</a>
</div>
</div>
<div style="margin:0px;padding:0px;float:right;margin-bottom:10px;margin-right:30px;font-size:12px;width:125px;text-align:center;margin-top:10px;">										
    <div style="background-image:url(http://static.cnblogs.com/images/upup.gif);margin:0px;padding:0px;width:46px;height:52px;float:left;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;background-repeat:no-repeat no-repeat;">
        <span style="margin:0px;padding:0px;font-size:14px;font-family:Verdana;color:rgb(1, 95, 182);line-height:1.5em;">0</span>
    </div>
	<div style="background-image:url(http://static.cnblogs.com/images/downdown.gif);margin:0px;padding:0px;margin-left:20px;width:46px;height:52px;float:right;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;background-repeat:no-repeat no-repeat;"> 
		<span style="margin:0px;padding:0px;font-size:14px;font-family:Verdana;color:rgb(1, 95, 182);line-height:1.5em;">0</span>
	</div>
	<div style="margin:0px;padding:0px;clear:both;"></div>	
	<div style="margin:0px;padding:0px;margin-top:5px;margin-left:0px;font-size:12px;color:gray;">
    (请您对文章做出评价)
    </div>	
</div>
</div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;line-height:1.8;font-size:12px;"><a href="http://www.cnblogs.com/samlin/archive/2008/07/06/1236958.html" style="margin:0px;padding:0px;color:rgb(0, 102, 204);text-decoration:none;">« </a> 上一篇：<a href="http://www.cnblogs.com/samlin/archive/2008/07/06/1236958.html" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);" title="发布于2008-07-06 18:58">JavaScript之HashTable[转]</a><br style="margin:0px;padding:0px;"/><a href="http://www.cnblogs.com/samlin/archive/2008/07/22/1248913.html" style="margin:0px;padding:0px;color:rgb(0, 102, 204);text-decoration:none;">» </a> 下一篇：<a href="http://www.cnblogs.com/samlin/archive/2008/07/22/1248913.html" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(0, 102, 204);" title="发布于2008-07-22 17:45">素材网</a><br style="margin:0px;padding:0px;"/></div>
</div>


		</div>
		<div style="margin:0px;padding:0px;border-bottom-width:0px;border-bottom-style:dotted;border-bottom-color:rgb(153, 153, 153);color:rgb(102, 102, 102);text-align:right;padding-bottom:5px;vertical-align:middle;">posted @ <span style="margin:0px;padding:0px;">2008-07-06 19:12</span> <a href="http://www.cnblogs.com/samlin/" style="margin:0px;padding:0px;text-decoration:none;color:rgb(102, 102, 102);">Sam Lin</a> 阅读(<span style="margin:0px;padding:0px;">1469</span>) 评论(<span style="margin:0px;padding:0px;">0</span>)  <a href="http://i.cnblogs.com/EditPosts.aspx?postid=1236962" rel="nofollow" style="margin:0px;padding:0px;text-decoration:none;color:rgb(102, 102, 102);">编辑</a> <a href="http://www.cnblogs.com/samlin/archive/2008/07/06/1236962.html#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(102, 102, 102);">收藏</a></div>
	</div></div></div></div></div></div></div></div></div></div><br/></span>
</div></body></html> 