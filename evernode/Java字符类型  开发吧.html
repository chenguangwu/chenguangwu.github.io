<html>
<head>
  <title>Java字符类型 | 开发吧</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="7646"/>
<h1>Java字符类型 | 开发吧</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2016/1/20 10:55</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://www.devba.com/index.php/archives/4777.html"><i>http://www.devba.com/index.php/archives/4777.html</i></a></td></tr>
</table>
</div>
<br/>

<div><span><br/><div style="font-size: 16px"><div><div style="color:rgb(51, 51, 51);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13px;line-height:normal;font-family:微软雅黑, 宋体, PMingLiU, Verdana, Arial, Helvetica, sans-serif;overflow-x:hidden;background:url(http://www.devba.com/wp-content/themes/Wesky_NewYear/images/newyear.png) 50% 0% no-repeat rgb(255, 255, 255);"><div><div><div><div><div style="box-shadow:rgb(170, 170, 170) 0px 1px 3px;border-radius:0px;background:white;">
<h2 style="border-bottom-style:solid;border:0px;padding:0px;margin:0px;font-size:18px;border-bottom-width:2px;border-bottom-color:rgb(240, 34, 0);height:30px;margin-left:15px;margin-right:15px;text-align:center;">Java字符类型</h2>
<div style="border:0px;margin:0px;padding:0px;font-size:12px;padding-left:10px;line-height:22px;color:rgb(119, 119, 119);text-align:center;">作者：孤风一剑   发布：2014-02-10 10:42   栏目：<a href="http://www.devba.com/index.php/archives/category/javakf" rel="category tag" style="border:0px;margin:0px;padding:0px;color:rgb(51, 51, 51);text-decoration:none;" title="查看Java开发中的全部文章">Java开发</a>   点击：967次   <a href="http://www.devba.com/index.php/archives/4777.html#respond" style="border:0px;margin:0px;padding:0px;color:rgb(51, 51, 51);text-decoration:none;" title="《Java字符类型》上的评论">抢沙发</a>   </div><div style="border:0px;margin:0px;padding:0px;clear:both;height:0px;line-height:0;font-size:0px;visibility:hidden;overflow:hidden;"></div>
        <div style="border:0px;margin:0px;padding:0px 10px;overflow:hidden;">
        <p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">在Java基本类型对应的包装类型中，最为复杂的就是字符类型和字符串类型了。本篇在讲解字符类型之前，必须要讲解一下Unicode编码方面的知识，否则不好理解源代码。</p>
<h1 style="border:0px;padding:0px;margin:0px;color:rgb(34, 34, 34);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(204, 204, 204);font-size:20px;line-height:30px;"><strong style="border:0px;margin:0px;padding:0px;">1、Unicode编码基本概念</strong></h1>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">（1）编码字符集</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">编码字符集是一个字符集，它为每一个字符分配一个唯一数字。Unicode 标准的核心是一个编码字符集，字母“A”的编码为0041和字符“€”的编码为20AC。Unicode标准始终使用十六进制数字，而且在书写时在前面加上前缀“U+”，所以“A”的编码书写为“U+0041”。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">（2）代码点code point和代码单元</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">代码点是指可用于编码字符集的数字。编码字符集定义一个有效的代码点范围，但是并不一定将字符分配给所有这些代码点。有效的 Unicode代码点范围是 U+0000 至 U+10FFFF</p>
<pre style="border:0px;margin:0px;padding:0px;">   代码单元可以理解为字符编码的一个基本单元，最常用的代码单元是字节（即8位），但是16位和32位整数也可以用于内部处理。</pre>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">（3）增补字符</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">16 位编码的所有 65，536 个字符并不能完全表示全世界所有正在使用或曾经使用的字符。于是，Unicode 标准已扩展到包含多达 1，112，064 个字符。那些超出原来的16 位限制的字符被称作<strong style="border:0px;margin:0px;padding:0px;">增补字符</strong>。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">Java的char类型是固定16bits的。代码点在U+0000 — U+FFFF之内到是可以用一个char完整的表示出一个字符。但代码点在U+FFFF之外的，一个char无论如何无法表示一个完整字符。这样用char类型来获取字符串中的那些代码点在U+FFFF之外的字符就会出现问题。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">因此，Java 平台不仅需要支持增补字符，而且必须使应用程序能够方便地做到这一点。Java Community Process 召集了一个专家组，以期找到一个适当的解决方案。该小组被称为JSR-204专家组，使用Unicode 增补字符支持的Java技术规范请求的编号。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">增补字符是代码点在 U+10000 至 U+10FFFF 范围之间的字符，也就是那些使用原始的 Unicode 的 16 位设计无法表示的字符。从 U+0000 至 U+FFFF 之间的字符集有时候被称为基本多语言面 （BMP UBasic Multilingual Plane ）。因此，每一个 Unicode 字符要么属于 BMP，要么属于增补字符<strong style="border:0px;margin:0px;padding:0px;">。</strong></p>
<h1 style="border:0px;padding:0px;margin:0px;color:rgb(34, 34, 34);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(204, 204, 204);font-size:20px;line-height:30px;"><strong style="border:0px;margin:0px;padding:0px;">2、基于Unicode的具体编码格式</strong></h1>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"><strong style="border:0px;margin:0px;padding:0px;">UTF-32 </strong>即将每一个 Unicode 代码点表示为相同值的32位整数。很明显，它是内部处理最方便的表达方式，但是，如果作为一般字符串表达方式，则要消耗更多的内存。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"><strong style="border:0px;margin:0px;padding:0px;">UTF-16</strong> 使用一个或两个未分配的16位代码单元的序列对 Unicode 代码点进行编码。假设U是一个代码点，也就是Unicode编码表中一个字符所对应的Unicode值。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">(1) 如果在BMP级别中，那么16bits(一个代码单元)就足够表示出字符的Unicode值。<br style="border:0px;margin:0px;padding:0px;"/>
(2) 如果U+10FFFF&gt;U&gt;=U+10000，也就是处于增补字符级别中。UTF-16用2个16位来表示出了，并且正好将每个16位都控制在替代区域U+D800-U+DFFF（其中\uD800-\uDBFF为高代理项 范围，\uDC00-  \uDFFF为低代理项 范围） 中。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">下面来看一下Java是如何处理这些增补字符的。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">分别初始化2个16位无符号的整数 —— W1和W2。其中W1=110110yyyyyyyyyy（0xD800-0xDBFF）,W2 = 110111xxxxxxxxxx(0xDC00-OxDFFF)。然后，将Unicode的高10位分配给W1的低10位，将Unicode 的低10位分配给W2的低10位。这样就可以将20bits的代码点U拆成两个16bits的代码单元。而且这两个代码点正好落在替代区域U+D800-U+DFFF中。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">举个例子：代码点U+1D56B（使用4个字节表示的代码点）</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">0x1D56B= 0001 1101 01-01 0110 1011</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">将0x1D56B的高10位0001 1101 01分配给W1的低10位组合成110110 0001 1101 01=0xD875<br style="border:0px;margin:0px;padding:0px;"/>
将0x1D56B的低10位01 0110 1011分配给W2的低10位组合成110111 01 0110 1011=0xDD6B<br style="border:0px;margin:0px;padding:0px;"/>
这样代码点U+1D56B采用UTF-16编码方式，用2个连续的代码单元U+D875和U+DD68表示出了。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">在Charachter类中定义相关的变量如下：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico.png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">public static final char MIN_HIGH_SURROGATE = '\uD800';</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">   public static final char MAX_HIGH_SURROGATE = '\uDBFF';</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">   public static final char MIN_LOW_SURROGATE  = '\uDC00';</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">   public static final char MAX_LOW_SURROGATE  = '\uDFFF';</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">   public static final char MIN_SURROGATE = MIN_HIGH_SURROGATE; // min_surrogate  '\uD800'</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">   public static final char MAX_SURROGATE = MAX_LOW_SURROGATE; // max_surrogate   '\uDFFF'</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">   public static final int MIN_SUPPLEMENTARY_CODE_POINT = 0x010000;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">   public static final int MIN_CODE_POINT = 0x000000;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">   public static final int MAX_CODE_POINT = 0X10FFFF;</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">利用如上定义的一些常量，就可以对传入的代码点或字符进行判断了，如下：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico [1].png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">// 最大的数为：10FFFF，也就是说以10开头的一定为Unicode编码</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">public static boolean isValidCodePoint(int codePoint) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // Optimized form of:</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    //     codePoint &gt;= MIN_CODE_POINT &amp;&amp; codePoint &lt;= MAX_CODE_POINT</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    int plane = codePoint &gt;&gt;&gt; 16;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    return plane &lt; ((MAX_CODE_POINT + 1) &gt;&gt;&gt; 16);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">}</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">public static boolean isBmpCodePoint(int codePoint) { // 是否为BMP代码点</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    return codePoint &gt;&gt;&gt; 16 == 0;//</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // Optimized form of:</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    //     codePoint &gt;= MIN_VALUE &amp;&amp; codePoint &lt;= MAX_VALUE</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // We consistently use logical shift (&gt;&gt;&gt;) to facilitate(促进）</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // additional runtime optimizations.</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">}</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">public static boolean isSupplementaryCodePoint(int codePoint) { // 是否为增补字符代码点</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    return codePoint &gt;= MIN_SUPPLEMENTARY_CODE_POINT &amp;&amp; codePoint &lt;  MAX_CODE_POINT + 1;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">}</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">public static boolean isHighSurrogate(char ch) {// 是否为高代理项</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // Help VM constant-fold; MAX_HIGH_SURROGATE + 1 == MIN_LOW_SURROGATE</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    return ch &gt;= MIN_HIGH_SURROGATE &amp;&amp; ch &lt; (MAX_HIGH_SURROGATE + 1);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">}</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">public static boolean isLowSurrogate(char ch) {// 是否为低代理项</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    return ch &gt;= MIN_LOW_SURROGATE &amp;&amp; ch &lt; (MAX_LOW_SURROGATE + 1);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">}</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">public static boolean isSurrogate(char ch) { // 是否为代理项</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    return ch &gt;= MIN_SURROGATE &amp;&amp; ch &lt; (MAX_SURROGATE + 1);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">}</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">如上只是介绍了一些基本的方法，这种类似的方法还很多，如</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico [2].png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">&lt;span style=&quot;font-family: 'Courier New';&quot;&gt;public static boolean isSurrogatePair(char high, char low) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return isHighSurrogate(high) &amp;&amp; isLowSurrogate(low);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // 计算一个字符需要用几个单元块来表示</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    public static int charCount(int codePoint) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return codePoint &gt;= MIN_SUPPLEMENTARY_CODE_POINT ? 2 : 1;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // 根据高和低代理项计算增补字符代码点</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    public static int toCodePoint(char high, char low) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        // Optimized form of:</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        // return ((high - MIN_HIGH_SURROGATE) &lt;&lt; 10)</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        //         + (low - MIN_LOW_SURROGATE)</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        //         + MIN_SUPPLEMENTARY_CODE_POINT;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return ((high &lt;&lt; 10) + low) + (MIN_SUPPLEMENTARY_CODE_POINT - (MIN_HIGH_SURROGATE &lt;&lt; 10) - MIN_LOW_SURROGATE);//???</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    public static int codePointAt(CharSequence seq, int index) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        char c1 = seq.charAt(index++);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        if (isHighSurrogate(c1)) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            if (index &lt; seq.length()) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                char c2 = seq.charAt(index);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                if (isLowSurrogate(c2)) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                    return toCodePoint(c1, c2);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return c1;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">&lt;/span&gt;</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">然后使用字符常量对一些字符和代码点进行了判断，如判断是否为合法的高位和低位增补字符、Unicode代码点需要几个单元块来存储、从字符序列中取出增补字符的代码点等。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"><strong style="border:0px;margin:0px;padding:0px;">UTF-8 </strong>使用一至四个字节的序列对编码 Unicode 代码点进行编码。U+0000 至 U+007F 使用一个字节编码，U+0080 至 U+07FF 使用两个字节，U+0800 至 U+FFFF 使用三个字节，而 U+10000 至 U+10FFFF 使用四个字节。UTF-8 设计原理为：字节值 0x00 至 0x7F 始终表示代码点 U+0000 至 U+007F（Basic Latin 字符子集，它对应 ASCII 字符集）。这些字节值永远不会表示其他代码点，这一特性使 UTF-8 可以很方便地在软件中将特殊的含义赋予某些 ASCII 字符。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">以下是Unicode和UTF-8之间的转换关系表：</p>
<table border="1" cellpadding="3" cellspacing="0" style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border:0px;margin:0px;padding:0px;" width="500">
<tbody style="border:0px;margin:0px;padding:0px;">
<tr style="border:0px;margin:0px;padding:0px;">
<td style="border:0px;margin:0px;padding:0px;width:240px;text-align:center;">U-00000000 - U-0000007F： 0xxxxxxx<br style="border:0px;margin:0px;padding:0px;"/>
U-00000080 - U-000007FF： 110xxxxx 10xxxxxx<br style="border:0px;margin:0px;padding:0px;"/>
U-00000800 - U-0000FFFF： 1110xxxx 10xxxxxx 10xxxxxx<br style="border:0px;margin:0px;padding:0px;"/>
U-00010000 - U-001FFFFF： 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx<br style="border:0px;margin:0px;padding:0px;"/>
U-00200000 - U-03FFFFFF： 111110xx 10xxxxxx 10xxxxxx 10xxxxx x 10xxxxxx<br style="border:0px;margin:0px;padding:0px;"/>
U-04000000 - U-7FFFFFFF： 1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx</td>
</tr>
</tbody>
</table>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">可以看到：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">（1）如果一个字节以10开头，一定不是首字节，需要向前查找。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">（2）在一个首字节中，如果以0开头，表示是一个ASCII字符，而开头的连续的1的个数也表示了这个字符的字节数。如1110xxxx表示这个字符由三个字节组成。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">下面来看一个使用各种编码对字符进行编码的例子，如下：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"><img src="Java字符类型  开发吧_files/Center.png" type="image/png" data-filename="Center.png" alt="" height="193" style="border:1px solid rgb(221, 221, 221);margin:0px auto;padding:4px;display:block;max-width:660px;background:rgb(238, 238, 238);" width="408"/></p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<h1 style="border:0px;padding:0px;margin:0px;color:rgb(34, 34, 34);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(204, 204, 204);font-size:20px;line-height:30px;"><strong style="border:0px;margin:0px;padding:0px;">3、源代码相关API</strong></h1>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">在使用源码相关的API时，需要注意（摘自Java 7 API说明文档）：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<ul style="border:0px;margin:0px;padding:0px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;">The methods that only accept a <code style="border:0px;margin:0px;padding:0px;">char</code> value cannot support supplementary characters. They treat <code style="border:0px;margin:0px;padding:0px;">char</code> values from the surrogate ranges as undefined characters. For example, <code style="border:0px;margin:0px;padding:0px;">Character.isLetter('\uD840')</code> returns <code style="border:0px;margin:0px;padding:0px;">false</code>, even though this specific value if followed by any low-surrogate value in a string would represent a letter.</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;">The methods that accept an <code style="border:0px;margin:0px;padding:0px;">int</code> value support all Unicode characters, including supplementary characters. For example, <code style="border:0px;margin:0px;padding:0px;">Character.isLetter(0x2F81A)</code> returns <code style="border:0px;margin:0px;padding:0px;">true</code> because the code point value represents a letter (a CJK ideograph).</li>
</ul>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">也就是说，在使用以char为参数的一类方法时，这类方法并不支持增补字符。参数为整数，也就是支持代码点值做为参数时是支持增补字符的。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<h1 style="border:0px;padding:0px;margin:0px;color:rgb(34, 34, 34);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(204, 204, 204);font-size:20px;line-height:30px;">4、字符的属性</h1>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">我们在编写Java代码的过程中，如果要定义一个Java合法的标识符或者需要将一个字符串转换为数值，那么Java是怎么来确定标识符合法或者字符串合法的呢？这就要涉及到字符属性的概念了。先来看CharacterData类的源代码，如下：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico [3].png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">abstract class CharacterData {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract int getProperties(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract int getType(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract boolean isWhitespace(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract boolean isMirrored(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract boolean isJavaIdentifierStart(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract boolean isJavaIdentifierPart(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract boolean isUnicodeIdentifierStart(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract boolean isUnicodeIdentifierPart(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract boolean isIdentifierIgnorable(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract int toLowerCase(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract int toUpperCase(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract int toTitleCase(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract int digit(int ch, int radix);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract int getNumericValue(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    abstract byte getDirectionality(int ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    //need to implement for JSR204</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    int toUpperCaseEx(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return toUpperCase(ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    char[] toUpperCaseCharArray(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return null;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    boolean isOtherLowercase(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return false;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    boolean isOtherUppercase(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return false;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    boolean isOtherAlphabetic(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return false;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    boolean isIdeographic(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return false;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // Character &lt;= 0xff (basic latin) is handled by internal fast-path</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // to avoid initializing large tables.</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // Note: performance of this &quot;fast-path&quot; code may be sub-optimal</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // in negative cases for some accessors due to complicated ranges.</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // Should revisit after optimization of table initialization.</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    static final CharacterData of(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        if (ch &gt;&gt;&gt; 8 == 0) {     // fast-path</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            return CharacterDataLatin1.instance; // 使用Latin编码所能表示的字符</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        } else {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            switch(ch &gt;&gt;&gt; 16) {  //plane 00-16</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            case(0):</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                return CharacterData00.instance;// 是由两个字节表示的字符，以下全部为增补字符</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            case(1):</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                return CharacterData01.instance;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            case(2):</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                return CharacterData02.instance;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            case(14):</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                return CharacterData0E.instance;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            case(15):   // Private Use</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            case(16):   // Private Use</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                return CharacterDataPrivateUse.instance;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            default:</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                return CharacterDataUndefined.instance;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">}</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">如上是一个抽象类，这个抽象类中定义了许多判断字符属性的抽象方法，这些方法的具体实现都在Character0X类中，这些类都继承了这个抽象类。其实Character类中有许多对应的方法，并不是Character类继承了这个抽象类，而是通过调用抽象类的具体实现类方法来实现字符属性的判断。我们并不关心这个字符由哪个具体类中的方法来判断，如果以后还增加了一些增补字符，那么只需要实现抽象类并且稍加修改of()方法即可。这就是使用<strong style="border:0px;margin:0px;padding:0px;">策略模式</strong>的好处。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">由于抽象类中定义的抽象方法都不是公开的，所以我们只好利用Character类中提供的方法进行字符属性的判断，如下：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico [4].png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.getDirectionality('('));//13</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.getDirectionality('{'));//13</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isMirrored('['));//true</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isMirrored(']'));//true</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isMirrored('c'));//false</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isMirrored('&amp;'));//false</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.getNumericValue('z'));//35</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.getNumericValue('中'));//-1</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.toUpperCase('A'));//A</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.digit('c', 16));//12 c在十六进制中代表12</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isJavaIdentifierStart('$'));//true 可以做为Java一个标识符的开头</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isJavaIdentifierStart('&amp;'));//false</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isJavaIdentifierStart('4'));//true 关键字不允许以数字开头</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isJavaIdentifierStart('解'));//true</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isJavaIdentifierPart(' '));//false 可以看到一个Java标识符的定义是不允许有空格的</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isJavaIdentifierPart('4'));//true 关键字不允许以数字开头</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">System.out.println(Character.isJavaIdentifierPart('解'));//true</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">那么Java是怎么判断这些字符的属性的呢？其实每一个Java字符都用一个32位，也就是4个字节来表示这个属性。具体的32位中的各个位所代表的涵义如下：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico [5].png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">1 bit   mirrored property</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">4 bits  directionality property</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">9 bits  signed offset used for converting case（有符号偏移，用于转换）</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">1 bit   if 1, adding the signed offset converts the character to lowercase</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">1 bit   if 1, subtracting（减去） the signed offset converts the character to uppercase</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">1 bit   if 1, this character has a titlecase equivalent (possibly itself)</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">3 bits  0  may not be part of an identifier</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        1  ignorable control; may continue a Unicode identifier or Java identifier</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        2  may continue a Java identifier but not a Unicode identifier (unused)</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        3  may continue a Unicode identifier or Java identifier</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        4  is a Java whitespace character</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        5  may start or continue a Java identifier;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           may continue but not start a Unicode identifier (underscores)</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        6  may start or continue a Java identifier but not a Unicode identifier ($)</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        7  may start or continue a Unicode identifier or Java identifier</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        Thus:（因此）</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           5, 6, 7 may start a Java identifier（Java标识符）</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           1, 2, 3, 5, 6, 7 may continue a Java identifier</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           7 may start a Unicode identifier</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           1, 3, 5, 7 may continue a Unicode identifier</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           1 is ignorable within an identifier</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           4 is Java whitespace</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">2 bits  0  this character has no numeric property</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        1  adding the digit offset to the character code and then</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           masking with 0x1F will produce the desired numeric value</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        2  this character has a &quot;strange&quot; numeric value</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        3  a Java supradecimal digit: adding the digit offset to the</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           character code, then masking with 0x1F, then adding 10</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">           will produce the desired numeric value</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">5 bits  digit offset</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">5 bits  character type</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">当我们传入一个'0'字符时，实际上通过</p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico [6].png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">static final CharacterData of(int ch)</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">方法判断后，最终会调用CharacterDataLatin1类中对应的方法去处理。Latin1中的所有字符都会在CharacterDataLatin1类中进行处理，而对于其他的字符，可能会在不同的CharacterDataXX.java类中进行处理，如可以用两个字节表示的字符用CharacterData01类处理，而一些增补字符会用其他的一些类进行处理。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">读者如果不是很理解的话，可以查看一下Unicode字符编码分布表，你就会明白CharacterData这个方法了。</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">具体来看一下ChatacterDataLation1的实现代码：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico [7].png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">static final int A[] = new int[256];// 2^8=256</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">  static final String A_DATA =</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    &quot;\u4800\u100F\u4800\u100F\u4800\u100F\u4800\u100F\u4800\u100F\u4800\u100F\u4800&quot;+</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    &quot;\u100F\u4800\u100F\u4800\u100F\u5800\u400F\u5000\u400F\u5800\u400F\u6000\u400F&quot;+</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    // 省略....</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    &quot;\u061D\u7002&quot;;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    static {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        { // THIS CODE WAS AUTOMATICALLY CREATED BY GenerateCharacter:</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            char[] data = A_DATA.toCharArray();</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            assert (data.length == (256 * 2));</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            int i = 0, j = 0;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            while (i &lt; (256 * 2)) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                int entry = data[i++] &lt;&lt; 16;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">                A[j++] = entry | data[i++];</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">            }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;"></li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">首先还需要说一下Latin1编码。Latin1是ISO-8859-1的别名，有些环境下写作Latin-1。<br style="border:0px;margin:0px;padding:0px;"/>
ISO-8859-1编码是单字节编码，向下兼容ASCII，其编码范围是0x00-0xFF，0x00-0x7F之间完全和ASCII一致，0x80-0x9F之间是控制字符，0xA0-0xFF之间是文字符号。<br style="border:0px;margin:0px;padding:0px;"/>
ISO-8859-1收录的字符除ASCII收录的字符外，还包括西欧语言、希腊语、泰语、阿拉伯语、希伯来语对应的文字符号。欧元符号出现的比较晚，没有被收录在ISO-8859-1当中。<br style="border:0px;margin:0px;padding:0px;"/>
因为ISO-8859-1编码范围使用了单字节内的所有空间，在支持ISO-8859-1的系统中传输和存储其他任何编码的字节流都不会被抛弃。换言之，把其他任何编码的字节流当作ISO-8859-1编码看待都没有问题。这是个很重要的特性，MySQL数据库默认编码是Latin1就是利用了这个特性。ASCII编码是一个7位的容器，ISO-8859-1编码是一个8位的容器。<br style="border:0px;margin:0px;padding:0px;"/>
回到我们的源代码中，可以看到最终A[]中存储了256个整数，就是使用有4个字节，32bits来存储的数，但是不能将这256个数当作一个整数来看待，没有任何的意义，需要读取32个比特位中特定的位的值，因为他代表着字符的属性。举个例子：ASCII表中的49代表'0'字符，获取这个字符对应的属性值为A[49]，转换后的二进制值如下：<br style="border:0px;margin:0px;padding:0px;"/>
0- 0011-000   000000-0-0   0-011-01-10   000-01001<br style="border:0px;margin:0px;padding:0px;"/>
1位：0表示没有mirrored property,如果是'('，'['，这些字符，这个位置的值为1<br style="border:0px;margin:0px;padding:0px;"/>
4位：3<br style="border:0px;margin:0px;padding:0px;"/>
9位：无偏移<br style="border:0px;margin:0px;padding:0px;"/>
1位：无小写<br style="border:0px;margin:0px;padding:0px;"/>
1位：无大写<br style="border:0px;margin:0px;padding:0px;"/>
1位：无首字母大写属性<br style="border:0px;margin:0px;padding:0px;"/>
3位：3 表示是一个合法的Unicode标识符或Java标识符<br style="border:0px;margin:0px;padding:0px;"/>
2位：1 有数字的属性<br style="border:0px;margin:0px;padding:0px;"/>
5位：数字移位为0<br style="border:0px;margin:0px;padding:0px;"/>
5位：字符类型代表的值为9</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">既然能够得到每个字符的代表属性的整数，接下来当然就是编写方法取出特定二进制位上的值了。如要查看一个字符的类型，而这个类型由二进制位的最后5位表示，取出后5位的方法如下：</p>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"> </p>
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;">
<div style="border:0px;margin:0px;padding:0px;"><b style="border:0px;margin:0px;padding:0px;">[java]</b> view plaincopyprint?<img src="Java字符类型  开发吧_files/CODE_ico [8].png" type="image/png" data-filename="CODE_ico.png" alt="在CODE上查看代码片" height="12" style="border:0px;margin:0px;padding:0px;" width="12"/><a href="Java字符类型  开发吧_files/ico_fork.svg"><img src="Java字符类型  开发吧_files/b019cf0502d870ff439cd9cd6ed41937.png" alt="ico_fork.svg"></a><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;"></p>
<div style="border:0px;margin:0px;padding:0px;"></div>
</div>
</div>
<ol start="1" style="border:0px;margin:0px;padding:0px;margin-left:20px;">
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">int getPropertiesEx(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        char offset = (char)ch;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        int props = B[offset];</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return props;</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    int getType(int ch) {</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        int props = getProperties(ch);</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">        return (props &amp; 0x1F);// 0001 1111取后5bits代表了character type</li>
<li style="border:0px;margin:0px;padding:0px;list-style:none;line-height:22px;">    }</li>
</ol>
</div>
<p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">当然还有许多的方法，有兴趣的读者可以自己去看一下。</p>
<hr style="border:0px;margin:0px;padding:0px;border-top:1px solid #666;"/><p style="border:0px;margin:0px;padding:5px 0px;line-height:22px;text-indent:2em;">本文固定链接: <a href="http://www.devba.com/index.php/archives/4777.html" rel="bookmark" style="border:0px;margin:0px;padding:0px;color:rgb(51, 51, 51);text-decoration:none;" title="Java字符类型">http://www.devba.com/index.php/archives/4777.html | 开发吧</a></p></div>
</div></div></div></div></div></div></div></div><br/></span>
</div></body></html> 