<html>
<head>
  <title>小团队的微服务之路</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="11843"/>
<h1>小团队的微服务之路</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2019/3/4 13:13</i></td></tr>
<tr><td><b>标签：</b></td><td><i>微信</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://mp.weixin.qq.com/s?__biz=MzI5ODQ2MzI3NQ==&mid=2247486428&idx=1&sn=6d02cf9703de12d55a3f63e411d7a702&chksm=eca43298dbd3bb8eb87fb9ec468e30796b2707dd9de57b61fdfa33e3b488c39ec458f04f4723&mpshare=1&scene=1&srcid=0304uuq4jigkXjTpMRp2UI8V#rd"><i>http://mp.weixin.qq.com/s?__biz=MzI5ODQ2MzI3NQ==&amp;mid=2247486428&amp;idx=1&amp;sn=6d02cf9703de12d55a3f63e411d7a702&amp;chksm=eca43298dbd3bb8eb87fb9ec468e30796b2707dd9de57b61fdfa33e3b488c39ec458f04f4723&amp;mpshare=1&amp;scene=1&amp;srcid=0304uuq4jigkXjTpMRp2UI8V#rd</i></a></td></tr>
</table>
</div>
<br/>

<div><span style="margin:0px;"><div style="padding:8px 0px;margin:8px auto;max-width:700px;"> <div style="padding:20px 16px 12px;margin:0;background-color:#fff"><div style="margin:0;padding:0"><div style="margin:0;padding:0"><h2 style="font-weight:400;margin:0;padding:0;font-size:22px;line-height:1.4;margin-bottom:14px"> 小团队的微服务之路 </h2><div style="margin:0;padding:0;margin-bottom:22px;line-height:20px;font-size:0;word-wrap:break-word;word-break:break-all"><span style="padding:0;display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0);color:rgba(0,0,0,0.3)"> Dean </span><span style="padding:0;display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative"><a style="margin:0;padding:0;color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)"> K8S中文社区 </a></span><em style="padding:0;font-style:normal;display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0);color:rgba(0,0,0,0.3)"></em></div><div style="margin:0;padding:0;overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="小团队的微服务之路_files/640.gif" type="image/gif" data-filename="640.gif" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;white-space:normal"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);margin-top:10px;box-sizing:border-box !important;overflow-wrap:break-word !important">微服务是否适合小团队是个见仁见智的问题。回归现象看本质，随着业务复杂度的提高，单体应用越来越庞大，就好像一个类的代码行越来越多，分而治之，切成多个类应该是更好的解决方法，所以一个庞大的单体应用分出多个小应用也更符合这种分治的思想。当然微服务架构不应该是一个小团队一开始就该考虑的问题，而是慢慢演化的结果，谨慎过度设计尤为重要。</p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">公司的背景是提供SaaS服务，对于大客户也会有定制开发以及私有化部署。经过2年不到的时间，技术架构经历了从单体到微服务再到容器化的过程。</div></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;letter-spacing:0.544px;white-space:normal;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;widows:1;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;padding:10px 0;color:rgb(62,62,62);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding:0.5em;display:inline-block;border-bottom:3px solid rgb(0,0,0);border-top-color:rgb(0,0,0);border-right-color:rgb(0,0,0);border-left-color:rgb(0,0,0);box-sizing:border-box !important;overflow-wrap:break-word !important"><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:18px;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(0,0,0);font-family:宋体;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(60,60,60);font-size:16px;font-weight:700;letter-spacing:1px;text-align:center;widows:1;background-color:rgb(255,255,255)">单体应用时代</span></span></span></strong></h3></div></div></div></div></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></p></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">早期开发只有两个人，考虑微服务之类的都是多余。不过由于受前公司影响，最初就决定了前后端分离的路线，因为不需要考虑SEO的问题，索性就做成了SPA单页应用。多说一句，前后端分离也不一定就不能服务端渲染，例如电商系统或者一些匿名即可访问的系统，加一层薄薄的View层，无论是PHP还是用Thymeleaf都是不错的选择。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">部署架构上，我们使用Nginx代理前端HTML资源，在接收请求时根据路径反向代理到server的8080端口实现业务。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640.jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-width:0;border-style:initial;border-color:initial;vertical-align:middle;top:0;left:0;right:0;bottom:0;box-sizing:border-box !important;overflow-wrap:break-word !important;width:677px !important;visibility:visible !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">接口定义</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">接口按照标准的Restful来定义：</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;list-style-type:square"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">版本，统一跟在 /api/后面，例如 /api/v2</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">以资源为中心，使用复数表述，例如/api/contacts，也可以嵌套，如/api/groups/1/contacts/100</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">url中尽量不使用动词，实践中发现做到这一点真的比较难，每个研发人员的思路不一致，起的名字也千奇百怪，都需要在代码Review中覆盖。</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">动作支持，POST / PUT / DELELE / GET ，这里有一个坑，PUT和PATCH都是更新，但是PUT是全量更新而PATCH是部分更新，前者如果传入的字段是空（未传也视为空）那么也会被更新到数据库中。目前我们虽然是使用PUT但是忽略空字段和未传字段，本质上是一种部分更新，这也带来了一些问题，比如确有置空的业务需要特殊处理。</span></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">接口通过swagger生成文档供前端同事使用。</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></p></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">持续集成（CI）</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">团队初始成员之前都有在大团队共事的经历，所以对于质量管控和流程管理都有一些共同的要求。因此在开发之初就引入了集成测试的体系，可以直接开发针对接口的测试用例，统一执行并计算覆盖率。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">一般来说代码自动执行的都是单元测试（Unit Test），我们之所以叫集成测试是因为测试用例是针对API的，并且包含了数据库的读写，MQ的操作等等，除了外部服务的依赖基本都是符合真实生产场景，相当于把Jmeter的事情直接在Java层面做掉了。这在开发初期为我们提供了非常大的便利性。但值得注意的是，由于数据库以及其他资源的引入，数据准备以及数据清理时要考虑的问题就会更多，例如如何控制并行任务之间的测试数据互不影响等等。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">为了让这一套流程可以自动化的运作起来， 引入Jenkins也是理所当然的事情了。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640.png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-width:0;border-style:initial;border-color:initial;vertical-align:middle;top:0;left:0;right:0;bottom:0;box-sizing:border-box !important;overflow-wrap:break-word !important;width:677px !important;visibility:visible !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">开发人员提交代码进入gerrit中，Jenkins被触发开始编译代码并执行集成测试，完成后生成测试报告，测试通过再由reviewer进行代码Review。在单体应用时代这样的CI架构已经足够好用，由于有集成测试的覆盖，在保持API兼容性的前提下进行代码重构都会变得更有信心。</div></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;letter-spacing:0.544px;white-space:normal;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;widows:1;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;padding:10px 0;color:rgb(62,62,62);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding:0.5em;display:inline-block;border-bottom:3px solid rgb(0,0,0);border-top-color:rgb(0,0,0);border-right-color:rgb(0,0,0);border-left-color:rgb(0,0,0);box-sizing:border-box !important;overflow-wrap:break-word !important"><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:18px;box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(0,0,0);font-family:宋体;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(60,60,60);font-size:16px;font-weight:700;letter-spacing:1px;text-align:center;widows:1;background-color:rgb(255,255,255)">微服务时代</span></span></strong></span></h3></div></div></div></div></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></p></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">服务拆分原则</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">从数据层面看，最简单的方式就是看数据库的表之间是否有比较少的关联。例如最容易分离的一般来说都是用户管理模块。如果从领域驱动设计（DDD）看，其实一个服务就是一个或几个相关联的领域模型，通过少量数据冗余划清服务边界。单个服务内通过领域服务完成多个领域对象协作。当然DDD比较复杂，要求领域对象设计上是充血模型而非贫血模型。从实践角度讲，充血模型对于大部分开发人员来说难度非常高，什么代码应该属于行为，什么属于领域服务，很多时候非常考验人员水平。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">服务拆分是一个大工程，往往需要几个对业务以及数据最熟悉的人一起讨论，甚至要考虑到团队结构，最终的效果是服务边界清晰， 没有环形依赖和避免双向依赖。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">框架选择</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">由于之前的单体服务使用的是Spring Boot，所以框架自然而的选择了Spring Cloud。其实个人认为微服务框架不应该限制技术与语言，但生产实践中发现无论Dubbo还是Spring Cloud都具有侵入性，我们在将Node.js应用融入Spring Cloud体系时就发现了许多问题。也许未来的Service Mesh才是更合理的发展道路。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640 [1].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-width:0;border-style:initial;border-color:initial;vertical-align:middle;top:0;left:0;right:0;bottom:0;box-sizing:border-box !important;overflow-wrap:break-word !important;width:677px !important;visibility:visible !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:12px;box-sizing:border-box !important;overflow-wrap:break-word !important">这是典型的Spring Cloud的使用方法，该图取自纯洁的微笑公众号。</span></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;list-style-type:square"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">Zuul作为Gateway，分发不同客户端的请求到具体Service</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">Erueka作为注册中心，完成了服务发现和服务注册</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">每个Service包括Gateway都自带了Hystrix提供的限流和熔断功能</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">Service之间通过Feign和Ribbon互相调用，Feign实际上是屏蔽了Service对Erueka的操作</span></p></li></ul></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">上文说的一旦要融入异构语言的Service，那么服务注册，服务发现，服务调用，熔断和限流都需要自己处理。再有关于Zuul要多说几句，Spring Cloud提供的Zuul对Netflix版本的做了裁剪，去掉了动态路由功能（Groovy实现），另外一点就是Zuul的性能一般，由于采用同步编程模型，对于IO密集型等后台处理时间长的链路非常容易将servlet的线程池占满，所以如果将Zuul与主要Service放置在同一台物理机上，在流量大的情况下，Zuul的资源消耗非常大。实际测试也发现经过Zuul与直接调用Service的性能损失在30%左右，并发压力大时更为明显。现在Spring Cloud Gateway是Pivotal主推的，支持异步编程模型，后续架构优化也许会采用，或是直接使用Kong这种基于Nginx的网关来提供性能。当然同步模型也有优点，编码更简单，后文将会提到使用ThreadLocal如何建立链路跟踪。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">架构改造</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">经过大半年的改造以及新需求的加入，单体服务被不断拆分，最终形成了10余个微服务，并且搭建了Spark用于BI。初步形成两大体系，微服务架构的在线业务系统（OLTP） + Spark大数据分析系统（OLAP）。数据源从只有MySQL增加到了ES和Hive。多数据源之间的数据同步也是值得一说的话题，但内容太多不在此文赘述。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640 [2].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-width:0;border-style:initial;border-color:initial;vertical-align:middle;top:0;left:0;right:0;bottom:0;box-sizing:border-box !important;overflow-wrap:break-word !important;width:677px !important;visibility:visible !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">服务拆分我们采用直接割接的方式，数据表也是整体迁移。因为几次大改造的升级申请了停服，所以步骤相对简单。如果需要不停服升级，那么应该采用先双写再逐步切换的方式保证业务不受影响。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">自动化部署</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">与CI比起来，持续交付（CD）实现更为复杂，在资源不足的情况我们尚未实现CD，只是实现执行了自动化部署。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">由于生产环境需要通过跳板机操作，所以我们通过Jenkins生成jar包传输到跳板机，之后再通过Ansible部署到集群。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640 [1].png" type="image/png" data-filename="640.png" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;top:0;left:0;right:0;bottom:0;box-sizing:border-box !important;overflow-wrap:break-word !important;width:677px !important;visibility:visible !important"/></p></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">简单粗暴的部署方式在小规模团队开发时还是够用的，只是需要在部署前保证测试（人工测试 + 自动化测试）到位。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">链路跟踪</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">开源的全链路跟踪很多，比如Spring Cloud Sleuth + Zipkin，国内有美团的CAT等等。其目的就是当一个请求经过多个服务时，可以通过一个固定值获取整条请求链路的行为日志，基于此可以再进行耗时分析等，衍生出一些性能诊断的功能。不过对于我们而言，首要目的就是trouble shooting，出了问题需要快速定位异常出现在什么服务，整个请求的链路是怎样的。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">为了让解决方案轻量，我们在日志中打印RequestId以及TraceId来标记链路。RequestId在Gateway生成表示唯一一次请求，TraceId相当于二级路径，一开始与RequestId一样，但进入线程池或者消息队列后，TraceId会增加标记来标识唯一条路径。举个例子，当一次请求会向MQ发送一个消息，那么这个消息可能会被多个消费者消费，此时每个消费线程都会自己生成一个TraceId来标记消费链路。加入TraceId的目的就是为了避免只用RequestId过滤出太多日志。实现如图所示：</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640 [3].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-width:0;border-style:initial;border-color:initial;vertical-align:middle;top:0;left:0;right:0;bottom:0;box-sizing:border-box !important;overflow-wrap:break-word !important;width:677px !important;visibility:visible !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">简单的说，通过ThreadLocal存放APIRequestContext串联单服务内的所有调用，当跨服务调用时，将APIRequestContext信息转化为Http Header，被调用方获取到Http Header后再次构建APIRequestContext放入ThreadLocal，重复循环保证RequestId和TraceId不丢失即可。如果进入MQ，那么APIRequestContext信息转化为Message Header即可（基于Rabbitmq实现）。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">当日志汇总到日志系统后，如果出现问题，只需要捕获发生异常的RequestId或是TraceId即可进行问题定位。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640 [4].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-width:0;border-style:initial;border-color:initial;vertical-align:middle;top:0;left:0;right:0;bottom:0;box-sizing:border-box !important;overflow-wrap:break-word !important;width:677px !important;visibility:visible !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">经过一年来的使用，基本可以满足绝大多数trouble shooting的场景，一般半小时内即可定位到具体业务。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">运维监控</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">在容器化之前，采用Telegraf + InfluxDB + Grafana的方案。Telegraf作为探针收集JVM，System，MySQL等资源的信息，写入InfluxDB，最终通过Grafana做数据可视化。Spring Boot Actuator可以配合Jolokia暴露JVM的Endpoint。整个方案零编码，只需要花时间配置。</div></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;letter-spacing:0.544px;white-space:normal;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;widows:1;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;padding:10px 0;color:rgb(62,62,62);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding:0.5em;display:inline-block;border-bottom:3px solid rgb(0,0,0);border-top-color:rgb(0,0,0);border-right-color:rgb(0,0,0);border-left-color:rgb(0,0,0);box-sizing:border-box !important;overflow-wrap:break-word !important"><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:18px;box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(0,0,0);font-family:宋体;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(60,60,60);font-size:16px;font-weight:700;letter-spacing:1px;text-align:center;widows:1;background-color:rgb(255,255,255)">容器化时代</span></span></strong></span></h3></div></div></div></div></div><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></p></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">架构改造</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">因为在做微服务之初就计划了容器化，所以架构并未大动，只是每个服务都会建立一个Dockerfile用于创建docker image。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640 [5].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;top:0;left:0;right:0;bottom:0;box-sizing:border-box !important;overflow-wrap:break-word !important;width:677px !important;visibility:visible !important"/></p></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">涉及变化的部分包括：</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><ol style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">CI中多了构建docker image的步骤</span></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">自动化测试过程中将数据库升级从应用中剥离单独做成docker image</span></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">生产中用Kubernetes自带的Service替代了Eruka</span></p></li></ol></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">理由下文一一道来。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">Spring Cloud与Kubernetes的融合</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">我们使用的是Redhat的OpenShift，可以认为是Kubernetes企业版，其本身就有Service的概念。一个Service下有多个Pod，Pod内即是一个可服务单元。Service之间互相调用时Kubernetes会提供默认的负载均衡控制，发起调用方只需要写被调用方的ServiceId即可。这一点和Spring Cloud Fegin使用Ribbon提供的功能如出一辙。也就是说服务治理可以通过Kubernetes来解决，那么为什么要替换呢？其实上文提到了，Spring Cloud技术栈对于异构语言的支持问题，我们有许多BFF（Backend for Frontend）是使用Node.js实现的，这些服务要想融合到Spring Cloud中，服务注册，负载均衡，心跳检查等等都要自己实现。如果以后还有其他语言架构的服务加入进来，这些轮子又要重造。基于此类原因综合考量后，决定采用OpenShift所提供的网络能力替换Eruka。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">由于本地开发和联调过程中依然依赖Eruka，所以只在生产上通过配置参数来控制：</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;list-style-type:square"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:left;box-sizing:border-box !important;overflow-wrap:break-word !important">eureka.client.enabled设置为false，停止各服务的Eureka注册</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:left;box-sizing:border-box !important;overflow-wrap:break-word !important">ribbon.eureka.enabled设置为false，让Ribbon不从Eureka获取服务列表</p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;padding-right:10px;padding-left:9px;min-height:1em;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:left;box-sizing:border-box !important;overflow-wrap:break-word !important">以服务foo为例，foo.ribbon.listofservers 设置为 http://foo:8080，那么当一个服务需要使用服务foo的时候，就会直接调用到http://foo:8080</p></li></ul><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></p></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important">CI的改造</strong></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">CI的改造主要是多了一部编译docker image并打包到Harbor的过程，部署时会直接从Harbor拉取镜像。另一个就是数据库的升级工具。之前我们使用flyway作为数据库升级工具，当应用启动时自动执行SQL脚本。随着服务实例越来越多，一个服务的多个实例同时升级的情况也时有发生，虽然flyway是通过数据库锁实现了升级过程不会有并发，但会导致被锁服务启动时间变长的问题。从实际升级过程来看，将可能发生的并发升级变为单一进程可能更靠谱。此外后期分库分表的架构也会使随应用启动自动升级数据库变的困难。综合考量，我们将升级任务做了拆分，每个服务都有自己的升级项目并会做容器化。在使用时，作为run once的工具来使用，即docker run -rm的方式。并且后续也支持了设定目标版本的功能，在私有化项目的跨版本升级中起到了非常好的效果。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">至于自动部署，由于服务之间存在上下游关系，例如Config，Eruka等属于基本服务被其他服务依赖，部署也产生了先后顺序。基于Jenkins做Pipeline可以很好的解决这个问题。</div></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;letter-spacing:0.544px;white-space:normal;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;widows:1;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;padding:10px 0;color:rgb(62,62,62);text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding:0.5em;display:inline-block;border-bottom:3px solid rgb(0,0,0);border-top-color:rgb(0,0,0);border-right-color:rgb(0,0,0);border-left-color:rgb(0,0,0);box-sizing:border-box !important;overflow-wrap:break-word !important"><h3 style="font-weight:400;font-size:16px;margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:18px;box-sizing:border-box !important;overflow-wrap:break-word !important"><strong style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(0,0,0);font-family:宋体;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(60,60,60);font-size:16px;font-weight:700;letter-spacing:1px;text-align:center;widows:1;background-color:rgb(255,255,255)">小结</span></span></strong></span></h3></div></div></div></div></div></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;line-height:27.2px;white-space:normal;widows:1;background-color:rgb(255,255,255);box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important">其实以上的每一点都可以深入的写成一篇文章，微服务的架构演进涉及到开发，测试和运维，要求团队内多工种紧密合作。分治是软件行业解决大系统的不二法门，作为小团队我们并没有盲目追新，而是在发展的过程通过服务化的方式解决问题。从另一方面我们也体会到了微服务对于人的要求，以及对于团队的挑战都比过去要高要大。未来仍需探索，演进仍在路上。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:left;box-sizing:border-box !important;overflow-wrap:break-word !important">作者：Dean，曾就职SAP，目前在初创团队任职架构师。</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:left;box-sizing:border-box !important;overflow-wrap:break-word !important"><br style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"/></div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:left;box-sizing:border-box !important;overflow-wrap:break-word !important">原文链接：</div><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-right:10px;padding-left:9px;font-size:15px;letter-spacing:1px;line-height:1.8;color:rgb(60,60,60);text-align:left;box-sizing:border-box !important;overflow-wrap:break-word !important">https://deanwangpro.com/2019/02/18/road-of-microservice/</div></div><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></p><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;font-size:16px;font-family:微软雅黑;text-align:center;line-height:1.75em;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640 [1].gif" type="image/gif" data-filename="640.gif" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;border-width:0;border-style:none;border-color:initial;box-sizing:border-box !important;overflow-wrap:break-word !important;visibility:visible !important;width:auto !important" title="分割线"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;font-size:16px;font-family:微软雅黑;line-height:25.6px;box-sizing:border-box !important;overflow-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;box-sizing:border-box !important;overflow-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><img src="小团队的微服务之路_files/640 [6].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;box-sizing:border-box !important;overflow-wrap:break-word !important;visibility:visible !important;width:677px !important"/></p><div style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0.544px;widows:1;line-height:25.6px;box-sizing:border-box !important;overflow-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;margin-bottom:10px;min-height:1em;text-align:center;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);font-size:14px;box-sizing:border-box !important;overflow-wrap:break-word !important">推荐阅读</span></p></div><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;list-style-type:square"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);text-decoration:underline;-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:12px;box-sizing:border-box !important;overflow-wrap:break-word !important"><a href="http://mp.weixin.qq.com/s?__biz=MzI5ODQ2MzI3NQ==&amp;mid=2247486341&amp;idx=1&amp;sn=53b0c92deb0cb87e83cd36a973b3e140&amp;chksm=eca432c1dbd3bbd7d829f251371055c2ab1282adf857214917c23159fcc5d41a38914e10b72b&amp;scene=21#wechat_redirect" style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);text-decoration:underline;-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:12px;box-sizing:border-box !important;overflow-wrap:break-word !important" target="_blank">Kubernetes 干货文章精选</a></span></p></li></ul></div></div><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em;list-style-type:square"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);text-decoration:underline;-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:12px;box-sizing:border-box !important;overflow-wrap:break-word !important"><a href="http://mp.weixin.qq.com/s?__biz=MzI5ODQ2MzI3NQ==&amp;mid=2247486349&amp;idx=1&amp;sn=1d6796352341d8c5732e3940fafc4231&amp;chksm=eca432c9dbd3bbdfc56afc2b875eb9c23c76e63ad586e054c3831446e427b8d0db0b0ba9bbb1&amp;scene=21#wechat_redirect" style="margin:0;padding:0;text-decoration:none;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box !important;overflow-wrap:break-word !important" target="_blank">如何顺利完成Kubernetes源码编译？</a></span></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);text-decoration:underline;font-size:12px;box-sizing:border-box !important;overflow-wrap:break-word !important"><a href="http://mp.weixin.qq.com/s?__biz=MzI5ODQ2MzI3NQ==&amp;mid=2247486368&amp;idx=1&amp;sn=650235a53a413806adb2a146db66462d&amp;chksm=eca432e4dbd3bbf2bc36b49458f52984fee77111e0648d77fb394475a5458e2952b24aebf5c8&amp;scene=21#wechat_redirect" style="margin:0;padding:0;text-decoration:none;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box !important;overflow-wrap:break-word !important" target="_blank">Go语言负责人：专属于云的编程语言！</a></span></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);text-decoration:underline;-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:12px;box-sizing:border-box !important;overflow-wrap:break-word !important"><a href="http://mp.weixin.qq.com/s?__biz=MzI5ODQ2MzI3NQ==&amp;mid=2247486373&amp;idx=1&amp;sn=768dccdc825226f481ec34a2c0672ccd&amp;chksm=eca432e1dbd3bbf7d9e04f5ef953808fac60dc1b7c09e32c38261d6f5b969ac7112075f08b3c&amp;scene=21#wechat_redirect" style="margin:0;padding:0;text-decoration:none;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box !important;overflow-wrap:break-word !important" target="_blank">Kubernetes 2018 年度简史，2019 年预测</a></span></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;box-sizing:border-box !important;overflow-wrap:break-word !important"><span style="margin:0;padding:0;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);text-decoration:underline;-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:12px;box-sizing:border-box !important;overflow-wrap:break-word !important"><a href="http://mp.weixin.qq.com/s?__biz=MzI5ODQ2MzI3NQ==&amp;mid=2247486403&amp;idx=1&amp;sn=1849a6ada3505c8f040d2b1263605b0c&amp;chksm=eca43287dbd3bb91d090258e3dea4f508f0d25cd995adcb0fd8e8970bd5972febe7a880aeae9&amp;scene=21#wechat_redirect" style="margin:0;padding:0;text-decoration:none;max-width:100% !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:rgb(2,30,170);-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box !important;overflow-wrap:break-word !important" target="_blank">Kubernetes上生产，7大因素带你上王者</a></span></p></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:12px;color:rgb(2,30,170);text-decoration:underline"><a href="http://mp.weixin.qq.com/s?__biz=MzI5ODQ2MzI3NQ==&amp;mid=2247486424&amp;idx=1&amp;sn=434aae13564d6c9cc7af8c109b74a43f&amp;chksm=eca4329cdbd3bb8ac96afa597e7efdd5fce0ac071ec635738e310166c3bd063d33b99ef88b31&amp;scene=21#wechat_redirect" style="margin:0;padding:0;-webkit-tap-highlight-color:rgba(0,0,0,0);max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:12px;color:rgb(2,30,170);text-decoration:underline" target="_blank">萌新深入理解负载均衡</a></span></p></li></ul></div></div><ul style="margin:0;padding:0"></ul></div></div></div></span>
</div></body></html> 