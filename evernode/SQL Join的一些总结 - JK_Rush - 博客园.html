<html>
<head>
  <title>SQL Join的一些总结 - JK_Rush - 博客园</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="7306"/>
<h1>SQL Join的一些总结 - JK_Rush - 博客园</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2015/9/9 16:53</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://www.cnblogs.com/rush/archive/2012/03/27/2420246.html"><i>http://www.cnblogs.com/rush/archive/2012/03/27/2420246.html</i></a></td></tr>
</table>
</div>
<br/>

<div><span><br/><div style="font-size: 16px"><div style="outline:none 0px;"><div style="outline:none 0px;font-family:verdana, Arial, Helvetica, sans-serif;color:rgb(51, 51, 51);font-size:10pt;line-height:1.8em;background:url(http://images.cnblogs.com/cnblogs_com/rush/268781/o_bg-clouds.png) 0% 0px no-repeat fixed rgb(192, 222, 237);"><div style="outline:none 0px;"><div style="outline:none 0px;"><div style="outline:none 0px;background:rgb(222, 231, 222);border-radius:10px;"><div style="outline:none 0px;background:none 0px 0px repeat scroll white;border-radius:10px;"><div style="outline:none 0px;"><div style="outline:none 0px;"><div style="outline:none 0px;"><div style="outline:none 0px;font-size:15px;line-height:1.8;font-family:'Microsoft Yahei', Tahoma, Arial, Helvetica, STHeiti;"><div style="outline:none 0px;word-break:break-word;"><h1 style="font-size:28px;margin:0px;outline:none 0px;padding:0px;margin-bottom:15px;color:white;border-radius:3px;padding-top:5px;letter-spacing:1px;line-height:1.8;margin-top:15px;padding-bottom:5px;padding-left:20px;background:none 0px 0px repeat scroll rgb(72, 61, 139);font-weight:bold;">1.1.1 摘要</h1>  <p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">Join是关系型数据库系统的重要操作之一，SQL Server中包含的常用Join：内联接、外联接和交叉联接等。如果我们想在两个或以上的表获取其中从一个表中的行与另一个表中的行匹配的数据，这时我们应该考虑使用Join，因为Join具体联接表或函数进行查询的特性</p>  <p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">本文将通过具体例子介绍SQL中的各种常用Join的特性和使用场合：</p>  <h2 style="margin:0px;padding:0px;outline:none 0px;color:rgb(25, 119, 176);line-height:1.8;padding-left:20px;font-weight:bold;font-size:21px;">目录</h2>  <ul style="margin:0px;padding:0px;outline:none 0px;margin-left:30px;list-style-type:disc;padding-left:0px;">   <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.cnblogs.com/rush/archive/2012/03/27/2420246.html#lb1" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">Inner join</a> </li>    <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.cnblogs.com/rush/archive/2012/03/27/2420246.html#lb2" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">Outer join </a></li>    <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.cnblogs.com/rush/archive/2012/03/27/2420246.html#lb3" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">Cross join </a></li>    <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.cnblogs.com/rush/archive/2012/03/27/2420246.html#lb4" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">Cross apply </a></li>    <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.cnblogs.com/rush/archive/2012/03/27/2420246.html#lb5" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">Cross apply 和 Inner join的区别</a> </li>    <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.cnblogs.com/rush/archive/2012/03/27/2420246.html#lb6" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">Semi-join和Anti-semi-join</a> </li> </ul>  <h1 style="font-size:28px;margin:0px;outline:none 0px;padding:0px;margin-bottom:15px;color:white;border-radius:3px;padding-top:5px;letter-spacing:1px;line-height:1.8;margin-top:15px;padding-bottom:5px;padding-left:20px;background:none 0px 0px repeat scroll rgb(72, 61, 139);font-weight:bold;">1.1.2 正文</h1>  <p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">首先我们在tempdb中分别定义三个表College、Student和Apply，具体SQL代码如下：</p>  <pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">USE </span>tempdb

<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- If database exists the same name datatable deletes it.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">IF </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">EXISTS(</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>TABLE_NAME <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">INFORMATION_SCHEMA.TABLES </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">WHERE </span>TABLE_NAME <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:red;">'College'</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">) </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">DROP TABLE </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">;
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">IF </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">EXISTS(</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>TABLE_NAME <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">INFORMATION_SCHEMA.TABLES </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">WHERE </span>TABLE_NAME <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:red;">'Student'</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">) </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">DROP TABLE </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">;
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">IF </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">EXISTS(</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>TABLE_NAME <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">INFORMATION_SCHEMA.TABLES </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">WHERE </span>TABLE_NAME <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:red;">'Apply'</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">) </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">DROP TABLE </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">Apply;

</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Create Database.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">create table </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>cName <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">nvarchar</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>50<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">), </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">state text</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>enrollment <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">int</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">);
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">create table </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">sID int</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>sName <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">nvarchar</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>50<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">), </span>GPA <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">real</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>sizeHS <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">int</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">);
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">create table </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">Apply(</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">sID int</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>cName <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">nvarchar</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>50<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">), </span>major <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">nvarchar</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>50<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">), </span>decision <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">text</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">);</span></pre>

<h2 style="margin:0px;padding:0px;outline:none 0px;color:rgb(25, 119, 176);line-height:1.8;padding-left:20px;font-weight:bold;font-size:21px;">Inner join</h2>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><b style="margin:0px;padding:0px;outline:none 0px;">内联接</b>（Inner join）是最常用的联接类型之一，它查询满足联接谓词的数据。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">假设我们要查询申请表Apply中申请学校的相关信息，由于Apply表中包含学校名字我们并不能预知，所以我们可以根据cName来<b style="margin:0px;padding:0px;outline:none 0px;">内联接</b>（Inner join）表College和Apply，从而找到Apply表中包含学校的信息。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">具体SQL代码如下：</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Gets college information from college table
---- bases on college name.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT DISTINCT </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>enrollment
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM  </span>College <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">INNER JOIN
        Apply </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">ON </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>cName <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= Apply.</span>cName</pre>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272151491835.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272151578468.png" type="image/png" data-filename="201203272151578468.png" alt="join0" border="0" height="158" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join0" width="238"/></a></p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图1查询结果</p>

<div align="center" style="margin:0px;padding:0px;outline:none 0px;">
  <table align="center" border="0" cellpadding="2" cellspacing="0" style="outline:none 0px;font-size:12px;font-style:inherit;font-variant:inherit;margin:0px 1.5em 0px 0px;padding:0px;font-weight:inherit;line-height:1.3;border-spacing:0px;border-collapse:collapse;border:1px solid silver;word-break:break-word;" width="400"><tbody style="margin:0px;padding:0px;outline:none 0px;">
      <tr style="margin:0px;padding:0px;outline:none 0px;background:none 0px 0px repeat scroll rgb(255, 255, 255);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">cName</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">state</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">enrollment</td>
      </tr>

      <tr style="margin:0px;padding:0px;outline:none 0px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(122, 160, 205);border-top-width:1px;border-top-style:solid;border-top-color:rgb(122, 160, 205);background:none 0px 0px repeat scroll rgb(211, 223, 237);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">Stanford</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">CA</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">15000</td>
      </tr>

      <tr style="margin:0px;padding:0px;outline:none 0px;background:none 0px 0px repeat scroll rgb(255, 255, 255);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">Berkeley</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">CA</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">36000</td>
      </tr>

      <tr style="margin:0px;padding:0px;outline:none 0px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(122, 160, 205);border-top-width:1px;border-top-style:solid;border-top-color:rgb(122, 160, 205);background:none 0px 0px repeat scroll rgb(211, 223, 237);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">MIT</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">MA</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">10000</td>
      </tr>

      <tr style="margin:0px;padding:0px;outline:none 0px;background:none 0px 0px repeat scroll rgb(255, 255, 255);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">Cornell</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">NY</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">21000</td>
      </tr>

      <tr style="margin:0px;padding:0px;outline:none 0px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(122, 160, 205);border-top-width:1px;border-top-style:solid;border-top-color:rgb(122, 160, 205);background:none 0px 0px repeat scroll rgb(211, 223, 237);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">Harvard</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">MA</td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="133">29000</td>
      </tr>
    </tbody></table>
</div>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">表1 College表中的数据</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">如上图1所示，我们把Apply表包含的学校信息查询出来了，由于Harvard并没有被查询出来，所以我们知道暂时还没有学生申请Harvard。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><b style="margin:0px;padding:0px;outline:none 0px;">内联接</b>（Inner join）满足交换律：“A inner join B” 和 “B inner join A” 是相等的。</p>

<h2 style="margin:0px;padding:0px;outline:none 0px;color:rgb(25, 119, 176);line-height:1.8;padding-left:20px;font-weight:bold;font-size:21px;">Outer join</h2>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">假设我们想看到所有学校信息；即使是那些没有申请的学校（如：Harvard），这时我们可以使用<b style="margin:0px;padding:0px;outline:none 0px;">外部联接</b>（Outer join）进行查询。由于<b style="margin:0px;padding:0px;outline:none 0px;">外部联接</b>保存一个或两个输入表的所有行，即使无法找到匹配联接谓词的行。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">具体SQL代码如下：</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Gets all college information
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>state<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>enrollment<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">,
Apply.</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, Apply.</span>major<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, Apply.</span>decision
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM  </span>College <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">LEFT OUTER JOIN
        Apply </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">ON </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>cName <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= Apply.</span>cName</pre>
<a href="http://11011.net/software/vspaste" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"></a>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272151596601.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272152026827.png" type="image/png" data-filename="201203272152026827.png" alt="join3" border="0" height="227" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join3" width="387"/></a></p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图2左联接查询结果</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">如上图3所示：由于在Apply表中并没有学生申请Harvard，但是我们通过<b style="margin:0px;padding:0px;outline:none 0px;">左联接</b>（left outer join）把所有学校信息查询出来了。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">由于<b style="margin:0px;padding:0px;outline:none 0px;">左联接</b>（left outer join）产生表College的完全集，而Apply表中匹配的则有值，而不匹配的则以NULL值取代，所以我们知道Apply表中没有学生申请Harvard。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">通过<b style="margin:0px;padding:0px;outline:none 0px;">左联接</b>查询我们可以获取College的完全集，假设现在我们既要获取College的完全集又要获取Apply的完全集，那么我们可以考虑使用<b style="margin:0px;padding:0px;outline:none 0px;">完整外部联接</b>（full outer join）。使用<b style="margin:0px;padding:0px;outline:none 0px;">完整外部联接</b>，我们可以查询所有的学校，不管它们是否匹配联接谓词：</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Gets all information from college and apply table.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>state<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>enrollment<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">,
Apply.</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, Apply.</span>major<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, Apply.</span>decision
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM  </span>College <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">FULL OUTER JOIN
        Apply </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">ON </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>cName <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= Apply.</span>cName </pre>
<a href="http://11011.net/software/vspaste" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"></a>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272152065558.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272152113983.png" type="image/png" data-filename="201203272152113983.png" alt="join4" border="0" height="225" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join4" width="391"/></a></p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图3 完整外部联接查询结果</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">现在我们获取了College和Apply的完全数据集，对于表中匹配的则有值，即使没有找到匹配cName的则以NULL值取代。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">下表显示每种<b style="margin:0px;padding:0px;outline:none 0px;">外部联接</b>（outer join）匹配时保留数据行的情况：</p>

<div align="center" style="margin:0px;padding:0px;outline:none 0px;">
  <table align="center" border="1" cellpadding="0" cellspacing="0" style="outline:none 0px;font-size:12px;font-style:inherit;font-variant:inherit;margin:0px 1.5em 0px 0px;padding:0px;font-weight:inherit;line-height:1.3;border-spacing:0px;border-collapse:collapse;border:1px solid silver;word-break:break-word;"><tbody style="margin:0px;padding:0px;outline:none 0px;">
      <tr style="margin:0px;padding:0px;outline:none 0px;background:none 0px 0px repeat scroll rgb(255, 255, 255);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="284">
          <p style="padding:0px;outline:none 0px;text-align:left;margin:10px auto;text-indent:0px;">联接类型</p>
        </td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="284">
          <p style="padding:0px;outline:none 0px;text-align:left;margin:10px auto;text-indent:0px;">保留数据行</p>
        </td>
      </tr>

      <tr style="margin:0px;padding:0px;outline:none 0px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(122, 160, 205);border-top-width:1px;border-top-style:solid;border-top-color:rgb(122, 160, 205);background:none 0px 0px repeat scroll rgb(211, 223, 237);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="284">
          <p style="padding:0px;outline:none 0px;text-align:left;margin:10px auto;text-indent:0px;">A left outer join B</p>
        </td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="284">
          <p style="padding:0px;outline:none 0px;text-align:left;margin:10px auto;text-indent:0px;">all A rows</p>
        </td>
      </tr>

      <tr style="margin:0px;padding:0px;outline:none 0px;background:none 0px 0px repeat scroll rgb(255, 255, 255);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="284">
          <p style="padding:0px;outline:none 0px;text-align:left;margin:10px auto;text-indent:0px;">A right outer join B</p>
        </td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="284">
          <p style="padding:0px;outline:none 0px;text-align:left;margin:10px auto;text-indent:0px;">all B rows</p>
        </td>
      </tr>

      <tr style="margin:0px;padding:0px;outline:none 0px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(122, 160, 205);border-top-width:1px;border-top-style:solid;border-top-color:rgb(122, 160, 205);background:none 0px 0px repeat scroll rgb(211, 223, 237);">
        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-width:1px;border-right-style:solid;border-right-color:rgb(204, 204, 204);padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="284">
          <p style="padding:0px;outline:none 0px;text-align:left;margin:10px auto;text-indent:0px;">A full outer join B</p>
        </td>

        <td style="margin:0px;outline:none 0px;text-align:left;white-space:normal;border-right-color:rgb(204, 204, 204);border-right-width:medium;border-right-style:none;padding:3px;border:1px solid silver;border-collapse:collapse;" valign="top" width="284">
          <p style="padding:0px;outline:none 0px;text-align:left;margin:10px auto;text-indent:0px;">all A and B rows</p>
        </td>
      </tr>
    </tbody></table>
</div>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">表2 外部联接保留数据行</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><b style="margin:0px;padding:0px;outline:none 0px;">完整外部联接</b>（full outer join）满足交换律：“A full outer join B” 和 “B full outer join A” 是相等的。</p>

<h2 style="margin:0px;padding:0px;outline:none 0px;color:rgb(25, 119, 176);line-height:1.8;padding-left:20px;font-weight:bold;font-size:21px;">Cross join</h2>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><b style="margin:0px;padding:0px;outline:none 0px;">交叉联接</b>（cross join）执行两个表的笛卡尔积（就是把表A和表B的数据进行一个N*M的组合）。也就是说，它匹配一个表与另一个表中的每一行；我们不能通过使用ON子句在<b style="margin:0px;padding:0px;outline:none 0px;">交叉联接</b>指定谓词，虽然我们可以使用WHERE子句来实现相同的结果，这是<b style="margin:0px;padding:0px;outline:none 0px;">交叉联接</b>基本上是作为一个<b style="margin:0px;padding:0px;outline:none 0px;">内部联接</b>了。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><b style="margin:0px;padding:0px;outline:none 0px;">交叉联接</b>相对于<b style="margin:0px;padding:0px;outline:none 0px;">内部联接</b>使用率较低，而且两个大表不应该进行<b style="margin:0px;padding:0px;outline:none 0px;">交叉联接</b>，因为这将导致一个非常昂贵的操作和一个非常大的结果集。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">具体SQL代码如下：</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- College Cross join Apply.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>state<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>College<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>enrollment<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">,
Apply.</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, Apply.</span>major<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, Apply.</span>decision
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>College
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">CROSS JOIN Apply</span></pre>
<a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272152151569.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272152166421.png" type="image/png" data-filename="201203272152166421.png" alt="join5" border="0" height="187" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join5" width="308"/></a> 

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图4 College表和Apply表的行数</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272152225237.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272152242040.png" type="image/png" data-filename="201203272152242040.png" alt="join6" border="0" height="205" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join6" width="412"/></a></p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图5 交叉联接</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">现在我们对College和Apply表进行交叉联接，而且生成数据行为College和Apply表行数的笛卡尔积即5 * 20 = 100。</p>

<h2 style="margin:0px;padding:0px;outline:none 0px;color:rgb(25, 119, 176);line-height:1.8;padding-left:20px;font-weight:bold;font-size:21px;">Cross apply</h2>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">在SQL Server 2005中提供了Cross apply使表可以和表值函数（table-valued functions TVF‘s）结果进行join查询。例如，现在我们想通过函数的结果值和表Student进行查询，这时我们可以使用Cross apply进行查询：</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Creates a function to get data from Apply base on sID.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">CREATE FUNCTION </span>dbo<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>fn_Apply<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>@sID <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">int</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">)
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">RETURNS </span>@Apply <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">TABLE </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>cName <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">nvarchar</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>50<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">), </span>major <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">nvarchar</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>50<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">))
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">AS
BEGIN
  INSERT </span>@Apply <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>major <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">Apply </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">where </span>[sID] <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= </span>@sID
  <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">RETURN    
END
 
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Student cross apply function fn_Apply.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>GPA<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sizeHS<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">,
</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>major 
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>Student <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">CROSS APPLY </span>dbo<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>fn_Apply<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>[sID]<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">)</span></pre>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">我们也可以使用<b style="margin:0px;padding:0px;outline:none 0px;">内部联接</b>实现和Cross apply相同的查询功能，具体SQL代码如下：</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Student INNER JOIN Apply bases on sID.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>GPA<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sizeHS<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">,
</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>major 
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>Student <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">INNER JOIN </span>[Apply]
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">ON </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= </span>[Apply]<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID</pre>
<a href="http://11011.net/software/vspaste" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"></a><a href="http://11011.net/software/vspaste" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"></a>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272152256052.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272152366816.png" type="image/png" data-filename="201203272152366816.png" alt="join7" border="0" height="217" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join7" width="381"/></a></p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图6 Cross apply查询</p>

<h2 style="margin:0px;padding:0px;outline:none 0px;color:rgb(25, 119, 176);line-height:1.8;padding-left:20px;font-weight:bold;font-size:21px;">Outer apply</h2>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">在介绍Cross apply和Outer join之后，现在让我们理解Out apply也就不难了，Outer apply使表可以和表值函数（table-valued functions TVF‘s）结果进行join查询，找到匹配值则有值，没有找到匹配值则以NULL表示。</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Student outer apply function fn_Apply.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>GPA<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sizeHS<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">,
</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>major 
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>Student <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">OUTER APPLY </span>dbo<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>fn_Apply<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>[sID]<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">)</span></pre>
<a href="http://images.cnblogs.com/cnblogs_com/rush/201203/2012032721524292.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272152432152.png" type="image/png" data-filename="201203272152432152.png" alt="join10" border="0" height="244" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join10" width="348"/></a> 

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图7 Outer apply查询</p>

<h2 style="margin:0px;padding:0px;outline:none 0px;color:rgb(25, 119, 176);line-height:1.8;padding-left:20px;font-weight:bold;font-size:21px;">Inner Join和Cross apply的区别</h2>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">首先我们知道Inner join是表和表的联接查询，而Cross apply是表和表值函数的联接查询，在前面Cross apply例子中，我们也可以通过Inner join实现相同的查询。</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Student cross apply function fn_Apply.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SET STATISTICS PROFILE ON
SET STATISTICS TIME ON

SELECT </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>GPA<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sizeHS<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">,
</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>major 
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>Student <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">CROSS APPLY </span>dbo<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>fn_Apply<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">(</span>[sID]<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">)

</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SET STATISTICS PROFILE OFF
SET STATISTICS TIME OFF
</span></pre>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Student INNER JOIN Apply base on sID.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SET STATISTICS PROFILE ON
SET STATISTICS TIME ON

SELECT </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>GPA<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sizeHS<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">,
</span>cName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>major 
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>Student <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">INNER JOIN </span>[Apply]
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">ON </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= </span>[Apply]<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID

<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SET STATISTICS PROFILE OFF
SET STATISTICS TIME OFF</span></pre>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">Cross apply查询执行时间:</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">CPU 时间= 0 毫秒，占用时间= 11 毫秒。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">Inner join查询执行时间:</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">CPU 时间= 0 毫秒，占用时间= 4 毫秒。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272152457287.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272152463807.png" type="image/png" data-filename="201203272152463807.png" alt="join8" border="0" height="324" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join8" width="596"/></a></p>
<a href="http://11011.net/software/vspaste" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"></a>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图8 执行计划</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">如图8所示：Cross apply首先执行TVF（table-valued functions），然后对表Studnet进行全表扫描，接着通过遍历sID查找匹配值。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">Inner join对表Student和Apply进行全表扫描，然后通过哈希匹配查找匹配的sID值。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">通过以上的SQL执行时间和执行计划，我们能不能说Inner join比Cross apply好呢？答案是否定的，如果表的数据量很大，那么Inner join的全表扫描耗费时间和CPU资源就增加了（可通过数据量大的表进行测试）。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">虽然大多数采用Cross apply实现的查询，可以通过Inner join实现，但Cross apply可能产生更好的执行计划和更佳的性能，因为它可以在联接执行之前限制集合加入。</p>

<h2 style="margin:0px;padding:0px;outline:none 0px;color:rgb(25, 119, 176);line-height:1.8;padding-left:20px;font-weight:bold;font-size:21px;">Semi-join和Anti-semi-join</h2>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">Semi-join从一个表中返回的行与另一个表中数据行进行不完全联接查询（查找到匹配的数据行就返回，不再继续查找）。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">Anti-semi-join从一个表中返回的行与另一个表中数据行进行不完全联接查询，然后返回不匹配的数据。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">不同于其他的联接运算，Semi-join和Anti-semi-join没有明确的语法来实现，但Semi-join和Anti-semi-join在SQL Server中有多种应用场合。我们可以使用EXISTS子来实现Semi-join查询，Not EXISTS来实现Anti-semi-join。现在让我们通过具体的例子说明吧！</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">假设要求我们找出Apply和Student表中sID匹配的学生信息，这和前面的Inner join查询结果将一样，具体SQL代码如下：</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Student Semi-join Apply base on sID.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>GPA<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sizeHS
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">----[Apply].cName, [Apply].major 
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>Student
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">WHERE </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">exists (
    </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">*
    </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">from </span>[Apply]
    <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">where </span>[Apply]<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">)</span></pre>
<a href="http://11011.net/software/vspaste" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"></a>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">我们发现常用的EXISTS子句，原来是通过Left Semi Join实现的，所以说Semi-join在SQL Server中又许多使用场合。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272152488102.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272152524608.png" type="image/png" data-filename="201203272152524608.png" alt="join13" border="0" height="198" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join13" width="266"/></a></p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图9 查询结果</p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272152527607.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272153046385.png" type="image/png" data-filename="201203272153046385.png" alt="join12" border="0" height="122" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join12" width="521"/></a></p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图10 执行计划</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">现在要求我们找出还没有申请学校的学生信息，这时我们立刻反应可以使用NOT EXISTS子句来实现该查询，具体SQL代码如下：</p>

<pre style="outline:none 0px;white-space:pre-wrap;word-wrap:break-word;margin:0px 20px 20px;padding:7px;font-family:Consolas, 微软雅黑, Arial, 宋体, sans-serif;font-size:12px;border:1px solid rgb(192, 192, 192);border-radius:5px;background-color:rgb(219, 234, 255);"><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">---- Gets student still not apply for school.
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sName<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>GPA<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">, </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sizeHS
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:green;">----[Apply].cName, [Apply].major 
</span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>Student
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">WHERE </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">NOT EXISTS (
    </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">SELECT </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">*
    </span><span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">FROM </span>[Apply]
    <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:blue;">WHERE </span>[Apply]<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID <span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">= </span>Student<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">.</span>sID
<span style="margin:0px;padding:0px;outline:none 0px;line-height:1.8;color:gray;">)

</span></pre>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">其实，我们常用的NOT EXISTS子句的实现是通过Anti-semi-join，通过执行计划我们发现在查找匹配sID时，SQL使用 Left Anti Semi Join进行查询。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272153093316.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272153143933.png" type="image/png" data-filename="201203272153143933.png" alt="join14" border="0" height="158" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join14" width="256"/></a></p>
<a href="http://11011.net/software/vspaste" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"></a>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图11 查询结果</p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;"><a href="http://images.cnblogs.com/cnblogs_com/rush/201203/201203272153373965.png" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;"><img src="SQL Join的一些总结 - JK_Rush - 博客园_files/201203272153414092.png" type="image/png" data-filename="201203272153414092.png" alt="join15" border="0" height="153" style="display:block;margin:0px;outline:none 0px;border-left-width:0px;margin-left:auto;border-right-width:0px;padding:0px;float:none;border-top-width:0px;border-bottom-width:0px;border:0px;margin-bottom:0px;margin-right:auto;" title="join15" width="435"/></a></p>

<p align="center" style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">图12 执行计划</p>

<h1 style="font-size:28px;margin:0px;outline:none 0px;padding:0px;margin-bottom:15px;color:white;border-radius:3px;padding-top:5px;letter-spacing:1px;line-height:1.8;margin-top:15px;padding-bottom:5px;padding-left:20px;background:none 0px 0px repeat scroll rgb(72, 61, 139);font-weight:bold;">1.1.3 总结</h1>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">本文介绍了SQL中常用了联接查询方式：Inner join、Outer join、Cross join和Cross apply的使用场合和特性。</p>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">系列博文导航</p>

<ul style="margin:0px;padding:0px;outline:none 0px;margin-left:30px;list-style-type:disc;padding-left:0px;">
  <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.cnblogs.com/rush/archive/2012/02/19/2358209.html" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;" target="_blank">Deadlock的一些总结</a> </li>

  <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.cnblogs.com/rush/archive/2011/12/11/2284262.html" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;" target="_blank">SQL Transcation的一些总结</a> </li>
</ul>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">参考</p>

<ul style="margin:0px;padding:0px;outline:none 0px;margin-left:30px;list-style-type:disc;padding-left:0px;">
  <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://coolshell.cn/articles/3463.html" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">http://coolshell.cn/articles/3463.html</a> </li>

  <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html</a> </li>

  <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://blogs.msdn.com/b/craigfr/archive/2006/07/19/671712.aspx" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;">http://blogs.msdn.com/b/craigfr/archive/2006/07/19/671712.aspx</a> </li>
</ul>

<p style="padding:0px;outline:none 0px;margin:10px auto;text-indent:0px;">SQL代码</p>

<ul style="margin:0px;padding:0px;outline:none 0px;margin-left:30px;list-style-type:disc;padding-left:0px;">
  <li style="margin:0px;padding:0px;outline:none 0px;list-style-type:disc;list-style:inherit;"><a href="http://files.cnblogs.com/rush/Sample.rar" style="margin:0px;padding:0px;outline:none 0px;color:rgb(255, 119, 0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51, 51, 51);border:0px;text-decoration:none;" title="http://files.cnblogs.com/rush/Sample.rar">http://files.cnblogs.com/rush/Sample.rar</a> </li>
</ul></div></div></div></div></div></div></div></div></div></div></div></div><br/></span>
</div></body></html> 