<html>
<head>
  <title>base64出现空格的问题 - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5587"/>
<h1>base64出现空格的问题 - CSDN博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/5/22 18:44</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://blog.csdn.net/wang0928007/article/details/7429568"><i>https://blog.csdn.net/wang0928007/article/details/7429568</i></a></td></tr>
</table>
</div>
<br/>

<div><span>
  <div>
<div style="font-size: 16px; display: inline-block; min-width: 100%; position: relative;"><div style="outline:0px;box-sizing:border-box;"><div style="box-sizing:inherit;outline:0px;font-family:&quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, sans-serif;font-size:14px;line-height:1.57143;background-color:rgb(245, 246, 247);color:rgb(51, 51, 51);"><div style="outline:0px;box-sizing:content-box;"><span style="box-sizing:inherit;outline:0px;"><div style="box-sizing:inherit;outline:0px;background:rgb(255, 255, 255);box-shadow:rgba(0, 0, 0, 0.0470588) 0px 2px 4px 0px;">
	<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-bottom:16px;">
			<span style="border-radius:50%;display:inline-block;width:26px;height:26px;line-height:26px;text-align:center;font-size:12px;outline:0px;box-sizing:inherit;border:1px solid rgb(231, 244, 223);color:rgb(134, 202, 94);margin-right:8px;margin-top:4px;float:left;">转</span>		<h6 style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:24px;word-break:break-all;">base64出现空格的问题</h6>
	</div>
	<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;padding-bottom:14px;border-bottom:1px solid rgb(227, 227, 227);">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;color:rgb(133, 133, 133);display:flex;">
												<span style="box-sizing:inherit;outline:0px;margin-right:14px;">2012年04月05日 18:10:22</span>
			<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-left:auto;float:right;">
				<span style="box-sizing:inherit;outline:0px;margin-right:14px;">阅读数：24321</span>
											</div>
		</div>
	</div>
	<div style="box-sizing:inherit;outline:0px;display:block;position:relative;padding-top:16px;">
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;word-break:break-all;">
                    
            <div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-family:&quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;word-break:break-all;">
                
<span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;">如：将一串参数做了base64后直接作为url的一部分发送出去了。</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">要知道base64的算法有pad，crcf的控制选项，而又很凑巧，发使用的是none，即pading部分带有crcf，</span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">这样一个正常的参数输入，会产生类似于:</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">ancdfdsfdsfdsfsadfasfsafafdsafadsfsafasdfasdfsad</span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">fadfdsfsd==</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">注意上面换行的地方被加了cr cf 即0a 0d.</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">这样的url通过ie出去后，ie将0a 0d 转化为%20 即空格的编码？ 这个为什么我现在还没有找到资料.</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">另外和我合作的服务端通知反映，他读到的参数是乱码，检查后发现是受到了+的干扰。</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">从具体来说base64中+ / 比较特殊，而/ 实际上并没有产生干扰，而+在服务端通知读取时候变成了空格，注意是空格不是%20.</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">&quot;</span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> 加号(+)是BASE64编码的一部分，而加号在QueryString中被当成是空格。    因此，当一个含有BASE64编码的字符串直接作为URL的一部分时，如果其中含有加号，则使用QueryString读取时，再使用BASE64解码就会发生错误。    解决的办法有两个：一是使用BASE64的字符串作为URL的一部分是，使用UrlEncode一类的函数进行编码；二是在接收BASE64字符串后，使用ReplaceAll将字符串中的空格替换成加号，然后再解码。 
 &quot;</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">另外我从c端的抓包发现从c端发出的数据确实0a 0d 被替换为%20 %20发出，但是+ / 已然不变。</span><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"> </span><br style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;"/><span style="outline:0px;box-sizing:border-box;word-break:break-all;color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;text-align:left;">也就是说服务端必定有某个层次能够得到原始数据，而问题可能就像上面引用部分文字描述的那样，即+被querystring之类的API做了手脚比如urlencoding。 </span>
            </div>
                <span style="display:block;clear:both;"></span></div>
				
        	</div>
	
		<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;padding-bottom:16px;margin-top:36px;border-bottom:1px solid rgb(227, 227, 227);">
						<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;margin-bottom:8px;font-size:12px;">
			<span style="box-sizing:inherit;outline:0px;color:rgb(77, 77, 77);">文章标签：</span>
						<a href="http://so.csdn.net/so/search/s.do?q=url&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">url						</a><a href="http://so.csdn.net/so/search/s.do?q=ie&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">ie						</a><a href="http://so.csdn.net/so/search/s.do?q=%E7%AE%97%E6%B3%95&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">算法						</a><a href="http://so.csdn.net/so/search/s.do?q=api&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">api						</a><a href="http://so.csdn.net/so/search/s.do?q=c&amp;t=blog" style="color:rgb(77, 77, 77);cursor:pointer;text-decoration:none;outline:0px;box-sizing:inherit;display:inline-block;word-break:break-all;border:1px solid rgb(204, 204, 204);border-radius:100px;padding:0px 8px;text-align:center;line-height:24px;min-width:24px;height:24px;margin-right:8px;" target="_blank">c						</a>
		</div>
						<div style="box-sizing:inherit;outline:0px;padding:0px;margin:0px;font-size:12px;margin-bottom:0px;">
			<span style="box-sizing:inherit;outline:0px;color:rgb(77, 77, 77);">个人分类：</span>
						<a href="https://blog.csdn.net/wang0928007/article/category/1057479" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(121, 165, 229);word-break:break-all;" target="_blank">外围方法						</a><a href="https://blog.csdn.net/wang0928007/article/category/1060929" style="box-sizing:inherit;outline:0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(121, 165, 229);word-break:break-all;" target="_blank">JAVA						</a>
		</div>
					</div>
	
	
		</div></span></div></div></div></div>
</div>
</span>
</div></body></html> 